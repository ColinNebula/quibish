/**
 * PreviewAnimation.css
 * Provides smooth animations for message preview with minimal flickering
 */

/* Dynamic message preview with GPU acceleration */
.pro-message-blurb.dynamic-preview {
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  will-change: opacity;
  /* Optimized fade-in animation */
  transition: opacity 150ms ease-out;
}

/* Prevent width transitions that cause flickering */
.pro-message-blurb.dynamic-preview.horizontal-scale {
  transition: none;
  /* Use data attributes to control sizing */
  width: var(--dynamic-width, auto);
  /* Avoid transitions on position-affecting properties */
}

/* Set stable dimensions for different text lengths */
.pro-message-blurb.dynamic-preview[data-text-length="short"] {
  min-width: 180px;
  max-width: 40%;
  width: var(--dynamic-width, 240px);
}

.pro-message-blurb.dynamic-preview[data-text-length="medium"] {
  min-width: 220px;
  max-width: 60%;
  width: var(--dynamic-width, 320px);
}

.pro-message-blurb.dynamic-preview[data-text-length="long"] {
  min-width: 280px;
  max-width: 80%;
  width: var(--dynamic-width, 450px);
}

/* Smooth content fade in */
@keyframes fadeInContent {
  from { opacity: 0.7; }
  to { opacity: 1; }
}

/* Style for the preview text to clearly show it's a draft */
.pro-message-blurb.dynamic-preview .pro-blurb-text {
  opacity: 0.85;
  font-style: italic;
  animation: fadeInContent 300ms ease-out forwards;
  transition: none; /* Prevent text layout transitions */
}

/* Use a subtle but visible indicator for draft state */
.pro-message-blurb.dynamic-preview .pro-status-dot.sending {
  opacity: 0.6;
  animation: none; /* Disable any animations that might cause flickering */
}

/* When the preview card is about to be removed */
.pro-message-blurb.dynamic-preview.removing {
  opacity: 0;
  transition: opacity 200ms ease-out;
  pointer-events: none;
}

/* Improved focus styling to indicate the preview is active */
.pro-message-blurb.dynamic-preview.active-typing {
  border-color: rgba(99, 102, 241, 0.3);
  box-shadow: 0 6px 16px rgba(99, 102, 241, 0.12);
}

/* Ensure long text doesn't cause layout issues */
.pro-message-blurb.dynamic-preview .pro-blurb-text {
  max-height: 200px;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: rgba(0,0,0,0.2) transparent;
}

/* Mobile-optimized styles */
@media (max-width: 768px) {
  .pro-message-blurb.dynamic-preview {
    max-width: 85%;
  }
  
  .pro-message-blurb.dynamic-preview[data-text-length="short"] {
    width: var(--dynamic-width, 220px);
  }
  
  .pro-message-blurb.dynamic-preview[data-text-length="medium"] {
    width: var(--dynamic-width, 280px);
  }
  
  .pro-message-blurb.dynamic-preview[data-text-length="long"] {
    width: var(--dynamic-width, 320px);
  }
}

/* Support for reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .pro-message-blurb.dynamic-preview,
  .pro-message-blurb.dynamic-preview .pro-blurb-text {
    transition: opacity 150ms linear !important;
    animation: none !important;
  }
}