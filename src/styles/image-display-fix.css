/* Image Display Fixes - SCOPED TO MESSAGES AREA ONLY */

/* Global image fixes - general fallback */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* MESSAGE AREA SPECIFIC: Only apply to images within message containers */
.pro-message-list img,
.pro-message-container img,
.message-bubble img,
.pro-message-blurb img:not(.message-avatar img) {
  max-width: 100% !important;
  height: auto !important;
  width: auto !important;
  object-fit: contain !important;
  border-radius: 8px;
  display: block;
}

/* Specific attached image styles - ONLY in messages area */
.pro-message-list .attached-image,
.pro-message-list .attachment-image,
.pro-message-blurb .attached-image,
.pro-message-blurb .attachment-image {
  max-width: 300px !important;
  max-height: 200px !important;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.2s ease;
  object-fit: contain;
}

.pro-message-list .attached-image:hover,
.pro-message-list .attachment-image:hover {
  transform: scale(1.02);
}

/* GIF specific styles - ONLY in messages area */
.pro-message-list .gif-image,
.pro-message-blurb .gif-image {
  max-width: 350px !important;
  max-height: 250px !important;
}

/* Image attachment container - ONLY in messages area */
.pro-message-list .image-attachment,
.pro-message-blurb .image-attachment {
  position: relative;
  display: inline-block;
  max-width: 100%;
  overflow: hidden;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
}

.pro-message-list .gif-attachment,
.pro-message-blurb .gif-attachment {
  background: rgba(255, 255, 255, 0.05);
}

/* Avatar image fixes - SEPARATE from message attachments */
.user-avatar img,
.contact-avatar img,
.conversation-avatar img,
.profile-avatar img,
.message-avatar img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  border-radius: 50%;
}

/* Message attachment fixes - ONLY in messages area */
.pro-message-list .message-attachment img,
.pro-message-blurb .message-attachment img {
  max-width: 280px;
  max-height: 240px;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s ease;
}

/* Media preview fixes - ONLY in messages area */
.pro-message-list .media-preview img,
.pro-message-blurb .media-preview img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  border-radius: 8px;
}

/* Prevent image overflow - ONLY in messages area */
.pro-message-list .message-content,
.pro-message-list .message-bubble,
.pro-message-list .pro-message-container,
.pro-message-blurb .message-content {
  overflow: hidden;
  word-wrap: break-word;
}

/* Mobile responsive image fixes - ONLY in messages area */
@media screen and (max-width: 768px) {
  .pro-message-list .attachment-image,
  .pro-message-list .attached-image,
  .pro-message-list .photo-message-container img,
  .pro-message-list .message-attachment img,
  .pro-message-blurb .attachment-image,
  .pro-message-blurb .attached-image {
    max-width: calc(100vw - 120px) !important;
    max-height: 200px !important;
  }
  
  .pro-message-list .gif-image,
  .pro-message-blurb .gif-image {
    max-width: calc(100vw - 100px) !important;
    max-height: 180px !important;
  }
  
  .user-avatar img {
    width: 48px !important;
    height: 48px !important;
  }
  
  /* Ensure containers don't constrain images - ONLY in messages area */
  .pro-message-list .pro-message-content,
  .pro-message-list .message-bubble,
  .pro-message-blurb .message-bubble {
    max-width: none !important;
  }
}

@media screen and (max-width: 480px) {
  .pro-message-list .attachment-image,
  .pro-message-list .attached-image,
  .pro-message-list .photo-message-container img,
  .pro-message-list .message-attachment img,
  .pro-message-blurb .attachment-image,
  .pro-message-blurb .attached-image {
    max-width: calc(100vw - 100px) !important;
    max-height: 180px !important;
  }
  
  .pro-message-list .gif-image,
  .pro-message-blurb .gif-image {
    max-width: calc(100vw - 80px) !important;
    max-height: 160px !important;
  }
  
  .user-avatar img {
    width: 44px !important;
    height: 44px !important;
  }
  
  /* Ensure containers don't constrain images - ONLY in messages area */
  .pro-message-list .pro-message-content,
  .pro-message-list .message-bubble,
  .pro-message-blurb .message-bubble {
    max-width: none !important;
  }
}

/* Ensure proper container sizing - ONLY in messages area */
.pro-message-list .message-media-container,
.pro-message-list .message-attachment,
.pro-message-blurb .message-attachment {
  max-width: 100%;
  overflow: visible;
  border-radius: 12px;
}

/* Message bubble adjustments for images - ONLY in messages area */
.pro-message-list .message-bubble:has(.attached-image),
.pro-message-list .pro-message-content:has(.attached-image),
.pro-message-blurb .message-bubble:has(.attached-image) {
  max-width: none !important;
  width: auto;
}

/* Ensure proper container sizing - ONLY in messages area */
.pro-message-list .message-media-container,
.pro-message-list .message-attachment,
.pro-message-blurb .message-attachment {
  max-width: 100%;
  overflow: visible;
  border-radius: 12px;
}

/* Fix for lightbox/modal images - NOT scoped to messages area */
.image-lightbox img,
.modal-image img {
  max-width: 90vw !important;
  max-height: 90vh !important;
  width: auto !important;
  height: auto !important;
  object-fit: contain !important;
}

/* PREVENT attached images from appearing in non-message areas */
.sidebar .attached-image,
.sidebar .attachment-image,
.header .attached-image,
.header .attachment-image,
.input-bar .attached-image,
.input-bar .attachment-image,
.pro-header .attached-image,
.pro-header .attachment-image,
.conversation-item .attached-image,
.conversation-item .attachment-image {
  display: none !important;
}

/* Ensure sidebar and header images are only avatars */
.sidebar img:not(.user-avatar img):not(.conversation-avatar img),
.pro-header img:not(.user-avatar img),
.input-bar img:not(.emoji-picker img) {
  max-width: 40px;
  max-height: 40px;
  border-radius: 50%;
  object-fit: cover;
}

/* Profile/settings image fixes */
.profile-image img,
.avatar-upload img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

/* File preview image fixes */
.file-preview img {
  max-width: 100%;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
}

/* Ensure images don't break layout */
.chat-messages img,
.conversation-content img {
  max-width: 100%;
  height: auto;
  vertical-align: top;
}

/* Fix for GIF images - ONLY in messages area */
.pro-message-list .gif-image,
.pro-message-list .emoji-gif img,
.pro-message-blurb .gif-image,
.pro-message-blurb .emoji-gif img {
  max-width: 200px !important;
  max-height: 200px !important;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
}

@media screen and (max-width: 480px) {
  .pro-message-list .gif-image,
  .pro-message-list .emoji-gif img,
  .pro-message-blurb .gif-image,
  .pro-message-blurb .emoji-gif img {
    max-width: 150px !important;
    max-height: 150px !important;
  }
}