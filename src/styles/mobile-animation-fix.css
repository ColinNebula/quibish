/* Mobile Animation Fix CSS */
/* Prevents screen shake and improves performance on mobile devices */

/* iPhone Pro Max Specific Fixes (430x932px portrait, 932x430px landscape) */
@media screen and (max-width: 430px) and (min-height: 900px) {
  /* Disable all problematic animations on Pro Max */
  * {
    animation-duration: 0.2s !important;
    transition-duration: 0.2s !important;
    animation-timing-function: ease-out !important;
    transition-timing-function: ease-out !important;
  }

  /* Essential animations only */
  .pro-message-container,
  .message {
    animation: messageSlideInProMax 0.3s ease-out !important;
  }

  @keyframes messageSlideInProMax {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Prevent viewport jumping on Pro Max */
  html {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    overflow-x: hidden;
    height: 100%;
    width: 100%;
  }

  body {
    position: relative;
    overflow-x: hidden;
    height: 100vh;
    height: 100dvh;
    width: 100vw;
    margin: 0;
    padding: 0;
  }

  /* Stabilize Pro Max chat interface */
  .pro-chat,
  .mobile-app-container {
    transform: translateZ(0);
    backface-visibility: hidden;
    will-change: auto;
    contain: layout style paint;
  }

  /* Optimize scrolling containers */
  .pro-message-list,
  .messages-list {
    contain: layout style paint;
    overflow-anchor: auto;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
  }

  /* Prevent button shake on Pro Max */
  .pro-action-btn,
  .header-action-btn,
  .voice-button,
  .send-button {
    transform: translateZ(0);
    backface-visibility: hidden;
    contain: layout style;
  }

  /* Input optimization for Pro Max */
  .pro-message-input,
  .message-input {
    contain: layout style;
    will-change: auto;
  }

  /* Modal stabilization */
  .call-options-modal,
  .modal-overlay {
    transform: translateZ(0);
    backface-visibility: hidden;
    contain: layout style paint;
  }
}

/* iPhone Pro Max Landscape Fixes */
@media screen and (max-height: 430px) and (min-width: 900px) and (orientation: landscape) {
  * {
    animation-duration: 0.15s !important;
    transition-duration: 0.15s !important;
  }

  .pro-chat {
    contain: layout style paint;
  }
}

/* Disable problematic animations on small screens */
@media (max-width: 768px) {
  * {
    /* Reduce animation intensity */
    animation-duration: 0.2s !important;
    transition-duration: 0.2s !important;
  }
  
  /* Disable problematic transforms that cause screen shake */
  .shake-prone {
    transform: none !important;
    animation: none !important;
  }
  
  /* Smooth scrolling fixes */
  html {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Prevent layout shift animations */
  .layout-stable {
    contain: layout style paint;
  }
  
  /* Hardware acceleration for smooth animations */
  .hardware-accelerated {
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
  }
  
  /* Reduce motion for accessibility and performance */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

/* Extra small screens - more aggressive fixes */
@media (max-width: 480px) {
  * {
    animation: none !important;
    transition: none !important;
  }
  
  /* Only allow essential transitions */
  .essential-transition {
    transition: opacity 0.15s ease !important;
  }
  
  /* Prevent viewport jumping */
  body {
    position: relative;
    overflow-x: hidden;
  }
  
  /* Stabilize chat interface */
  .chat-container {
    transform: translateZ(0);
    will-change: auto;
  }
}

/* Specific fixes for common shake-causing elements */
.button-container,
.modal-overlay,
.dropdown-menu {
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Prevent text selection animations that cause shake */
::selection {
  background: rgba(0, 123, 255, 0.3);
}

::-moz-selection {
  background: rgba(0, 123, 255, 0.3);
}

/* High refresh rate display optimizations */
@media (min-resolution: 2dppx) {
  .smooth-animation {
    animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1) !important;
  }
  
  .pro-message-container,
  .message {
    backface-visibility: hidden;
    transform: translateZ(0);
  }
}

/* 120Hz ProMotion display optimizations for iPhone Pro Max */
@media screen and (max-width: 430px) and (min-refresh-rate: 120Hz) {
  .pro-chat,
  .mobile-app-container {
    will-change: transform;
    contain: layout style paint;
  }
  
  .pro-message-list {
    scroll-behavior: smooth;
    contain: layout style paint;
  }
}

/* Performance optimizations for all devices */
.performance-optimized {
  transform: translateZ(0);
  backface-visibility: hidden;
  will-change: auto;
  contain: layout style paint;
}