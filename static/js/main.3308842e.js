/*! For license information please see main.3308842e.js.LICENSE.txt */
(()=>{var e={3:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib.StreamCipher,a=e.algo,s=a.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,a=this._S=[],s=0;s<256;s++)a[s]=s;s=0;for(var r=0;s<256;s++){var i=s%n,o=t[i>>>2]>>>24-i%4*8&255;r=(r+a[s]+o)%256;var l=a[s];a[s]=a[r],a[r]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var e=this._S,t=this._i,n=this._j,a=0,s=0;s<4;s++){n=(n+e[t=(t+1)%256])%256;var r=e[t];e[t]=e[n],e[n]=r,a|=e[(e[t]+e[n])%256]<<24-8*s}return this._i=t,this._j=n,a}e.RC4=n._createHelper(s);var i=a.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)r.call(this)}});e.RC4Drop=n._createHelper(i)}(),t.RC4)}()},8:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.pad.Iso97971={pad:function(e,n){e.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(e,n)},unpad:function(e){t.pad.ZeroPadding.unpad(e),e.sigBytes--}},t.pad.Iso97971)}()},20:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(689),n(787),function(){var e=t,n=e.lib,a=n.Base,s=n.WordArray,r=e.algo,i=r.MD5,o=r.EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,a=this.cfg,r=a.hasher.create(),i=s.create(),o=i.words,l=a.keySize,c=a.iterations;o.length<l;){n&&r.update(n),n=r.update(e).finalize(t),r.reset();for(var d=1;d<c;d++)n=r.finalize(n),r.reset();i.concat(n)}return i.sigBytes=4*l,i}});e.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),t.EvpKDF)}()},45:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.mode.CTR=function(){var e=t.lib.BlockCipherMode.extend(),n=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize,s=this._iv,r=this._counter;s&&(r=this._counter=s.slice(0),this._iv=void 0);var i=r.slice(0);n.encryptBlock(i,0),r[a-1]=r[a-1]+1|0;for(var o=0;o<a;o++)e[t+o]^=i[o]}});return e.Decryptor=n,e}(),t.mode.CTR)}()},55:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(654),function(e){var n=t,a=n.lib,s=a.WordArray,r=a.Hasher,i=n.x64.Word,o=n.algo,l=[],c=[],d=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var a=(2*e+3*t)%5;e=t%5,t=a}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var s=1,r=0;r<24;r++){for(var o=0,u=0,h=0;h<7;h++){if(1&s){var m=(1<<h)-1;m<32?u^=1<<m:o^=1<<m-32}128&s?s=s<<1^113:s<<=1}d[r]=i.create(o,u)}}();var u=[];!function(){for(var e=0;e<25;e++)u[e]=i.create()}();var h=o.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,a=this.blockSize/2,s=0;s<a;s++){var r=e[t+2*s],i=e[t+2*s+1];r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),(T=n[s]).high^=i,T.low^=r}for(var o=0;o<24;o++){for(var h=0;h<5;h++){for(var m=0,p=0,f=0;f<5;f++)m^=(T=n[h+5*f]).high,p^=T.low;var g=u[h];g.high=m,g.low=p}for(h=0;h<5;h++){var v=u[(h+4)%5],y=u[(h+1)%5],b=y.high,x=y.low;for(m=v.high^(b<<1|x>>>31),p=v.low^(x<<1|b>>>31),f=0;f<5;f++)(T=n[h+5*f]).high^=m,T.low^=p}for(var w=1;w<25;w++){var S=(T=n[w]).high,k=T.low,j=l[w];j<32?(m=S<<j|k>>>32-j,p=k<<j|S>>>32-j):(m=k<<j-32|S>>>64-j,p=S<<j-32|k>>>64-j);var N=u[c[w]];N.high=m,N.low=p}var C=u[0],E=n[0];for(C.high=E.high,C.low=E.low,h=0;h<5;h++)for(f=0;f<5;f++){var T=n[w=h+5*f],A=u[w],I=u[(h+1)%5+5*f],M=u[(h+2)%5+5*f];T.high=A.high^~I.high&M.high,T.low=A.low^~I.low&M.low}T=n[0];var D=d[o];T.high^=D.high,T.low^=D.low}},_doFinalize:function(){var t=this._data,n=t.words,a=(this._nDataBytes,8*t.sigBytes),r=32*this.blockSize;n[a>>>5]|=1<<24-a%32,n[(e.ceil((a+1)/r)*r>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var i=this._state,o=this.cfg.outputLength/8,l=o/8,c=[],d=0;d<l;d++){var u=i[d],h=u.high,m=u.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),m=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8),c.push(m),c.push(h)}return new s.init(c,o)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=r._createHelper(h),n.HmacSHA3=r._createHmacHelper(h)}(Math),t.SHA3)}()},85:(e,t,n)=>{"use strict";var a=n(340),s=n(950),r=n(119);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(i(188))}function u(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=u(e)))return t;e=e.sibling}return null}var h=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope");var E=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var T=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var A=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var M=Symbol.for("react.client.reference");function D(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===M?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case k:return"Suspense";case j:return"SuspenseList";case E:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case f:return"Portal";case w:return(e.displayName||"Context")+".Provider";case x:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:D(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return D(e(t))}catch(n){}}return null}var P=Array.isArray,_=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z={pending:!1,data:null,method:null,action:null},F=[],L=-1;function O(e){return{current:e}}function U(e){0>L||(e.current=F[L],F[L]=null,L--)}function B(e,t){L++,F[L]=e.current,e.current=t}var H=O(null),q=O(null),V=O(null),W=O(null);function G(e,t){switch(B(V,t),B(q,e),B(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?su(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ru(t=su(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(H),B(H,e)}function K(){U(H),U(q),U(V)}function Q(e){null!==e.memoizedState&&B(W,e);var t=H.current,n=ru(t,e.type);t!==n&&(B(q,e),B(H,n))}function Y(e){q.current===e&&(U(H),U(q)),W.current===e&&(U(W),Qu._currentValue=z)}var $=Object.prototype.hasOwnProperty,J=a.unstable_scheduleCallback,X=a.unstable_cancelCallback,Z=a.unstable_shouldYield,ee=a.unstable_requestPaint,te=a.unstable_now,ne=a.unstable_getCurrentPriorityLevel,ae=a.unstable_ImmediatePriority,se=a.unstable_UserBlockingPriority,re=a.unstable_NormalPriority,ie=a.unstable_LowPriority,oe=a.unstable_IdlePriority,le=a.log,ce=a.unstable_setDisableYieldValue,de=null,ue=null;function he(e){if("function"===typeof le&&ce(e),ue&&"function"===typeof ue.setStrictMode)try{ue.setStrictMode(de,e)}catch(t){}}var me=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/fe|0)|0},pe=Math.log,fe=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var a=e.pendingLanes;if(0===a)return 0;var s=0,r=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&a;return 0!==o?0!==(a=o&~r)?s=ye(a):0!==(i&=o)?s=ye(i):n||0!==(n=o&~e)&&(s=ye(n)):0!==(o=a&~r)?s=ye(o):0!==i?s=ye(i):n||0!==(n=a&~e)&&(s=ye(n)),0===s?0:0!==t&&t!==s&&0===(t&r)&&((r=s&-s)>=(n=t&-t)||32===r&&0!==(4194048&n))?t:s}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function ke(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function je(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ne(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ce(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-me(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|4194090&n}function Ee(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-me(n),s=1<<a;s&t|e[a]&t&&(e[a]|=t),n&=~s}}function Te(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ae(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ie(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Me=Math.random().toString(36).slice(2),De="__reactFiber$"+Me,Pe="__reactProps$"+Me,_e="__reactContainer$"+Me,Re="__reactEvents$"+Me,ze="__reactListeners$"+Me,Fe="__reactHandles$"+Me,Le="__reactResources$"+Me,Oe="__reactMarker$"+Me;function Ue(e){delete e[De],delete e[Pe],delete e[Re],delete e[ze],delete e[Fe]}function Be(e){var t=e[De];if(t)return t;for(var n=e.parentNode;n;){if(t=n[_e]||n[De]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bu(e);null!==e;){if(n=e[De])return n;e=bu(e)}return t}n=(e=n).parentNode}return null}function He(e){if(e=e[De]||e[_e]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ve(e){var t=e[Le];return t||(t=e[Le]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function We(e){e[Oe]=!0}var Ge=new Set,Ke={};function Qe(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Ke[e]=t,e=0;e<t.length;e++)Ge.add(t[e])}var $e,Je,Xe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(s=t,$.call(et,s)||!$.call(Ze,s)&&(Xe.test(s)?et[s]=!0:(Ze[s]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var s}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function at(e,t,n,a){if(null===a)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+a)}}function st(e){if(void 0===$e)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);$e=t&&t[1]||"",Je=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+$e+e+Je}var rt=!1;function it(e,t){if(!e||rt)return"";rt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(s){var a=s}Reflect.construct(e,[],n)}else{try{n.call()}catch(r){a=r}e.call(n.prototype)}}else{try{throw Error()}catch(i){a=i}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&a&&"string"===typeof o.stack)return[o.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=a.DetermineComponentFrameRoot(),i=r[0],o=r[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(s=a=0;a<l.length&&!l[a].includes("DetermineComponentFrameRoot");)a++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(a===l.length||s===c.length)for(a=l.length-1,s=c.length-1;1<=a&&0<=s&&l[a]!==c[s];)s--;for(;1<=a&&0<=s;a--,s--)if(l[a]!==c[s]){if(1!==a||1!==s)do{if(a--,0>--s||l[a]!==c[s]){var d="\n"+l[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=a&&0<=s);break}}}finally{rt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?st(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return st(e.type);case 16:return st("Lazy");case 13:return st("Suspense");case 19:return st("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return st("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ut(e){e._valueTracker||(e._valueTracker=function(e){var t=dt(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=dt(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function ft(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,a,s,r,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?yt(e,i,ct(t)):null!=n?yt(e,i,ct(n)):null!=a&&e.removeAttribute("value"),null==s&&null!=r&&(e.defaultChecked=!!r),null!=s&&(e.checked=s&&"function"!==typeof s&&"symbol"!==typeof s),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,a,s,r,i,o){if(null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&"boolean"!==typeof r&&(e.type=r),null!=t||null!=n){if(!("submit"!==r&&"reset"!==r||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}a="function"!==typeof(a=null!=a?a:s)&&"symbol"!==typeof a&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i)}function yt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,a){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&a&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(a&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(i(92));if(P(a)){if(1<a.length)throw Error(i(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jt(e,t,n){var a=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,n):"number"!==typeof n||0===n||kt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Nt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var s in t)a=t[s],t.hasOwnProperty(s)&&n[s]!==a&&jt(e,s,a)}else for(var r in t)t.hasOwnProperty(r)&&jt(e,r,t[r])}function Ct(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return Tt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var It=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Pt=null;function _t(e){var t=He(e);if(t&&(e=t.stateNode)){var n=e[Pe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+ft(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var s=a[Pe]||null;if(!s)throw Error(i(90));gt(a,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&ht(a)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Rt=!1;function zt(e,t,n){if(Rt)return e(t,n);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==Dt||null!==Pt)&&(Bc(),Dt&&(t=Dt,e=Pt,Pt=Dt=null,_t(t),e)))for(t=0;t<e.length;t++)_t(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var a=n[Pe]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Lt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ot=!1;if(Lt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(Ph){Ot=!1}var Bt=null,Ht=null,qt=null;function Vt(){if(qt)return qt;var e,t,n=Ht,a=n.length,s="value"in Bt?Bt.value:Bt.textContent,r=s.length;for(e=0;e<a&&n[e]===s[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===s[r-t];t++);return qt=s.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function Kt(){return!1}function Qt(e){function t(t,n,a,s,r){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?Gt:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Yt,$t,Jt,Xt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Qt(Xt),en=h({},Xt,{view:0,detail:0}),tn=Qt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jt&&(Jt&&"mousemove"===e.type?(Yt=e.screenX-Jt.screenX,$t=e.screenY-Jt.screenY):$t=Yt=0,Jt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:$t}}),an=Qt(nn),sn=Qt(h({},nn,{dataTransfer:0})),rn=Qt(h({},en,{relatedTarget:0})),on=Qt(h({},Xt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Qt(h({},Xt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Qt(h({},Xt,{data:0})),dn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},un={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return mn}var fn=Qt(h({},en,{key:function(e){if(e.key){var t=dn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?un[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Qt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Qt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Qt(h({},Xt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Qt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Qt(h({},Xt,{newState:0,oldState:0})),wn=[9,13,27,32],Sn=Lt&&"CompositionEvent"in window,kn=null;Lt&&"documentMode"in document&&(kn=document.documentMode);var jn=Lt&&"TextEvent"in window&&!kn,Nn=Lt&&(!Sn||kn&&8<kn&&11>=kn),Cn=String.fromCharCode(32),En=!1;function Tn(e,t){switch(e){case"keyup":return-1!==wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function An(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function Pn(e,t,n,a){Dt?Pt?Pt.push(a):Pt=[a]:Dt=a,0<(t=Vd(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var _n=null,Rn=null;function zn(e){zd(e,0)}function Fn(e){if(ht(qe(e)))return e}function Ln(e,t){if("change"===e)return t}var On=!1;if(Lt){var Un;if(Lt){var Bn="oninput"in document;if(!Bn){var Hn=document.createElement("div");Hn.setAttribute("oninput","return;"),Bn="function"===typeof Hn.oninput}Un=Bn}else Un=!1;On=Un&&(!document.documentMode||9<document.documentMode)}function qn(){_n&&(_n.detachEvent("onpropertychange",Vn),Rn=_n=null)}function Vn(e){if("value"===e.propertyName&&Fn(Rn)){var t=[];Pn(t,Rn,e,Mt(e)),zt(zn,t)}}function Wn(e,t,n){"focusin"===e?(qn(),Rn=n,(_n=t).attachEvent("onpropertychange",Vn)):"focusout"===e&&qn()}function Gn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Rn)}function Kn(e,t){if("click"===e)return Fn(t)}function Qn(e,t){if("input"===e||"change"===e)return Fn(t)}var Yn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function $n(e,t){if(Yn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var s=n[a];if(!$.call(t,s)||!Yn(e[s],t[s]))return!1}return!0}function Jn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xn(e,t){var n,a=Jn(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Jn(a)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ea(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ta(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var na=Lt&&"documentMode"in document&&11>=document.documentMode,aa=null,sa=null,ra=null,ia=!1;function oa(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ia||null==aa||aa!==mt(a)||("selectionStart"in(a=aa)&&ta(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ra&&$n(ra,a)||(ra=a,0<(a=Vd(sa,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=aa)))}function la(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ca={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},da={},ua={};function ha(e){if(da[e])return da[e];if(!ca[e])return e;var t,n=ca[e];for(t in n)if(n.hasOwnProperty(t)&&t in ua)return da[e]=n[t];return e}Lt&&(ua=document.createElement("div").style,"AnimationEvent"in window||(delete ca.animationend.animation,delete ca.animationiteration.animation,delete ca.animationstart.animation),"TransitionEvent"in window||delete ca.transitionend.transition);var ma=ha("animationend"),pa=ha("animationiteration"),fa=ha("animationstart"),ga=ha("transitionrun"),va=ha("transitionstart"),ya=ha("transitioncancel"),ba=ha("transitionend"),xa=new Map,wa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sa(e,t){xa.set(e,t),Qe(t,[e])}wa.push("scrollEnd");var ka=new WeakMap;function ja(e,t){if("object"===typeof e&&null!==e){var n=ka.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},ka.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Na=[],Ca=0,Ea=0;function Ta(){for(var e=Ca,t=Ea=Ca=0;t<e;){var n=Na[t];Na[t++]=null;var a=Na[t];Na[t++]=null;var s=Na[t];Na[t++]=null;var r=Na[t];if(Na[t++]=null,null!==a&&null!==s){var i=a.pending;null===i?s.next=s:(s.next=i.next,i.next=s),a.pending=s}0!==r&&Da(n,s,r)}}function Aa(e,t,n,a){Na[Ca++]=e,Na[Ca++]=t,Na[Ca++]=n,Na[Ca++]=a,Ea|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Ia(e,t,n,a){return Aa(e,t,n,a),Pa(e)}function Ma(e,t){return Aa(e,null,null,t),Pa(e)}function Da(e,t,n){e.lanes|=n;var a=e.alternate;null!==a&&(a.lanes|=n);for(var s=!1,r=e.return;null!==r;)r.childLanes|=n,null!==(a=r.alternate)&&(a.childLanes|=n),22===r.tag&&(null===(e=r.stateNode)||1&e._visibility||(s=!0)),e=r,r=r.return;return 3===e.tag?(r=e.stateNode,s&&null!==t&&(s=31-me(n),null===(a=(e=r.hiddenUpdates)[s])?e[s]=[t]:a.push(t),t.lane=536870912|n),r):null}function Pa(e){if(50<Dc)throw Dc=0,Pc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var _a={};function Ra(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function za(e,t,n,a){return new Ra(e,t,n,a)}function Fa(e){return!(!(e=e.prototype)||!e.isReactComponent)}function La(e,t){var n=e.alternate;return null===n?((n=za(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Oa(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ua(e,t,n,a,s,r){var o=0;if(a=e,"function"===typeof e)Fa(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,H.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return(e=za(31,n,t,s)).elementType=E,e.lanes=r,e;case g:return Ba(n.children,s,r,t);case v:o=8,s|=24;break;case y:return(e=za(12,n,t,2|s)).elementType=y,e.lanes=r,e;case k:return(e=za(13,n,t,s)).elementType=k,e.lanes=r,e;case j:return(e=za(19,n,t,s)).elementType=j,e.lanes=r,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case w:o=10;break e;case x:o=9;break e;case S:o=11;break e;case N:o=14;break e;case C:o=16,a=null;break e}o=29,n=Error(i(130,null===e?"null":typeof e,"")),a=null}return(t=za(o,n,t,s)).elementType=e,t.type=a,t.lanes=r,t}function Ba(e,t,n,a){return(e=za(7,e,a,t)).lanes=n,e}function Ha(e,t,n){return(e=za(6,e,null,t)).lanes=n,e}function qa(e,t,n){return(t=za(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Va=[],Wa=0,Ga=null,Ka=0,Qa=[],Ya=0,$a=null,Ja=1,Xa="";function Za(e,t){Va[Wa++]=Ka,Va[Wa++]=Ga,Ga=e,Ka=t}function es(e,t,n){Qa[Ya++]=Ja,Qa[Ya++]=Xa,Qa[Ya++]=$a,$a=e;var a=Ja;e=Xa;var s=32-me(a)-1;a&=~(1<<s),n+=1;var r=32-me(t)+s;if(30<r){var i=s-s%5;r=(a&(1<<i)-1).toString(32),a>>=i,s-=i,Ja=1<<32-me(t)+s|n<<s|a,Xa=r+e}else Ja=1<<r|n<<s|a,Xa=e}function ts(e){null!==e.return&&(Za(e,1),es(e,1,0))}function ns(e){for(;e===Ga;)Ga=Va[--Wa],Va[Wa]=null,Ka=Va[--Wa],Va[Wa]=null;for(;e===$a;)$a=Qa[--Ya],Qa[Ya]=null,Xa=Qa[--Ya],Qa[Ya]=null,Ja=Qa[--Ya],Qa[Ya]=null}var as=null,ss=null,rs=!1,is=null,os=!1,ls=Error(i(519));function cs(e){throw fs(ja(Error(i(418,"")),e)),ls}function ds(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[De]=e,t[Pe]=a,n){case"dialog":Fd("cancel",t),Fd("close",t);break;case"iframe":case"object":case"embed":Fd("load",t);break;case"video":case"audio":for(n=0;n<_d.length;n++)Fd(_d[n],t);break;case"source":Fd("error",t);break;case"img":case"image":case"link":Fd("error",t),Fd("load",t);break;case"details":Fd("toggle",t);break;case"input":Fd("invalid",t),vt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),ut(t);break;case"select":Fd("invalid",t);break;case"textarea":Fd("invalid",t),wt(t,a.value,a.defaultValue,a.children),ut(t)}"string"!==typeof(n=a.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===a.suppressHydrationWarning||$d(t.textContent,n)?(null!=a.popover&&(Fd("beforetoggle",t),Fd("toggle",t)),null!=a.onScroll&&Fd("scroll",t),null!=a.onScrollEnd&&Fd("scrollend",t),null!=a.onClick&&(t.onclick=Jd),t=!0):t=!1,t||cs(e)}function us(e){for(as=e.return;as;)switch(as.tag){case 5:case 13:return void(os=!1);case 27:case 3:return void(os=!0);default:as=as.return}}function hs(e){if(e!==as)return!1;if(!rs)return us(e),rs=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||iu(e.type,e.memoizedProps)),t=!t),t&&ss&&cs(e),us(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ss=vu(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ss=null}}else 27===n?(n=ss,mu(e.type)?(e=yu,yu=null,ss=e):ss=n):ss=as?vu(e.stateNode.nextSibling):null;return!0}function ms(){ss=as=null,rs=!1}function ps(){var e=is;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),is=null),e}function fs(e){null===is?is=[e]:is.push(e)}var gs=O(null),vs=null,ys=null;function bs(e,t,n){B(gs,t._currentValue),t._currentValue=n}function xs(e){e._currentValue=gs.current,U(gs)}function ws(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Ss(e,t,n,a){var s=e.child;for(null!==s&&(s.return=e);null!==s;){var r=s.dependencies;if(null!==r){var o=s.child;r=r.firstContext;e:for(;null!==r;){var l=r;r=s;for(var c=0;c<t.length;c++)if(l.context===t[c]){r.lanes|=n,null!==(l=r.alternate)&&(l.lanes|=n),ws(r.return,n,e),a||(o=null);break e}r=l.next}}else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(r=o.alternate)&&(r.lanes|=n),ws(o,n,e),o=null}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===e){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}}function ks(e,t,n,a){e=null;for(var s=t,r=!1;null!==s;){if(!r)if(0!==(524288&s.flags))r=!0;else if(0!==(262144&s.flags))break;if(10===s.tag){var o=s.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=s.type;Yn(s.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(s===W.current){if(null===(o=s.alternate))throw Error(i(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(null!==e?e.push(Qu):e=[Qu])}s=s.return}null!==e&&Ss(t,e,n,a),t.flags|=262144}function js(e){for(e=e.firstContext;null!==e;){if(!Yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ns(e){vs=e,ys=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Cs(e){return Ts(vs,e)}function Es(e,t){return null===vs&&Ns(e),Ts(e,t)}function Ts(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ys){if(null===e)throw Error(i(308));ys=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ys=ys.next=t;return n}var As="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Is=a.unstable_scheduleCallback,Ms=a.unstable_NormalPriority,Ds={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ps(){return{controller:new As,data:new Map,refCount:0}}function _s(e){e.refCount--,0===e.refCount&&Is(Ms,function(){e.controller.abort()})}var Rs=null,zs=0,Fs=0,Ls=null;function Os(){if(0===--zs&&null!==Rs){null!==Ls&&(Ls.status="fulfilled");var e=Rs;Rs=null,Fs=0,Ls=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Us=_.S;_.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Rs){var n=Rs=[];zs=0,Fs=Ad(),Ls={status:"pending",value:void 0,then:function(e){n.push(e)}}}zs++,t.then(Os,Os)}(0,t),null!==Us&&Us(e,t)};var Bs=O(null);function Hs(){var e=Bs.current;return null!==e?e:ac.pooledCache}function qs(e,t){B(Bs,null===t?Bs.current:t.pool)}function Vs(){var e=Hs();return null===e?null:{parent:Ds._currentValue,pool:e}}var Ws=Error(i(460)),Gs=Error(i(474)),Ks=Error(i(542)),Qs={then:function(){}};function Ys(e){return"fulfilled"===(e=e.status)||"rejected"===e}function $s(){}function Js(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then($s,$s),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw er(e=t.reason),e;default:if("string"===typeof t.status)t.then($s,$s);else{if(null!==(e=ac)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw er(e=t.reason),e}throw Xs=t,Ws}}var Xs=null;function Zs(){if(null===Xs)throw Error(i(459));var e=Xs;return Xs=null,e}function er(e){if(e===Ws||e===Ks)throw Error(i(483))}var tr=!1;function nr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ar(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function sr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function rr(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&nc)){var s=a.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),a.pending=t,t=Pa(e),Da(e,null,n),t}return Aa(e,a,t,n),Pa(e)}function ir(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Ee(e,n)}}function or(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===r?s=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var lr=!1;function cr(){if(lr){if(null!==Ls)throw Ls}}function dr(e,t,n,a){lr=!1;var s=e.updateQueue;tr=!1;var r=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?r=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==r){var u=s.baseState;for(i=0,d=c=l=null,o=r;;){var m=-536870913&o.lane,p=m!==o.lane;if(p?(rc&m)===m:(a&m)===m){0!==m&&m===Fs&&(lr=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var f=e,g=o;m=t;var v=n;switch(g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(v,u,m);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(m="function"===typeof(f=g.payload)?f.call(v,u,m):f)||void 0===m)break e;u=h({},u,m);break e;case 2:tr=!0}}null!==(m=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=s.callbacks)?s.callbacks=[m]:p.push(m))}else p={lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=m;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(p=o).next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}null===d&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null===r&&(s.shared.lanes=0),mc|=i,e.lanes=i,e.memoizedState=u}}function ur(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function hr(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ur(n[e],t)}var mr=O(null),pr=O(0);function fr(e,t){B(pr,e=uc),B(mr,t),uc=e|t.baseLanes}function gr(){B(pr,uc),B(mr,mr.current)}function vr(){uc=pr.current,U(mr),U(pr)}var yr=0,br=null,xr=null,wr=null,Sr=!1,kr=!1,jr=!1,Nr=0,Cr=0,Er=null,Tr=0;function Ar(){throw Error(i(321))}function Ir(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function Mr(e,t,n,a,s,r){return yr=r,br=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=null===e||null===e.memoizedState?Wi:Gi,jr=!1,r=n(a,s),jr=!1,kr&&(r=Pr(t,n,a,s)),Dr(e),r}function Dr(e){_.H=Vi;var t=null!==xr&&null!==xr.next;if(yr=0,wr=xr=br=null,Sr=!1,Cr=0,Er=null,t)throw Error(i(300));null===e||Eo||null!==(e=e.dependencies)&&js(e)&&(Eo=!0)}function Pr(e,t,n,a){br=e;var s=0;do{if(kr&&(Er=null),Cr=0,kr=!1,25<=s)throw Error(i(301));if(s+=1,wr=xr=null,null!=e.updateQueue){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,null!=r.memoCache&&(r.memoCache.index=0)}_.H=Ki,r=t(n,a)}while(kr);return r}function _r(){var e=_.H,t=e.useState()[0];return t="function"===typeof t.then?Ur(t):t,e=e.useState()[0],(null!==xr?xr.memoizedState:null)!==e&&(br.flags|=1024),t}function Rr(){var e=0!==Nr;return Nr=0,e}function zr(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fr(e){if(Sr){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Sr=!1}yr=0,wr=xr=br=null,kr=!1,Cr=Nr=0,Er=null}function Lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wr?br.memoizedState=wr=e:wr=wr.next=e,wr}function Or(){if(null===xr){var e=br.alternate;e=null!==e?e.memoizedState:null}else e=xr.next;var t=null===wr?br.memoizedState:wr.next;if(null!==t)wr=t,xr=e;else{if(null===e){if(null===br.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(xr=e).memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},null===wr?br.memoizedState=wr=e:wr=wr.next=e}return wr}function Ur(e){var t=Cr;return Cr+=1,null===Er&&(Er=[]),e=Js(Er,e,t),t=br,null===(null===wr?t.memoizedState:wr.next)&&(t=t.alternate,_.H=null===t||null===t.memoizedState?Wi:Gi),e}function Br(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Ur(e);if(e.$$typeof===w)return Cs(e)}throw Error(i(438,String(e)))}function Hr(e){var t=null,n=br.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var a=br.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},br.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=T;return t.index++,n}function qr(e,t){return"function"===typeof t?t(e):t}function Vr(e){return Wr(Or(),xr,e)}function Wr(e,t,n){var a=e.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=n;var s=e.baseQueue,r=a.pending;if(null!==r){if(null!==s){var o=s.next;s.next=r.next,r.next=o}t.baseQueue=s=r,a.pending=null}if(r=e.baseState,null===s)e.memoizedState=r;else{var l=o=null,c=null,d=t=s.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(rc&h)===h:(yr&h)===h){var m=d.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Fs&&(u=!0);else{if((yr&m)===m){d=d.next,m===Fs&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=r):c=c.next=h,br.lanes|=m,mc|=m}h=d.action,jr&&n(r,h),r=d.hasEagerState?d.eagerState:n(r,h)}else m={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=m,o=r):c=c.next=m,br.lanes|=h,mc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=r:c.next=l,!Yn(r,e.memoizedState)&&(Eo=!0,u&&null!==(n=Ls)))throw n;e.memoizedState=r,e.baseState=o,e.baseQueue=c,a.lastRenderedState=r}return null===s&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Gr(e){var t=Or(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var a=n.dispatch,s=n.pending,r=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{r=e(r,o.action),o=o.next}while(o!==s);Yn(r,t.memoizedState)||(Eo=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),n.lastRenderedState=r}return[r,a]}function Kr(e,t,n){var a=br,s=Or(),r=rs;if(r){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!Yn((xr||s).memoizedState,n);if(o&&(s.memoizedState=n,Eo=!0),s=s.queue,gi(2048,8,$r.bind(null,a,s,e),[e]),s.getSnapshot!==t||o||null!==wr&&1&wr.memoizedState.tag){if(a.flags|=2048,mi(9,{destroy:void 0,resource:void 0},Yr.bind(null,a,s,n,t),null),null===ac)throw Error(i(349));r||0!==(124&yr)||Qr(a,t,n)}return n}function Qr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=br.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},br.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Yr(e,t,n,a){t.value=n,t.getSnapshot=a,Jr(t)&&Xr(e)}function $r(e,t,n){return n(function(){Jr(t)&&Xr(e)})}function Jr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch(a){return!0}}function Xr(e){var t=Ma(e,2);null!==t&&zc(t,e,2)}function Zr(e){var t=Lr();if("function"===typeof e){var n=e;if(e=n(),jr){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:e},t}function ei(e,t,n,a){return e.baseState=n,Wr(e,xr,"function"===typeof a?a:qr)}function ti(e,t,n,a,s){if(Bi(e))throw Error(i(485));if(null!==(e=t.action)){var r={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){r.listeners.push(e)}};null!==_.T?n(!0):r.isTransition=!1,a(r),null===(n=t.pending)?(r.next=t.pending=r,ni(t,r)):(r.next=n.next,t.pending=n.next=r)}}function ni(e,t){var n=t.action,a=t.payload,s=e.state;if(t.isTransition){var r=_.T,i={};_.T=i;try{var o=n(s,a),l=_.S;null!==l&&l(i,o),ai(e,t,o)}catch(c){ri(e,t,c)}finally{_.T=r}}else try{ai(e,t,r=n(s,a))}catch(d){ri(e,t,d)}}function ai(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){si(e,t,n)},function(n){return ri(e,t,n)}):si(e,t,n)}function si(e,t,n){t.status="fulfilled",t.value=n,ii(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ni(e,n)))}function ri(e,t,n){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=n,ii(t),t=t.next}while(t!==a)}e.action=null}function ii(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function oi(e,t){return t}function li(e,t){if(rs){var n=ac.formState;if(null!==n){e:{var a=br;if(rs){if(ss){t:{for(var s=ss,r=os;8!==s.nodeType;){if(!r){s=null;break t}if(null===(s=vu(s.nextSibling))){s=null;break t}}s="F!"===(r=s.data)||"F"===r?s:null}if(s){ss=vu(s.nextSibling),a="F!"===s.data;break e}}cs(a)}a=!1}a&&(t=n[0])}}return(n=Lr()).memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:t},n.queue=a,n=Li.bind(null,br,a),a.dispatch=n,a=Zr(!1),r=Ui.bind(null,br,!1,a.queue),s={state:t,dispatch:null,action:e,pending:null},(a=Lr()).queue=s,n=ti.bind(null,br,s,r,n),s.dispatch=n,a.memoizedState=e,[t,n,!1]}function ci(e){return di(Or(),xr,e)}function di(e,t,n){if(t=Wr(e,t,oi)[0],e=Vr(qr)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var a=Ur(t)}catch(i){if(i===Ws)throw Ks;throw i}else a=t;var s=(t=Or()).queue,r=s.dispatch;return n!==t.memoizedState&&(br.flags|=2048,mi(9,{destroy:void 0,resource:void 0},ui.bind(null,s,n),null)),[a,r,e]}function ui(e,t){e.action=t}function hi(e){var t=Or(),n=xr;if(null!==n)return di(t,n,e);Or(),t=t.memoizedState;var a=(n=Or()).queue.dispatch;return n.memoizedState=e,[t,a,!1]}function mi(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},null===(t=br.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},br.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function pi(){return Or().memoizedState}function fi(e,t,n,a){var s=Lr();a=void 0===a?null:a,br.flags|=e,s.memoizedState=mi(1|t,{destroy:void 0,resource:void 0},n,a)}function gi(e,t,n,a){var s=Or();a=void 0===a?null:a;var r=s.memoizedState.inst;null!==xr&&null!==a&&Ir(a,xr.memoizedState.deps)?s.memoizedState=mi(t,r,n,a):(br.flags|=e,s.memoizedState=mi(1|t,r,n,a))}function vi(e,t){fi(8390656,8,e,t)}function yi(e,t){gi(2048,8,e,t)}function bi(e,t){return gi(4,2,e,t)}function xi(e,t){return gi(4,4,e,t)}function wi(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Si(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gi(4,4,wi.bind(null,t,e),n)}function ki(){}function ji(e,t){var n=Or();t=void 0===t?null:t;var a=n.memoizedState;return null!==t&&Ir(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Ni(e,t){var n=Or();t=void 0===t?null:t;var a=n.memoizedState;if(null!==t&&Ir(t,a[1]))return a[0];if(a=e(),jr){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[a,t],a}function Ci(e,t,n){return void 0===n||0!==(1073741824&yr)?e.memoizedState=t:(e.memoizedState=n,e=Rc(),br.lanes|=e,mc|=e,n)}function Ei(e,t,n,a){return Yn(n,t)?n:null!==mr.current?(e=Ci(e,n,a),Yn(e,t)||(Eo=!0),e):0===(42&yr)?(Eo=!0,e.memoizedState=n):(e=Rc(),br.lanes|=e,mc|=e,t)}function Ti(e,t,n,a,s){var r=R.p;R.p=0!==r&&8>r?r:8;var i=_.T,o={};_.T=o,Ui(e,!1,t,n);try{var l=s(),c=_.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Oi(e,t,function(e,t){var n=[],a={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(a.status="rejected",a.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),a}(l,a),_c());else Oi(e,t,a,_c())}catch(d){Oi(e,t,{then:function(){},status:"rejected",reason:d},_c())}finally{R.p=r,_.T=i}}function Ai(){}function Ii(e,t,n,a){if(5!==e.tag)throw Error(i(476));var s=Mi(e).queue;Ti(e,s,t,z,null===n?Ai:function(){return Di(e),n(a)})}function Mi(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:z,baseState:z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:z},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Di(e){Oi(e,Mi(e).next.queue,{},_c())}function Pi(){return Cs(Qu)}function _i(){return Or().memoizedState}function Ri(){return Or().memoizedState}function zi(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=_c(),a=rr(t,e=sr(n),n);return null!==a&&(zc(a,t,n),ir(a,t,n)),t={cache:Ps()},void(e.payload=t)}t=t.return}}function Fi(e,t,n){var a=_c();n={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Bi(e)?Hi(t,n):null!==(n=Ia(e,t,n,a))&&(zc(n,e,a),qi(n,t,a))}function Li(e,t,n){Oi(e,t,n,_c())}function Oi(e,t,n,a){var s={lane:a,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bi(e))Hi(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=r(i,n);if(s.hasEagerState=!0,s.eagerState=o,Yn(o,i))return Aa(e,t,s,0),null===ac&&Ta(),!1}catch(l){}if(null!==(n=Ia(e,t,s,a)))return zc(n,e,a),qi(n,t,a),!0}return!1}function Ui(e,t,n,a){if(a={lane:2,revertLane:Ad(),action:a,hasEagerState:!1,eagerState:null,next:null},Bi(e)){if(t)throw Error(i(479))}else null!==(t=Ia(e,n,a,2))&&zc(t,e,2)}function Bi(e){var t=e.alternate;return e===br||null!==t&&t===br}function Hi(e,t){kr=Sr=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qi(e,t,n){if(0!==(4194048&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Ee(e,n)}}var Vi={readContext:Cs,use:Br,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useLayoutEffect:Ar,useInsertionEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useSyncExternalStore:Ar,useId:Ar,useHostTransitionStatus:Ar,useFormState:Ar,useActionState:Ar,useOptimistic:Ar,useMemoCache:Ar,useCacheRefresh:Ar},Wi={readContext:Cs,use:Br,useCallback:function(e,t){return Lr().memoizedState=[e,void 0===t?null:t],e},useContext:Cs,useEffect:vi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,fi(4194308,4,wi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fi(4194308,4,e,t)},useInsertionEffect:function(e,t){fi(4,2,e,t)},useMemo:function(e,t){var n=Lr();t=void 0===t?null:t;var a=e();if(jr){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=Lr();if(void 0!==n){var s=n(t);if(jr){he(!0);try{n(t)}finally{he(!1)}}}else s=t;return a.memoizedState=a.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},a.queue=e,e=e.dispatch=Fi.bind(null,br,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Lr().memoizedState=e},useState:function(e){var t=(e=Zr(e)).queue,n=Li.bind(null,br,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ki,useDeferredValue:function(e,t){return Ci(Lr(),e,t)},useTransition:function(){var e=Zr(!1);return e=Ti.bind(null,br,e.queue,!0,!1),Lr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=br,s=Lr();if(rs){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===ac)throw Error(i(349));0!==(124&rc)||Qr(a,t,n)}s.memoizedState=n;var r={value:n,getSnapshot:t};return s.queue=r,vi($r.bind(null,a,r,e),[e]),a.flags|=2048,mi(9,{destroy:void 0,resource:void 0},Yr.bind(null,a,r,n,t),null),n},useId:function(){var e=Lr(),t=ac.identifierPrefix;if(rs){var n=Xa;t="\xab"+t+"R"+(n=(Ja&~(1<<32-me(Ja)-1)).toString(32)+n),0<(n=Nr++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Tr++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Pi,useFormState:li,useActionState:li,useOptimistic:function(e){var t=Lr();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ui.bind(null,br,!0,n),n.dispatch=t,[e,t]},useMemoCache:Hr,useCacheRefresh:function(){return Lr().memoizedState=zi.bind(null,br)}},Gi={readContext:Cs,use:Br,useCallback:ji,useContext:Cs,useEffect:yi,useImperativeHandle:Si,useInsertionEffect:bi,useLayoutEffect:xi,useMemo:Ni,useReducer:Vr,useRef:pi,useState:function(){return Vr(qr)},useDebugValue:ki,useDeferredValue:function(e,t){return Ei(Or(),xr.memoizedState,e,t)},useTransition:function(){var e=Vr(qr)[0],t=Or().memoizedState;return["boolean"===typeof e?e:Ur(e),t]},useSyncExternalStore:Kr,useId:_i,useHostTransitionStatus:Pi,useFormState:ci,useActionState:ci,useOptimistic:function(e,t){return ei(Or(),0,e,t)},useMemoCache:Hr,useCacheRefresh:Ri},Ki={readContext:Cs,use:Br,useCallback:ji,useContext:Cs,useEffect:yi,useImperativeHandle:Si,useInsertionEffect:bi,useLayoutEffect:xi,useMemo:Ni,useReducer:Gr,useRef:pi,useState:function(){return Gr(qr)},useDebugValue:ki,useDeferredValue:function(e,t){var n=Or();return null===xr?Ci(n,e,t):Ei(n,xr.memoizedState,e,t)},useTransition:function(){var e=Gr(qr)[0],t=Or().memoizedState;return["boolean"===typeof e?e:Ur(e),t]},useSyncExternalStore:Kr,useId:_i,useHostTransitionStatus:Pi,useFormState:hi,useActionState:hi,useOptimistic:function(e,t){var n=Or();return null!==xr?ei(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Hr,useCacheRefresh:Ri},Qi=null,Yi=0;function $i(e){var t=Yi;return Yi+=1,null===Qi&&(Qi=[]),Js(Qi,e,t)}function Ji(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Xi(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zi(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(e,t){return(e=La(e,t)).index=0,e.sibling=null,e}function r(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=67108866,n):a:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Ha(n,e.mode,a)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,a){var r=n.type;return r===g?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===C&&Zi(r)===t.type)?(Ji(t=s(t,n.props),n),t.return=e,t):(Ji(t=Ua(n.type,n.key,n.props,null,e.mode,a),n),t.return=e,t)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qa(n,e.mode,a)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function u(e,t,n,a,r){return null===t||7!==t.tag?((t=Ba(n,e.mode,a,r)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ha(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Ji(n=Ua(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case f:return(t=qa(t,e.mode,n)).return=e,t;case C:return h(e,t=(0,t._init)(t._payload),n)}if(P(t)||I(t))return(t=Ba(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,$i(t),n);if(t.$$typeof===w)return h(e,Es(e,t),n);Xi(e,t)}return null}function m(e,t,n,a){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==s?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===s?c(e,t,n,a):null;case f:return n.key===s?d(e,t,n,a):null;case C:return m(e,t,n=(s=n._init)(n._payload),a)}if(P(n)||I(n))return null!==s?null:u(e,t,n,a,null);if("function"===typeof n.then)return m(e,t,$i(n),a);if(n.$$typeof===w)return m(e,t,Es(e,n),a);Xi(e,n)}return null}function v(e,t,n,a,s){if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return l(t,e=e.get(n)||null,""+a,s);if("object"===typeof a&&null!==a){switch(a.$$typeof){case p:return c(t,e=e.get(null===a.key?n:a.key)||null,a,s);case f:return d(t,e=e.get(null===a.key?n:a.key)||null,a,s);case C:return v(e,t,n,a=(0,a._init)(a._payload),s)}if(P(a)||I(a))return u(t,e=e.get(n)||null,a,s,null);if("function"===typeof a.then)return v(e,t,n,$i(a),s);if(a.$$typeof===w)return v(e,t,n,Es(t,a),s);Xi(t,a)}return null}function y(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===g&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case p:e:{for(var b=d.key;null!==c;){if(c.key===b){if((b=d.type)===g){if(7===c.tag){n(l,c.sibling),(u=s(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===C&&Zi(b)===c.type){n(l,c.sibling),Ji(u=s(c,d.props),d),u.return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}d.type===g?((u=Ba(d.props.children,l.mode,u,d.key)).return=l,l=u):(Ji(u=Ua(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case f:e:{for(b=d.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(l,c.sibling),(u=s(c,d.children||[])).return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}(u=qa(d,l.mode,u)).return=l,l=u}return o(l);case C:return y(l,c,d=(b=d._init)(d._payload),u)}if(P(d))return function(s,i,o,l){for(var c=null,d=null,u=i,p=i=0,f=null;null!==u&&p<o.length;p++){u.index>p?(f=u,u=null):f=u.sibling;var g=m(s,u,o[p],l);if(null===g){null===u&&(u=f);break}e&&u&&null===g.alternate&&t(s,u),i=r(g,i,p),null===d?c=g:d.sibling=g,d=g,u=f}if(p===o.length)return n(s,u),rs&&Za(s,p),c;if(null===u){for(;p<o.length;p++)null!==(u=h(s,o[p],l))&&(i=r(u,i,p),null===d?c=u:d.sibling=u,d=u);return rs&&Za(s,p),c}for(u=a(u);p<o.length;p++)null!==(f=v(u,s,p,o[p],l))&&(e&&null!==f.alternate&&u.delete(null===f.key?p:f.key),i=r(f,i,p),null===d?c=f:d.sibling=f,d=f);return e&&u.forEach(function(e){return t(s,e)}),rs&&Za(s,p),c}(l,c,d,u);if(I(d)){if("function"!==typeof(b=I(d)))throw Error(i(150));return function(s,o,l,c){if(null==l)throw Error(i(151));for(var d=null,u=null,p=o,f=o=0,g=null,y=l.next();null!==p&&!y.done;f++,y=l.next()){p.index>f?(g=p,p=null):g=p.sibling;var b=m(s,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(s,p),o=r(b,o,f),null===u?d=b:u.sibling=b,u=b,p=g}if(y.done)return n(s,p),rs&&Za(s,f),d;if(null===p){for(;!y.done;f++,y=l.next())null!==(y=h(s,y.value,c))&&(o=r(y,o,f),null===u?d=y:u.sibling=y,u=y);return rs&&Za(s,f),d}for(p=a(p);!y.done;f++,y=l.next())null!==(y=v(p,s,f,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?f:y.key),o=r(y,o,f),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach(function(e){return t(s,e)}),rs&&Za(s,f),d}(l,c,d=b.call(d),u)}if("function"===typeof d.then)return y(l,c,$i(d),u);if(d.$$typeof===w)return y(l,c,Es(l,d),u);Xi(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(n(l,c.sibling),(u=s(c,d)).return=l,l=u):(n(l,c),(u=Ha(d,l.mode,u)).return=l,l=u),o(l)):n(l,c)}return function(e,t,n,a){try{Yi=0;var s=y(e,t,n,a);return Qi=null,s}catch(i){if(i===Ws||i===Ks)throw i;var r=za(29,i,null,e.mode);return r.lanes=a,r.return=e,r}}}var to=eo(!0),no=eo(!1),ao=O(null),so=null;function ro(e){var t=e.alternate;B(co,1&co.current),B(ao,e),null===so&&(null===t||null!==mr.current||null!==t.memoizedState)&&(so=e)}function io(e){if(22===e.tag){if(B(co,co.current),B(ao,e),null===so){var t=e.alternate;null!==t&&null!==t.memoizedState&&(so=e)}}else oo()}function oo(){B(co,co.current),B(ao,ao.current)}function lo(e){U(ao),so===e&&(so=null),U(co)}var co=O(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gu(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ho(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var mo={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=_c(),s=sr(a);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=rr(e,s,a))&&(zc(t,e,a),ir(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=_c(),s=sr(a);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=rr(e,s,a))&&(zc(t,e,a),ir(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=_c(),a=sr(n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=rr(e,a,n))&&(zc(t,e,n),ir(t,e,n))}};function po(e,t,n,a,s,r,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!$n(n,a)||!$n(s,r))}function fo(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&mo.enqueueReplaceState(t,t.state,null)}function go(e,t){var n=t;if("ref"in t)for(var a in n={},t)"ref"!==a&&(n[a]=t[a]);if(e=e.defaultProps)for(var s in n===t&&(n=h({},n)),e)void 0===n[s]&&(n[s]=e[s]);return n}var vo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function yo(e){vo(e)}function bo(e){console.error(e)}function xo(e){vo(e)}function wo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function So(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function ko(e,t,n){return(n=sr(n)).tag=3,n.payload={element:null},n.callback=function(){wo(e,t)},n}function jo(e){return(e=sr(e)).tag=3,e}function No(e,t,n,a){var s=n.type.getDerivedStateFromError;if("function"===typeof s){var r=a.value;e.payload=function(){return s(r)},e.callback=function(){So(t,n,a)}}var i=n.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){So(t,n,a),"function"!==typeof s&&(null===jc?jc=new Set([this]):jc.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var Co=Error(i(461)),Eo=!1;function To(e,t,n,a){t.child=null===e?no(t,null,n,a):to(t,e.child,n,a)}function Ao(e,t,n,a,s){n=n.render;var r=t.ref;if("ref"in a){var i={};for(var o in a)"ref"!==o&&(i[o]=a[o])}else i=a;return Ns(t),a=Mr(e,t,n,i,r,s),o=Rr(),null===e||Eo?(rs&&o&&ts(t),t.flags|=1,To(e,t,a,s),t.child):(zr(e,t,s),Yo(e,t,s))}function Io(e,t,n,a,s){if(null===e){var r=n.type;return"function"!==typeof r||Fa(r)||void 0!==r.defaultProps||null!==n.compare?((e=Ua(n.type,null,a,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Mo(e,t,r,a,s))}if(r=e.child,!$o(e,s)){var i=r.memoizedProps;if((n=null!==(n=n.compare)?n:$n)(i,a)&&e.ref===t.ref)return Yo(e,t,s)}return t.flags|=1,(e=La(r,a)).ref=t.ref,e.return=t,t.child=e}function Mo(e,t,n,a,s){if(null!==e){var r=e.memoizedProps;if($n(r,a)&&e.ref===t.ref){if(Eo=!1,t.pendingProps=a=r,!$o(e,s))return t.lanes=e.lanes,Yo(e,t,s);0!==(131072&e.flags)&&(Eo=!0)}}return Ro(e,t,n,a,s)}function Do(e,t,n){var a=t.pendingProps,s=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode){if(0!==(128&t.flags)){if(a=null!==r?r.baseLanes|n:n,null!==e){for(s=t.child=e.child,r=0;null!==s;)r=r|s.lanes|s.childLanes,s=s.sibling;t.childLanes=r&~a}else t.childLanes=0,t.child=null;return Po(e,t,a,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Po(e,t,null!==r?r.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&qs(0,null!==r?r.cachePool:null),null!==r?fr(t,r):gr(),io(t)}else null!==r?(qs(0,r.cachePool),fr(t,r),oo(),t.memoizedState=null):(null!==e&&qs(0,null),gr(),oo());return To(e,t,s,n),t.child}function Po(e,t,n,a){var s=Hs();return s=null===s?null:{parent:Ds._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},null!==e&&qs(0,null),gr(),io(t),null!==e&&ks(e,t,a,!0),null}function _o(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ro(e,t,n,a,s){return Ns(t),n=Mr(e,t,n,a,void 0,s),a=Rr(),null===e||Eo?(rs&&a&&ts(t),t.flags|=1,To(e,t,n,s),t.child):(zr(e,t,s),Yo(e,t,s))}function zo(e,t,n,a,s,r){return Ns(t),t.updateQueue=null,n=Pr(t,a,n,s),Dr(e),a=Rr(),null===e||Eo?(rs&&a&&ts(t),t.flags|=1,To(e,t,n,r),t.child):(zr(e,t,r),Yo(e,t,r))}function Fo(e,t,n,a,s){if(Ns(t),null===t.stateNode){var r=_a,i=n.contextType;"object"===typeof i&&null!==i&&(r=Cs(i)),r=new n(a,r),t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,r.updater=mo,t.stateNode=r,r._reactInternals=t,(r=t.stateNode).props=a,r.state=t.memoizedState,r.refs={},nr(t),i=n.contextType,r.context="object"===typeof i&&null!==i?Cs(i):_a,r.state=t.memoizedState,"function"===typeof(i=n.getDerivedStateFromProps)&&(ho(t,n,i,a),r.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(i=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),i!==r.state&&mo.enqueueReplaceState(r,r.state,null),dr(t,a,r,s),cr(),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){r=t.stateNode;var o=t.memoizedProps,l=go(n,o);r.props=l;var c=r.context,d=n.contextType;i=_a,"object"===typeof d&&null!==d&&(i=Cs(d));var u=n.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof r.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(o||c!==i)&&fo(t,r,a,i),tr=!1;var h=t.memoizedState;r.state=h,dr(t,a,r,s),cr(),c=t.memoizedState,o||h!==c||tr?("function"===typeof u&&(ho(t,n,u,a),c=t.memoizedState),(l=tr||po(t,n,l,a,h,c,i))?(d||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(t.flags|=4194308)):("function"===typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),r.props=a,r.state=c,r.context=i,a=l):("function"===typeof r.componentDidMount&&(t.flags|=4194308),a=!1)}else{r=t.stateNode,ar(e,t),d=go(n,i=t.memoizedProps),r.props=d,u=t.pendingProps,h=r.context,c=n.contextType,l=_a,"object"===typeof c&&null!==c&&(l=Cs(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(i!==u||h!==l)&&fo(t,r,a,l),tr=!1,h=t.memoizedState,r.state=h,dr(t,a,r,s),cr();var m=t.memoizedState;i!==u||h!==m||tr||null!==e&&null!==e.dependencies&&js(e.dependencies)?("function"===typeof o&&(ho(t,n,o,a),m=t.memoizedState),(d=tr||po(t,n,d,a,h,m,l)||null!==e&&null!==e.dependencies&&js(e.dependencies))?(c||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(a,m,l),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(a,m,l)),"function"===typeof r.componentDidUpdate&&(t.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof r.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),r.props=a,r.state=m,r.context=l,a=d):("function"!==typeof r.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return r=a,_o(e,t),a=0!==(128&t.flags),r||a?(r=t.stateNode,n=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render(),t.flags|=1,null!==e&&a?(t.child=to(t,e.child,null,s),t.child=to(t,null,n,s)):To(e,t,n,s),t.memoizedState=r.state,e=t.child):e=Yo(e,t,s),e}function Lo(e,t,n,a){return ms(),t.flags|=256,To(e,t,n,a),t.child}var Oo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uo(e){return{baseLanes:e,cachePool:Vs()}}function Bo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Ho(e,t,n){var a,s=t.pendingProps,r=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&co.current)),a&&(r=!0,t.flags&=-129),a=0!==(32&t.flags),t.flags&=-33,null===e){if(rs){if(r?ro(t):oo(),rs){var l,c=ss;if(l=c){e:{for(l=c,c=os;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vu(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==$a?{id:Ja,overflow:Xa}:null,retryLane:536870912,hydrationErrors:null},(l=za(18,null,null,0)).stateNode=c,l.return=t,t.child=l,as=t,ss=null,l=!0):l=!1}l||cs(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gu(c)?t.lanes=32:t.lanes=536870912,null;lo(t)}return c=s.children,s=s.fallback,r?(oo(),c=Vo({mode:"hidden",children:c},r=t.mode),s=Ba(s,r,n,null),c.return=t,s.return=t,c.sibling=s,t.child=c,(r=t.child).memoizedState=Uo(n),r.childLanes=Bo(e,a,n),t.memoizedState=Oo,s):(ro(t),qo(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(ro(t),t.flags&=-257,t=Wo(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),r=s.fallback,c=t.mode,s=Vo({mode:"visible",children:s.children},c),(r=Ba(r,c,n,null)).flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,to(t,e.child,null,n),(s=t.child).memoizedState=Uo(n),s.childLanes=Bo(e,a,n),t.memoizedState=Oo,t=r);else if(ro(t),gu(c)){if(a=c.nextSibling&&c.nextSibling.dataset)var d=a.dgst;a=d,(s=Error(i(419))).stack="",s.digest=a,fs({value:s,source:null,stack:null}),t=Wo(e,t,n)}else if(Eo||ks(e,t,n,!1),a=0!==(n&e.childLanes),Eo||a){if(null!==(a=ac)&&(0!==(s=0!==((s=0!==(42&(s=n&-n))?1:Te(s))&(a.suspendedLanes|n))?0:s)&&s!==l.retryLane))throw l.retryLane=s,Ma(e,s),zc(a,e,s),Co;"$?"===c.data||Kc(),t=Wo(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ss=vu(c.nextSibling),as=t,rs=!0,is=null,os=!1,null!==e&&(Qa[Ya++]=Ja,Qa[Ya++]=Xa,Qa[Ya++]=$a,Ja=e.id,Xa=e.overflow,$a=t),(t=qo(t,s.children)).flags|=4096);return t}return r?(oo(),r=s.fallback,c=t.mode,d=(l=e.child).sibling,(s=La(l,{mode:"hidden",children:s.children})).subtreeFlags=65011712&l.subtreeFlags,null!==d?r=La(d,r):(r=Ba(r,c,n,null)).flags|=2,r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,null===(c=e.child.memoizedState)?c=Uo(n):(null!==(l=c.cachePool)?(d=Ds._currentValue,l=l.parent!==d?{parent:d,pool:d}:l):l=Vs(),c={baseLanes:c.baseLanes|n,cachePool:l}),r.memoizedState=c,r.childLanes=Bo(e,a,n),t.memoizedState=Oo,s):(ro(t),e=(n=e.child).sibling,(n=La(n,{mode:"visible",children:s.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function qo(e,t){return(t=Vo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Vo(e,t){return(e=za(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Wo(e,t,n){return to(t,e.child,null,n),(e=qo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Go(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),ws(e.return,t,n)}function Ko(e,t,n,a,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=a,r.tail=n,r.tailMode=s)}function Qo(e,t,n){var a=t.pendingProps,s=a.revealOrder,r=a.tail;if(To(e,t,a.children,n),0!==(2&(a=co.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Go(e,n,t);else if(19===e.tag)Go(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(B(co,a),s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ko(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===uo(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ko(t,!0,n,null,r);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),mc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(ks(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=La(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=La(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function $o(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!js(e))}function Jo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Eo=!0;else{if(!$o(e,n)&&0===(128&t.flags))return Eo=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),bs(0,Ds,e.memoizedState.cache),ms();break;case 27:case 5:Q(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:bs(0,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(ro(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ho(e,t,n):(ro(t),null!==(e=Yo(e,t,n))?e.sibling:null);ro(t);break;case 19:var s=0!==(128&e.flags);if((a=0!==(n&t.childLanes))||(ks(e,t,n,!1),a=0!==(n&t.childLanes)),s){if(a)return Qo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),B(co,co.current),a)break;return null;case 22:case 23:return t.lanes=0,Do(e,t,n);case 24:bs(0,Ds,e.memoizedState.cache)}return Yo(e,t,n)}(e,t,n);Eo=0!==(131072&e.flags)}else Eo=!1,rs&&0!==(1048576&t.flags)&&es(t,Ka,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,s=a._init;if(a=s(a._payload),t.type=a,"function"!==typeof a){if(void 0!==a&&null!==a){if((s=a.$$typeof)===S){t.tag=11,t=Ao(null,t,a,e,n);break e}if(s===N){t.tag=14,t=Io(null,t,a,e,n);break e}}throw t=D(a)||a,Error(i(306,t,""))}Fa(a)?(e=go(a,e),t.tag=1,t=Fo(null,t,a,e,n)):(t.tag=0,t=Ro(null,t,a,e,n))}return t;case 0:return Ro(e,t,t.type,t.pendingProps,n);case 1:return Fo(e,t,a=t.type,s=go(a,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(i(387));a=t.pendingProps;var r=t.memoizedState;s=r.element,ar(e,t),dr(t,a,null,n);var o=t.memoizedState;if(a=o.cache,bs(0,Ds,a),a!==r.cache&&Ss(t,[Ds],n,!0),cr(),a=o.element,r.isDehydrated){if(r={element:a,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=Lo(e,t,a,n);break e}if(a!==s){fs(s=ja(Error(i(424)),t)),t=Lo(e,t,a,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ss=vu(e.firstChild),as=t,rs=!0,is=null,os=!0,n=no(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ms(),a===s){t=Yo(e,t,n);break e}To(e,t,a,n)}t=t.child}return t;case 26:return _o(e,t),null===e?(n=Tu(t.type,null,t.pendingProps,null))?t.memoizedState=n:rs||(n=t.type,e=t.pendingProps,(a=au(V.current).createElement(n))[De]=t,a[Pe]=e,eu(a,n,e),We(a),t.stateNode=a):t.memoizedState=Tu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&rs&&(a=t.stateNode=xu(t.type,t.pendingProps,V.current),as=t,os=!0,s=ss,mu(t.type)?(yu=s,ss=vu(a.firstChild)):ss=s),To(e,t,t.pendingProps.children,n),_o(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&rs&&((s=a=ss)&&(null!==(a=function(e,t,n,a){for(;1===e.nodeType;){var s=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[Oe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(r=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(r!==s.rel||e.getAttribute("href")!==(null==s.href||""===s.href?null:s.href)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin)||e.getAttribute("title")!==(null==s.title?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((r=e.getAttribute("src"))!==(null==s.src?null:s.src)||e.getAttribute("type")!==(null==s.type?null:s.type)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var r=null==s.name?null:""+s.name;if("hidden"===s.type&&e.getAttribute("name")===r)return e}if(null===(e=vu(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,os))?(t.stateNode=a,as=t,ss=vu(a.firstChild),os=!1,s=!0):s=!1),s||cs(t)),Q(t),s=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,iu(s,r)?a=null:null!==o&&iu(s,o)&&(t.flags|=32),null!==t.memoizedState&&(s=Mr(e,t,_r,null,null,n),Qu._currentValue=s),_o(e,t),To(e,t,a,n),t.child;case 6:return null===e&&rs&&((e=n=ss)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vu(e.nextSibling)))return null}return e}(n,t.pendingProps,os))?(t.stateNode=n,as=t,ss=null,e=!0):e=!1),e||cs(t)),null;case 13:return Ho(e,t,n);case 4:return G(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=to(t,null,a,n):To(e,t,a,n),t.child;case 11:return Ao(e,t,t.type,t.pendingProps,n);case 7:return To(e,t,t.pendingProps,n),t.child;case 8:case 12:return To(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,bs(0,t.type,a.value),To(e,t,a.children,n),t.child;case 9:return s=t.type._context,a=t.pendingProps.children,Ns(t),a=a(s=Cs(s)),t.flags|=1,To(e,t,a,n),t.child;case 14:return Io(e,t,t.type,t.pendingProps,n);case 15:return Mo(e,t,t.type,t.pendingProps,n);case 19:return Qo(e,t,n);case 31:return a=t.pendingProps,n=t.mode,a={mode:a.mode,children:a.children},null===e?((n=Vo(a,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=La(e.child,a)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Do(e,t,n);case 24:return Ns(t),a=Cs(Ds),null===e?(null===(s=Hs())&&(s=ac,r=Ps(),s.pooledCache=r,r.refCount++,null!==r&&(s.pooledCacheLanes|=n),s=r),t.memoizedState={parent:a,cache:s},nr(t),bs(0,Ds,s)):(0!==(e.lanes&n)&&(ar(e,t),dr(t,null,null,n),cr()),s=e.memoizedState,r=t.memoizedState,s.parent!==a?(s={parent:a,cache:a},t.memoizedState=s,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=s),bs(0,Ds,a)):(a=r.cache,bs(0,Ds,a),a!==s.cache&&Ss(t,[Ds],n,!0))),To(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Xo(e){e.flags|=4}function Zo(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Bu(t)){if(null!==(t=ao.current)&&((4194048&rc)===rc?null!==so:(62914560&rc)!==rc&&0===(536870912&rc)||t!==so))throw Xs=Qs,Gs;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=65011712&s.subtreeFlags,a|=65011712&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function al(e,t,n){var a=t.pendingProps;switch(ns(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),xs(Ds),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hs(t)?Xo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,ps())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Xo(t),null!==n?(nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Xo(t),nl(t),Zo(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==a&&Xo(t),nl(t),t.flags&=-16777217),null;case 27:Y(t),n=V.current;var s=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Xo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return nl(t),null}e=H.current,hs(t)?ds(t):(e=xu(s,a,n),t.stateNode=e,Xo(t))}return nl(t),null;case 5:if(Y(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Xo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return nl(t),null}if(e=H.current,hs(t))ds(t);else{switch(s=au(V.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof a.is?s.createElement("select",{is:a.is}):s.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e="string"===typeof a.is?s.createElement(n,{is:a.is}):s.createElement(n)}}e[De]=t,e[Pe]=a;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(eu(e,n,a),n){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Xo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&Xo(t);else{if("string"!==typeof a&&null===t.stateNode)throw Error(i(166));if(e=V.current,hs(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(s=as))switch(s.tag){case 27:case 5:a=s.memoizedProps}e[De]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||$d(e.nodeValue,n)))||cs(t)}else(e=au(e).createTextNode(a))[De]=t,t.stateNode=e}return nl(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(s=hs(t),null!==a&&null!==a.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[De]=t}else ms(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),s=!1}else s=ps(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=s),s=!0;if(!s)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==a,e=null!==e&&null!==e.memoizedState,n){s=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(s=a.alternate.memoizedState.cachePool.pool);var r=null;null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(r=a.memoizedState.cachePool.pool),r!==s&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return K(),null===e&&Ud(t.stateNode.containerInfo),nl(t),null;case 10:return xs(t.type),nl(t),null;case 19:if(U(co),null===(s=t.memoizedState))return nl(t),null;if(a=0!==(128&t.flags),null===(r=s.rendering))if(a)tl(s,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(r=uo(e))){for(t.flags|=128,tl(s,!1),e=r.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Oa(n,e),n=n.sibling;return B(co,1&co.current|2),t.child}e=e.sibling}null!==s.tail&&te()>Sc&&(t.flags|=128,a=!0,tl(s,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=uo(r))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(s,!0),null===s.tail&&"hidden"===s.tailMode&&!r.alternate&&!rs)return nl(t),null}else 2*te()-s.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,a=!0,tl(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(null!==(e=s.last)?e.sibling=r:t.child=r,s.last=r)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=te(),t.sibling=null,e=co.current,B(co,a?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),vr(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&U(Bs),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),xs(Ds),nl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function sl(e,t){switch(ns(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return xs(Ds),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));ms()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(co),null;case 4:return K(),null;case 10:return xs(t.type),null;case 22:case 23:return lo(t),vr(),null!==e&&U(Bs),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return xs(Ds),null;default:return null}}function rl(e,t){switch(ns(t),t.tag){case 3:xs(Ds),K();break;case 26:case 27:case 5:Y(t);break;case 4:K();break;case 13:lo(t);break;case 19:U(co);break;case 10:xs(t.type);break;case 22:case 23:lo(t),vr(),null!==e&&U(Bs);break;case 24:xs(Ds)}}function il(e,t){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var s=a.next;n=s;do{if((n.tag&e)===e){a=void 0;var r=n.create,i=n.inst;a=r(),i.destroy=a}n=n.next}while(n!==s)}}catch(o){dd(t,t.return,o)}}function ol(e,t,n){try{var a=t.updateQueue,s=null!==a?a.lastEffect:null;if(null!==s){var r=s.next;a=r;do{if((a.tag&e)===e){var i=a.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,s=t;var l=n,c=o;try{c()}catch(d){dd(s,l,d)}}}a=a.next}while(a!==r)}}catch(d){dd(t,t.return,d)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{hr(t,n)}catch(a){dd(e,e.return,a)}}}function cl(e,t,n){n.props=go(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){dd(e,t,a)}}function dl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"===typeof n?e.refCleanup=n(a):n.current=a}}catch(s){dd(e,t,s)}}function ul(e,t){var n=e.ref,a=e.refCleanup;if(null!==n)if("function"===typeof a)try{a()}catch(s){dd(e,t,s)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(r){dd(e,t,r)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(s){dd(e,e.return,s)}}function ml(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,o=null,l=null,c=null,d=null,u=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:a.hasOwnProperty(p)||Xd(e,t,p,null,a,h)}}for(var m in a){var p=a[m];if(h=n[m],a.hasOwnProperty(m)&&(null!=p||null!=h))switch(m){case"type":r=p;break;case"name":s=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==h&&Xd(e,t,m,p,a,h)}}return void gt(e,o,l,c,d,u,r,s);case"select":for(r in p=o=l=m=null,n)if(c=n[r],n.hasOwnProperty(r)&&null!=c)switch(r){case"value":break;case"multiple":p=c;default:a.hasOwnProperty(r)||Xd(e,t,r,null,a,c)}for(s in a)if(r=a[s],c=n[s],a.hasOwnProperty(s)&&(null!=r||null!=c))switch(s){case"value":m=r;break;case"defaultValue":l=r;break;case"multiple":o=r;default:r!==c&&Xd(e,t,s,r,a,c)}return t=l,n=o,a=p,void(null!=m?bt(e,!!n,m,!1):!!a!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=m=null,n)if(s=n[l],n.hasOwnProperty(l)&&null!=s&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Xd(e,t,l,null,a,s)}for(o in a)if(s=a[o],r=n[o],a.hasOwnProperty(o)&&(null!=s||null!=r))switch(o){case"value":m=s;break;case"defaultValue":p=s;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=s)throw Error(i(91));break;default:s!==r&&Xd(e,t,o,s,a,r)}return void xt(e,m,p);case"option":for(var f in n)if(m=n[f],n.hasOwnProperty(f)&&null!=m&&!a.hasOwnProperty(f))if("selected"===f)e.selected=!1;else Xd(e,t,f,null,a,m);for(c in a)if(m=a[c],p=n[c],a.hasOwnProperty(c)&&m!==p&&(null!=m||null!=p))if("selected"===c)e.selected=m&&"function"!==typeof m&&"symbol"!==typeof m;else Xd(e,t,c,m,a,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)m=n[g],n.hasOwnProperty(g)&&null!=m&&!a.hasOwnProperty(g)&&Xd(e,t,g,null,a,m);for(d in a)if(m=a[d],p=n[d],a.hasOwnProperty(d)&&m!==p&&(null!=m||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:Xd(e,t,d,m,a,p)}return;default:if(Ct(t)){for(var v in n)m=n[v],n.hasOwnProperty(v)&&void 0!==m&&!a.hasOwnProperty(v)&&Zd(e,t,v,void 0,a,m);for(u in a)m=a[u],p=n[u],!a.hasOwnProperty(u)||m===p||void 0===m&&void 0===p||Zd(e,t,u,m,a,p);return}}for(var y in n)m=n[y],n.hasOwnProperty(y)&&null!=m&&!a.hasOwnProperty(y)&&Xd(e,t,y,null,a,m);for(h in a)m=a[h],p=n[h],!a.hasOwnProperty(h)||m===p||null==m&&null==p||Xd(e,t,h,m,a,p)}(a,e.type,n,t),a[Pe]=t}catch(s){dd(e,e.return,s)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&mu(e.type)||4===e.tag}function fl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&mu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jd));else if(4!==a&&(27===a&&mu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function vl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&(27===a&&mu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,s=t.attributes;s.length;)t.removeAttributeNode(s[0]);eu(t,a,n),t[De]=e,t[Pe]=n}catch(r){dd(e,e.return,r)}}var bl=!1,xl=!1,wl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,kl=null;function jl(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(e,n),4&a&&il(5,n);break;case 1:if(Fl(e,n),4&a)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){dd(n,n.return,i)}else{var s=go(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){dd(n,n.return,o)}}64&a&&ll(n),512&a&&dl(n,n.return);break;case 3:if(Fl(e,n),64&a&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{hr(e,t)}catch(i){dd(n,n.return,i)}}break;case 27:null===t&&4&a&&yl(n);case 26:case 5:Fl(e,n),null===t&&4&a&&hl(n),512&a&&dl(n,n.return);break;case 12:Fl(e,n);break;case 13:Fl(e,n),4&a&&Il(e,n),64&a&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,n=pd.bind(null,n))));break;case 22:if(!(a=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||xl,s=bl;var r=xl;bl=a,(xl=t)&&!r?Ol(e,n,0!==(8772&n.subtreeFlags)):Fl(e,n),bl=s,xl=r}break;case 30:break;default:Fl(e,n)}}function Nl(e){var t=e.alternate;null!==t&&(e.alternate=null,Nl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ue(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cl=null,El=!1;function Tl(e,t,n){for(n=n.child;null!==n;)Al(e,t,n),n=n.sibling}function Al(e,t,n){if(ue&&"function"===typeof ue.onCommitFiberUnmount)try{ue.onCommitFiberUnmount(de,n)}catch(r){}switch(n.tag){case 26:xl||ul(n,t),Tl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:xl||ul(n,t);var a=Cl,s=El;mu(n.type)&&(Cl=n.stateNode,El=!1),Tl(e,t,n),wu(n.stateNode),Cl=a,El=s;break;case 5:xl||ul(n,t);case 6:if(a=Cl,s=El,Cl=null,Tl(e,t,n),El=s,null!==(Cl=a))if(El)try{(9===Cl.nodeType?Cl.body:"HTML"===Cl.nodeName?Cl.ownerDocument.body:Cl).removeChild(n.stateNode)}catch(i){dd(n,t,i)}else try{Cl.removeChild(n.stateNode)}catch(i){dd(n,t,i)}break;case 18:null!==Cl&&(El?(pu(9===(e=Cl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Eh(e)):pu(Cl,n.stateNode));break;case 4:a=Cl,s=El,Cl=n.stateNode.containerInfo,El=!0,Tl(e,t,n),Cl=a,El=s;break;case 0:case 11:case 14:case 15:xl||ol(2,n,t),xl||ol(4,n,t),Tl(e,t,n);break;case 1:xl||(ul(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount&&cl(n,t,a)),Tl(e,t,n);break;case 21:Tl(e,t,n);break;case 22:xl=(a=xl)||null!==n.memoizedState,Tl(e,t,n),xl=a;break;default:Tl(e,t,n)}}function Il(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Eh(e)}catch(n){dd(t,t.return,n)}}function Ml(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var a=fd.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}function Dl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var s=n[a],r=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(mu(l.type)){Cl=l.stateNode,El=!1;break e}break;case 5:Cl=l.stateNode,El=!1;break e;case 3:case 4:Cl=l.stateNode.containerInfo,El=!0;break e}l=l.return}if(null===Cl)throw Error(i(160));Al(r,o,s),Cl=null,El=!1,null!==(r=s.alternate)&&(r.return=null),s.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)_l(t,e),t=t.sibling}var Pl=null;function _l(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Dl(t,e),Rl(e),4&a&&(ol(3,e,e.return),il(3,e),ol(5,e,e.return));break;case 1:Dl(t,e),Rl(e),512&a&&(xl||null===n||ul(n,n.return)),64&a&&bl&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a))));break;case 26:var s=Pl;if(Dl(t,e),Rl(e),512&a&&(xl||null===n||ul(n,n.return)),4&a){var r=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,s=s.ownerDocument||s;t:switch(a){case"title":(!(r=s.getElementsByTagName("title")[0])||r[Oe]||r[De]||"http://www.w3.org/2000/svg"===r.namespaceURI||r.hasAttribute("itemprop"))&&(r=s.createElement(a),s.head.insertBefore(r,s.querySelector("head > title"))),eu(r,a,n),r[De]=e,We(r),a=r;break e;case"link":var o=Ou("link","href",s).get(a+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((r=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&r.getAttribute("rel")===(null==n.rel?null:n.rel)&&r.getAttribute("title")===(null==n.title?null:n.title)&&r.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}eu(r=s.createElement(a),a,n),s.head.appendChild(r);break;case"meta":if(o=Ou("meta","content",s).get(a+(n.content||"")))for(l=0;l<o.length;l++)if((r=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&r.getAttribute("name")===(null==n.name?null:n.name)&&r.getAttribute("property")===(null==n.property?null:n.property)&&r.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&r.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}eu(r=s.createElement(a),a,n),s.head.appendChild(r);break;default:throw Error(i(468,a))}r[De]=e,We(r),a=r}e.stateNode=a}else Uu(s,e.type,e.stateNode);else e.stateNode=_u(s,a,e.memoizedProps);else r!==a?(null===r?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):r.count--,null===a?Uu(s,e.type,e.stateNode):_u(s,a,e.memoizedProps)):null===a&&null!==e.stateNode&&ml(e,e.memoizedProps,n.memoizedProps)}break;case 27:Dl(t,e),Rl(e),512&a&&(xl||null===n||ul(n,n.return)),null!==n&&4&a&&ml(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Dl(t,e),Rl(e),512&a&&(xl||null===n||ul(n,n.return)),32&e.flags){s=e.stateNode;try{St(s,"")}catch(p){dd(e,e.return,p)}}4&a&&null!=e.stateNode&&ml(e,s=e.memoizedProps,null!==n?n.memoizedProps:s),1024&a&&(wl=!0);break;case 6:if(Dl(t,e),Rl(e),4&a){if(null===e.stateNode)throw Error(i(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(p){dd(e,e.return,p)}}break;case 3:if(Lu=null,s=Pl,Pl=ju(t.containerInfo),Dl(t,e),Pl=s,Rl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Eh(t.containerInfo)}catch(p){dd(e,e.return,p)}wl&&(wl=!1,zl(e));break;case 4:a=Pl,Pl=ju(e.stateNode.containerInfo),Dl(t,e),Rl(e),Pl=a;break;case 12:default:Dl(t,e),Rl(e);break;case 13:Dl(t,e),Rl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(wc=te()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ml(e,a)));break;case 22:s=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=bl,u=xl;if(bl=d||s,xl=u||c,Dl(t,e),xl=u,bl=d,Rl(e),8192&a)e:for(t=e.stateNode,t._visibility=s?-2&t._visibility:1|t._visibility,s&&(null===n||c||bl||xl||Ll(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(r=c.stateNode,s)"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,m=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==m||"boolean"===typeof m?"":(""+m).trim()}}catch(p){dd(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=s?"":c.memoizedProps}catch(p){dd(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(n=a.retryQueue)&&(a.retryQueue=null,Ml(e,n))));break;case 19:Dl(t,e),Rl(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ml(e,a)));case 30:case 21:}}function Rl(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(pl(a)){n=a;break}a=a.return}if(null==n)throw Error(i(160));switch(n.tag){case 27:var s=n.stateNode;vl(e,fl(e),s);break;case 5:var r=n.stateNode;32&n.flags&&(St(r,""),n.flags&=-33),vl(e,fl(e),r);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(e,fl(e),o);break;default:throw Error(i(161))}}catch(l){dd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function zl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;zl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Fl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)jl(e,t.alternate,t),t=t.sibling}function Ll(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),Ll(t);break;case 1:ul(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ll(t);break;case 27:wu(t.stateNode);case 26:case 5:ul(t,t.return),Ll(t);break;case 22:null===t.memoizedState&&Ll(t);break;default:Ll(t)}e=e.sibling}}function Ol(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,s=e,r=t,i=r.flags;switch(r.tag){case 0:case 11:case 15:Ol(s,r,n),il(4,r);break;case 1:if(Ol(s,r,n),"function"===typeof(s=(a=r).stateNode).componentDidMount)try{s.componentDidMount()}catch(c){dd(a,a.return,c)}if(null!==(s=(a=r).updateQueue)){var o=a.stateNode;try{var l=s.shared.hiddenCallbacks;if(null!==l)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)ur(l[s],o)}catch(c){dd(a,a.return,c)}}n&&64&i&&ll(r),dl(r,r.return);break;case 27:yl(r);case 26:case 5:Ol(s,r,n),n&&null===a&&4&i&&hl(r),dl(r,r.return);break;case 12:Ol(s,r,n);break;case 13:Ol(s,r,n),n&&4&i&&Il(s,r);break;case 22:null===r.memoizedState&&Ol(s,r,n),dl(r,r.return);break;case 30:break;default:Ol(s,r,n)}t=t.sibling}}function Ul(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&_s(n))}function Bl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&_s(e))}function Hl(e,t,n,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ql(e,t,n,a),t=t.sibling}function ql(e,t,n,a){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Hl(e,t,n,a),2048&s&&il(9,t);break;case 1:case 13:default:Hl(e,t,n,a);break;case 3:Hl(e,t,n,a),2048&s&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&_s(e)));break;case 12:if(2048&s){Hl(e,t,n,a),e=t.stateNode;try{var r=t.memoizedProps,i=r.id,o=r.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){dd(t,t.return,l)}}else Hl(e,t,n,a);break;case 23:break;case 22:r=t.stateNode,i=t.alternate,null!==t.memoizedState?2&r._visibility?Hl(e,t,n,a):Wl(e,t):2&r._visibility?Hl(e,t,n,a):(r._visibility|=2,Vl(e,t,n,a,0!==(10256&t.subtreeFlags))),2048&s&&Ul(i,t);break;case 24:Hl(e,t,n,a),2048&s&&Bl(t.alternate,t)}}function Vl(e,t,n,a,s){for(s=s&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var r=e,i=t,o=n,l=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:Vl(r,i,o,l,s),il(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?Vl(r,i,o,l,s):Wl(r,i):(d._visibility|=2,Vl(r,i,o,l,s)),s&&2048&c&&Ul(i.alternate,i);break;case 24:Vl(r,i,o,l,s),s&&2048&c&&Bl(i.alternate,i);break;default:Vl(r,i,o,l,s)}t=t.sibling}}function Wl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,a=t,s=a.flags;switch(a.tag){case 22:Wl(n,a),2048&s&&Ul(a.alternate,a);break;case 24:Wl(n,a),2048&s&&Bl(a.alternate,a);break;default:Wl(n,a)}t=t.sibling}}var Gl=8192;function Kl(e){if(e.subtreeFlags&Gl)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 26:Kl(e),e.flags&Gl&&null!==e.memoizedState&&function(e,t,n){if(null===Hu)throw Error(i(475));var a=Hu;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var s=Au(n.href),r=e.querySelector(Iu(s));if(r)return null!==(e=r._p)&&"object"===typeof e&&"function"===typeof e.then&&(a.count++,a=Vu.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=r,void We(r);r=e.ownerDocument||e,n=Mu(n),(s=Su.get(s))&&zu(n,s),We(r=r.createElement("link"));var o=r;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),eu(r,"link",n),t.instance=r}null===a.stylesheets&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(a.count++,t=Vu.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}(Pl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Pl;Pl=ju(e.stateNode.containerInfo),Kl(e),Pl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Gl,Gl=16777216,Kl(e),Gl=t):Kl(e))}}function Yl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function $l(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];kl=a,Zl(a,e)}Yl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:$l(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:$l(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Xl(e)):$l(e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];kl=a,Zl(a,e)}Yl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Xl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Xl(t));break;default:Xl(t)}e=e.sibling}}function Zl(e,t){for(;null!==kl;){var n=kl;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var a=n.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:_s(n.memoizedState.cache)}if(null!==(a=n.child))a.return=n,kl=a;else e:for(n=e;null!==kl;){var s=(a=kl).sibling,r=a.return;if(Nl(a),a===n){kl=null;break e}if(null!==s){s.return=r,kl=s;break e}kl=r}}}var ec={getCacheForType:function(e){var t=Cs(Ds),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,ac=null,sc=null,rc=0,ic=0,oc=null,lc=!1,cc=!1,dc=!1,uc=0,hc=0,mc=0,pc=0,fc=0,gc=0,vc=0,yc=null,bc=null,xc=!1,wc=0,Sc=1/0,kc=null,jc=null,Nc=0,Cc=null,Ec=null,Tc=0,Ac=0,Ic=null,Mc=null,Dc=0,Pc=null;function _c(){if(0!==(2&nc)&&0!==rc)return rc&-rc;if(null!==_.T){return 0!==Fs?Fs:Ad()}return Ie()}function Rc(){0===gc&&(gc=0===(536870912&rc)||rs?Se():536870912);var e=ao.current;return null!==e&&(e.flags|=32),gc}function zc(e,t,n){(e!==ac||2!==ic&&9!==ic)&&null===e.cancelPendingCommit||(qc(e,0),Uc(e,rc,gc,!1)),Ne(e,n),0!==(2&nc)&&e===ac||(e===ac&&(0===(2&nc)&&(pc|=n),4===hc&&Uc(e,rc,gc,!1)),Sd(e))}function Fc(e,t,n){if(0!==(6&nc))throw Error(i(327));for(var a=!n&&0===(124&t)&&0===(t&e.expiredLanes)||xe(e,t),s=a?function(e,t){var n=nc;nc|=2;var a=Wc(),s=Gc();ac!==e||rc!==t?(kc=null,Sc=te()+500,qc(e,t)):cc=xe(e,t);e:for(;;)try{if(0!==ic&&null!==sc){t=sc;var r=oc;t:switch(ic){case 1:ic=0,oc=null,Zc(e,t,r,1);break;case 2:case 9:if(Ys(r)){ic=0,oc=null,Xc(t);break}t=function(){2!==ic&&9!==ic||ac!==e||(ic=7),Sd(e)},r.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:Ys(r)?(ic=0,oc=null,Xc(t)):(ic=0,oc=null,Zc(e,t,r,7));break;case 5:var o=null;switch(sc.tag){case 26:o=sc.memoizedState;case 5:case 27:var l=sc;if(!o||Bu(o)){ic=0,oc=null;var c=l.sibling;if(null!==c)sc=c;else{var d=l.return;null!==d?(sc=d,ed(d)):sc=null}break t}}ic=0,oc=null,Zc(e,t,r,5);break;case 6:ic=0,oc=null,Zc(e,t,r,6);break;case 8:Hc(),hc=6;break e;default:throw Error(i(462))}}$c();break}catch(u){Vc(e,u)}return ys=vs=null,_.H=a,_.A=s,nc=n,null!==sc?0:(ac=null,rc=0,Ta(),hc)}(e,t):Qc(e,t,!0),r=a;;){if(0===s){cc&&!a&&Uc(e,t,0,!1);break}if(n=e.current.alternate,!r||Oc(n)){if(2===s){if(r=t,e.errorRecoveryDisabledLanes&r)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;s=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(qc(l,o).flags|=256),2!==(o=Qc(l,o,!1))){if(dc&&!c){l.errorRecoveryDisabledLanes|=r,pc|=r,s=4;break e}r=bc,bc=s,null!==r&&(null===bc?bc=r:bc.push.apply(bc,r))}s=o}if(r=!1,2!==s)continue}}if(1===s){qc(e,0),Uc(e,t,0,!0);break}e:{switch(a=e,r=s){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Uc(a,t,gc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(s=wc+300-te())){if(Uc(a,t,gc,!lc),0!==be(a,0,!0))break e;a.timeoutHandle=lu(Lc.bind(null,a,n,bc,kc,xc,t,gc,pc,vc,lc,r,2,-0,0),s)}else Lc(a,n,bc,kc,xc,t,gc,pc,vc,lc,r,0,-0,0)}break}s=Qc(e,t,!1),r=!1}Sd(e)}function Lc(e,t,n,a,s,r,o,l,c,d,u,h,m,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Hu={stylesheets:null,count:0,unsuspend:qu},Ql(t),null!==(h=function(){if(null===Hu)throw Error(i(475));var e=Hu;return e.stylesheets&&0===e.count&&Gu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Gu(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nd.bind(null,e,t,r,n,a,s,o,l,c,u,1,m,p)),void Uc(e,r,o,!d);nd(e,t,r,n,a,s,o,l,c)}function Oc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var a=0;a<n.length;a++){var s=n[a],r=s.getSnapshot;s=s.value;try{if(!Yn(r(),s))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uc(e,t,n,a){t&=~fc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var s=t;0<s;){var r=31-me(s),i=1<<r;a[r]=-1,s&=~i}0!==n&&Ce(e,n,t)}function Bc(){return 0!==(6&nc)||(kd(0,!1),!1)}function Hc(){if(null!==sc){if(0===ic)var e=sc.return;else ys=vs=null,Fr(e=sc),Qi=null,Yi=0,e=sc;for(;null!==e;)rl(e.alternate,e),e=e.return;sc=null}}function qc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cu(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Hc(),ac=e,sc=n=La(e.current,null),rc=t,ic=0,oc=null,lc=!1,cc=xe(e,t),dc=!1,vc=gc=fc=pc=mc=hc=0,bc=yc=null,xc=!1,0!==(8&t)&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var s=31-me(a),r=1<<s;t|=e[s],a&=~r}return uc=t,Ta(),n}function Vc(e,t){br=null,_.H=Vi,t===Ws||t===Ks?(t=Zs(),ic=3):t===Gs?(t=Zs(),ic=4):ic=t===Co?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===sc&&(hc=1,wo(e,ja(t,e.current)))}function Wc(){var e=_.H;return _.H=Vi,null===e?Vi:e}function Gc(){var e=_.A;return _.A=ec,e}function Kc(){hc=4,lc||(4194048&rc)!==rc&&null!==ao.current||(cc=!0),0===(134217727&mc)&&0===(134217727&pc)||null===ac||Uc(ac,rc,gc,!1)}function Qc(e,t,n){var a=nc;nc|=2;var s=Wc(),r=Gc();ac===e&&rc===t||(kc=null,qc(e,t)),t=!1;var i=hc;e:for(;;)try{if(0!==ic&&null!==sc){var o=sc,l=oc;switch(ic){case 8:Hc(),i=6;break e;case 3:case 2:case 9:case 6:null===ao.current&&(t=!0);var c=ic;if(ic=0,oc=null,Zc(e,o,l,c),n&&cc){i=0;break e}break;default:c=ic,ic=0,oc=null,Zc(e,o,l,c)}}Yc(),i=hc;break}catch(d){Vc(e,d)}return t&&e.shellSuspendCounter++,ys=vs=null,nc=a,_.H=s,_.A=r,null===sc&&(ac=null,rc=0,Ta()),i}function Yc(){for(;null!==sc;)Jc(sc)}function $c(){for(;null!==sc&&!Z();)Jc(sc)}function Jc(e){var t=Jo(e.alternate,e,uc);e.memoizedProps=e.pendingProps,null===t?ed(e):sc=t}function Xc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=zo(n,t,t.pendingProps,t.type,void 0,rc);break;case 11:t=zo(n,t,t.pendingProps,t.type.render,t.ref,rc);break;case 5:Fr(t);default:rl(n,t),t=Jo(n,t=sc=Oa(t,uc),uc)}e.memoizedProps=e.pendingProps,null===t?ed(e):sc=t}function Zc(e,t,n,a){ys=vs=null,Fr(t),Qi=null,Yi=0;var s=t.return;try{if(function(e,t,n,a,s){if(n.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){if(null!==(t=n.alternate)&&ks(t,n,s,!0),null!==(n=ao.current)){switch(n.tag){case 13:return null===so?Kc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=s,a===Qs?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),ud(e,a,s)),!1;case 22:return n.flags|=65536,a===Qs?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),ud(e,a,s)),!1}throw Error(i(435,n.tag))}return ud(e,a,s),Kc(),!1}if(rs)return null!==(t=ao.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=s,a!==ls&&fs(ja(e=Error(i(422),{cause:a}),n))):(a!==ls&&fs(ja(t=Error(i(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,s&=-s,e.lanes|=s,a=ja(a,n),or(e,s=ko(e.stateNode,a,s)),4!==hc&&(hc=2)),!1;var r=Error(i(520),{cause:a});if(r=ja(r,n),null===yc?yc=[r]:yc.push(r),4!==hc&&(hc=2),null===t)return!0;a=ja(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=s&-s,n.lanes|=e,or(n,e=ko(n.stateNode,a,e)),!1;case 1:if(t=n.type,r=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==r&&"function"===typeof r.componentDidCatch&&(null===jc||!jc.has(r))))return n.flags|=65536,s&=-s,n.lanes|=s,No(s=jo(s),e,n,a),or(n,s),!1}n=n.return}while(null!==n);return!1}(e,s,t,n,rc))return hc=1,wo(e,ja(n,e.current)),void(sc=null)}catch(r){if(null!==s)throw sc=s,r;return hc=1,wo(e,ja(n,e.current)),void(sc=null)}32768&t.flags?(rs||1===a?e=!0:cc||0!==(536870912&rc)?e=!1:(lc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=ao.current)&&13===a.tag&&(a.flags|=16384))),td(t,e)):ed(t)}function ed(e){var t=e;do{if(0!==(32768&t.flags))return void td(t,lc);e=t.return;var n=al(t.alternate,t,uc);if(null!==n)return void(sc=n);if(null!==(t=t.sibling))return void(sc=t);sc=t=e}while(null!==t);0===hc&&(hc=5)}function td(e,t){do{var n=sl(e.alternate,e);if(null!==n)return n.flags&=32767,void(sc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(sc=e);sc=e=n}while(null!==e);hc=6,sc=null}function nd(e,t,n,a,s,r,o,l,c){e.cancelPendingCommit=null;do{od()}while(0!==Nc);if(0!==(6&nc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(r=t.lanes|t.childLanes,function(e,t,n,a,s,r){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var d=31-me(n),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var m=h[d];null!==m&&(m.lane&=-536870913)}n&=~u}0!==a&&Ce(e,a,0),0!==r&&0===s&&0!==e.tag&&(e.suspendedLanes|=r&~(i&~t))}(e,n,r|=Ea,o,l,c),e===ac&&(sc=ac=null,rc=0),Ec=t,Cc=e,Tc=n,Ac=r,Ic=s,Mc=a,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,J(re,function(){return ld(),null})):(e.callbackNode=null,e.callbackPriority=0),a=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||a){a=_.T,_.T=null,s=R.p,R.p=2,o=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,tu=nh,ta(e=ea(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var s=a.anchorOffset,r=a.focusNode;a=a.focusOffset;try{n.nodeType,r.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==r||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===n&&++d===s&&(l=o),m===r&&++u===a&&(c=o),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nu={focusedElem:e,selectionRange:n},nh=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(r=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==r){e=void 0,n=t,s=r.memoizedProps,r=r.memoizedState,a=n.stateNode;try{var f=go(n.type,s,(n.elementType,n.type));e=a.getSnapshotBeforeUpdate(f,r),a.__reactInternalSnapshotBeforeUpdate=e}catch(v){dd(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))fu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":fu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{nc=o,R.p=s,_.T=a}}Nc=1,ad(),sd(),rd()}}function ad(){if(1===Nc){Nc=0;var e=Cc,t=Ec,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=_.T,_.T=null;var a=R.p;R.p=2;var s=nc;nc|=4;try{_l(t,e);var r=nu,i=ea(e.containerInfo),o=r.focusedElem,l=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&Zn(o.ownerDocument.documentElement,o)){if(null!==l&&ta(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var m=h.getSelection(),p=o.textContent.length,f=Math.min(l.start,p),g=void 0===l.end?f:Math.min(l.end,p);!m.extend&&f>g&&(i=g,g=f,f=i);var v=Xn(o,f),y=Xn(o,g);if(v&&y&&(1!==m.rangeCount||m.anchorNode!==v.node||m.anchorOffset!==v.offset||m.focusNode!==y.node||m.focusOffset!==y.offset)){var b=u.createRange();b.setStart(v.node,v.offset),m.removeAllRanges(),f>g?(m.addRange(b),m.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),m.addRange(b))}}}}for(u=[],m=o;m=m.parentNode;)1===m.nodeType&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var x=u[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}nh=!!tu,nu=tu=null}finally{nc=s,R.p=a,_.T=n}}e.current=t,Nc=2}}function sd(){if(2===Nc){Nc=0;var e=Cc,t=Ec,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=_.T,_.T=null;var a=R.p;R.p=2;var s=nc;nc|=4;try{jl(e,t.alternate,t)}finally{nc=s,R.p=a,_.T=n}}Nc=3}}function rd(){if(4===Nc||3===Nc){Nc=0,ee();var e=Cc,t=Ec,n=Tc,a=Mc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Nc=5:(Nc=0,Ec=Cc=null,id(e,e.pendingLanes));var s=e.pendingLanes;if(0===s&&(jc=null),Ae(n),t=t.stateNode,ue&&"function"===typeof ue.onCommitFiberRoot)try{ue.onCommitFiberRoot(de,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==a){t=_.T,s=R.p,R.p=2,_.T=null;try{for(var r=e.onRecoverableError,i=0;i<a.length;i++){var o=a[i];r(o.value,{componentStack:o.stack})}}finally{_.T=t,R.p=s}}0!==(3&Tc)&&od(),Sd(e),s=e.pendingLanes,0!==(4194090&n)&&0!==(42&s)?e===Pc?Dc++:(Dc=0,Pc=e):Dc=0,kd(0,!1)}}function id(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,_s(t)))}function od(e){return ad(),sd(),rd(),ld()}function ld(){if(5!==Nc)return!1;var e=Cc,t=Ac;Ac=0;var n=Ae(Tc),a=_.T,s=R.p;try{R.p=32>n?32:n,_.T=null,n=Ic,Ic=null;var r=Cc,o=Tc;if(Nc=0,Ec=Cc=null,Tc=0,0!==(6&nc))throw Error(i(331));var l=nc;if(nc|=4,Jl(r.current),ql(r,r.current,o,n),nc=l,kd(0,!1),ue&&"function"===typeof ue.onPostCommitFiberRoot)try{ue.onPostCommitFiberRoot(de,r)}catch(c){}return!0}finally{R.p=s,_.T=a,id(e,t)}}function cd(e,t,n){t=ja(n,t),null!==(e=rr(e,t=ko(e.stateNode,t,2),2))&&(Ne(e,2),Sd(e))}function dd(e,t,n){if(3===e.tag)cd(e,e,n);else for(;null!==t;){if(3===t.tag){cd(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===jc||!jc.has(a))){e=ja(n,e),null!==(a=rr(t,n=jo(2),2))&&(No(n,a,t,e),Ne(a,2),Sd(a));break}}t=t.return}}function ud(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new tc;var s=new Set;a.set(t,s)}else void 0===(s=a.get(t))&&(s=new Set,a.set(t,s));s.has(n)||(dc=!0,s.add(n),e=hd.bind(null,e,t,n),t.then(e,e))}function hd(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ac===e&&(rc&n)===n&&(4===hc||3===hc&&(62914560&rc)===rc&&300>te()-wc?0===(2&nc)&&qc(e,0):fc|=n,vc===rc&&(vc=0)),Sd(e)}function md(e,t){0===t&&(t=ke()),null!==(e=Ma(e,t))&&(Ne(e,t),Sd(e))}function pd(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),md(e,n)}function fd(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==a&&a.delete(t),md(e,n)}var gd=null,vd=null,yd=!1,bd=!1,xd=!1,wd=0;function Sd(e){e!==vd&&null===e.next&&(null===vd?gd=vd=e:vd=vd.next=e),bd=!0,yd||(yd=!0,uu(function(){0!==(6&nc)?J(ae,jd):Nd()}))}function kd(e,t){if(!xd&&bd){xd=!0;do{for(var n=!1,a=gd;null!==a;){if(!t)if(0!==e){var s=a.pendingLanes;if(0===s)var r=0;else{var i=a.suspendedLanes,o=a.pingedLanes;r=(1<<31-me(42|e)+1)-1,r=201326741&(r&=s&~(i&~o))?201326741&r|1:r?2|r:0}0!==r&&(n=!0,Td(a,r))}else r=rc,0===(3&(r=be(a,a===ac?r:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||xe(a,r)||(n=!0,Td(a,r));a=a.next}}while(n);xd=!1}}function jd(){Nd()}function Nd(){bd=yd=!1;var e=0;0!==wd&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ou&&(ou=e,!0);return ou=null,!1}()&&(e=wd),wd=0);for(var t=te(),n=null,a=gd;null!==a;){var s=a.next,r=Cd(a,t);0===r?(a.next=null,null===n?gd=s:n.next=s,null===s&&(vd=n)):(n=a,(0!==e||0!==(3&r))&&(bd=!0)),a=s}kd(e,!1)}function Cd(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,r=-62914561&e.pendingLanes;0<r;){var i=31-me(r),o=1<<i,l=s[i];-1===l?0!==(o&n)&&0===(o&a)||(s[i]=we(o,t)):l<=t&&(e.expiredLanes|=o),r&=~o}if(n=rc,n=be(e,e===(t=ac)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===n||e===t&&(2===ic||9===ic)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&X(a),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||xe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==a&&X(a),Ae(n)){case 2:case 8:n=se;break;case 32:default:n=re;break;case 268435456:n=oe}return a=Ed.bind(null,e),n=J(n,a),e.callbackPriority=t,e.callbackNode=n,t}return null!==a&&null!==a&&X(a),e.callbackPriority=2,e.callbackNode=null,2}function Ed(e,t){if(0!==Nc&&5!==Nc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(od()&&e.callbackNode!==n)return null;var a=rc;return 0===(a=be(e,e===ac?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Fc(e,a,t),Cd(e,te()),null!=e.callbackNode&&e.callbackNode===n?Ed.bind(null,e):null)}function Td(e,t){if(od())return null;Fc(e,t,!0)}function Ad(){return 0===wd&&(wd=Se()),wd}function Id(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:At(""+e)}function Md(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Dd=0;Dd<wa.length;Dd++){var Pd=wa[Dd];Sa(Pd.toLowerCase(),"on"+(Pd[0].toUpperCase()+Pd.slice(1)))}Sa(ma,"onAnimationEnd"),Sa(pa,"onAnimationIteration"),Sa(fa,"onAnimationStart"),Sa("dblclick","onDoubleClick"),Sa("focusin","onFocus"),Sa("focusout","onBlur"),Sa(ga,"onTransitionRun"),Sa(va,"onTransitionStart"),Sa(ya,"onTransitionCancel"),Sa(ba,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _d="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_d));function zd(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],s=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=c;try{r(s)}catch(d){vo(d)}s.currentTarget=null,r=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=c;try{r(s)}catch(d){vo(d)}s.currentTarget=null,r=l}}}}function Fd(e,t){var n=t[Re];void 0===n&&(n=t[Re]=new Set);var a=e+"__bubble";n.has(a)||(Bd(t,e,2,!1),n.add(a))}function Ld(e,t,n){var a=0;t&&(a|=4),Bd(n,e,a,t)}var Od="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[Od]){e[Od]=!0,Ge.forEach(function(t){"selectionchange"!==t&&(Rd.has(t)||Ld(t,!1,e),Ld(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Od]||(t[Od]=!0,Ld("selectionchange",!1,t))}}function Bd(e,t,n,a){switch(ch(t)){case 2:var s=ah;break;case 8:s=sh;break;default:s=rh}n=s.bind(null,t,n,e),s=void 0,!Ot||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),a?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Hd(e,t,n,a,s){var r=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===s)break;if(4===i)for(i=a.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===s)return;i=i.return}for(;null!==o;){if(null===(i=Be(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){a=r=i;continue e}o=o.parentNode}}a=a.return}zt(function(){var a=r,s=Mt(n),i=[];e:{var o=xa.get(e);if(void 0!==o){var c=Zt,d=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":c=fn;break;case"focusin":d="focus",c=rn;break;case"focusout":d="blur",c=rn;break;case"beforeblur":case"afterblur":c=rn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case ma:case pa:case fa:c=on;break;case ba:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=xn}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),m=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=a;null!==f;){var g=f;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===m||null!=(g=Ft(f,m))&&u.push(qd(f,g,p)),h)break;f=f.return}0<u.length&&(o=new c(o,d,null,n,s),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===It||!(d=n.relatedTarget||n.fromElement)||!Be(d)&&!d[_e])&&(c||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=a,null!==(d=(d=n.relatedTarget||n.toElement)?Be(d):null)&&(h=l(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=a),c!==d)){if(u=an,g="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=gn,g="onPointerLeave",m="onPointerEnter",f="pointer"),h=null==c?o:qe(c),p=null==d?o:qe(d),(o=new u(g,f+"leave",c,n,s)).target=h,o.relatedTarget=p,g=null,Be(s)===a&&((u=new u(m,f+"enter",d,n,s)).target=p,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(m=d,f=0,p=u=c;p;p=Wd(p))f++;for(p=0,g=m;g;g=Wd(g))p++;for(;0<f-p;)u=Wd(u),f--;for(;0<p-f;)m=Wd(m),p--;for(;f--;){if(u===m||null!==m&&u===m.alternate)break e;u=Wd(u),m=Wd(m)}u=null}else u=null;null!==c&&Gd(i,o,c,u,!1),null!==d&&null!==h&&Gd(i,h,d,u,!0)}if("select"===(c=(o=a?qe(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Ln;else if(Dn(o))if(On)v=Qn;else{v=Gn;var y=Wn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?a&&Ct(a.elementType)&&(v=Ln):v=Kn;switch(v&&(v=v(e,a))?Pn(i,v,n,s):(y&&y(e,o,a),"focusout"===e&&a&&"number"===o.type&&null!=a.memoizedProps.value&&yt(o,"number",o.value)),y=a?qe(a):window,e){case"focusin":(Dn(y)||"true"===y.contentEditable)&&(aa=y,sa=a,ra=null);break;case"focusout":ra=sa=aa=null;break;case"mousedown":ia=!0;break;case"contextmenu":case"mouseup":case"dragend":ia=!1,oa(i,n,s);break;case"selectionchange":if(na)break;case"keydown":case"keyup":oa(i,n,s)}var b;if(Sn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else In?Tn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Nn&&"ko"!==n.locale&&(In||"onCompositionStart"!==x?"onCompositionEnd"===x&&In&&(b=Vt()):(Ht="value"in(Bt=s)?Bt.value:Bt.textContent,In=!0)),0<(y=Vd(a,x)).length&&(x=new cn(x,e,null,n,s),i.push({event:x,listeners:y}),b?x.data=b:null!==(b=An(n))&&(x.data=b))),(b=jn?function(e,t){switch(e){case"compositionend":return An(t);case"keypress":return 32!==t.which?null:(En=!0,Cn);case"textInput":return(e=t.data)===Cn&&En?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!Sn&&Tn(e,t)?(e=Vt(),qt=Ht=Bt=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(x=Vd(a,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,s),i.push({event:y,listeners:x}),y.data=b)),function(e,t,n,a,s){if("submit"===t&&n&&n.stateNode===s){var r=Id((s[Pe]||null).action),i=a.submitter;i&&null!==(t=(t=i[Pe]||null)?Id(t.formAction):i.getAttribute("formAction"))&&(r=t,i=null);var o=new Zt("action","action",null,a,s);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==wd){var e=i?Md(s,i):new FormData(s);Ii(n,{pending:!0,data:e,method:s.method,action:r},null,e)}}else"function"===typeof r&&(o.preventDefault(),e=i?Md(s,i):new FormData(s),Ii(n,{pending:!0,data:e,method:s.method,action:r},r,e))},currentTarget:s}]})}}(i,e,a,n,s)}zd(i,t)})}function qd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vd(e,t){for(var n=t+"Capture",a=[];null!==e;){var s=e,r=s.stateNode;if(5!==(s=s.tag)&&26!==s&&27!==s||null===r||(null!=(s=Ft(e,n))&&a.unshift(qd(e,s,r)),null!=(s=Ft(e,t))&&a.push(qd(e,s,r))),3===e.tag)return a;e=e.return}return[]}function Wd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Gd(e,t,n,a,s){for(var r=t._reactName,i=[];null!==n&&n!==a;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===a)break;5!==o&&26!==o&&27!==o||null===c||(l=c,s?null!=(c=Ft(n,r))&&i.unshift(qd(n,c,l)):s||null!=(c=Ft(n,r))&&i.push(qd(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Kd=/\r\n?/g,Qd=/\u0000|\uFFFD/g;function Yd(e){return("string"===typeof e?e:""+e).replace(Kd,"\n").replace(Qd,"")}function $d(e,t){return t=Yd(t),Yd(e)===t}function Jd(){}function Xd(e,t,n,a,s,r){switch(n){case"children":"string"===typeof a?"body"===t||"textarea"===t&&""===a||St(e,a):("number"===typeof a||"bigint"===typeof a)&&"body"!==t&&St(e,""+a);break;case"className":nt(e,"class",a);break;case"tabIndex":nt(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,a);break;case"style":Nt(e,a,r);break;case"data":if("object"!==t){nt(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"===typeof a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=At(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"===typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof r&&("formAction"===n?("input"!==t&&Xd(e,t,"name",s.name,s,null),Xd(e,t,"formEncType",s.formEncType,s,null),Xd(e,t,"formMethod",s.formMethod,s,null),Xd(e,t,"formTarget",s.formTarget,s,null)):(Xd(e,t,"encType",s.encType,s,null),Xd(e,t,"method",s.method,s,null),Xd(e,t,"target",s.target,s,null))),null==a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(n);break}a=At(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=Jd);break;case"onScroll":null!=a&&Fd("scroll",e);break;case"onScrollEnd":null!=a&&Fd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(n=a.__html)){if(null!=s.children)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"muted":e.muted=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"===typeof a||"boolean"===typeof a||"symbol"===typeof a){e.removeAttribute("xlink:href");break}n=At(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":null==a||"function"===typeof a||"symbol"===typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Fd("beforetoggle",e),Fd("toggle",e),tt(e,"popover",a);break;case"xlinkActuate":at(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":at(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":at(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":at(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":at(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":at(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":at(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":at(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":at(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":tt(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Et.get(n)||n,a)}}function Zd(e,t,n,a,s,r){switch(n){case"style":Nt(e,a,r);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(n=a.__html)){if(null!=s.children)throw Error(i(60));e.innerHTML=n}}break;case"children":"string"===typeof a?St(e,a):("number"===typeof a||"bigint"===typeof a)&&St(e,""+a);break;case"onScroll":null!=a&&Fd("scroll",e);break;case"onScrollEnd":null!=a&&Fd("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Jd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(s=n.endsWith("Capture"),t=n.slice(2,s?n.length-7:void 0),"function"===typeof(r=null!=(r=e[Pe]||null)?r[n]:null)&&e.removeEventListener(t,r,s),"function"!==typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):tt(e,n,a):("function"!==typeof r&&null!==r&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,s)))}}function eu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fd("error",e),Fd("load",e);var a,s=!1,r=!1;for(a in n)if(n.hasOwnProperty(a)){var o=n[a];if(null!=o)switch(a){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Xd(e,t,a,o,n,null)}}return r&&Xd(e,t,"srcSet",n.srcSet,n,null),void(s&&Xd(e,t,"src",n.src,n,null));case"input":Fd("invalid",e);var l=a=o=r=null,c=null,d=null;for(s in n)if(n.hasOwnProperty(s)){var u=n[s];if(null!=u)switch(s){case"name":r=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":a=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:Xd(e,t,s,u,n,null)}}return vt(e,a,l,c,d,o,r,!1),void ut(e);case"select":for(r in Fd("invalid",e),s=o=a=null,n)if(n.hasOwnProperty(r)&&null!=(l=n[r]))switch(r){case"value":a=l;break;case"defaultValue":o=l;break;case"multiple":s=l;default:Xd(e,t,r,l,n,null)}return t=a,n=o,e.multiple=!!s,void(null!=t?bt(e,!!s,t,!1):null!=n&&bt(e,!!s,n,!0));case"textarea":for(o in Fd("invalid",e),a=r=s=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":s=l;break;case"defaultValue":r=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:Xd(e,t,o,l,n,null)}return wt(e,s,r,a),void ut(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(s=n[c]))if("selected"===c)e.selected=s&&"function"!==typeof s&&"symbol"!==typeof s;else Xd(e,t,c,s,n,null);return;case"dialog":Fd("beforetoggle",e),Fd("toggle",e),Fd("cancel",e),Fd("close",e);break;case"iframe":case"object":Fd("load",e);break;case"video":case"audio":for(s=0;s<_d.length;s++)Fd(_d[s],e);break;case"image":Fd("error",e),Fd("load",e);break;case"details":Fd("toggle",e);break;case"embed":case"source":case"link":Fd("error",e),Fd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(s=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Xd(e,t,d,s,n,null)}return;default:if(Ct(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(s=n[u])&&Zd(e,t,u,s,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(s=n[l])&&Xd(e,t,l,s,n,null))}var tu=null,nu=null;function au(e){return 9===e.nodeType?e:e.ownerDocument}function su(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ru(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function iu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ou=null;var lu="function"===typeof setTimeout?setTimeout:void 0,cu="function"===typeof clearTimeout?clearTimeout:void 0,du="function"===typeof Promise?Promise:void 0,uu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof du?function(e){return du.resolve(null).then(e).catch(hu)}:lu;function hu(e){setTimeout(function(){throw e})}function mu(e){return"head"===e}function pu(e,t){var n=t,a=0,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0<a&&8>a){n=a;var i=e.ownerDocument;if(1&n&&wu(i.documentElement),2&n&&wu(i.body),4&n)for(wu(n=i.head),i=n.firstChild;i;){var o=i.nextSibling,l=i.nodeName;i[Oe]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}if(0===s)return e.removeChild(r),void Eh(t);s--}else"$"===n||"$?"===n||"$!"===n?s++:a=n.charCodeAt(0)-48;else a=0;n=r}while(n);Eh(t)}function fu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":fu(n),Ue(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yu=null;function bu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function xu(e,t,n){switch(t=au(n),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function wu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ue(e)}var Su=new Map,ku=new Set;function ju(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Nu=R.d;R.d={f:function(){var e=Nu.f(),t=Bc();return e||t},r:function(e){var t=He(e);null!==t&&5===t.tag&&"form"===t.type?Di(t):Nu.r(e)},D:function(e){Nu.D(e),Eu("dns-prefetch",e,null)},C:function(e,t){Nu.C(e,t),Eu("preconnect",e,t)},L:function(e,t,n){Nu.L(e,t,n);var a=Cu;if(a&&e&&t){var s='link[rel="preload"][as="'+ft(t)+'"]';"image"===t&&n&&n.imageSrcSet?(s+='[imagesrcset="'+ft(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(s+='[imagesizes="'+ft(n.imageSizes)+'"]')):s+='[href="'+ft(e)+'"]';var r=s;switch(t){case"style":r=Au(e);break;case"script":r=Du(e)}Su.has(r)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Su.set(r,e),null!==a.querySelector(s)||"style"===t&&a.querySelector(Iu(r))||"script"===t&&a.querySelector(Pu(r))||(eu(t=a.createElement("link"),"link",e),We(t),a.head.appendChild(t)))}},m:function(e,t){Nu.m(e,t);var n=Cu;if(n&&e){var a=t&&"string"===typeof t.as?t.as:"script",s='link[rel="modulepreload"][as="'+ft(a)+'"][href="'+ft(e)+'"]',r=s;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Du(e)}if(!Su.has(r)&&(e=h({rel:"modulepreload",href:e},t),Su.set(r,e),null===n.querySelector(s))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Pu(r)))return}eu(a=n.createElement("link"),"link",e),We(a),n.head.appendChild(a)}}},X:function(e,t){Nu.X(e,t);var n=Cu;if(n&&e){var a=Ve(n).hoistableScripts,s=Du(e),r=a.get(s);r||((r=n.querySelector(Pu(s)))||(e=h({src:e,async:!0},t),(t=Su.get(s))&&Fu(e,t),We(r=n.createElement("script")),eu(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},a.set(s,r))}},S:function(e,t,n){Nu.S(e,t,n);var a=Cu;if(a&&e){var s=Ve(a).hoistableStyles,r=Au(e);t=t||"default";var i=s.get(r);if(!i){var o={loading:0,preload:null};if(i=a.querySelector(Iu(r)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Su.get(r))&&zu(e,n);var l=i=a.createElement("link");We(l),eu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Ru(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:o},s.set(r,i)}}},M:function(e,t){Nu.M(e,t);var n=Cu;if(n&&e){var a=Ve(n).hoistableScripts,s=Du(e),r=a.get(s);r||((r=n.querySelector(Pu(s)))||(e=h({src:e,async:!0,type:"module"},t),(t=Su.get(s))&&Fu(e,t),We(r=n.createElement("script")),eu(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},a.set(s,r))}}};var Cu="undefined"===typeof document?null:document;function Eu(e,t,n){var a=Cu;if(a&&"string"===typeof t&&t){var s=ft(t);s='link[rel="'+e+'"][href="'+s+'"]',"string"===typeof n&&(s+='[crossorigin="'+n+'"]'),ku.has(s)||(ku.add(s),e={rel:e,crossOrigin:n,href:t},null===a.querySelector(s)&&(eu(t=a.createElement("link"),"link",e),We(t),a.head.appendChild(t)))}}function Tu(e,t,n,a){var s,r,o,l,c=(c=V.current)?ju(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Au(n.href),(a=(n=Ve(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Au(n.href);var d=Ve(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Iu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Su.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Su.set(e,n),d||(s=c,r=e,o=n,l=u.state,s.querySelector('link[rel="preload"][as="style"]['+r+"]")?l.loading=1:(r=s.createElement("link"),l.preload=r,r.addEventListener("load",function(){return l.loading|=1}),r.addEventListener("error",function(){return l.loading|=2}),eu(r,"link",o),We(r),s.head.appendChild(r))))),t&&null===a)throw Error(i(528,""));return u}if(t&&null!==a)throw Error(i(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Du(n),(a=(n=Ve(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Au(e){return'href="'+ft(e)+'"'}function Iu(e){return'link[rel="stylesheet"]['+e+"]"}function Mu(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Du(e){return'[src="'+ft(e)+'"]'}function Pu(e){return"script[async]"+e}function _u(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+ft(n.href)+'"]');if(a)return t.instance=a,We(a),a;var s=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return We(a=(e.ownerDocument||e).createElement("style")),eu(a,"style",s),Ru(a,n.precedence,e),t.instance=a;case"stylesheet":s=Au(n.href);var r=e.querySelector(Iu(s));if(r)return t.state.loading|=4,t.instance=r,We(r),r;a=Mu(n),(s=Su.get(s))&&zu(a,s),We(r=(e.ownerDocument||e).createElement("link"));var o=r;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),eu(r,"link",a),t.state.loading|=4,Ru(r,n.precedence,e),t.instance=r;case"script":return r=Du(n.src),(s=e.querySelector(Pu(r)))?(t.instance=s,We(s),s):(a=n,(s=Su.get(r))&&Fu(a=h({},n),s),We(s=(e=e.ownerDocument||e).createElement("script")),eu(s,"link",a),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Ru(a,n.precedence,e));return t.instance}function Ru(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=a.length?a[a.length-1]:null,r=s,i=0;i<a.length;i++){var o=a[i];if(o.dataset.precedence===t)r=o;else if(r!==s)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function zu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Fu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Lu=null;function Ou(e,t,n){if(null===Lu){var a=new Map,s=Lu=new Map;s.set(n,a)}else(a=(s=Lu).get(n))||(a=new Map,s.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),s=0;s<n.length;s++){var r=n[s];if(!(r[Oe]||r[De]||"link"===e&&"stylesheet"===r.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==r.namespaceURI){var i=r.getAttribute(t)||"";i=e+i;var o=a.get(i);o?o.push(r):a.set(i,[r])}}return a}function Uu(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Bu(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Hu=null;function qu(){}function Vu(){if(this.count--,0===this.count)if(this.stylesheets)Gu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Wu=null;function Gu(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Wu=new Map,t.forEach(Ku,e),Wu=null,Vu.call(e))}function Ku(e,t){if(!(4&t.state.loading)){var n=Wu.get(e);if(n)var a=n.get(null);else{n=new Map,Wu.set(e,n);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var i=s[r];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),a=i)}a&&n.set(null,a)}i=(s=t.instance).getAttribute("data-precedence"),(r=n.get(i)||a)===a&&n.set(null,s),n.set(i,s),this.count++,a=Vu.bind(this),s.addEventListener("load",a),s.addEventListener("error",a),r?r.parentNode.insertBefore(s,r.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(s,e.firstChild),t.state.loading|=4}}var Qu={$$typeof:w,Provider:null,Consumer:null,_currentValue:z,_currentValue2:z,_threadCount:0};function Yu(e,t,n,a,s,r,i,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=je(0),this.hiddenUpdates=je(null),this.identifierPrefix=a,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function $u(e,t,n,a,s,r,i,o,l,c,d,u){return e=new Yu(e,t,n,i,o,l,c,u),t=1,!0===r&&(t|=24),r=za(3,null,null,t),e.current=r,r.stateNode=e,(t=Ps()).refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:a,isDehydrated:n,cache:t},nr(r),e}function Ju(e){return e?e=_a:_a}function Xu(e,t,n,a,s,r){s=Ju(s),null===a.context?a.context=s:a.pendingContext=s,(a=sr(t)).payload={element:n},null!==(r=void 0===r?null:r)&&(a.callback=r),null!==(n=rr(e,a,t))&&(zc(n,0,t),ir(n,e,t))}function Zu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Zu(e,t),(e=e.alternate)&&Zu(e,t)}function th(e){if(13===e.tag){var t=Ma(e,67108864);null!==t&&zc(t,0,67108864),eh(e,67108864)}}var nh=!0;function ah(e,t,n,a){var s=_.T;_.T=null;var r=R.p;try{R.p=2,rh(e,t,n,a)}finally{R.p=r,_.T=s}}function sh(e,t,n,a){var s=_.T;_.T=null;var r=R.p;try{R.p=8,rh(e,t,n,a)}finally{R.p=r,_.T=s}}function rh(e,t,n,a){if(nh){var s=ih(a);if(null===s)Hd(e,t,a,oh,n),yh(e,a);else if(function(e,t,n,a,s){switch(t){case"focusin":return uh=bh(uh,e,t,n,a,s),!0;case"dragenter":return hh=bh(hh,e,t,n,a,s),!0;case"mouseover":return mh=bh(mh,e,t,n,a,s),!0;case"pointerover":var r=s.pointerId;return ph.set(r,bh(ph.get(r)||null,e,t,n,a,s)),!0;case"gotpointercapture":return r=s.pointerId,fh.set(r,bh(fh.get(r)||null,e,t,n,a,s)),!0}return!1}(s,e,t,n,a))a.stopPropagation();else if(yh(e,a),4&t&&-1<vh.indexOf(e)){for(;null!==s;){var r=He(s);if(null!==r)switch(r.tag){case 3:if((r=r.stateNode).current.memoizedState.isDehydrated){var i=ye(r.pendingLanes);if(0!==i){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-me(i);o.entanglements[1]|=l,i&=~l}Sd(r),0===(6&nc)&&(Sc=te()+500,kd(0,!1))}}break;case 13:null!==(o=Ma(r,2))&&zc(o,0,2),Bc(),eh(r,2)}if(null===(r=ih(a))&&Hd(e,t,a,oh,n),r===s)break;s=r}null!==s&&a.stopPropagation()}else Hd(e,t,a,null,n)}}function ih(e){return lh(e=Mt(e))}var oh=null;function lh(e){if(oh=null,null!==(e=Be(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return oh=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case ae:return 2;case se:return 8;case re:case ie:return 32;case oe:return 268435456;default:return 32}default:return 32}}var dh=!1,uh=null,hh=null,mh=null,ph=new Map,fh=new Map,gh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yh(e,t){switch(e){case"focusin":case"focusout":uh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":mh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fh.delete(t.pointerId)}}function bh(e,t,n,a,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=He(t))&&th(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function xh(e){var t=Be(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}(e.priority,function(){if(13===n.tag){var e=_c();e=Te(e);var t=Ma(n,e);null!==t&&zc(t,0,e),eh(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function wh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ih(e.nativeEvent);if(null!==n)return null!==(t=He(n))&&th(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);It=a,n.target.dispatchEvent(a),It=null,t.shift()}return!0}function Sh(e,t,n){wh(e)&&n.delete(t)}function kh(){dh=!1,null!==uh&&wh(uh)&&(uh=null),null!==hh&&wh(hh)&&(hh=null),null!==mh&&wh(mh)&&(mh=null),ph.forEach(Sh),fh.forEach(Sh)}function jh(e,t){e.blockedOn===t&&(e.blockedOn=null,dh||(dh=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,kh)))}var Nh=null;function Ch(e){Nh!==e&&(Nh=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Nh===e&&(Nh=null);for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1],s=e[t+2];if("function"!==typeof a){if(null===lh(a||n))continue;break}var r=He(n);null!==r&&(e.splice(t,3),t-=3,Ii(r,{pending:!0,data:s,method:n.method,action:a},a,s))}}))}function Eh(e){function t(t){return jh(t,e)}null!==uh&&jh(uh,e),null!==hh&&jh(hh,e),null!==mh&&jh(mh,e),ph.forEach(t),fh.forEach(t);for(var n=0;n<gh.length;n++){var a=gh[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<gh.length&&null===(n=gh[0]).blockedOn;)xh(n),null===n.blockedOn&&gh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<n.length;a+=3){var s=n[a],r=n[a+1],i=s[Pe]||null;if("function"===typeof r)i||Ch(n);else if(i){var o=null;if(r&&r.hasAttribute("formAction")){if(s=r,i=r[Pe]||null)o=i.formAction;else if(null!==lh(s))continue}else o=i.action;"function"===typeof o?n[a+1]=o:(n.splice(a,3),a-=3),Ch(n)}}}function Th(e){this._internalRoot=e}function Ah(e){this._internalRoot=e}Ah.prototype.render=Th.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Xu(t.current,_c(),e,t,null,null)},Ah.prototype.unmount=Th.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Xu(e.current,2,null,e,null,null),Bc(),t[_e]=null}},Ah.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gh.length&&0!==t&&t<gh[n].priority;n++);gh.splice(n,0,e),0===n&&xh(e)}};var Ih=s.version;if("19.1.1"!==Ih)throw Error(i(527,Ih,"19.1.1"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,a=t;;){var s=n.return;if(null===s)break;var r=s.alternate;if(null===r){if(null!==(a=s.return)){n=a;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===n)return d(s),e;if(r===a)return d(s),t;r=r.sibling}throw Error(i(188))}if(n.return!==a.return)n=s,a=r;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,a=r;break}if(c===a){o=!0,a=s,n=r;break}c=c.sibling}if(!o){for(c=r.child;c;){if(c===n){o=!0,n=r,a=s;break}if(c===a){o=!0,a=r,n=s;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==a)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?u(e):null)?null:e.stateNode};var Mh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{de=Dh.inject(Mh),ue=Dh}catch(_h){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var n=!1,a="",s=yo,r=bo,l=xo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onUncaughtError&&(s=t.onUncaughtError),void 0!==t.onCaughtError&&(r=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=$u(e,1,!1,null,0,n,a,s,r,l,0,null),e[_e]=t.current,Ud(e),new Th(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(i(299));var a=!1,s="",r=yo,l=bo,c=xo,d=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onUncaughtError&&(r=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(d=n.formState)),(t=$u(e,1,!0,t,0,a,s,r,l,c,0,d)).context=Ju(null),n=t.current,(s=sr(a=Te(a=_c()))).callback=null,rr(n,s,a),n=a,t.current.lanes=n,Ne(t,n),Sd(t),e[_e]=t.current,Ud(e),new Ah(t)},t.version="19.1.1"},115:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),function(){var e=t,n=e.lib.CipherParams,a=e.enc.Hex;e.format.Hex={stringify:function(e){return e.ciphertext.toString(a)},parse:function(e){var t=a.parse(e);return n.create({ciphertext:t})}}}(),t.format.Hex)}()},118:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.mode.CTRGladman=function(){var e=t.lib.BlockCipherMode.extend();function n(e){if(255===(e>>24&255)){var t=e>>16&255,n=e>>8&255,a=255&e;255===t?(t=0,255===n?(n=0,255===a?a=0:++a):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=a}else e+=1<<24;return e}function a(e){return 0===(e[0]=n(e[0]))&&(e[1]=n(e[1])),e}var s=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,s=n.blockSize,r=this._iv,i=this._counter;r&&(i=this._counter=r.slice(0),this._iv=void 0),a(i);var o=i.slice(0);n.encryptBlock(o,0);for(var l=0;l<s;l++)e[t+l]^=o[l]}});return e.Decryptor=s,e}(),t.mode.CTRGladman)}()},119:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(863)},137:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib.BlockCipher,a=e.algo,s=[],r=[],i=[],o=[],l=[],c=[],d=[],u=[],h=[],m=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,a=0;for(t=0;t<256;t++){var p=a^a<<1^a<<2^a<<3^a<<4;p=p>>>8^255&p^99,s[n]=p,r[p]=n;var f=e[n],g=e[f],v=e[g],y=257*e[p]^16843008*p;i[n]=y<<24|y>>>8,o[n]=y<<16|y>>>16,l[n]=y<<8|y>>>24,c[n]=y,y=16843009*v^65537*g^257*f^16843008*n,d[p]=y<<24|y>>>8,u[p]=y<<16|y>>>16,h[p]=y<<8|y>>>24,m[p]=y,n?(n=f^e[e[e[v^f]]],a^=e[e[a]]):n=a=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],f=a.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,a=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],i=0;i<a;i++)i<n?r[i]=t[i]:(c=r[i-1],i%n?n>6&&i%n==4&&(c=s[c>>>24]<<24|s[c>>>16&255]<<16|s[c>>>8&255]<<8|s[255&c]):(c=s[(c=c<<8|c>>>24)>>>24]<<24|s[c>>>16&255]<<16|s[c>>>8&255]<<8|s[255&c],c^=p[i/n|0]<<24),r[i]=r[i-n]^c);for(var o=this._invKeySchedule=[],l=0;l<a;l++){if(i=a-l,l%4)var c=r[i];else c=r[i-4];o[l]=l<4||i<=4?c:d[s[c>>>24]]^u[s[c>>>16&255]]^h[s[c>>>8&255]]^m[s[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,o,l,c,s)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,d,u,h,m,r),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,a,s,r,i,o){for(var l=this._nRounds,c=e[t]^n[0],d=e[t+1]^n[1],u=e[t+2]^n[2],h=e[t+3]^n[3],m=4,p=1;p<l;p++){var f=a[c>>>24]^s[d>>>16&255]^r[u>>>8&255]^i[255&h]^n[m++],g=a[d>>>24]^s[u>>>16&255]^r[h>>>8&255]^i[255&c]^n[m++],v=a[u>>>24]^s[h>>>16&255]^r[c>>>8&255]^i[255&d]^n[m++],y=a[h>>>24]^s[c>>>16&255]^r[d>>>8&255]^i[255&u]^n[m++];c=f,d=g,u=v,h=y}f=(o[c>>>24]<<24|o[d>>>16&255]<<16|o[u>>>8&255]<<8|o[255&h])^n[m++],g=(o[d>>>24]<<24|o[u>>>16&255]<<16|o[h>>>8&255]<<8|o[255&c])^n[m++],v=(o[u>>>24]<<24|o[h>>>16&255]<<16|o[c>>>8&255]<<8|o[255&d])^n[m++],y=(o[h>>>24]<<24|o[c>>>16&255]<<16|o[d>>>8&255]<<8|o[255&u])^n[m++],e[t]=f,e[t+1]=g,e[t+2]=v,e[t+3]=y},keySize:8});e.AES=n._createHelper(f)}(),t.AES)}()},167:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.mode.CFB=function(){var e=t.lib.BlockCipherMode.extend();function n(e,t,n,a){var s,r=this._iv;r?(s=r.slice(0),this._iv=void 0):s=this._prevBlock,a.encryptBlock(s,0);for(var i=0;i<n;i++)e[t+i]^=s[i]}return e.Encryptor=e.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize;n.call(this,e,t,s,a),this._prevBlock=e.slice(t,t+s)}}),e.Decryptor=e.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize,r=e.slice(t,t+s);n.call(this,e,t,s,a),this._prevBlock=r}}),e}(),t.mode.CFB)}()},210:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(654),n(810),n(353),n(988),n(367),n(766),n(689),n(427),n(798),n(290),n(883),n(55),n(909),n(787),n(425),n(20),n(755),n(167),n(45),n(118),n(907),n(768),n(279),n(239),n(8),n(321),n(406),n(115),n(137),n(774),n(3),n(676),n(278),n(722),t)}()},239:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.pad.Iso10126={pad:function(e,n){var a=4*n,s=a-e.sigBytes%a;e.concat(t.lib.WordArray.random(s-1)).concat(t.lib.WordArray.create([s<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},t.pad.Iso10126)}()},278:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib.StreamCipher,a=e.algo,s=[],r=[],i=[],o=a.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var s=0;s<4;s++)l.call(this);for(s=0;s<8;s++)a[s]^=n[s+4&7];if(t){var r=t.words,i=r[0],o=r[1],c=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=c>>>16|4294901760&d,h=d<<16|65535&c;for(a[0]^=c,a[1]^=u,a[2]^=d,a[3]^=h,a[4]^=c,a[5]^=u,a[6]^=d,a[7]^=h,s=0;s<4;s++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),s[0]=n[0]^n[5]>>>16^n[3]<<16,s[1]=n[2]^n[7]>>>16^n[5]<<16,s[2]=n[4]^n[1]>>>16^n[7]<<16,s[3]=n[6]^n[3]>>>16^n[1]<<16;for(var a=0;a<4;a++)s[a]=16711935&(s[a]<<8|s[a]>>>24)|4278255360&(s[a]<<24|s[a]>>>8),e[t+a]^=s[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)r[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,n=0;n<8;n++){var a=e[n]+t[n],s=65535&a,o=a>>>16,l=((s*s>>>17)+s*o>>>15)+o*o,c=((4294901760&a)*a|0)+((65535&a)*a|0);i[n]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.RabbitLegacy=n._createHelper(o)}(),t.RabbitLegacy)}()},279:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,a=4*t,s=a-n%a,r=n+s-1;e.clamp(),e.words[r>>>2]|=s<<24-r%4*8,e.sigBytes+=s},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},t.pad.Ansix923)}()},290:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(654),function(){var e=t,n=e.lib.Hasher,a=e.x64,s=a.Word,r=a.WordArray,i=e.algo;function o(){return s.create.apply(s,arguments)}var l=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=o()}();var d=i.SHA512=n.extend({_doReset:function(){this._hash=new r.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,a=n[0],s=n[1],r=n[2],i=n[3],o=n[4],d=n[5],u=n[6],h=n[7],m=a.high,p=a.low,f=s.high,g=s.low,v=r.high,y=r.low,b=i.high,x=i.low,w=o.high,S=o.low,k=d.high,j=d.low,N=u.high,C=u.low,E=h.high,T=h.low,A=m,I=p,M=f,D=g,P=v,_=y,R=b,z=x,F=w,L=S,O=k,U=j,B=N,H=C,q=E,V=T,W=0;W<80;W++){var G,K,Q=c[W];if(W<16)K=Q.high=0|e[t+2*W],G=Q.low=0|e[t+2*W+1];else{var Y=c[W-15],$=Y.high,J=Y.low,X=($>>>1|J<<31)^($>>>8|J<<24)^$>>>7,Z=(J>>>1|$<<31)^(J>>>8|$<<24)^(J>>>7|$<<25),ee=c[W-2],te=ee.high,ne=ee.low,ae=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,se=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),re=c[W-7],ie=re.high,oe=re.low,le=c[W-16],ce=le.high,de=le.low;K=(K=(K=X+ie+((G=Z+oe)>>>0<Z>>>0?1:0))+ae+((G+=se)>>>0<se>>>0?1:0))+ce+((G+=de)>>>0<de>>>0?1:0),Q.high=K,Q.low=G}var ue,he=F&O^~F&B,me=L&U^~L&H,pe=A&M^A&P^M&P,fe=I&D^I&_^D&_,ge=(A>>>28|I<<4)^(A<<30|I>>>2)^(A<<25|I>>>7),ve=(I>>>28|A<<4)^(I<<30|A>>>2)^(I<<25|A>>>7),ye=(F>>>14|L<<18)^(F>>>18|L<<14)^(F<<23|L>>>9),be=(L>>>14|F<<18)^(L>>>18|F<<14)^(L<<23|F>>>9),xe=l[W],we=xe.high,Se=xe.low,ke=q+ye+((ue=V+be)>>>0<V>>>0?1:0),je=ve+fe;q=B,V=H,B=O,H=U,O=F,U=L,F=R+(ke=(ke=(ke=ke+he+((ue+=me)>>>0<me>>>0?1:0))+we+((ue+=Se)>>>0<Se>>>0?1:0))+K+((ue+=G)>>>0<G>>>0?1:0))+((L=z+ue|0)>>>0<z>>>0?1:0)|0,R=P,z=_,P=M,_=D,M=A,D=I,A=ke+(ge+pe+(je>>>0<ve>>>0?1:0))+((I=ue+je|0)>>>0<ue>>>0?1:0)|0}p=a.low=p+I,a.high=m+A+(p>>>0<I>>>0?1:0),g=s.low=g+D,s.high=f+M+(g>>>0<D>>>0?1:0),y=r.low=y+_,r.high=v+P+(y>>>0<_>>>0?1:0),x=i.low=x+z,i.high=b+R+(x>>>0<z>>>0?1:0),S=o.low=S+L,o.high=w+F+(S>>>0<L>>>0?1:0),j=d.low=j+U,d.high=k+O+(j>>>0<U>>>0?1:0),C=u.low=C+H,u.high=N+B+(C>>>0<H>>>0?1:0),T=h.low=T+V,h.high=E+q+(T>>>0<V>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[30+(a+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(a+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=n._createHelper(d),e.HmacSHA512=n._createHmacHelper(d)}(),t.SHA512)}()},321:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},t.pad.ZeroPadding)}()},340:(e,t,n)=>{"use strict";e.exports=n(487)},352:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(85)},353:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){var e=t,n=e.lib.WordArray,a=e.enc;function s(e){return e<<8&4278255360|e>>>8&16711935}a.Utf16=a.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],s=0;s<n;s+=2){var r=t[s>>>2]>>>16-s%4*8&65535;a.push(String.fromCharCode(r))}return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s++)a[s>>>1]|=e.charCodeAt(s)<<16-s%2*16;return n.create(a,2*t)}},a.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],r=0;r<n;r+=2){var i=s(t[r>>>2]>>>16-r%4*8&65535);a.push(String.fromCharCode(i))}return a.join("")},parse:function(e){for(var t=e.length,a=[],r=0;r<t;r++)a[r>>>1]|=s(e.charCodeAt(r)<<16-r%2*16);return n.create(a,2*t)}}}(),t.enc.Utf16)}()},367:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){var e=t,n=e.lib.WordArray;function a(e,t,a){for(var s=[],r=0,i=0;i<t;i++)if(i%4){var o=a[e.charCodeAt(i-1)]<<i%4*2|a[e.charCodeAt(i)]>>>6-i%4*2;s[r>>>2]|=o<<24-r%4*8,r++}return n.create(s,r)}e.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var n=e.words,a=e.sigBytes,s=t?this._safe_map:this._map;e.clamp();for(var r=[],i=0;i<a;i+=3)for(var o=(n[i>>>2]>>>24-i%4*8&255)<<16|(n[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|n[i+2>>>2]>>>24-(i+2)%4*8&255,l=0;l<4&&i+.75*l<a;l++)r.push(s.charAt(o>>>6*(3-l)&63));var c=s.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e,t){void 0===t&&(t=!0);var n=e.length,s=t?this._safe_map:this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<s.length;i++)r[s.charCodeAt(i)]=i}var o=s.charAt(64);if(o){var l=e.indexOf(o);-1!==l&&(n=l)}return a(e,n,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),t.enc.Base64url)}()},406:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding)}()},414:(e,t,n)=>{"use strict";e.exports=n(916)},425:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(427),n(787),function(){var e=t,n=e.lib,a=n.Base,s=n.WordArray,r=e.algo,i=r.SHA256,o=r.HMAC,l=r.PBKDF2=a.extend({cfg:a.extend({keySize:4,hasher:i,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,a=o.create(n.hasher,e),r=s.create(),i=s.create([1]),l=r.words,c=i.words,d=n.keySize,u=n.iterations;l.length<d;){var h=a.update(t).finalize(i);a.reset();for(var m=h.words,p=m.length,f=h,g=1;g<u;g++){f=a.finalize(f),a.reset();for(var v=f.words,y=0;y<p;y++)m[y]^=v[y]}r.concat(h),c[0]++}return r.sigBytes=4*d,r}});e.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)}}(),t.PBKDF2)}()},427:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(e){var n=t,a=n.lib,s=a.WordArray,r=a.Hasher,i=n.algo,o=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),a=2;a<=n;a++)if(!(t%a))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var a=2,s=0;s<64;)t(a)&&(s<8&&(o[s]=n(e.pow(a,.5))),l[s]=n(e.pow(a,1/3)),s++),a++}();var c=[],d=i.SHA256=r.extend({_doReset:function(){this._hash=new s.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,a=n[0],s=n[1],r=n[2],i=n[3],o=n[4],d=n[5],u=n[6],h=n[7],m=0;m<64;m++){if(m<16)c[m]=0|e[t+m];else{var p=c[m-15],f=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,g=c[m-2],v=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;c[m]=f+c[m-7]+v+c[m-16]}var y=a&s^a&r^s&r,b=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),x=h+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&d^~o&u)+l[m]+c[m];h=u,u=d,d=o,o=i+x|0,i=r,r=s,s=a,a=x+(b+y)|0}n[0]=n[0]+a|0,n[1]=n[1]+s|0,n[2]=n[2]+r|0,n[3]=n[3]+i|0,n[4]=n[4]+o|0,n[5]=n[5]+d|0,n[6]=n[6]+u|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,a=8*this._nDataBytes,s=8*t.sigBytes;return n[s>>>5]|=128<<24-s%32,n[14+(s+64>>>9<<4)]=e.floor(a/4294967296),n[15+(s+64>>>9<<4)]=a,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=r._createHelper(d),n.HmacSHA256=r._createHmacHelper(d)}(Math),t.SHA256)}()},477:()=>{},487:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,s=e[a];if(!(0<r(s,t)))break e;e[a]=t,e[n]=s,n=a}}function a(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,s=e.length,i=s>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>r(l,n))c<s&&0>r(d,l)?(e[a]=d,e[c]=n,a=c):(e[a]=l,e[o]=n,a=o);else{if(!(c<s&&0>r(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,f=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=a(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,n(c,t)}t=a(d)}}function S(e){if(g=!1,w(e),!f)if(null!==a(c))f=!0,j||(j=!0,k());else{var t=a(d);null!==t&&D(S,t.startTime-e)}}var k,j=!1,N=-1,C=5,E=-1;function T(){return!!v||!(t.unstable_now()-E<C)}function A(){if(v=!1,j){var e=t.unstable_now();E=e;var n=!0;try{e:{f=!1,g&&(g=!1,b(N),N=-1),p=!0;var r=m;try{t:{for(w(e),h=a(c);null!==h&&!(h.expirationTime>e&&T());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),n=!0;break t}h===a(c)&&s(c),w(e)}else s(c);h=a(c)}if(null!==h)n=!0;else{var l=a(d);null!==l&&D(S,l.startTime-e),n=!1}}break e}finally{h=null,m=r,p=!1}n=void 0}}finally{n?k():j=!1}}}if("function"===typeof x)k=function(){x(A)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,M=I.port2;I.port1.onmessage=A,k=function(){M.postMessage(null)}}else k=function(){y(A,0)};function D(e,n){N=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,s,r){var i=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?i+r:i:r=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:r,expirationTime:o=r+o,sortIndex:-1},r>i?(e.sortIndex=r,n(d,e),null===a(c)&&e===a(d)&&(g?(b(N),N=-1):g=!0,D(S,r-i))):(e.sortIndex=o,n(c,e),f||p||(f=!0,j||(j=!0,k()))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},654:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(e){var n=t,a=n.lib,s=a.Base,r=a.WordArray,i=n.x64={};i.Word=s.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=s.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:8*t.length},toX32:function(){for(var e=this.words,t=e.length,n=[],a=0;a<t;a++){var s=e[a];n.push(s.high),n.push(s.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=s.clone.call(this),t=e.words=this.words.slice(0),n=t.length,a=0;a<n;a++)t[a]=t[a].clone();return e}})}(),t)}()},676:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib.StreamCipher,a=e.algo,s=[],r=[],i=[],o=a.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var a=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],s=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)s[n]^=a[n+4&7];if(t){var r=t.words,i=r[0],o=r[1],c=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=c>>>16|4294901760&d,h=d<<16|65535&c;for(s[0]^=c,s[1]^=u,s[2]^=d,s[3]^=h,s[4]^=c,s[5]^=u,s[6]^=d,s[7]^=h,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),s[0]=n[0]^n[5]>>>16^n[3]<<16,s[1]=n[2]^n[7]>>>16^n[5]<<16,s[2]=n[4]^n[1]>>>16^n[7]<<16,s[3]=n[6]^n[3]>>>16^n[1]<<16;for(var a=0;a<4;a++)s[a]=16711935&(s[a]<<8|s[a]>>>24)|4278255360&(s[a]<<24|s[a]>>>8),e[t+a]^=s[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)r[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,n=0;n<8;n++){var a=e[n]+t[n],s=65535&a,o=a>>>16,l=((s*s>>>17)+s*o>>>15)+o*o,c=((4294901760&a)*a|0)+((65535&a)*a|0);i[n]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.Rabbit=n._createHelper(o)}(),t.Rabbit)}()},689:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){var e=t,n=e.lib,a=n.WordArray,s=n.Hasher,r=e.algo,i=[],o=r.SHA1=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,a=n[0],s=n[1],r=n[2],o=n[3],l=n[4],c=0;c<80;c++){if(c<16)i[c]=0|e[t+c];else{var d=i[c-3]^i[c-8]^i[c-14]^i[c-16];i[c]=d<<1|d>>>31}var u=(a<<5|a>>>27)+l+i[c];u+=c<20?1518500249+(s&r|~s&o):c<40?1859775393+(s^r^o):c<60?(s&r|s&o|r&o)-1894007588:(s^r^o)-899497514,l=o,o=r,r=s<<30|s>>>2,s=a,a=u}n[0]=n[0]+a|0,n[1]=n[1]+s|0,n[2]=n[2]+r|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[14+(a+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(a+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=s._createHelper(o),e.HmacSHA1=s._createHmacHelper(o)}(),t.SHA1)}()},703:function(e,t,n){e.exports=function(){var e=e||function(e,t){var a;if("undefined"!==typeof window&&window.crypto&&(a=window.crypto),"undefined"!==typeof self&&self.crypto&&(a=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(a=globalThis.crypto),!a&&"undefined"!==typeof window&&window.msCrypto&&(a=window.msCrypto),!a&&"undefined"!==typeof n.g&&n.g.crypto&&(a=n.g.crypto),!a)try{a=n(477)}catch(g){}var s=function(){if(a){if("function"===typeof a.getRandomValues)try{return a.getRandomValues(new Uint32Array(1))[0]}catch(g){}if("function"===typeof a.randomBytes)try{return a.randomBytes(4).readInt32LE()}catch(g){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},l=o.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=o.WordArray=l.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,a=this.sigBytes,s=e.sigBytes;if(this.clamp(),a%4)for(var r=0;r<s;r++){var i=n[r>>>2]>>>24-r%4*8&255;t[a+r>>>2]|=i<<24-(a+r)%4*8}else for(var o=0;o<s;o+=4)t[a+o>>>2]=n[o>>>2];return this.sigBytes+=s,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(s());return new c.init(t,e)}}),d=i.enc={},u=d.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],s=0;s<n;s++){var r=t[s>>>2]>>>24-s%4*8&255;a.push((r>>>4).toString(16)),a.push((15&r).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a+=2)n[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new c.init(n,t/2)}},h=d.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],s=0;s<n;s++){var r=t[s>>>2]>>>24-s%4*8&255;a.push(String.fromCharCode(r))}return a.join("")},parse:function(e){for(var t=e.length,n=[],a=0;a<t;a++)n[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new c.init(n,t)}},m=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},p=o.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=m.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,a=this._data,s=a.words,r=a.sigBytes,i=this.blockSize,o=r/(4*i),l=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*i,d=e.min(4*l,r);if(l){for(var u=0;u<l;u+=i)this._doProcessBlock(s,u);n=s.splice(0,l),a.sigBytes-=d}return new c.init(n,d)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(o.Hasher=p.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math);return e}()},722:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib.BlockCipher,a=e.algo;const s=16,r=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],i=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var o={pbox:[],sbox:[]};function l(e,t){let n=t>>24&255,a=t>>16&255,s=t>>8&255,r=255&t,i=e.sbox[0][n]+e.sbox[1][a];return i^=e.sbox[2][s],i+=e.sbox[3][r],i}function c(e,t,n){let a,r=t,i=n;for(let o=0;o<s;++o)r^=e.pbox[o],i=l(e,r)^i,a=r,r=i,i=a;return a=r,r=i,i=a,i^=e.pbox[s],r^=e.pbox[s+1],{left:r,right:i}}function d(e,t,n){let a,r=t,i=n;for(let o=s+1;o>1;--o)r^=e.pbox[o],i=l(e,r)^i,a=r,r=i,i=a;return a=r,r=i,i=a,i^=e.pbox[1],r^=e.pbox[0],{left:r,right:i}}function u(e,t,n){for(let s=0;s<4;s++){e.sbox[s]=[];for(let t=0;t<256;t++)e.sbox[s][t]=i[s][t]}let a=0;for(let i=0;i<s+2;i++)e.pbox[i]=r[i]^t[a],a++,a>=n&&(a=0);let o=0,l=0,d=0;for(let r=0;r<s+2;r+=2)d=c(e,o,l),o=d.left,l=d.right,e.pbox[r]=o,e.pbox[r+1]=l;for(let s=0;s<4;s++)for(let t=0;t<256;t+=2)d=c(e,o,l),o=d.left,l=d.right,e.sbox[s][t]=o,e.sbox[s][t+1]=l;return!0}var h=a.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4;u(o,t,n)}},encryptBlock:function(e,t){var n=c(o,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},decryptBlock:function(e,t){var n=d(o,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},blockSize:2,keySize:4,ivSize:2});e.Blowfish=n._createHelper(h)}(),t.Blowfish)}()},755:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(20),void(t.lib.Cipher||function(e){var n=t,a=n.lib,s=a.Base,r=a.WordArray,i=a.BufferedBlockAlgorithm,o=n.enc,l=(o.Utf8,o.Base64),c=n.algo.EvpKDF,d=a.Cipher=i.extend({cfg:s.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?b:v}return function(t){return{encrypt:function(n,a,s){return e(a).encrypt(t,n,a,s)},decrypt:function(n,a,s){return e(a).decrypt(t,n,a,s)}}}}()}),u=(a.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),n.mode={}),h=a.BlockCipherMode=s.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=u.CBC=function(){var t=h.extend();function n(t,n,a){var s,r=this._iv;r?(s=r,this._iv=e):s=this._prevBlock;for(var i=0;i<a;i++)t[n+i]^=s[i]}return t.Encryptor=t.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize;n.call(this,e,t,s),a.encryptBlock(e,t),this._prevBlock=e.slice(t,t+s)}}),t.Decryptor=t.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize,r=e.slice(t,t+s);a.decryptBlock(e,t),n.call(this,e,t,s),this._prevBlock=r}}),t}(),p=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,a=n-e.sigBytes%n,s=a<<24|a<<16|a<<8|a,i=[],o=0;o<a;o+=4)i.push(s);var l=r.create(i,a);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},f=(a.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:p}),reset:function(){var e;d.reset.call(this);var t=this.cfg,n=t.iv,a=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=a.createEncryptor:(e=a.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(a,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),a.CipherParams=s.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),g=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?r.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(e){var t,n=l.parse(e),a=n.words;return 1398893684==a[0]&&1701076831==a[1]&&(t=r.create(a.slice(2,4)),a.splice(0,4),n.sigBytes-=16),f.create({ciphertext:n,salt:t})}},v=a.SerializableCipher=s.extend({cfg:s.extend({format:g}),encrypt:function(e,t,n,a){a=this.cfg.extend(a);var s=e.createEncryptor(n,a),r=s.finalize(t),i=s.cfg;return f.create({ciphertext:r,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:a.format})},decrypt:function(e,t,n,a){return a=this.cfg.extend(a),t=this._parse(t,a.format),e.createDecryptor(n,a).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(n.kdf={}).OpenSSL={execute:function(e,t,n,a,s){if(a||(a=r.random(8)),s)i=c.create({keySize:t+n,hasher:s}).compute(e,a);else var i=c.create({keySize:t+n}).compute(e,a);var o=r.create(i.words.slice(t),4*n);return i.sigBytes=4*t,f.create({key:i,iv:o,salt:a})}},b=a.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:y}),encrypt:function(e,t,n,a){var s=(a=this.cfg.extend(a)).kdf.execute(n,e.keySize,e.ivSize,a.salt,a.hasher);a.iv=s.iv;var r=v.encrypt.call(this,e,t,s.key,a);return r.mixIn(s),r},decrypt:function(e,t,n,a){a=this.cfg.extend(a),t=this._parse(t,a.format);var s=a.kdf.execute(n,e.keySize,e.ivSize,t.salt,a.hasher);return a.iv=s.iv,v.decrypt.call(this,e,t,s.key,a)}})}()))}()},766:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(e){var n=t,a=n.lib,s=a.WordArray,r=a.Hasher,i=n.algo,o=[];!function(){for(var t=0;t<64;t++)o[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=i.MD5=r.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var a=t+n,s=e[a];e[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}var r=this._hash.words,i=e[t+0],l=e[t+1],m=e[t+2],p=e[t+3],f=e[t+4],g=e[t+5],v=e[t+6],y=e[t+7],b=e[t+8],x=e[t+9],w=e[t+10],S=e[t+11],k=e[t+12],j=e[t+13],N=e[t+14],C=e[t+15],E=r[0],T=r[1],A=r[2],I=r[3];E=c(E,T,A,I,i,7,o[0]),I=c(I,E,T,A,l,12,o[1]),A=c(A,I,E,T,m,17,o[2]),T=c(T,A,I,E,p,22,o[3]),E=c(E,T,A,I,f,7,o[4]),I=c(I,E,T,A,g,12,o[5]),A=c(A,I,E,T,v,17,o[6]),T=c(T,A,I,E,y,22,o[7]),E=c(E,T,A,I,b,7,o[8]),I=c(I,E,T,A,x,12,o[9]),A=c(A,I,E,T,w,17,o[10]),T=c(T,A,I,E,S,22,o[11]),E=c(E,T,A,I,k,7,o[12]),I=c(I,E,T,A,j,12,o[13]),A=c(A,I,E,T,N,17,o[14]),E=d(E,T=c(T,A,I,E,C,22,o[15]),A,I,l,5,o[16]),I=d(I,E,T,A,v,9,o[17]),A=d(A,I,E,T,S,14,o[18]),T=d(T,A,I,E,i,20,o[19]),E=d(E,T,A,I,g,5,o[20]),I=d(I,E,T,A,w,9,o[21]),A=d(A,I,E,T,C,14,o[22]),T=d(T,A,I,E,f,20,o[23]),E=d(E,T,A,I,x,5,o[24]),I=d(I,E,T,A,N,9,o[25]),A=d(A,I,E,T,p,14,o[26]),T=d(T,A,I,E,b,20,o[27]),E=d(E,T,A,I,j,5,o[28]),I=d(I,E,T,A,m,9,o[29]),A=d(A,I,E,T,y,14,o[30]),E=u(E,T=d(T,A,I,E,k,20,o[31]),A,I,g,4,o[32]),I=u(I,E,T,A,b,11,o[33]),A=u(A,I,E,T,S,16,o[34]),T=u(T,A,I,E,N,23,o[35]),E=u(E,T,A,I,l,4,o[36]),I=u(I,E,T,A,f,11,o[37]),A=u(A,I,E,T,y,16,o[38]),T=u(T,A,I,E,w,23,o[39]),E=u(E,T,A,I,j,4,o[40]),I=u(I,E,T,A,i,11,o[41]),A=u(A,I,E,T,p,16,o[42]),T=u(T,A,I,E,v,23,o[43]),E=u(E,T,A,I,x,4,o[44]),I=u(I,E,T,A,k,11,o[45]),A=u(A,I,E,T,C,16,o[46]),E=h(E,T=u(T,A,I,E,m,23,o[47]),A,I,i,6,o[48]),I=h(I,E,T,A,y,10,o[49]),A=h(A,I,E,T,N,15,o[50]),T=h(T,A,I,E,g,21,o[51]),E=h(E,T,A,I,k,6,o[52]),I=h(I,E,T,A,p,10,o[53]),A=h(A,I,E,T,w,15,o[54]),T=h(T,A,I,E,l,21,o[55]),E=h(E,T,A,I,b,6,o[56]),I=h(I,E,T,A,C,10,o[57]),A=h(A,I,E,T,v,15,o[58]),T=h(T,A,I,E,j,21,o[59]),E=h(E,T,A,I,f,6,o[60]),I=h(I,E,T,A,S,10,o[61]),A=h(A,I,E,T,m,15,o[62]),T=h(T,A,I,E,x,21,o[63]),r[0]=r[0]+E|0,r[1]=r[1]+T|0,r[2]=r[2]+A|0,r[3]=r[3]+I|0},_doFinalize:function(){var t=this._data,n=t.words,a=8*this._nDataBytes,s=8*t.sigBytes;n[s>>>5]|=128<<24-s%32;var r=e.floor(a/4294967296),i=a;n[15+(s+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n[14+(s+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(n.length+1),this._process();for(var o=this._hash,l=o.words,c=0;c<4;c++){var d=l[c];l[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return o},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,a,s,r,i){var o=e+(t&n|~t&a)+s+i;return(o<<r|o>>>32-r)+t}function d(e,t,n,a,s,r,i){var o=e+(t&a|n&~a)+s+i;return(o<<r|o>>>32-r)+t}function u(e,t,n,a,s,r,i){var o=e+(t^n^a)+s+i;return(o<<r|o>>>32-r)+t}function h(e,t,n,a,s,r,i){var o=e+(n^(t|~a))+s+i;return(o<<r|o>>>32-r)+t}n.MD5=r._createHelper(l),n.HmacMD5=r._createHmacHelper(l)}(Math),t.MD5)}()},768:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),t.mode.ECB)}()},774:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(988),n(766),n(20),n(755),function(){var e=t,n=e.lib,a=n.WordArray,s=n.BlockCipher,r=e.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=r.DES=s.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var a=i[n]-1;t[n]=e[a>>>5]>>>31-a%32&1}for(var s=this._subKeys=[],r=0;r<16;r++){var c=s[r]=[],d=l[r];for(n=0;n<24;n++)c[n/6|0]|=t[(o[n]-1+d)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(o[n+24]-1+d)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var u=this._invSubKeys=[];for(n=0;n<16;n++)u[n]=s[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),h.call(this,1,1431655765);for(var a=0;a<16;a++){for(var s=n[a],r=this._lBlock,i=this._rBlock,o=0,l=0;l<8;l++)o|=c[l][((i^s[l])&d[l])>>>0];this._lBlock=i,this._rBlock=r^o}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,h.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function m(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=s._createHelper(u);var p=r.TripleDES=s.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),s=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=u.createEncryptor(a.create(t)),this._des2=u.createEncryptor(a.create(n)),this._des3=u.createEncryptor(a.create(s))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=s._createHelper(p)}(),t.TripleDES)}()},787:function(e,t,n){!function(){var t;e.exports=(t=n(703),void function(){var e=t,n=e.lib.Base,a=e.enc.Utf8;e.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,s=4*n;t.sigBytes>s&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),i=this._iKey=t.clone(),o=r.words,l=i.words,c=0;c<n;c++)o[c]^=1549556828,l[c]^=909522486;r.sigBytes=i.sigBytes=s,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}())}()},798:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(427),function(){var e=t,n=e.lib.WordArray,a=e.algo,s=a.SHA256,r=a.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=s._createHelper(r),e.HmacSHA224=s._createHmacHelper(r)}(),t.SHA224)}()},810:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){if("function"==typeof ArrayBuffer){var e=t.lib.WordArray,n=e.init,a=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!==typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,a=[],s=0;s<t;s++)a[s>>>2]|=e[s]<<24-s%4*8;n.call(this,a,t)}else n.apply(this,arguments)};a.prototype=e}}(),t.lib.WordArray)}()},863:(e,t,n)=>{"use strict";var a=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(s(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(s(299));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=n,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,a=c(n,t.crossOrigin),s="string"===typeof t.integrity?t.integrity:void 0,r="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:a,integrity:s,fetchPriority:r}):"script"===n&&i.d.X(e,{crossOrigin:a,integrity:s,fetchPriority:r,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,a=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},883:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(654),n(290),function(){var e=t,n=e.x64,a=n.Word,s=n.WordArray,r=e.algo,i=r.SHA512,o=r.SHA384=i.extend({_doReset:function(){this._hash=new s.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(o),e.HmacSHA384=i._createHmacHelper(o)}(),t.SHA384)}()},907:function(e,t,n){!function(){var t;e.exports=(t=n(703),n(755),t.mode.OFB=function(){var e=t.lib.BlockCipherMode.extend(),n=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize,s=this._iv,r=this._keystream;s&&(r=this._keystream=s.slice(0),this._iv=void 0),n.encryptBlock(r,0);for(var i=0;i<a;i++)e[t+i]^=r[i]}});return e.Decryptor=n,e}(),t.mode.OFB)}()},909:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){var e=t,n=e.lib,a=n.WordArray,s=n.Hasher,r=e.algo,i=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=a.create([0,1518500249,1859775393,2400959708,2840853838]),u=a.create([1352829926,1548603684,1836072691,2053994217,0]),h=r.RIPEMD160=s.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var a=t+n,s=e[a];e[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}var r,h,b,x,w,S,k,j,N,C,E,T=this._hash.words,A=d.words,I=u.words,M=i.words,D=o.words,P=l.words,_=c.words;for(S=r=T[0],k=h=T[1],j=b=T[2],N=x=T[3],C=w=T[4],n=0;n<80;n+=1)E=r+e[t+M[n]]|0,E+=n<16?m(h,b,x)+A[0]:n<32?p(h,b,x)+A[1]:n<48?f(h,b,x)+A[2]:n<64?g(h,b,x)+A[3]:v(h,b,x)+A[4],E=(E=y(E|=0,P[n]))+w|0,r=w,w=x,x=y(b,10),b=h,h=E,E=S+e[t+D[n]]|0,E+=n<16?v(k,j,N)+I[0]:n<32?g(k,j,N)+I[1]:n<48?f(k,j,N)+I[2]:n<64?p(k,j,N)+I[3]:m(k,j,N)+I[4],E=(E=y(E|=0,_[n]))+C|0,S=C,C=N,N=y(j,10),j=k,k=E;E=T[1]+b+N|0,T[1]=T[2]+x+C|0,T[2]=T[3]+w+S|0,T[3]=T[4]+r+k|0,T[4]=T[0]+h+j|0,T[0]=E},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;t[a>>>5]|=128<<24-a%32,t[14+(a+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var s=this._hash,r=s.words,i=0;i<5;i++){var o=r[i];r[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return s},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});function m(e,t,n){return e^t^n}function p(e,t,n){return e&t|~e&n}function f(e,t,n){return(e|~t)^n}function g(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}e.RIPEMD160=s._createHelper(h),e.HmacRIPEMD160=s._createHmacHelper(h)}(Math),t.RIPEMD160)}()},916:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(e,t,a){var s=null;if(void 0!==a&&(s=""+a),void 0!==t.key&&(s=""+t.key),"key"in t)for(var r in a={},t)"key"!==r&&(a[r]=t[r]);else a=t;return t=a.ref,{$$typeof:n,type:e,key:s,ref:void 0!==t?t:null,props:a}}t.Fragment=a,t.jsx=s,t.jsxs=s},950:(e,t,n)=>{"use strict";e.exports=n(983)},983:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,f(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},k=Object.prototype.hasOwnProperty;function j(e,t,a,s,r,i){return a=i.ref,{$$typeof:n,type:e,key:t,ref:void 0!==a?a:null,props:i}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(){}function A(e,t,s,r,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(o){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case n:case a:d=!0;break;case h:return A((d=e._init)(e._payload),t,s,r,i)}}if(d)return i=i(e),d=""===r?"."+E(e,0):r,w(i)?(s="",null!=d&&(s=d.replace(C,"$&/")+"/"),A(i,t,s,"",function(e){return e})):null!=i&&(N(i)&&(l=i,c=s+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+d,i=j(l.type,c,void 0,0,0,l.props)),t.push(i)),1;d=0;var u,p=""===r?".":r+":";if(w(e))for(var f=0;f<e.length;f++)d+=A(r=e[f],t,s,o=p+E(r,f),i);else if("function"===typeof(f=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=m&&u[m]||u["@@iterator"])?u:null))for(e=f.call(e),f=0;!(r=e.next()).done;)d+=A(r=r.value,t,s,o=p+E(r,f++),i);else if("object"===o){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,s,r,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function I(e,t,n){if(null==e)return e;var a=[],s=0;return A(e,a,"","",function(e){return t.call(n,e,s++)}),a}function M(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function P(){}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=i,t.PureComponent=b,t.StrictMode=r,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var a=f({},e.props),s=e.key;if(null!=t)for(r in void 0!==t.ref&&void 0,void 0!==t.key&&(s=""+t.key),t)!k.call(t,r)||"key"===r||"__self"===r||"__source"===r||"ref"===r&&void 0===t.ref||(a[r]=t[r]);var r=arguments.length-2;if(1===r)a.children=n;else if(1<r){for(var i=Array(r),o=0;o<r;o++)i[o]=arguments[o+2];a.children=i}return j(e.type,s,void 0,0,0,a)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var a,s={},r=null;if(null!=t)for(a in void 0!==t.key&&(r=""+t.key),t)k.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(s[a]=t[a]);var i=arguments.length-2;if(1===i)s.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];s.children=o}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===s[a]&&(s[a]=i[a]);return j(e,r,void 0,0,0,s)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var a=e(),s=S.S;null!==s&&s(n,a),"object"===typeof a&&null!==a&&"function"===typeof a.then&&a.then(P,D)}catch(r){D(r)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var a=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return a.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.1"},988:function(e,t,n){!function(){var t;e.exports=(t=n(703),function(){var e=t,n=e.lib.WordArray;function a(e,t,a){for(var s=[],r=0,i=0;i<t;i++)if(i%4){var o=a[e.charCodeAt(i-1)]<<i%4*2|a[e.charCodeAt(i)]>>>6-i%4*2;s[r>>>2]|=o<<24-r%4*8,r++}return n.create(s,r)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,a=this._map;e.clamp();for(var s=[],r=0;r<n;r+=3)for(var i=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;o<4&&r+.75*o<n;o++)s.push(a.charAt(i>>>6*(3-o)&63));var l=a.charAt(64);if(l)for(;s.length%4;)s.push(l);return s.join("")},parse:function(e){var t=e.length,n=this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var r=0;r<n.length;r++)s[n.charCodeAt(r)]=r}var i=n.charAt(64);if(i){var o=e.indexOf(i);-1!==o&&(t=o)}return a(e,t,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64)}()}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(950),t=n(352);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=a(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function r(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const l=new class{constructor(){this.tokenKey="auth_token",this.refreshKey="refresh_token",this.encryptionKey=null,this.initializeEncryption()}initializeEncryption(){if(!sessionStorage.getItem("session_enc_key")){const e=this.generateSecureKey();sessionStorage.setItem("session_enc_key",e)}this.encryptionKey=sessionStorage.getItem("session_enc_key")}generateSecureKey(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}async encryptData(e){try{const t=(new TextEncoder).encode(e),n=crypto.getRandomValues(new Uint8Array(12)),a=await crypto.subtle.importKey("raw",new Uint8Array(this.encryptionKey.match(/.{2}/g).map(e=>parseInt(e,16))),{name:"AES-GCM"},!1,["encrypt"]),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},a,t),r=new Uint8Array(n.length+s.byteLength);return r.set(n),r.set(new Uint8Array(s),n.length),btoa(String.fromCharCode(...r))}catch(t){throw console.error("Encryption failed:",t),new Error("Failed to encrypt token")}}async decryptData(e){try{const t=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))),n=t.slice(0,12),a=t.slice(12),s=await crypto.subtle.importKey("raw",new Uint8Array(this.encryptionKey.match(/.{2}/g).map(e=>parseInt(e,16))),{name:"AES-GCM"},!1,["decrypt"]),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},s,a);return(new TextDecoder).decode(r)}catch(t){throw console.error("Decryption failed:",t),new Error("Failed to decrypt token")}}async setToken(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{this.clearInsecureStorage();const n=await this.encryptData(e);if(sessionStorage.setItem(this.tokenKey,n),t){const e=await this.encryptData(t);sessionStorage.setItem(this.refreshKey,e)}return this.setTokenExpiration(),console.log("\ud83d\udd10 Token stored securely"),!0}catch(n){return console.error("Failed to store token securely:",n),!1}}async getToken(){try{const e=sessionStorage.getItem(this.tokenKey);return e?await this.decryptData(e):null}catch(e){return console.error("Failed to retrieve token:",e),this.clearTokens(),null}}async getRefreshToken(){try{const e=sessionStorage.getItem(this.refreshKey);return e?await this.decryptData(e):null}catch(e){return console.error("Failed to retrieve refresh token:",e),null}}clearTokens(){sessionStorage.removeItem(this.tokenKey),sessionStorage.removeItem(this.refreshKey),sessionStorage.removeItem("session_enc_key"),this.clearInsecureStorage(),console.log("\ud83e\uddf9 All tokens cleared")}clearInsecureStorage(){localStorage.removeItem("token"),localStorage.removeItem("authToken"),localStorage.removeItem("user_token"),localStorage.removeItem("jwt_token");const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&(n.includes("token")||n.includes("auth"))&&e.push(n)}e.forEach(e=>{localStorage.removeItem(e),console.warn("\ud83e\uddf9 Removed insecure storage: ".concat(e))})}setTokenExpiration(){this.expirationTimer&&clearTimeout(this.expirationTimer),this.expirationTimer=setTimeout(()=>{console.warn("\u23f0 Token expiring soon, clearing tokens"),this.clearTokens(),window.dispatchEvent(new CustomEvent("tokenExpiring"))},828e5)}async hasValidToken(){try{return!!await this.getToken()}catch(e){return!1}}async migrateFromLocalStorage(){const e=localStorage.getItem("token");return!!e&&(console.log("\ud83d\udd04 Migrating token from insecure localStorage"),await this.setToken(e),localStorage.removeItem("token"),console.log("\u2705 Token migration completed"),!0)}async getTokenForRequest(){let e=await this.getToken();if(e||(await this.migrateFromLocalStorage(),e=await this.getToken()),!e){const t=await this.getRefreshToken();t&&(e=await this.refreshAccessToken(t))}return e}async refreshAccessToken(e){try{const t=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(t.ok){const e=await t.json();return await this.setToken(e.token,e.refreshToken),e.token}return this.clearTokens(),null}catch(t){return console.error("Token refresh failed:",t),this.clearTokens(),null}}async verifyTokenIntegrity(){try{const t=await this.getToken();if(!t)return!1;const n=t.split(".");if(3!==n.length)return console.warn("\ud83d\udea8 Token structure invalid"),this.clearTokens(),!1;try{const e=JSON.parse(atob(n[1])),t=Math.floor(Date.now()/1e3);if(e.exp&&e.exp<t)return console.warn("\u23f0 Token expired"),this.clearTokens(),!1}catch(e){return console.warn("\ud83d\udea8 Token payload invalid"),this.clearTokens(),!1}return!0}catch(t){return console.error("Token integrity check failed:",t),this.clearTokens(),!1}}async initialize(){await this.migrateFromLocalStorage(),await this.verifyTokenIntegrity(),setInterval(()=>{this.verifyTokenIntegrity()},3e5),console.log("\ud83d\udd10 Secure token manager initialized")}},c="login",d="logout",u="page_view",h="feature_used",m="error_occurred",p="user_activity_log",f="user_session_data",g="user_analytics_data";const v=new class{constructor(){this.sessionStartTime=Date.now(),this.sessionId=this.generateSessionId(),this.lastActivityTime=Date.now(),this.isTrackingEnabled=!0,this.initializeSession(),this.setupCleanupInterval()}generateSessionId(){return"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}initializeSession(){try{const e={sessionId:this.sessionId,startTime:this.sessionStartTime,userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:"".concat(window.screen.width,"x").concat(window.screen.height),viewportSize:"".concat(window.innerWidth,"x").concat(window.innerHeight)};localStorage.setItem(f,JSON.stringify(e)),this.logActivity(c,{sessionId:this.sessionId,timestamp:this.sessionStartTime})}catch(e){console.error("Failed to initialize session:",e)}}logActivity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isTrackingEnabled)try{const n={id:this.generateActivityId(),type:e,timestamp:Date.now(),sessionId:this.sessionId,data:o(o({},t),{},{url:window.location.href,referrer:document.referrer,viewportSize:"".concat(window.innerWidth,"x").concat(window.innerHeight)})};this.lastActivityTime=n.timestamp;const a=this.getActivityLog();a.push(n),a.length>1e3&&a.splice(0,a.length-1e3),localStorage.setItem(p,JSON.stringify(a)),this.updateAnalytics(n),window.dispatchEvent(new CustomEvent("userActivity",{detail:n}))}catch(n){console.error("Failed to log activity:",n)}}generateActivityId(){return"activity_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}getActivityLog(){try{const e=localStorage.getItem(p);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to get activity log:",e),[]}}clearActivityLog(){try{return localStorage.removeItem(p),localStorage.removeItem(g),!0}catch(e){return console.error("Failed to clear activity log:",e),!1}}getActivityStats(){try{var e,t,n;const a=this.getActivityLog(),s=Date.now(),r=(new Date).setHours(0,0,0,0),i=s-6048e5,o=s-2592e6,l={total:a.length,today:a.filter(e=>e.timestamp>=r).length,thisWeek:a.filter(e=>e.timestamp>=i).length,thisMonth:a.filter(e=>e.timestamp>=o).length,byType:{},byHour:new Array(24).fill(0),byDay:{},sessionDuration:s-this.sessionStartTime,lastActivity:this.lastActivityTime,mostActiveHour:0,mostActiveDay:"",topActivities:[]};a.forEach(e=>{const t=e.type;l.byType[t]=(l.byType[t]||0)+1;const n=new Date(e.timestamp).getHours();l.byHour[n]++;const a=new Date(e.timestamp).toDateString();l.byDay[a]=(l.byDay[a]||0)+1});const c=Math.max(...l.byHour||[]);l.mostActiveHour=null!==(e=null===(t=l.byHour)||void 0===t||null===(n=t.indexOf)||void 0===n?void 0:n.call(t,c))&&void 0!==e?e:-1;const d=Object.keys(l.byDay).reduce((e,t)=>l.byDay[e]>l.byDay[t]?e:t,"");return l.mostActiveDay=d,l.topActivities=Object.entries(l.byType).sort((e,t)=>{let[,n]=e,[,a]=t;return a-n}).slice(0,5).map(e=>{let[t,n]=e;return{type:t,count:n}}),l}catch(a){return console.error("Failed to get activity stats:",a),{total:0,today:0,thisWeek:0,thisMonth:0,byType:{},byHour:new Array(24).fill(0),byDay:{},sessionDuration:0,lastActivity:Date.now(),mostActiveHour:0,mostActiveDay:"",topActivities:[]}}}updateAnalytics(e){try{const t=this.getAnalyticsData(),n=(new Date).toDateString();t.daily[n]||(t.daily[n]={activities:0,types:{},firstActivity:e.timestamp,lastActivity:e.timestamp});const a=t.daily[n];a.activities++,a.types[e.type]=(a.types[e.type]||0)+1,a.lastActivity=e.timestamp,t.global.totalActivities++,t.global.types[e.type]=(t.global.types[e.type]||0)+1,t.global.lastUpdated=e.timestamp,localStorage.setItem(g,JSON.stringify(t))}catch(t){console.error("Failed to update analytics:",t)}}getAnalyticsData(){try{const e=localStorage.getItem(g);if(e)return JSON.parse(e)}catch(e){console.error("Failed to get analytics data:",e)}return{global:{totalActivities:0,types:{},firstActivity:Date.now(),lastUpdated:Date.now()},daily:{},weekly:{},monthly:{}}}setTrackingEnabled(e){this.isTrackingEnabled=e,localStorage.setItem("activity_tracking_enabled",e)}isTrackingEnabledCheck(){return this.isTrackingEnabled}trackPageView(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logActivity(u,o({page:e},t))}trackFeatureUsage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logActivity(h,o({feature:e},t))}trackError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logActivity(m,{error:{message:e.message,stack:e.stack,name:e.name},context:t})}setupCleanupInterval(){setInterval(()=>{this.cleanupOldActivities()},36e5)}cleanupOldActivities(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;try{const t=this.getActivityLog(),n=Date.now()-24*e*60*60*1e3,a=t.filter(e=>e.timestamp>=n);localStorage.setItem(p,JSON.stringify(a)),console.log("Cleaned up ".concat(t.length-a.length," old activities"))}catch(t){console.error("Failed to cleanup old activities:",t)}}exportActivityData(){try{return{activities:this.getActivityLog(),analytics:this.getAnalyticsData(),session:JSON.parse(localStorage.getItem(f)||"{}"),exportedAt:Date.now()}}catch(e){return console.error("Failed to export activity data:",e),null}}importActivityData(e){try{return e.activities&&localStorage.setItem(p,JSON.stringify(e.activities)),e.analytics&&localStorage.setItem(g,JSON.stringify(e.analytics)),!0}catch(t){return console.error("Failed to import activity data:",t),!1}}getSessionInfo(){try{const e=localStorage.getItem(f);return e?JSON.parse(e):null}catch(e){return console.error("Failed to get session info:",e),null}}},y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v.logActivity(e,t)};const b=new class{constructor(){this.STORAGE_KEYS={USER_DATA:"quibish_user_data",USER_PROFILE:"quibish_user_profile",MESSAGES:"quibish_messages",CONVERSATIONS:"quibish_conversations",SETTINGS:"quibish_settings",AUTH_TOKEN:"quibish_auth_token",SESSION_DATA:"quibish_session_data",REMEMBER_ME:"quibish_remember_me"},this.listeners={},this.initializeStorage()}initializeStorage(){try{this.isStorageAvailable("localStorage")?this.primaryStorage=localStorage:(console.warn("\u26a0\ufe0f localStorage not available, using sessionStorage"),this.primaryStorage=sessionStorage),this.migrateOldData(),console.log("\u2705 Persistent storage initialized")}catch(e){console.error("\u274c Failed to initialize storage:",e)}}isStorageAvailable(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,"test"),t.removeItem(n),!0}catch(t){return!1}}migrateOldData(){try{const e=localStorage.getItem("user")||sessionStorage.getItem("user");if(e&&!this.getUserData()){const t=JSON.parse(e);this.setUserData(t),console.log("\ud83d\udce6 Migrated user data to persistent storage")}const t=localStorage.getItem("quibish_messages");if(t&&!this.getMessages().length){const e=JSON.parse(t);this.setMessages(e),console.log("\ud83d\udce6 Migrated messages to persistent storage")}const n=localStorage.getItem("authToken")||sessionStorage.getItem("authToken");n&&!this.getAuthToken()&&(this.setAuthToken(n),console.log("\ud83d\udce6 Migrated auth token to persistent storage"))}catch(e){console.warn("\u26a0\ufe0f Error during data migration:",e)}}setItem(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{const a="string"===typeof t?t:JSON.stringify(t);return n&&this.getRememberMe()?(localStorage.setItem(e,a),console.log("\ud83d\udcbe Stored ".concat(e," persistently"))):(sessionStorage.setItem(e,a),console.log("\ud83d\udcf1 Stored ".concat(e," for session"))),this.isCriticalData(e)&&localStorage.setItem(e,a),this.notifyListeners(e,t),!0}catch(a){return console.error("\u274c Failed to store ".concat(e,":"),a),!1}}getItem(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{let n=localStorage.getItem(e);return n||(n=sessionStorage.getItem(e)),n?t?JSON.parse(n):n:null}catch(n){return console.error("\u274c Failed to retrieve ".concat(e,":"),n),null}}removeItem(e){try{return localStorage.removeItem(e),sessionStorage.removeItem(e),this.notifyListeners(e,null),console.log("\ud83d\uddd1\ufe0f Removed ".concat(e," from all storage")),!0}catch(t){return console.error("\u274c Failed to remove ".concat(e,":"),t),!1}}isCriticalData(e){return[this.STORAGE_KEYS.USER_DATA,this.STORAGE_KEYS.USER_PROFILE,this.STORAGE_KEYS.MESSAGES,this.STORAGE_KEYS.AUTH_TOKEN].includes(e)}setUserData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=this.getRememberMe());const n=this.setItem(this.STORAGE_KEYS.USER_DATA,e,t);return n&&this.setUserProfile(e,t),n}getUserData(){return this.getItem(this.STORAGE_KEYS.USER_DATA)}updateUserData(e){const t=o(o(o({},this.getUserData()||{}),e),{},{updatedAt:(new Date).toISOString()});return this.setUserData(t)}setUserProfile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=this.getRememberMe()),this.setItem(this.STORAGE_KEYS.USER_PROFILE,e,t)}getUserProfile(){return this.getItem(this.STORAGE_KEYS.USER_PROFILE)}updateUserProfile(e){const t=o(o(o({},this.getUserProfile()||{}),e),{},{updatedAt:(new Date).toISOString()});return this.setUserProfile(t),this.updateUserData(e),t}setMessages(e){return this.setItem(this.STORAGE_KEYS.MESSAGES,e,!0)}getMessages(){return this.getItem(this.STORAGE_KEYS.MESSAGES)||[]}addMessage(e){const t=this.getMessages();return t.push(o(o({},e),{},{id:e.id||Date.now().toString(),timestamp:e.timestamp||(new Date).toISOString()})),t.length>1e3&&t.splice(0,t.length-1e3),this.setMessages(t)}updateMessage(e,t){const n=this.getMessages(),a=n.findIndex(t=>t.id===e);return-1!==a&&(n[a]=o(o(o({},n[a]),t),{},{updatedAt:(new Date).toISOString()}),this.setMessages(n))}deleteMessage(e){const t=this.getMessages().filter(t=>t.id!==e);return this.setMessages(t)}setAuthToken(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=this.getRememberMe()),this.setItem(this.STORAGE_KEYS.AUTH_TOKEN,e,t)}getAuthToken(){return this.getItem(this.STORAGE_KEYS.AUTH_TOKEN,!1)}setRememberMe(e){return localStorage.setItem(this.STORAGE_KEYS.REMEMBER_ME,e.toString()),e}getRememberMe(){return"true"===localStorage.getItem(this.STORAGE_KEYS.REMEMBER_ME)}setSettings(e){return this.setItem(this.STORAGE_KEYS.SETTINGS,e,!0)}getSettings(){return this.getItem(this.STORAGE_KEYS.SETTINGS)||{}}updateSettings(e){const t=o(o(o({},this.getSettings()),e),{},{updatedAt:(new Date).toISOString()});return this.setSettings(t)}setConversations(e){return this.setItem(this.STORAGE_KEYS.CONVERSATIONS,e,!0)}getConversations(){return this.getItem(this.STORAGE_KEYS.CONVERSATIONS)||[]}addConversation(e){const t=this.getConversations();return t.push(o(o({},e),{},{id:e.id||Date.now().toString(),createdAt:e.createdAt||(new Date).toISOString()})),this.setConversations(t)}setSessionData(e){return this.setItem(this.STORAGE_KEYS.SESSION_DATA,e,!1)}getSessionData(){return this.getItem(this.STORAGE_KEYS.SESSION_DATA)}clearAllData(){Object.values(this.STORAGE_KEYS).forEach(e=>{this.removeItem(e)});["user","authToken","token","quibish_messages"].forEach(e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)}),console.log("\ud83e\uddf9 Cleared all persistent data")}clearSessionData(){sessionStorage.clear(),this.removeItem(this.STORAGE_KEYS.SESSION_DATA),console.log("\ud83e\uddf9 Cleared session data")}exportAllData(){const e={};return Object.entries(this.STORAGE_KEYS).forEach(t=>{let[n,a]=t;const s=this.getItem(a);s&&(e[n]=s)}),o(o({},e),{},{exportDate:(new Date).toISOString(),version:"1.0"})}importAllData(e){try{return Object.entries(e).forEach(e=>{let[t,n]=e;this.STORAGE_KEYS[t]&&this.setItem(this.STORAGE_KEYS[t],n,!0)}),console.log("\u2705 Data imported successfully"),!0}catch(t){return console.error("\u274c Failed to import data:",t),!1}}getStorageStats(){const e={localStorage:{},sessionStorage:{},total:{localStorage:0,sessionStorage:0}};return Object.entries(this.STORAGE_KEYS).forEach(t=>{let[n,a]=t;const s=localStorage.getItem(a),r=sessionStorage.getItem(a);if(s){const t=new Blob([s]).size;e.localStorage[n]=t,e.total.localStorage+=t}if(r){const t=new Blob([r]).size;e.sessionStorage[n]=t,e.total.sessionStorage+=t}}),e}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}notifyListeners(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>{try{e(t)}catch(n){console.error("\u274c Error in storage listener:",n)}})}healthCheck(){try{const e="__health_check__",t="test";localStorage.setItem(e,t);const n=localStorage.getItem(e);localStorage.removeItem(e),sessionStorage.setItem(e,t);const a=sessionStorage.getItem(e);return sessionStorage.removeItem(e),{healthy:!0,localStorage:n===t,sessionStorage:a===t,timestamp:(new Date).toISOString()}}catch(e){return{healthy:!1,error:e.message,timestamp:(new Date).toISOString()}}}};var x=n(414);const w=(0,e.createContext)(),S=t=>{let{children:n}=t;const[a,s]=(0,e.useState)(null),[r,i]=(0,e.useState)(null),[u,h]=(0,e.useState)(!0),[m,p]=(0,e.useState)(!1);(0,e.useEffect)(()=>{(async()=>{console.log("\ud83d\udd04 Initializing authentication...");const e=b.getUserData(),t=b.getAuthToken(),n=b.getRememberMe();if(console.log("\ud83d\udce6 Storage check:",{hasUser:!!e,hasToken:!!t,remembered:n}),t&&e)try{i(t),p(n);const o="true"==={NODE_ENV:"production",PUBLIC_URL:"/quibish",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_BASE_URL:"http://localhost:5000/api",REACT_APP_ENV:"dev",REACT_APP_WEBSOCKET_URL:"ws://localhost:5000"}.REACT_APP_OFFLINE_MODE;let l=!o;if(!1&&!o)try{const e=new AbortController,t=setTimeout(()=>e.abort(),500),n=await fetch("http://localhost:5001/api/health",{method:"HEAD",signal:e.signal});clearTimeout(t),l=n.ok}catch(a){l=!1,console.log("\ud83d\udce1 Backend server not available - using offline mode")}if(l)try{const a=new AbortController,r=setTimeout(()=>a.abort(),2e3),i=await fetch("http://localhost:5001/api/users/profile",{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},signal:a.signal});if(clearTimeout(r),!i.ok)throw new Error("Invalid token");{const t=await i.json();if(t.success&&t.user){const e=t.user;s(e),b.setUserData(e,n),console.log("\u2705 Restored session with fresh profile data:",{remembered:n,user:e.username,theme:e.theme,language:e.language})}else s(e),console.log("\ud83d\udcf1 Used stored session data (profile fetch failed):",{remembered:n,user:e.username})}}catch(r){"AbortError"===r.name?console.log("\ud83d\udd04 Backend connection timeout - working in offline mode"):r.message.includes("Failed to fetch")||r.message.includes("ERR_CONNECTION_REFUSED")?console.log("\ud83d\udce1 Backend server not available - working in offline mode"):console.warn("\u26a0\ufe0f Could not fetch fresh profile, using stored data:",r.message),s(e),console.log("\ud83d\udcbe Using stored session data (offline mode):",{remembered:n,user:e.username})}else s(e),console.log("\ud83d\udcbe Using stored session data (offline mode - backend unavailable):",{remembered:n,user:e.username})}catch(o){console.error("\u274c Error initializing auth with stored data:",o),b.clearAllData()}else console.log("\ud83d\udd0d No valid session found");h(!1)})()},[]);return(0,x.jsx)(w.Provider,{value:{isAuthenticated:!!r,user:a,token:r,loading:u,rememberMe:m,login:async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s(e),i(t),p(n);try{b.setRememberMe(n),b.setAuthToken(t,n),b.setUserData(e,n),console.log("\ud83d\udd10 User session saved persistently (".concat(n?"remembered":"temporary",")"));try{await l.setToken(t),await l.clearInsecureStorage()}catch(a){console.warn("\u26a0\ufe0f Secure token storage failed, using persistent storage fallback")}y(c,{userId:e.id||"anonymous",method:"manual",remembered:n,secure:!0})}catch(a){console.error("\u274c Error storing session data:",a);const s=n?localStorage:sessionStorage;s.setItem("authToken",t),s.setItem("user",JSON.stringify(e))}},logout:async()=>{a&&y(d,{userId:a.id||"anonymous"}),s(null),i(null),p(!1),b.clearAllData();try{await l.clearTokens()}catch(e){console.warn("\u26a0\ufe0f Error clearing secure tokens:",e)}console.log("\ud83d\udd10 User session cleared from all storage")},refreshUser:async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a&&r){try{if(e){const e=await fetch("http://localhost:5001/api/users/profile",{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();if(t.success&&t.user){const e=t.user;return s(e),b.updateUserData(e),console.log("\u2705 User data refreshed from backend"),e}}}const t=b.getUserData();if(t)return s(t),console.log("\ud83d\udcf1 User data refreshed from storage"),t}catch(t){console.error("\u274c Error refreshing user data:",t)}return a}},updateUser:e=>{if(!a)return;const t=o(o(o({},a),e),{},{updatedAt:(new Date).toISOString()});return s(t),b.updateUserData(t),console.log("\ud83d\udc64 User data updated:",Object.keys(e)),t}},children:n})},k=()=>{const t=(0,e.useContext)(w);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},j=t=>{let{isOpen:n,onClose:a,user:s,onUpdateProfile:r}=t;console.log("\ud83d\ude80 UserProfileModal rendered with props:",{isOpen:n,user:s,hasOnClose:!!a,hasOnUpdateProfile:!!r});const[i,l]=(0,e.useState)({name:"",email:"",phone:"",bio:"",avatar:null,status:"online",theme:"light",notifications:!0,privacy:"friends"}),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(null),[f,g]=(0,e.useState)("profile");(0,e.useEffect)(()=>{s&&(l({name:s.name||"",email:s.email||"",phone:s.phone||"",bio:s.bio||"",avatar:s.avatar||null,status:s.status||"online",theme:s.theme||"light",notifications:!1!==s.notifications,privacy:s.privacy||"friends"}),p(s.avatar))},[s]);const v=(e,t)=>{l(n=>o(o({},n),{},{[e]:t}))};return n?(0,x.jsx)("div",{className:"profile-modal-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"profile-modal",children:[(0,x.jsxs)("div",{className:"profile-modal-header",children:[(0,x.jsx)("h3",{children:"Profile Settings"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"profile-modal-tabs",children:[(0,x.jsx)("button",{className:"tab-btn ".concat("profile"===f?"active":""),onClick:()=>g("profile"),children:"Profile"}),(0,x.jsx)("button",{className:"tab-btn ".concat("preferences"===f?"active":""),onClick:()=>g("preferences"),children:"Preferences"}),(0,x.jsx)("button",{className:"tab-btn ".concat("privacy"===f?"active":""),onClick:()=>g("privacy"),children:"Privacy"})]}),(0,x.jsxs)("div",{className:"profile-modal-content",children:["profile"===f&&(0,x.jsxs)("div",{className:"profile-tab",children:[(0,x.jsx)("div",{className:"avatar-section",children:(0,x.jsxs)("div",{className:"avatar-container",children:[(0,x.jsxs)("div",{className:"profile-avatar ".concat(u?"loading":""),children:[u?(0,x.jsxs)("div",{className:"avatar-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("span",{children:"Processing..."})]}):m?(0,x.jsx)("img",{src:m,alt:"Profile",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):(0,x.jsx)("div",{className:"avatar-placeholder",children:i.name.charAt(0).toUpperCase()||"U"}),(0,x.jsx)("div",{className:"status-indicator","data-status":i.status})]}),c&&(0,x.jsxs)("div",{className:"avatar-upload",children:[(0,x.jsx)("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(t.type))return void alert("Please select a valid image file (JPEG, PNG, GIF, or WebP)");if(t.size>5242880)return void alert("File size must be less than 5MB");h(!0);const n=new FileReader;n.onload=e=>{try{const t=e.target.result;p(t),l(e=>o(o({},e),{},{avatar:t})),h(!1)}catch(t){console.error("Error reading file:",t),alert("Error processing image file"),h(!1)}},n.onerror=()=>{alert("Error reading file"),h(!1)},n.readAsDataURL(t)},style:{display:"none"},disabled:u}),(0,x.jsx)("label",{htmlFor:"avatar-upload",className:"upload-btn ".concat(u?"disabled":""),children:u?"Processing...":"Change Photo"})]})]})}),(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{var e;const t={};return null!==(e=i.name)&&void 0!==e&&e.trim()?i.name.trim().length<2&&(t.name="Name must be at least 2 characters"):t.name="Name is required",i.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)&&(t.email="Please enter a valid email address"),i.phone&&!/^[\+]?[0-9\s\-\(\)]{10,}$/.test(i.phone)&&(t.phone="Please enter a valid phone number"),i.bio&&i.bio.length>500&&(t.bio="Bio must be less than 500 characters"),t})();if(Object.keys(t).length>0){const e=Object.values(t).join("\n");return void alert(e)}h(!0);try{await new Promise((e,t)=>{setTimeout(()=>{Math.random()<.1?t(new Error("Network error")):e()},1e3)}),r&&r(i);const e=o(o({},JSON.parse(localStorage.getItem("user")||sessionStorage.getItem("user")||"{}")),i);localStorage.getItem("user")&&localStorage.setItem("user",JSON.stringify(e)),sessionStorage.getItem("user")&&sessionStorage.setItem("user",JSON.stringify(e)),d(!1),alert("Profile updated successfully!")}catch(n){console.error("Error updating profile:",n),alert("Failed to update profile: ".concat(n.message,". Please try again."))}finally{h(!1)}},className:"profile-form",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Display Name *"}),(0,x.jsx)("input",{type:"text",value:i.name,onChange:e=>v("name",e.target.value),disabled:!c,required:!0})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Email"}),(0,x.jsx)("input",{type:"email",value:i.email,onChange:e=>v("email",e.target.value),disabled:!c})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Phone"}),(0,x.jsx)("input",{type:"tel",value:i.phone,onChange:e=>v("phone",e.target.value),disabled:!c})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Bio"}),(0,x.jsx)("textarea",{value:i.bio,onChange:e=>v("bio",e.target.value),disabled:!c,rows:"3",placeholder:"Tell others about yourself..."})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Status"}),(0,x.jsxs)("select",{value:i.status,onChange:e=>v("status",e.target.value),disabled:!c,children:[(0,x.jsx)("option",{value:"online",children:"\ud83d\udfe2 Online"}),(0,x.jsx)("option",{value:"away",children:"\ud83d\udfe1 Away"}),(0,x.jsx)("option",{value:"busy",children:"\ud83d\udd34 Busy"}),(0,x.jsx)("option",{value:"offline",children:"\u26ab Offline"})]})]}),(0,x.jsx)("div",{className:"form-actions",children:c?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{type:"button",onClick:()=>{s&&(l({name:s.name||"",email:s.email||"",phone:s.phone||"",bio:s.bio||"",avatar:s.avatar||null,status:s.status||"online",theme:s.theme||"light",notifications:!1!==s.notifications,privacy:s.privacy||"friends"}),p(s.avatar)),d(!1)},className:"cancel-btn",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:u,className:"save-btn",children:u?"Saving...":"Save Changes"})]}):(0,x.jsx)("button",{type:"button",onClick:()=>d(!0),className:"edit-btn",children:"Edit Profile"})})]})]}),"preferences"===f&&(0,x.jsxs)("div",{className:"preferences-tab",children:[(0,x.jsxs)("div",{className:"pref-group",children:[(0,x.jsx)("label",{children:"Theme"}),(0,x.jsxs)("div",{className:"theme-options",children:[(0,x.jsxs)("label",{className:"radio-option",children:[(0,x.jsx)("input",{type:"radio",name:"theme",value:"light",checked:"light"===i.theme,onChange:e=>v("theme",e.target.value)}),(0,x.jsx)("span",{children:"\u2600\ufe0f Light"})]}),(0,x.jsxs)("label",{className:"radio-option",children:[(0,x.jsx)("input",{type:"radio",name:"theme",value:"dark",checked:"dark"===i.theme,onChange:e=>v("theme",e.target.value)}),(0,x.jsx)("span",{children:"\ud83c\udf19 Dark"})]}),(0,x.jsxs)("label",{className:"radio-option",children:[(0,x.jsx)("input",{type:"radio",name:"theme",value:"auto",checked:"auto"===i.theme,onChange:e=>v("theme",e.target.value)}),(0,x.jsx)("span",{children:"\ud83d\udd04 Auto"})]})]})]}),(0,x.jsx)("div",{className:"pref-group",children:(0,x.jsxs)("label",{className:"checkbox-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:i.notifications,onChange:e=>v("notifications",e.target.checked)}),(0,x.jsx)("span",{children:"Enable Notifications"})]})})]}),"privacy"===f&&(0,x.jsxs)("div",{className:"privacy-tab",children:[(0,x.jsxs)("div",{className:"pref-group",children:[(0,x.jsx)("label",{children:"Profile Visibility"}),(0,x.jsxs)("select",{value:i.privacy,onChange:e=>v("privacy",e.target.value),children:[(0,x.jsx)("option",{value:"public",children:"\ud83c\udf10 Public"}),(0,x.jsx)("option",{value:"friends",children:"\ud83d\udc65 Friends Only"}),(0,x.jsx)("option",{value:"private",children:"\ud83d\udd12 Private"})]})]}),(0,x.jsxs)("div",{className:"privacy-info",children:[(0,x.jsx)("h4",{children:"Privacy Settings"}),(0,x.jsxs)("ul",{children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Public:"})," Your profile is visible to everyone"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Friends Only:"})," Only your contacts can see your profile"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Private:"})," Your profile is hidden from others"]})]})]})]})]})]})}):null},N=t=>{let{isOpen:n,onClose:a,initialSection:s="general"}=t;const{user:r,updateUser:i}=k(),[l,c]=(0,e.useState)(s),[d,u]=(0,e.useState)({theme:"light",language:"en",timezone:"auto",notifications:{desktop:!0,sound:!0,vibration:!0,email:!1,newMessages:!0,mentions:!0,calls:!0},privacy:{profileVisibility:"friends",lastSeen:!0,readReceipts:!0,typing:!0,blockedUsers:[]},chat:{fontSize:"medium",enterToSend:!0,autoDownload:!0,encryption:!0,backupEnabled:!0},media:{autoPlayVideos:!0,autoDownloadImages:!0,quality:"high",compression:"auto"}}),[h,m]=(0,e.useState)(!1);(0,e.useEffect)(()=>{n&&(()=>{try{const e=localStorage.getItem("quibish_settings");e&&u(t=>o(o({},t),JSON.parse(e))),r&&u(e=>o(o({},e),{},{theme:r.theme||e.theme,notifications:o(o({},e.notifications),r.notifications),privacy:o(o({},e.privacy),r.privacy)}))}catch(e){console.error("Error loading settings:",e)}})()},[n,r]);const p=(e,t,n)=>{u(a=>o(o({},a),{},{[e]:"object"!==typeof a[e]||Array.isArray(a[e])?n:o(o({},a[e]),{},{[t]:n})}))};return n?(0,x.jsx)("div",{className:"settings-modal-overlay",onClick:e=>e.target===e.currentTarget&&a(),children:(0,x.jsxs)("div",{className:"settings-modal",children:[(0,x.jsxs)("div",{className:"settings-header",children:[(0,x.jsx)("h2",{children:"Settings"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"settings-content",children:[(0,x.jsx)("div",{className:"settings-nav",children:[{id:"general",name:"General",icon:"\u2699\ufe0f"},{id:"notifications",name:"Notifications",icon:"\ud83d\udd14"},{id:"privacy",name:"Privacy",icon:"\ud83d\udd12"},{id:"chat",name:"Chat",icon:"\ud83d\udcac"},{id:"media",name:"Media",icon:"\ud83d\udcf1"},{id:"account",name:"Account",icon:"\ud83d\udc64"}].map(e=>(0,x.jsxs)("button",{className:"nav-item ".concat(l===e.id?"active":""),onClick:()=>c(e.id),children:[(0,x.jsx)("span",{className:"nav-icon",children:e.icon}),(0,x.jsx)("span",{className:"nav-text",children:e.name})]},e.id))}),(0,x.jsxs)("div",{className:"settings-panel",children:["general"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"General Settings"}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Theme"}),(0,x.jsxs)("select",{value:d.theme,onChange:e=>p("theme",null,e.target.value),children:[(0,x.jsx)("option",{value:"light",children:"Light"}),(0,x.jsx)("option",{value:"dark",children:"Dark"}),(0,x.jsx)("option",{value:"auto",children:"Auto (System)"})]})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Language"}),(0,x.jsxs)("select",{value:d.language,onChange:e=>p("language",null,e.target.value),children:[(0,x.jsx)("option",{value:"en",children:"English"}),(0,x.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,x.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,x.jsx)("option",{value:"de",children:"Deutsch"})]})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Timezone"}),(0,x.jsxs)("select",{value:d.timezone,onChange:e=>p("timezone",null,e.target.value),children:[(0,x.jsx)("option",{value:"auto",children:"Auto-detect"}),(0,x.jsx)("option",{value:"UTC",children:"UTC"}),(0,x.jsx)("option",{value:"America/New_York",children:"Eastern Time"}),(0,x.jsx)("option",{value:"America/Los_Angeles",children:"Pacific Time"})]})]})]}),"notifications"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"Notification Settings"}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.notifications.desktop,onChange:e=>p("notifications","desktop",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Desktop Notifications"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.notifications.sound,onChange:e=>p("notifications","sound",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Sound Notifications"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.notifications.newMessages,onChange:e=>p("notifications","newMessages",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"New Messages"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.notifications.mentions,onChange:e=>p("notifications","mentions",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Mentions & Replies"]})})]}),"privacy"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"Privacy Settings"}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Profile Visibility"}),(0,x.jsxs)("select",{value:d.privacy.profileVisibility,onChange:e=>p("privacy","profileVisibility",e.target.value),children:[(0,x.jsx)("option",{value:"public",children:"Public"}),(0,x.jsx)("option",{value:"friends",children:"Friends Only"}),(0,x.jsx)("option",{value:"private",children:"Private"})]})]}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.privacy.lastSeen,onChange:e=>p("privacy","lastSeen",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Show Last Seen"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.privacy.readReceipts,onChange:e=>p("privacy","readReceipts",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Read Receipts"]})})]}),"chat"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"Chat Settings"}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Font Size"}),(0,x.jsxs)("select",{value:d.chat.fontSize,onChange:e=>p("chat","fontSize",e.target.value),children:[(0,x.jsx)("option",{value:"small",children:"Small"}),(0,x.jsx)("option",{value:"medium",children:"Medium"}),(0,x.jsx)("option",{value:"large",children:"Large"}),(0,x.jsx)("option",{value:"extra-large",children:"Extra Large"})]})]}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.chat.enterToSend,onChange:e=>p("chat","enterToSend",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Enter to Send Messages"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.chat.encryption,onChange:e=>p("chat","encryption",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"End-to-End Encryption"]})})]}),"media"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"Media Settings"}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.media.autoPlayVideos,onChange:e=>p("media","autoPlayVideos",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Auto-play Videos"]})}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:d.media.autoDownloadImages,onChange:e=>p("media","autoDownloadImages",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"}),"Auto-download Images"]})}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Media Quality"}),(0,x.jsxs)("select",{value:d.media.quality,onChange:e=>p("media","quality",e.target.value),children:[(0,x.jsx)("option",{value:"low",children:"Low"}),(0,x.jsx)("option",{value:"medium",children:"Medium"}),(0,x.jsx)("option",{value:"high",children:"High"}),(0,x.jsx)("option",{value:"original",children:"Original"})]})]})]}),"account"===l&&(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"Account Settings"}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Account Information"}),(0,x.jsxs)("div",{className:"account-info",children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Name:"})," ",(null===r||void 0===r?void 0:r.name)||"Demo User"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Email:"})," ",(null===r||void 0===r?void 0:r.email)||"demo@quibish.com"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Status:"})," ",(null===r||void 0===r?void 0:r.status)||"Online"]})]})]}),(0,x.jsx)("div",{className:"setting-group",children:(0,x.jsx)("button",{className:"danger-btn",onClick:()=>{confirm("Are you sure you want to reset all settings to defaults?")&&(localStorage.removeItem("quibish_settings"),window.location.reload())},children:"Reset All Settings"})})]})]})]}),(0,x.jsxs)("div",{className:"settings-footer",children:[(0,x.jsx)("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),(0,x.jsx)("button",{className:"btn-primary",onClick:async()=>{m(!0);try{localStorage.setItem("quibish_settings",JSON.stringify(d)),i&&r&&i(o(o({},r),{},{theme:d.theme,notifications:d.notifications,privacy:d.privacy})),document.documentElement.setAttribute("data-theme",d.theme),console.log("Settings saved successfully"),alert("Settings saved successfully!")}catch(e){console.error("Error saving settings:",e),alert("Failed to save settings. Please try again.")}finally{m(!1)}},disabled:h,children:h?"Saving...":"Save Settings"})]})]})}):null},C=t=>{let{isOpen:n,onClose:a,onGifSelect:s}=t;const[r,i]=(0,e.useState)(""),[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)([]),m=[{id:"1",url:"https://media.giphy.com/media/3oKIPnAiaMCws8nOsE/giphy.gif",name:"Happy Dance",title:"Happy",size:1024e3,width:480,height:270},{id:"2",url:"https://media.giphy.com/media/l0MYrLAFex1R71l0A/giphy.gif",name:"Funny Cat",title:"Funny",size:856e3,width:480,height:360},{id:"3",url:"https://media.giphy.com/media/3o7TKTDn976rzVgky4/giphy.gif",name:"Excited Jump",title:"Excited",size:975e3,width:400,height:300},{id:"4",url:"https://media.giphy.com/media/l1J9u3TZfpmeDLkD6/giphy.gif",name:"Thumbs Up",title:"Approval",size:642e3,width:480,height:480},{id:"5",url:"https://media.giphy.com/media/3o7aD2saalBwwftBIY/giphy.gif",name:"Party Time",title:"Celebration",size:12e5,width:500,height:375},{id:"6",url:"https://media.giphy.com/media/26AHPxxnSw1L9T1rW/giphy.gif",name:"Mind Blown",title:"Surprised",size:89e4,width:480,height:270},{id:"7",url:"https://media.giphy.com/media/l3vR85PnGsBwu1PFK/giphy.gif",name:"Love Hearts",title:"Love",size:756e3,width:480,height:360},{id:"8",url:"https://media.giphy.com/media/3o6Zt0hNCfak3QCqsw/giphy.gif",name:"Crying Sad",title:"Sad",size:623e3,width:400,height:400}];(0,e.useEffect)(()=>{n&&(h(m),l(m))},[n]);const p=(0,e.useCallback)(async e=>{if(e.trim()){d(!0);try{const t=m.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.name.toLowerCase().includes(e.toLowerCase()));0===t.length?l(u.slice(0,3)):l(t)}catch(t){console.error("GIF search failed:",t),l(u.slice(0,3))}d(!1)}else l(u)},[u,m]);(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&a()};return n&&(document.addEventListener("keydown",e),setTimeout(()=>{const e=document.querySelector(".gif-search-input");e&&e.focus()},100)),()=>{document.removeEventListener("keydown",e)}},[n,a]);const f=e=>{console.log("GIF selected:",e),s(e),a()};return n?(0,x.jsx)("div",{className:"gif-picker-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"gif-picker-modal",children:[(0,x.jsxs)("div",{className:"gif-picker-header",children:[(0,x.jsx)("h3",{children:"Choose a GIF"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsx)("div",{className:"gif-search",children:(0,x.jsx)("input",{type:"text",placeholder:"Search for GIFs...",value:r,onChange:e=>{const t=e.target.value;i(t),window.gifSearchTimeout&&clearTimeout(window.gifSearchTimeout),window.gifSearchTimeout=setTimeout(()=>{p(t)},300)},className:"gif-search-input"})}),(0,x.jsx)("div",{className:"gif-grid",children:c?(0,x.jsxs)("div",{className:"gif-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Loading GIFs..."}),(0,x.jsx)("span",{children:"Finding the perfect reaction"})]}):o.length>0?o.map(e=>(0,x.jsxs)("div",{className:"gif-item",onClick:()=>f(e),role:"button",tabIndex:0,"aria-label":"Select ".concat(e.name||e.title," GIF"),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),f(e))},children:[(0,x.jsx)("img",{src:e.url,alt:e.name||e.title,loading:"lazy",onError:e=>{e.target.style.display="none",e.target.parentElement.style.background="#f0f0f0",e.target.parentElement.innerHTML+='<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#999;font-size:12px;">Failed to load</div>'}}),(0,x.jsx)("div",{className:"gif-overlay",children:(0,x.jsx)("span",{children:e.name||e.title})})]},e.id)):(0,x.jsxs)("div",{className:"no-results",children:[(0,x.jsx)("p",{children:"No GIFs found"}),(0,x.jsx)("span",{children:"Try searching for something else"}),(0,x.jsx)("button",{className:"reset-search-btn",onClick:()=>{i(""),l(u)},children:"Show Trending"})]})}),!r&&(0,x.jsxs)("div",{className:"gif-categories",children:[(0,x.jsx)("h4",{children:"Popular Categories"}),(0,x.jsx)("div",{className:"category-buttons",children:["Happy","Funny","Love","Sad","Excited","Surprised","Celebration","Approval"].map(e=>(0,x.jsx)("button",{className:"category-btn",onClick:()=>{i(e),p(e)},children:e},e))})]})]})}):null};const E=new class{constructor(){this.contacts=[],this.contactGroups=[],this.storageKey="quibish_contacts",this.groupStorageKey="quibish_contact_groups"}initialize(){return this.loadContactsFromStorage(),this.loadGroupsFromStorage(),{success:!0,contactCount:this.contacts.length,groupCount:this.contactGroups.length}}async getContacts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{search:t,group:n,limit:a=100,offset:s=0}=e;try{const e=await fetch("/api/contacts?limit=".concat(a,"&offset=").concat(s).concat(t?"&search=".concat(encodeURIComponent(t)):"").concat(n?"&group=".concat(encodeURIComponent(n)):""),{headers:{Authorization:"Bearer ".concat(await l.getTokenForRequest())}});if(e.ok){const t=await e.json();if(t.success)return this.contacts=t.contacts,this.saveContactsToStorage(),this.contacts}}catch(r){console.warn("API unavailable, using local contacts:",r)}return this.filterContacts(this.contacts,{search:t,group:n})}filterContacts(e,t){let{search:n,group:a}=t,s=[...e];if(n){const e=n.toLowerCase();s=s.filter(t=>{var a,s,r;return(null===(a=t.name)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(s=t.email)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(r=t.phone)||void 0===r?void 0:r.includes(n))})}return a&&(s=s.filter(e=>{var t;return null===(t=e.groups)||void 0===t?void 0:t.includes(a)})),s.sort((e,t)=>e.name.localeCompare(t.name))}async addContact(e){try{const n=o({id:Date.now().toString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},e),a=this.validateContact(n);if(!a.valid)return{success:!1,errors:a.errors};try{const e=await fetch("/api/contacts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(await l.getTokenForRequest())},body:JSON.stringify(n)});if(!e.ok){const t=await e.json();return{success:!1,errors:t.errors||[t.error||"Unknown error"]}}{const t=await e.json();if(t.success)return this.contacts.push(t.contact),this.saveContactsToStorage(),{success:!0,contact:t.contact}}}catch(t){console.warn("API unavailable, saving locally:",t)}return this.contacts.push(n),this.saveContactsToStorage(),{success:!0,contact:n,offline:!0}}catch(n){return console.error("Failed to add contact:",n),{success:!1,error:n.message}}}async updateContact(e,t){try{const a=this.contacts.findIndex(t=>t.id===e);if(-1===a)return{success:!1,error:"Contact not found"};const s=o(o(o({},this.contacts[a]),t),{},{updatedAt:(new Date).toISOString()}),r=this.validateContact(s);if(!r.valid)return{success:!1,errors:r.errors};try{const t=await fetch("/api/contacts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(await l.getTokenForRequest())},body:JSON.stringify(s)});if(!t.ok){const e=await t.json();return{success:!1,errors:e.errors||[e.error||"Unknown error"]}}{const e=await t.json();if(e.success)return this.contacts[a]=e.contact,this.saveContactsToStorage(),{success:!0,contact:e.contact}}}catch(n){console.warn("API unavailable, updating locally:",n)}return this.contacts[a]=s,this.saveContactsToStorage(),{success:!0,contact:s,offline:!0}}catch(a){return console.error("Failed to update contact:",a),{success:!1,error:a.message}}}async deleteContact(e){try{const n=this.contacts.findIndex(t=>t.id===e);if(-1===n)return{success:!1,error:"Contact not found"};try{const t=await fetch("/api/contacts/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(await l.getTokenForRequest())}});if(!t.ok){return{success:!1,error:(await t.json()).error||"Unknown error"}}if((await t.json()).success)return this.contacts.splice(n,1),this.saveContactsToStorage(),{success:!0}}catch(t){console.warn("API unavailable, deleting locally:",t)}return this.contacts.splice(n,1),this.saveContactsToStorage(),{success:!0,offline:!0}}catch(n){return console.error("Failed to delete contact:",n),{success:!1,error:n.message}}}validateContact(e){const t=[];return(!e.name||e.name.trim().length<1)&&t.push("Name is required"),e.email&&!this.isValidEmail(e.email)&&t.push("Invalid email format"),e.phone&&!this.isValidPhone(e.phone)&&t.push("Invalid phone format"),e.name&&e.name.length>100&&t.push("Name must be less than 100 characters"),{valid:0===t.length,errors:t}}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return/^[+]?[1-9][\d]{0,15}$/.test(e.replace(/[\s\-()]/g,""))}createGroup(e){const t=o({id:Date.now().toString(),createdAt:(new Date).toISOString()},e);return this.contactGroups.push(t),this.saveGroupsToStorage(),{success:!0,group:t}}getGroups(){return this.contactGroups}addContactToGroup(e,t){const n=this.contacts.find(t=>t.id===e);return n?(n.groups||(n.groups=[]),n.groups.includes(t)||(n.groups.push(t),this.saveContactsToStorage()),{success:!0}):{success:!1,error:"Contact not found"}}removeContactFromGroup(e,t){const n=this.contacts.find(t=>t.id===e);return n&&n.groups?(n.groups=n.groups.filter(e=>e!==t),this.saveContactsToStorage(),{success:!0}):{success:!1,error:"Contact or group not found"}}async importFromDevice(){if(!("contacts"in navigator)||!("ContactsManager"in window))return{success:!1,error:"Contact API not supported"};try{const a=["name","email","tel"],s={multiple:!0},r=await navigator.contacts.select(a,s),i=[];for(const o of r){var e,t,n;const a={name:(null===(e=o.name)||void 0===e?void 0:e[0])||"Unknown",email:null===(t=o.email)||void 0===t?void 0:t[0],phone:null===(n=o.tel)||void 0===n?void 0:n[0]},s=await this.addContact(a);s.success&&i.push(s.contact)}return{success:!0,imported:i.length,contacts:i}}catch(a){return{success:!1,error:a.message}}}exportContacts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json";try{let t,n,a;if("csv"===e)t=this.contactsToCSV(),n="contacts.csv",a="text/csv";else t=JSON.stringify(this.contacts,null,2),n="contacts.json",a="application/json";const s=new Blob([t],{type:a}),r=URL.createObjectURL(s),i=document.createElement("a");return i.href=r,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),{success:!0}}catch(t){return console.error("Failed to export contacts:",t),{success:!1,error:t.message}}}contactsToCSV(){return[["Name","Email","Phone","Created At"],...this.contacts.map(e=>[e.name||"",e.email||"",e.phone||"",e.createdAt||""])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")}saveContactsToStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.contacts))}catch(e){console.error("Failed to save contacts to storage:",e)}}loadContactsFromStorage(){try{const e=localStorage.getItem(this.storageKey);e&&(this.contacts=JSON.parse(e))}catch(e){console.error("Failed to load contacts from storage:",e),this.contacts=[]}}saveGroupsToStorage(){try{localStorage.setItem(this.groupStorageKey,JSON.stringify(this.contactGroups))}catch(e){console.error("Failed to save groups to storage:",e)}}loadGroupsFromStorage(){try{const e=localStorage.getItem(this.groupStorageKey);e&&(this.contactGroups=JSON.parse(e))}catch(e){console.error("Failed to load groups from storage:",e),this.contactGroups=[]}}getStatistics(){const e=this.contacts.length,t=this.contacts.filter(e=>e.email).length,n=this.contacts.filter(e=>e.phone).length;return{total:e,withEmail:t,withPhone:n,groups:this.contactGroups.length,emailPercentage:e>0?Math.round(t/e*100):0,phonePercentage:e>0?Math.round(n/e*100):0}}},T=t=>{let{isOpen:n,onClose:a,onCreateChat:s}=t;const[r,i]=(0,e.useState)("direct"),[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(""),[m,p]=(0,e.useState)([]),[f,g]=(0,e.useState)(!1);(0,e.useEffect)(()=>{n&&v()},[n]);const v=async()=>{g(!0);try{const e=await E.getContacts({search:u});p(e)}catch(e){console.error("Failed to load contacts:",e),p([])}g(!1)},y=e=>{l("direct"===r?[e]:t=>t.find(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])},b=()=>{i("direct"),l([]),d(""),h(""),a()};return n?(0,x.jsx)("div",{className:"new-chat-overlay",onClick:e=>{e.target===e.currentTarget&&b()},children:(0,x.jsxs)("div",{className:"new-chat-modal",children:[(0,x.jsxs)("div",{className:"new-chat-header",children:[(0,x.jsx)("h3",{children:"Start New Chat"}),(0,x.jsx)("button",{className:"close-btn",onClick:b,children:"\xd7"})]}),(0,x.jsx)("div",{className:"chat-type-selector",children:(0,x.jsxs)("div",{className:"chat-type-tabs",children:[(0,x.jsx)("button",{className:"tab ".concat("direct"===r?"active":""),onClick:()=>i("direct"),children:"Direct Message"}),(0,x.jsx)("button",{className:"tab ".concat("group"===r?"active":""),onClick:()=>i("group"),children:"Group Chat"})]})}),"group"===r&&(0,x.jsx)("div",{className:"group-settings",children:(0,x.jsx)("input",{type:"text",placeholder:"Enter group name...",value:c,onChange:e=>d(e.target.value),className:"group-name-input"})}),(0,x.jsx)("div",{className:"contact-search",children:(0,x.jsx)("input",{type:"text",placeholder:"Search contacts...",value:u,onChange:e=>{h(e.target.value),setTimeout(()=>v(),300)},className:"contact-search-input"})}),(0,x.jsx)("div",{className:"selected-contacts",children:o.length>0&&(0,x.jsxs)("div",{className:"selected-list",children:[(0,x.jsxs)("h4",{children:["Selected (",o.length,"):"]}),(0,x.jsx)("div",{className:"selected-items",children:o.map(e=>(0,x.jsxs)("div",{className:"selected-contact",children:[(0,x.jsx)("span",{children:e.name}),(0,x.jsx)("button",{onClick:()=>y(e),className:"remove-btn",children:"\xd7"})]},e.id))})]})}),(0,x.jsx)("div",{className:"contact-list",children:f?(0,x.jsxs)("div",{className:"loading-state",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Loading contacts..."})]}):m.length>0?(0,x.jsx)("div",{className:"contacts",children:m.map(e=>{const t=o.find(t=>t.id===e.id);return(0,x.jsxs)("div",{className:"contact-item ".concat(t?"selected":""),onClick:()=>y(e),children:[(0,x.jsx)("div",{className:"contact-avatar",children:e.avatar?(0,x.jsx)("img",{src:e.avatar,alt:e.name}):(0,x.jsx)("div",{className:"avatar-placeholder",children:e.name.charAt(0).toUpperCase()})}),(0,x.jsxs)("div",{className:"contact-info",children:[(0,x.jsx)("h4",{children:e.name}),e.email&&(0,x.jsx)("p",{className:"contact-email",children:e.email}),e.phone&&(0,x.jsx)("p",{className:"contact-phone",children:e.phone})]}),(0,x.jsx)("div",{className:"contact-actions",children:t?(0,x.jsx)("div",{className:"selected-indicator",children:"\u2713"}):(0,x.jsx)("div",{className:"select-indicator",children:"+"})})]},e.id)})}):(0,x.jsxs)("div",{className:"no-contacts",children:[(0,x.jsx)("p",{children:"No contacts found"}),(0,x.jsx)("span",{children:"Try adjusting your search or add some contacts first"})]})}),(0,x.jsxs)("div",{className:"new-chat-footer",children:[(0,x.jsx)("button",{className:"cancel-btn",onClick:b,children:"Cancel"}),(0,x.jsx)("button",{className:"create-btn",onClick:()=>{if(0===o.length)return void alert("Please select at least one contact");if("group"===r&&!c.trim())return void alert("Please enter a group name");const e={type:r,participants:o,name:"group"===r?c:null,createdAt:(new Date).toISOString()};s(e),b()},disabled:0===o.length,children:"direct"===r?"Start Chat":"Create Group"})]})]})}):null};const A=new class{constructor(){this.feedbackHistory=[],this.feedbackCategories=["bug_report","feature_request","improvement","ui_ux","performance","general"],this.apiEndpoint="/api/feedback"}async submitFeedback(e){try{const n=o(o({id:Date.now().toString(),timestamp:(new Date).toISOString()},e),{},{status:"submitted"}),a=this.validateFeedback(n);if(!a.valid)return{success:!1,errors:a.errors};try{const e=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(e.ok){const t=await e.json();return this.feedbackHistory.push(n),{success:!0,feedbackId:t.id||n.id,message:"Feedback submitted successfully"}}}catch(t){console.warn("API submission failed, storing locally:",t)}return this.feedbackHistory.push(n),this.saveFeedbackToStorage(),{success:!0,feedbackId:n.id,message:"Feedback saved locally",offline:!0}}catch(n){return console.error("Feedback submission failed:",n),{success:!1,error:n.message}}}getFeedback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{category:t,status:n,limit:a=50}=e;let s=[...this.feedbackHistory];return t&&(s=s.filter(e=>e.category===t)),n&&(s=s.filter(e=>e.status===n)),s.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)),s.slice(0,a)}validateFeedback(e){const t=[];return(!e.title||e.title.trim().length<3)&&t.push("Title must be at least 3 characters long"),(!e.description||e.description.trim().length<10)&&t.push("Description must be at least 10 characters long"),e.category&&this.feedbackCategories.includes(e.category)||t.push("Invalid category selected"),e.title&&e.title.length>200&&t.push("Title must be less than 200 characters"),e.description&&e.description.length>2e3&&t.push("Description must be less than 2000 characters"),{valid:0===t.length,errors:t}}saveFeedbackToStorage(){try{localStorage.setItem("quibish_feedback",JSON.stringify(this.feedbackHistory))}catch(e){console.error("Failed to save feedback to storage:",e)}}loadFeedbackFromStorage(){try{const e=localStorage.getItem("quibish_feedback");e&&(this.feedbackHistory=JSON.parse(e))}catch(e){console.error("Failed to load feedback from storage:",e),this.feedbackHistory=[]}}getCategories(){return this.feedbackCategories.map(e=>({id:e,name:this.formatCategoryName(e),description:this.getCategoryDescription(e)}))}formatCategoryName(e){return e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}getCategoryDescription(e){return{bug_report:"Report bugs, errors, or unexpected behavior",feature_request:"Suggest new features or functionality",improvement:"Suggest improvements to existing features",ui_ux:"Feedback about user interface and user experience",performance:"Report performance issues or slow loading",general:"General feedback and suggestions"}[e]||"General feedback"}async updateFeedbackStatus(e,t){try{const a=this.feedbackHistory.find(t=>t.id===e);if(!a)return{success:!1,error:"Feedback not found"};a.status=t,a.lastUpdated=(new Date).toISOString();try{if((await fetch("".concat(this.apiEndpoint,"/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)return this.saveFeedbackToStorage(),{success:!0}}catch(n){console.warn("Failed to update feedback on server:",n)}return this.saveFeedbackToStorage(),{success:!0,offline:!0}}catch(a){return console.error("Failed to update feedback status:",a),{success:!1,error:a.message}}}deleteFeedback(e){try{const t=this.feedbackHistory.findIndex(t=>t.id===e);return-1===t?{success:!1,error:"Feedback not found"}:(this.feedbackHistory.splice(t,1),this.saveFeedbackToStorage(),{success:!0})}catch(t){return console.error("Failed to delete feedback:",t),{success:!1,error:t.message}}}getStatistics(){const e=this.feedbackHistory.length,t={},n={};return this.feedbackCategories.forEach(e=>{t[e]=0}),this.feedbackHistory.forEach(e=>{t.hasOwnProperty(e.category)&&t[e.category]++,n[e.status]?n[e.status]++:n[e.status]=1}),{total:e,byCategory:t,byStatus:n,averagePerDay:this.calculateAveragePerDay()}}calculateAveragePerDay(){if(0===this.feedbackHistory.length)return 0;const e=this.feedbackHistory.map(e=>new Date(e.timestamp).toDateString()),t=[...new Set(e)];return this.feedbackHistory.length/t.length}initialize(){return this.loadFeedbackFromStorage(),{success:!0,feedbackCount:this.feedbackHistory.length,categories:this.getCategories()}}},I=t=>{let{isOpen:n,onClose:a}=t;const[s,r]=(0,e.useState)({title:"",description:"",category:"general",priority:"medium",email:""}),[i,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)([]),m=A.getCategories(),p=e=>{const{name:t,value:n}=e.target;r(e=>o(o({},e),{},{[t]:n})),u.length>0&&h([])},f=()=>{r({title:"",description:"",category:"general",priority:"medium",email:""}),h([]),d(!1),a()};return n?(0,x.jsx)("div",{className:"feedback-overlay",onClick:e=>{e.target===e.currentTarget&&f()},children:(0,x.jsxs)("div",{className:"feedback-modal",children:[(0,x.jsxs)("div",{className:"feedback-header",children:[(0,x.jsx)("h3",{children:"Send Feedback"}),(0,x.jsx)("button",{className:"close-btn",onClick:f,children:"\xd7"})]}),c?(0,x.jsxs)("div",{className:"success-message",children:[(0,x.jsx)("div",{className:"success-icon",children:"\u2713"}),(0,x.jsx)("h4",{children:"Thank you for your feedback!"}),(0,x.jsx)("p",{children:"We appreciate your input and will review it carefully."})]}):(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(!0),h([]);try{const e=await A.submitFeedback(s);e.success?(d(!0),r({title:"",description:"",category:"general",priority:"medium",email:""}),setTimeout(()=>{f()},2e3)):h(e.errors||["Failed to submit feedback"])}catch(t){h(["An unexpected error occurred. Please try again."])}l(!1)},className:"feedback-form",children:[u.length>0&&(0,x.jsx)("div",{className:"error-messages",children:u.map((e,t)=>(0,x.jsx)("div",{className:"error-message",children:e},t))}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"title",children:"Subject *"}),(0,x.jsx)("input",{type:"text",id:"title",name:"title",value:s.title,onChange:p,placeholder:"Brief description of your feedback...",required:!0,maxLength:200}),(0,x.jsxs)("span",{className:"char-count",children:[s.title.length,"/200"]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"category",children:"Category *"}),(0,x.jsx)("select",{id:"category",name:"category",value:s.category,onChange:p,required:!0,children:m.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"priority",children:"Priority"}),(0,x.jsxs)("select",{id:"priority",name:"priority",value:s.priority,onChange:p,children:[(0,x.jsx)("option",{value:"low",children:"Low"}),(0,x.jsx)("option",{value:"medium",children:"Medium"}),(0,x.jsx)("option",{value:"high",children:"High"}),(0,x.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"description",children:"Description *"}),(0,x.jsx)("textarea",{id:"description",name:"description",value:s.description,onChange:p,placeholder:"Please provide detailed feedback...",required:!0,rows:5,maxLength:2e3}),(0,x.jsxs)("span",{className:"char-count",children:[s.description.length,"/2000"]})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email (optional)"}),(0,x.jsx)("input",{type:"email",id:"email",name:"email",value:s.email,onChange:p,placeholder:"your.email@example.com"}),(0,x.jsx)("small",{children:"We'll only use this to follow up on your feedback if needed."})]}),(0,x.jsxs)("div",{className:"form-footer",children:[(0,x.jsx)("button",{type:"button",className:"cancel-btn",onClick:f,disabled:i,children:"Cancel"}),(0,x.jsx)("button",{type:"submit",className:"submit-btn",disabled:i||!s.title.trim()||!s.description.trim(),children:i?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"loading-spinner"}),"Sending..."]}):"Send Feedback"})]})]})]})}):null},M=t=>{let{isOpen:n,onClose:a}=t;const[s,r]=(0,e.useState)("getting-started"),[i,l]=(0,e.useState)(""),c={"getting-started":{title:"Getting Started",icon:"\ud83d\ude80",content:[{question:"How do I start a new chat?",answer:'Click the "New Chat" button in the sidebar or use the \u2795 icon in the header. You can start direct messages or create group chats with multiple contacts.'},{question:"How do I add contacts?",answer:'Go to the Contacts section and click "Add Contact". You can manually add contacts or import them from your device if supported.'},{question:"How do I send my first message?",answer:"Select a conversation from the sidebar, type your message in the input field at the bottom, and press Enter or click the send button."}]},messaging:{title:"Messaging Features",icon:"\ud83d\udcac",content:[{question:"How do I send files and images?",answer:"Click the attachment icon (\ud83d\udcce) next to the message input. You can send images, documents, videos, and other file types."},{question:"How do I add reactions to messages?",answer:"Hover over a message and click the reaction button, or long-press on mobile. Choose from available emoji reactions."},{question:"Can I edit or delete messages?",answer:"Yes! Click the three dots menu on any message to edit, delete, or perform other actions on your messages."},{question:"How do I search for messages?",answer:"Use the search icon in the header to search through your conversation history. You can search by text content or contact names."}]},"voice-video":{title:"Voice & Video Calls",icon:"\ud83d\udcde",content:[{question:"How do I start a voice call?",answer:"In any conversation, click the phone icon to start a voice call. Make sure you have microphone permissions enabled."},{question:"How do I start a video call?",answer:"Click the video camera icon in the conversation header. Ensure your camera and microphone permissions are granted."},{question:"Can I mute myself during a call?",answer:"Yes, use the mute button during any call to toggle your microphone on/off. Other participants will see a mute indicator."},{question:"How do voice calls work?",answer:"All voice and video calls use secure internet-based connections through WebRTC technology for the best quality and privacy."}]},settings:{title:"Settings & Customization",icon:"\u2699\ufe0f",content:[{question:"How do I change my profile picture?",answer:"Go to your user profile settings and click on your current avatar. Upload a new image to change your profile picture across all conversations."},{question:"Can I enable dark mode?",answer:"Yes! Look for the theme toggle in your settings or profile menu. Dark mode helps reduce eye strain in low-light environments."},{question:"How do I manage notifications?",answer:"Access notification settings through the main settings menu. You can customize notification sounds, frequency, and which events trigger notifications."},{question:"Is my data encrypted?",answer:"Yes, Quibish uses end-to-end encryption for your messages and calls to ensure your privacy and security."}]},troubleshooting:{title:"Troubleshooting",icon:"\ud83d\udd27",content:[{question:"Messages are not sending",answer:"Check your internet connection. If offline, messages will be saved and sent when you reconnect. Try refreshing the page if issues persist."},{question:"Voice/video calls not working",answer:"Ensure microphone and camera permissions are granted. Check your browser settings and try using a different browser if problems continue."},{question:"App is running slowly",answer:"Clear your browser cache, close other tabs, or restart your browser. Large conversation histories may impact performance."},{question:"I lost my conversation history",answer:"Conversation history is stored locally and on our servers. Try logging out and back in, or contact support if data appears to be missing."}]},privacy:{title:"Privacy & Security",icon:"\ud83d\udd12",content:[{question:"How is my data protected?",answer:"We use industry-standard encryption, secure servers, and follow best practices for data protection. Your conversations are private and secure."},{question:"Who can see my profile information?",answer:"Only your contacts can see your profile information. You control what information is shared and with whom."},{question:"Can I delete my account?",answer:"Yes, you can delete your account and all associated data through the account settings. This action is permanent and cannot be undone."},{question:"How do I report inappropriate content?",answer:"Use the report function on any message or contact. Our moderation team reviews all reports and takes appropriate action."}]}};if(!n)return null;const d=(()=>{if(!i.trim())return c[s].content;return Object.values(c).flatMap(e=>e.content.map(t=>o(o({},t),{},{section:e.title}))).filter(e=>e.question.toLowerCase().includes(i.toLowerCase())||e.answer.toLowerCase().includes(i.toLowerCase()))})();return(0,x.jsx)("div",{className:"help-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"help-modal",children:[(0,x.jsxs)("div",{className:"help-header",children:[(0,x.jsx)("h3",{children:"Help & Support"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsx)("div",{className:"help-search",children:(0,x.jsx)("input",{type:"text",placeholder:"Search help topics...",value:i,onChange:e=>l(e.target.value),className:"help-search-input"})}),(0,x.jsxs)("div",{className:"help-content",children:[!i&&(0,x.jsx)("div",{className:"help-sidebar",children:(0,x.jsx)("nav",{className:"help-nav",children:Object.entries(c).map(e=>{let[t,n]=e;return(0,x.jsxs)("button",{className:"nav-item ".concat(s===t?"active":""),onClick:()=>r(t),children:[(0,x.jsx)("span",{className:"nav-icon",children:n.icon}),(0,x.jsx)("span",{className:"nav-title",children:n.title})]},t)})})}),(0,x.jsx)("div",{className:"help-main ".concat(i?"search-mode":""),children:i?(0,x.jsxs)("div",{className:"search-results",children:[(0,x.jsxs)("h4",{children:["Search Results (",d.length,")"]}),d.length>0?(0,x.jsx)("div",{className:"faq-list",children:d.map((e,t)=>(0,x.jsxs)("div",{className:"faq-item",children:[e.section&&(0,x.jsx)("div",{className:"faq-section",children:e.section}),(0,x.jsx)("h5",{className:"faq-question",children:e.question}),(0,x.jsx)("p",{className:"faq-answer",children:e.answer})]},t))}):(0,x.jsxs)("div",{className:"no-results",children:[(0,x.jsxs)("p",{children:['No results found for "',i,'"']}),(0,x.jsx)("span",{children:"Try different keywords or browse categories"})]})]}):(0,x.jsxs)("div",{className:"section-content",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsx)("span",{className:"section-icon",children:c[s].icon}),(0,x.jsx)("h4",{children:c[s].title})]}),(0,x.jsx)("div",{className:"faq-list",children:c[s].content.map((e,t)=>(0,x.jsxs)("div",{className:"faq-item",children:[(0,x.jsx)("h5",{className:"faq-question",children:e.question}),(0,x.jsx)("p",{className:"faq-answer",children:e.answer})]},t))})]})})]}),(0,x.jsx)("div",{className:"help-footer",children:(0,x.jsxs)("div",{className:"footer-content",children:[(0,x.jsx)("p",{children:"Still need help?"}),(0,x.jsxs)("div",{className:"footer-actions",children:[(0,x.jsx)("button",{className:"contact-support-btn",children:"\ud83d\udce7 Contact Support"}),(0,x.jsx)("button",{className:"feedback-btn",children:"\ud83d\udcdd Send Feedback"})]})]})})]})})},D=t=>{let{isOpen:n,onClose:a,onCapture:s,mode:r="photo"}=t;const[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(null),[p,f]=(0,e.useState)("user"),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)([]),[w,S]=(0,e.useState)("off"),k=(0,e.useRef)(null),j=(0,e.useRef)(null),N=(0,e.useRef)(null),C=(0,e.useRef)(null);(0,e.useEffect)(()=>(n?E():T(),()=>{T()}),[n,p]);const E=async()=>{o(!0),c(null);try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera access is not supported in this browser");const e={video:{facingMode:p,width:{ideal:1280},height:{ideal:720}},audio:"video"===r},t=await navigator.mediaDevices.getUserMedia(e);m(t),C.current=t,u(!0),k.current&&(k.current.srcObject=t,await k.current.play())}catch(e){console.error("Camera initialization error:",e),c(A(e)),u(!1)}finally{o(!1)}},T=()=>{C.current&&(C.current.getTracks().forEach(e=>e.stop()),C.current=null,m(null)),N.current&&g&&(N.current.stop(),v(!1))},A=e=>"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?"Camera permission denied. Please enable camera access and try again.":"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?"No camera found on this device.":"NotReadableError"===e.name||"TrackStartError"===e.name?"Camera is already in use by another application.":"OverconstrainedError"===e.name?"Camera does not support the requested settings.":e.message||"Failed to access camera. Please try again.";return n?(0,x.jsx)("div",{className:"camera-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"camera-modal",children:[(0,x.jsxs)("div",{className:"camera-header",children:[(0,x.jsx)("button",{className:"camera-close",onClick:a,children:"\xd7"}),(0,x.jsx)("div",{className:"camera-title",children:"photo"===r?"\ud83d\udcf7 Camera":"\ud83c\udfa5 Video"}),(0,x.jsxs)("div",{className:"camera-actions",children:[(0,x.jsx)("button",{className:"flash-btn ".concat("on"===w?"active":""),onClick:async()=>{if(h)try{const e=h.getVideoTracks()[0];if(e.getCapabilities().torch){const t="off"===w?"on":"off";await e.applyConstraints({advanced:[{torch:"on"===t}]}),S(t)}}catch(e){console.error("Flash toggle error:",e)}},title:"Toggle Flash",children:"\u26a1"}),(0,x.jsx)("button",{className:"switch-camera-btn",onClick:()=>{f(e=>"user"===e?"environment":"user")},title:"Switch Camera",children:"\ud83d\udd04"})]})]}),(0,x.jsxs)("div",{className:"camera-content",children:[i&&(0,x.jsxs)("div",{className:"camera-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Initializing camera..."})]}),l&&(0,x.jsxs)("div",{className:"camera-error",children:[(0,x.jsx)("div",{className:"error-icon",children:"\ud83d\udea8"}),(0,x.jsx)("h4",{children:"Camera Error"}),(0,x.jsx)("p",{children:l}),(0,x.jsx)("button",{className:"retry-btn",onClick:E,children:"Try Again"})]}),d&&!l&&(0,x.jsxs)("div",{className:"camera-view",children:[(0,x.jsx)("video",{ref:k,className:"camera-video",autoPlay:!0,playsInline:!0,muted:!0}),(0,x.jsx)("canvas",{ref:j,className:"camera-canvas",style:{display:"none"}}),g&&(0,x.jsxs)("div",{className:"recording-indicator",children:[(0,x.jsx)("div",{className:"recording-dot"}),(0,x.jsx)("span",{children:"Recording..."})]})]})]}),d&&!l&&(0,x.jsx)("div",{className:"camera-controls",children:"photo"===r?(0,x.jsx)("button",{className:"capture-btn",onClick:()=>{if(!k.current||!j.current)return;const e=k.current,t=j.current,n=t.getContext("2d");t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,t.width,t.height),t.toBlob(e=>{if(e&&s){const t=new File([e],"photo_".concat(Date.now(),".jpg"),{type:"image/jpeg"});s(t,"photo"),a()}},"image/jpeg",.9)},children:"\ud83d\udcf7 Capture Photo"}):(0,x.jsx)("div",{className:"video-controls",children:g?(0,x.jsx)("button",{className:"stop-btn",onClick:()=>{N.current&&g&&(N.current.stop(),v(!1))},children:"\u23f9\ufe0f Stop Recording"}):(0,x.jsx)("button",{className:"record-btn",onClick:()=>{if(h)try{const e={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(e.mimeType)||(e.mimeType="video/webm",MediaRecorder.isTypeSupported(e.mimeType)||(e.mimeType="video/mp4"));const t=new MediaRecorder(h,e);N.current=t;const n=[];t.ondataavailable=e=>{e.data.size>0&&n.push(e.data)},t.onstop=()=>{const e=new Blob(n,{type:t.mimeType}),r=new File([e],"video_".concat(Date.now(),".webm"),{type:e.type});s&&s(r,"video"),b([]),a()},t.start(1e3),v(!0),b(n)}catch(e){console.error("Recording start error:",e),c("Failed to start recording. Please try again.")}},children:"\u25cf Start Recording"})})})]})}):null},P=t=>{let{isOpen:n,onClose:a,onContactsSelected:s,multiple:r=!0}=t;const[i,l]=(0,e.useState)([]),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)([]),[m,p]=(0,e.useState)(""),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(null),[b,w]=(0,e.useState)(null),[S,k]=(0,e.useState)(null);(0,e.useEffect)(()=>{n&&j()},[n]),(0,e.useEffect)(()=>{if(m.trim()){const e=i.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.email&&e.email.toLowerCase().includes(m.toLowerCase())||e.phone&&e.phone.includes(m));d(e)}else d(i)},[i,m]);const j=async()=>{if(g(!0),y(null),"contacts"in navigator&&"ContactsManager"in window)try{const e=await navigator.contacts.getProperties();k({supported:!0,properties:e,api:"ContactsManager"}),await C()}catch(e){console.error("ContactsManager error:",e),N()}else if("contacts"in navigator)try{k({supported:!0,properties:["name","email","tel"],api:"ContactPicker"}),await C()}catch(e){console.error("ContactPicker error:",e),N()}else N()},N=()=>{k({supported:!1,reason:"Contact access is not supported in this browser",api:"none"}),E(),g(!1)},C=async()=>{try{if("ContactsManager"===(null===S||void 0===S?void 0:S.api)){const e=(await navigator.contacts.select(["name","email","tel"],{multiple:r})).map((e,t)=>{var n,a,s;return{id:"native_".concat(t),name:(null===(n=e.name)||void 0===n?void 0:n[0])||"Unknown",email:(null===(a=e.email)||void 0===a?void 0:a[0])||"",phone:(null===(s=e.tel)||void 0===s?void 0:s[0])||"",source:"device"}});l(e),w(!0)}else{const e=(await navigator.contacts.select(["name","email","tel"],{multiple:r})).map((e,t)=>({id:"picker_".concat(t),name:e.name||"Unknown",email:e.email||"",phone:e.tel||"",source:"device"}));l(e),w(!0)}}catch(e){console.error("Contact permission error:",e),"NotAllowedError"===e.name?(y("Contact access permission denied. Please enable contact access."),w(!1)):"NotSupportedError"===e.name?(y("Contact access is not supported on this device."),w(!1)):(y("Failed to access contacts. Using manual entry mode."),w(!1)),E()}finally{g(!1)}},E=()=>{const e=[{id:"fallback_1",name:"Manual Entry",email:"",phone:"",source:"manual",isManualEntry:!0}];try{const t=JSON.parse(localStorage.getItem("app_contacts")||"[]");e.push(...t.map(e=>o(o({},e),{},{source:"saved"})))}catch(t){console.error("Error loading saved contacts:",t)}l(e),w(!1)},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;e.length>0&&s&&s(e),a()},A=e=>u.find(t=>t.id===e.id);return n?(0,x.jsx)("div",{className:"contact-picker-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"contact-picker-modal",children:[(0,x.jsxs)("div",{className:"contact-picker-header",children:[(0,x.jsx)("h3",{children:r?"\ud83d\udcde Select Contacts":"\ud83d\udcde Select Contact"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),f&&(0,x.jsxs)("div",{className:"contact-picker-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Accessing contacts..."})]}),v&&(0,x.jsxs)("div",{className:"contact-picker-error",children:[(0,x.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)("p",{children:v}),(0,x.jsx)("button",{className:"retry-btn",onClick:j,children:"Try Again"})]}),!f&&!v&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"contact-picker-search",children:(0,x.jsx)("input",{type:"text",placeholder:"Search contacts...",value:m,onChange:e=>p(e.target.value),className:"search-input"})}),(0,x.jsx)("div",{className:"contact-picker-content",children:c.length>0?(0,x.jsx)("div",{className:"contacts-list",children:c.map(e=>(0,x.jsxs)("div",{className:"contact-item ".concat(A(e)?"selected":""," ").concat(e.isManualEntry?"manual-entry":""),onClick:()=>(e=>{if(e.isManualEntry){const e=prompt("Enter contact name:"),t=prompt("Enter email (optional):")||"",n=prompt("Enter phone number (optional):")||"";if(e){const a={id:"manual_".concat(Date.now()),name:e,email:t,phone:n,source:"manual"};r?h(e=>[...e,a]):(h([a]),T([a]))}return}r?h(t=>t.find(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e]):(h([e]),T([e]))})(e),children:[(0,x.jsx)("div",{className:"contact-avatar",children:e.isManualEntry?"\u2795":e.name.charAt(0).toUpperCase()}),(0,x.jsxs)("div",{className:"contact-info",children:[(0,x.jsxs)("div",{className:"contact-name",children:[e.name,"device"===e.source&&(0,x.jsx)("span",{className:"source-badge",children:"Device"}),"saved"===e.source&&(0,x.jsx)("span",{className:"source-badge saved",children:"Saved"})]}),e.email&&(0,x.jsx)("div",{className:"contact-email",children:e.email}),e.phone&&(0,x.jsx)("div",{className:"contact-phone",children:e.phone})]}),r&&!e.isManualEntry&&(0,x.jsx)("div",{className:"contact-checkbox",children:A(e)?"\u2713":""})]},e.id))}):(0,x.jsxs)("div",{className:"no-contacts",children:[(0,x.jsx)("div",{className:"no-contacts-icon",children:"\ud83d\udcde"}),(0,x.jsx)("h4",{children:"No contacts found"}),(0,x.jsx)("p",{children:m?'No contacts match "'.concat(m,'"'):"No contacts available"})]})}),r&&u.length>0&&(0,x.jsxs)("div",{className:"contact-picker-footer",children:[(0,x.jsxs)("div",{className:"selected-count",children:[u.length," contact",1!==u.length?"s":""," selected"]}),(0,x.jsxs)("div",{className:"footer-actions",children:[(0,x.jsx)("button",{className:"cancel-btn",onClick:()=>h([]),children:"Clear"}),(0,x.jsx)("button",{className:"submit-btn",onClick:()=>T(),children:"Add Selected"})]})]})]})]})}):null},_=t=>{let{isOpen:n,onClose:a}=t;const[s,r]=(0,e.useState)([]),[i,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)([]),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(null),[b,w]=(0,e.useState)("name"),[S,k]=(0,e.useState)("grid"),[j,N]=(0,e.useState)({name:"",email:"",phone:"",company:"",notes:""});(0,e.useEffect)(()=>{n&&C()},[n]),(0,e.useEffect)(()=>{let e=s;c.trim()&&(e=s.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.email&&e.email.toLowerCase().includes(c.toLowerCase())||e.phone&&e.phone.includes(c)||e.company&&e.company.toLowerCase().includes(c.toLowerCase()))),e=[...e].sort((e,t)=>{switch(b){case"name":return e.name.localeCompare(t.name);case"email":return(e.email||"").localeCompare(t.email||"");case"company":return(e.company||"").localeCompare(t.company||"");case"recent":return new Date(t.lastContacted||0)-new Date(e.lastContacted||0);default:return 0}}),l(e)},[s,c,b]);const C=async()=>{p(!0);try{const e=await E.getContacts();r(e)}catch(e){console.error("Error loading contacts:",e)}finally{p(!1)}};return n?(0,x.jsx)("div",{className:"contact-manager-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"contact-manager-modal",children:[(0,x.jsxs)("div",{className:"contact-manager-header",children:[(0,x.jsx)("h3",{children:"\ud83d\udcde Contact Manager"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"contact-manager-toolbar",children:[(0,x.jsx)("div",{className:"search-section",children:(0,x.jsx)("input",{type:"text",placeholder:"Search contacts...",value:c,onChange:e=>d(e.target.value),className:"search-input"})}),(0,x.jsxs)("div",{className:"toolbar-actions",children:[(0,x.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"sort-select",children:[(0,x.jsx)("option",{value:"name",children:"Sort by Name"}),(0,x.jsx)("option",{value:"email",children:"Sort by Email"}),(0,x.jsx)("option",{value:"company",children:"Sort by Company"}),(0,x.jsx)("option",{value:"recent",children:"Sort by Recent"})]}),(0,x.jsxs)("div",{className:"view-toggle",children:[(0,x.jsx)("button",{className:"view-btn ".concat("grid"===S?"active":""),onClick:()=>k("grid"),title:"Grid View",children:"\u2059"}),(0,x.jsx)("button",{className:"view-btn ".concat("list"===S?"active":""),onClick:()=>k("list"),title:"List View",children:"\u2630"})]}),(0,x.jsx)("button",{className:"add-btn",onClick:()=>g(!0),children:"\u2795 Add"})]})]}),u.length>0&&(0,x.jsxs)("div",{className:"selection-bar",children:[(0,x.jsxs)("span",{children:[u.length," selected"]}),(0,x.jsxs)("div",{className:"selection-actions",children:[(0,x.jsx)("button",{onClick:()=>{u.length===i.length?h([]):h(i.map(e=>e.id))},children:u.length===i.length?"Deselect All":"Select All"}),(0,x.jsx)("button",{onClick:async()=>{if(0!==u.length&&window.confirm("Are you sure you want to delete ".concat(u.length," contact(s)?")))try{const e=(await Promise.all(u.map(e=>E.deleteContact(e)))).filter(e=>e.success);e.length>0&&(r(e=>e.filter(e=>!u.includes(e.id))),h([])),e.length<u.length&&alert("Some contacts could not be deleted")}catch(e){console.error("Error deleting contacts:",e),alert("Failed to delete some contacts")}},className:"delete-btn",children:"Delete Selected"})]})]}),(0,x.jsx)("div",{className:"contact-manager-content",children:m?(0,x.jsxs)("div",{className:"loading-state",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Loading contacts..."})]}):i.length>0?(0,x.jsx)("div",{className:"contacts-container ".concat(S),children:i.map(e=>(0,x.jsxs)("div",{className:"contact-card ".concat(u.includes(e.id)?"selected":""),children:[(0,x.jsx)("div",{className:"contact-checkbox",children:(0,x.jsx)("input",{type:"checkbox",checked:u.includes(e.id),onChange:()=>{return t=e.id,void h(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}})}),(0,x.jsx)("div",{className:"contact-avatar",children:e.name.charAt(0).toUpperCase()}),(0,x.jsxs)("div",{className:"contact-details",children:[(0,x.jsx)("div",{className:"contact-name",children:e.name}),e.email&&(0,x.jsx)("div",{className:"contact-email",children:e.email}),e.phone&&(0,x.jsx)("div",{className:"contact-phone",children:e.phone}),e.company&&(0,x.jsx)("div",{className:"contact-company",children:e.company})]}),(0,x.jsxs)("div",{className:"contact-actions",children:[(0,x.jsx)("button",{onClick:()=>y(e),className:"edit-btn",title:"Edit",children:"\u270f\ufe0f"}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this contact?"))try{const t=await E.deleteContact(e);t.success?(r(t=>t.filter(t=>t.id!==e)),h(t=>t.filter(t=>t!==e))):alert("Failed to delete contact: ".concat(t.error))}catch(t){console.error("Error deleting contact:",t),alert("Failed to delete contact")}})(e.id),className:"delete-btn",title:"Delete",children:"\ud83d\uddd1\ufe0f"})]})]},e.id))}):(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udcde"}),(0,x.jsx)("h4",{children:"No contacts found"}),(0,x.jsx)("p",{children:c?'No contacts match "'.concat(c,'"'):"Start by adding your first contact"}),(0,x.jsx)("button",{className:"add-first-btn",onClick:()=>g(!0),children:"Add Contact"})]})}),(0,x.jsxs)("div",{className:"contact-manager-footer",children:[(0,x.jsxs)("div",{className:"footer-info",children:[s.length," total contact",1!==s.length?"s":""]}),(0,x.jsxs)("div",{className:"footer-actions",children:[(0,x.jsx)("input",{type:"file",accept:".json,.csv",onChange:async e=>{const t=e.target.files[0];if(t){try{const e=await t.text();let n;if(t.name.endsWith(".json"))n=JSON.parse(e);else if(t.name.endsWith(".csv")){const t=e.split("\n");t[0].split(",").map(e=>e.trim().replace(/"/g,""));n=t.slice(1).map(e=>{const t=e.split(",").map(e=>e.trim().replace(/"/g,""));return{name:t[0]||"Unknown",email:t[1]||"",phone:t[2]||"",company:t[3]||""}}).filter(e=>e.name&&"Unknown"!==e.name)}if(Array.isArray(n)){const e=(await Promise.all(n.map(e=>E.addContact(e)))).filter(e=>e.success);e.length>0?(r(t=>[...t,...e.map(e=>e.contact)]),alert("Successfully imported ".concat(e.length," contacts"))):alert("No contacts were imported")}else alert("Invalid file format")}catch(n){console.error("Error importing contacts:",n),alert("Failed to import contacts")}e.target.value=""}},style:{display:"none"},id:"import-input"}),(0,x.jsx)("label",{htmlFor:"import-input",className:"import-btn",children:"\ud83d\udcc1 Import"}),(0,x.jsx)("button",{onClick:async()=>{try{const e=E.exportContacts("json");e.success||alert("Failed to export contacts: ".concat(e.error))}catch(e){console.error("Error exporting contacts:",e),alert("Failed to export contacts")}},className:"export-btn",children:"\ud83d\udcc4 Export"})]})]}),f&&(0,x.jsx)("div",{className:"add-contact-overlay",children:(0,x.jsxs)("div",{className:"add-contact-modal",children:[(0,x.jsxs)("div",{className:"add-contact-header",children:[(0,x.jsx)("h4",{children:"Add New Contact"}),(0,x.jsx)("button",{onClick:()=>g(!1),children:"\xd7"})]}),(0,x.jsxs)("div",{className:"add-contact-form",children:[(0,x.jsx)("input",{type:"text",placeholder:"Full Name *",value:j.name,onChange:e=>N(t=>o(o({},t),{},{name:e.target.value}))}),(0,x.jsx)("input",{type:"email",placeholder:"Email",value:j.email,onChange:e=>N(t=>o(o({},t),{},{email:e.target.value}))}),(0,x.jsx)("input",{type:"tel",placeholder:"Phone Number",value:j.phone,onChange:e=>N(t=>o(o({},t),{},{phone:e.target.value}))}),(0,x.jsx)("input",{type:"text",placeholder:"Company",value:j.company,onChange:e=>N(t=>o(o({},t),{},{company:e.target.value}))}),(0,x.jsx)("textarea",{placeholder:"Notes",value:j.notes,onChange:e=>N(t=>o(o({},t),{},{notes:e.target.value})),rows:"3"}),(0,x.jsxs)("div",{className:"form-actions",children:[(0,x.jsx)("button",{onClick:()=>g(!1),className:"cancel-btn",children:"Cancel"}),(0,x.jsx)("button",{onClick:async()=>{if(j.name.trim())try{const e=await E.addContact(j);e.success?(r(t=>[...t,e.contact]),N({name:"",email:"",phone:"",company:"",notes:""}),g(!1)):alert("Failed to add contact: ".concat(e.errors?e.errors.join(", "):e.error))}catch(e){console.error("Error adding contact:",e),alert("Failed to add contact")}else alert("Please enter a contact name")},className:"save-btn",children:"Add Contact"})]})]})]})}),v&&(0,x.jsx)("div",{className:"add-contact-overlay",children:(0,x.jsxs)("div",{className:"add-contact-modal",children:[(0,x.jsxs)("div",{className:"add-contact-header",children:[(0,x.jsx)("h4",{children:"Edit Contact"}),(0,x.jsx)("button",{onClick:()=>y(null),children:"\xd7"})]}),(0,x.jsxs)("div",{className:"add-contact-form",children:[(0,x.jsx)("input",{type:"text",placeholder:"Full Name *",value:v.name,onChange:e=>y(t=>o(o({},t),{},{name:e.target.value}))}),(0,x.jsx)("input",{type:"email",placeholder:"Email",value:v.email||"",onChange:e=>y(t=>o(o({},t),{},{email:e.target.value}))}),(0,x.jsx)("input",{type:"tel",placeholder:"Phone Number",value:v.phone||"",onChange:e=>y(t=>o(o({},t),{},{phone:e.target.value}))}),(0,x.jsx)("input",{type:"text",placeholder:"Company",value:v.company||"",onChange:e=>y(t=>o(o({},t),{},{company:e.target.value}))}),(0,x.jsx)("textarea",{placeholder:"Notes",value:v.notes||"",onChange:e=>y(t=>o(o({},t),{},{notes:e.target.value})),rows:"3"}),(0,x.jsxs)("div",{className:"form-actions",children:[(0,x.jsx)("button",{onClick:()=>y(null),className:"cancel-btn",children:"Cancel"}),(0,x.jsx)("button",{onClick:async()=>{if(v.name.trim())try{const e=await E.updateContact(v.id,v);e.success?(r(t=>t.map(t=>t.id===e.contact.id?e.contact:t)),y(null)):alert("Failed to update contact: ".concat(e.errors?e.errors.join(", "):e.error))}catch(e){console.error("Error updating contact:",e),alert("Failed to update contact")}else alert("Please enter a contact name")},className:"save-btn",children:"Save Changes"})]})]})]})})]})}):null};const R=new class{constructor(){this.cache=new Map,this.cacheTimeout=3e5}async searchUsers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{limit:n=10,includeCurrentUser:a=!1}=t;if(!e||e.trim().length<2)return{success:!1,error:"Search query must be at least 2 characters long",users:[]};const s=e.trim(),r="search:".concat(s,":").concat(n,":").concat(a);if(this.cache.has(r)){const e=this.cache.get(r);if(Date.now()-e.timestamp<this.cacheTimeout)return e.data;this.cache.delete(r)}try{const e=await l.getTokenForRequest();if(!e)return{success:!1,error:"Authentication required",users:[]};const t=await fetch("/api/users/search?q=".concat(encodeURIComponent(s),"&limit=").concat(n),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){const e=await t.json();return e.success?(this.cache.set(r,{data:{success:!0,users:e.users,query:s,count:e.count},timestamp:Date.now()}),{success:!0,users:e.users,query:s,count:e.count}):{success:!1,error:e.error||"Search failed",users:[]}}return{success:!1,error:(await t.json()).error||"Search request failed",users:[]}}catch(i){return console.error("User search error:",i),{success:!1,error:"Network error during search",users:[]}}}async getUserById(e){try{const t=await l.getTokenForRequest();if(!t)return{success:!1,error:"Authentication required"};const n=await fetch("/api/users/".concat(e),{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(n.ok){return await n.json()}return{success:!1,error:(await n.json()).error||"Failed to get user"}}catch(t){return console.error("Get user error:",t),{success:!1,error:"Network error"}}}clearCache(){this.cache.clear()}getRecentSearches(){try{const e=localStorage.getItem("recentUserSearches");return e?JSON.parse(e):[]}catch(e){return console.error("Error getting recent searches:",e),[]}}addToRecentSearches(e,t){try{const n=this.getRecentSearches(),a={query:e.trim(),user:{id:t.id,name:t.name,username:t.username,avatar:t.avatar},timestamp:Date.now()},s=[a,...n.filter(n=>n.user.id!==t.id&&n.query.toLowerCase()!==e.toLowerCase())].slice(0,10);localStorage.setItem("recentUserSearches",JSON.stringify(s))}catch(n){console.error("Error saving recent search:",n)}}clearRecentSearches(){try{localStorage.removeItem("recentUserSearches")}catch(e){console.error("Error clearing recent searches:",e)}}formatUserForDisplay(e){return{id:e.id,name:e.name||e.username,username:e.username,displayName:e.displayName||e.name,avatar:e.avatar,status:e.status||"offline",bio:e.bio,location:e.location,company:e.company,isOnline:"online"===e.status}}debounce(e,t){let n;return function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...s)},t)}}createDebouncedSearch(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return this.debounce(async function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.trim().length>=2){const s=await t.searchUsers(n,a);e(s)}else e({success:!0,users:[],query:"",count:0})},n)}},z=t=>{let{isOpen:n,onClose:a,onUserSelect:s,searchQuery:r="",onSearchQueryChange:i}=t;const[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(""),[m,p]=(0,e.useState)([]),[f,g]=(0,e.useState)(r),[v,y]=(0,e.useState)(null),b=(0,e.useRef)(null);(0,e.useEffect)(()=>{n&&(p(R.getRecentSearches()),g(r),setTimeout(()=>{b.current&&b.current.focus()},100))},[n,r]);const w=R.createDebouncedSearch(e=>{d(!1),e.success?(l(e.users),h("")):(h(e.error),l([]))},300),S=async e=>{if(v!==e.id)try{y(e.id),f.trim()&&R.addToRecentSearches(f,e),await s(e),a()}catch(u){console.error("Error creating chat:",u)}finally{y(null)}};return n?(0,x.jsx)("div",{className:"user-search-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"user-search-modal",onKeyDown:e=>{"Escape"===e.key&&a()},children:[(0,x.jsxs)("div",{className:"user-search-header",children:[(0,x.jsx)("h3",{children:"\ud83d\udd0d Search Users"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"user-search-content",children:[(0,x.jsx)("div",{className:"search-input-section",children:(0,x.jsxs)("div",{className:"search-input-container",children:[(0,x.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,x.jsx)("input",{ref:b,type:"text",placeholder:"Search users by name, username, or email...",value:f,onChange:e=>{const t=e.target.value;g(t),null===i||void 0===i||i(t),t.trim().length>=2?(d(!0),h(""),w(t)):(l([]),d(!1),h(""))},className:"user-search-input",autoComplete:"off"}),f&&(0,x.jsx)("button",{className:"clear-search-btn",onClick:()=>{g(""),null===i||void 0===i||i(""),l([]),h("")},children:"\xd7"})]})}),c&&(0,x.jsxs)("div",{className:"search-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Searching users..."})]}),u&&(0,x.jsxs)("div",{className:"search-error",children:[(0,x.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)("p",{children:u})]}),!c&&!u&&f.trim().length>=2&&(0,x.jsxs)("div",{className:"search-results",children:[(0,x.jsxs)("div",{className:"results-header",children:[(0,x.jsx)("h4",{children:"Search Results"}),o.length>0&&(0,x.jsxs)("span",{className:"results-count",children:[o.length," user",1!==o.length?"s":""," found"]})]}),o.length>0?(0,x.jsx)("div",{className:"users-list",children:o.map(e=>(0,x.jsxs)("div",{className:"user-item",onClick:()=>S(e),children:[(0,x.jsxs)("div",{className:"user-avatar",children:[e.avatar?(0,x.jsx)("img",{src:e.avatar,alt:e.name,onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,(0,x.jsx)("div",{className:"avatar-fallback",style:{display:e.avatar?"none":"flex"},children:(e.name||e.username||"?").charAt(0).toUpperCase()}),(0,x.jsx)("div",{className:"status-indicator ".concat(e.status||"offline")})]}),(0,x.jsxs)("div",{className:"user-info",children:[(0,x.jsx)("div",{className:"user-name",children:e.name||e.username}),(0,x.jsxs)("div",{className:"user-details",children:[(0,x.jsxs)("span",{className:"username",children:["@",e.username]}),e.bio&&(0,x.jsx)("span",{className:"bio",children:e.bio}),e.location&&(0,x.jsxs)("span",{className:"location",children:["\ud83d\udccd ",e.location]})]})]}),(0,x.jsx)("div",{className:"user-actions",children:(0,x.jsx)("button",{className:"chat-btn ".concat(v===e.id?"loading":""),title:v===e.id?"Creating chat...":"Start Chat",disabled:v===e.id,children:v===e.id?(0,x.jsx)("div",{className:"loading-spinner-small"}):"\ud83d\udcac"})})]},e.id))}):(0,x.jsxs)("div",{className:"no-results",children:[(0,x.jsx)("span",{className:"no-results-icon",children:"\ud83d\udd0d"}),(0,x.jsx)("h4",{children:"No users found"}),(0,x.jsx)("p",{children:"Try searching with different keywords"})]})]}),!c&&!u&&f.trim().length<2&&m.length>0&&(0,x.jsxs)("div",{className:"recent-searches",children:[(0,x.jsxs)("div",{className:"recent-header",children:[(0,x.jsx)("h4",{children:"Recent Searches"}),(0,x.jsx)("button",{className:"clear-recent-btn",onClick:()=>{R.clearRecentSearches(),p([])},children:"Clear All"})]}),(0,x.jsx)("div",{className:"recent-list",children:m.map((e,t)=>(0,x.jsxs)("div",{className:"recent-item",onClick:()=>(async e=>{g(e.query),null===i||void 0===i||i(e.query),await S(e.user)})(e),children:[(0,x.jsx)("div",{className:"recent-avatar",children:e.user.avatar?(0,x.jsx)("img",{src:e.user.avatar,alt:e.user.name}):(0,x.jsx)("div",{className:"avatar-fallback",children:(e.user.name||e.user.username||"?").charAt(0).toUpperCase()})}),(0,x.jsxs)("div",{className:"recent-info",children:[(0,x.jsx)("div",{className:"recent-name",children:e.user.name||e.user.username}),(0,x.jsxs)("div",{className:"recent-query",children:['"',e.query,'"']})]}),(0,x.jsx)("div",{className:"recent-time",children:new Date(e.timestamp).toLocaleDateString()})]},"".concat(e.user.id,"-").concat(t)))})]}),!c&&!u&&f.trim().length<2&&0===m.length&&(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("span",{className:"empty-icon",children:"\ud83d\udc65"}),(0,x.jsx)("h4",{children:"Search for Users"}),(0,x.jsx)("p",{children:"Enter at least 2 characters to search for other users"}),(0,x.jsxs)("div",{className:"search-tips",children:[(0,x.jsx)("h5",{children:"Search Tips:"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:'\ud83d\udd24 Search by name: "John Doe"'}),(0,x.jsx)("li",{children:'\ud83d\udce7 Search by username: "johndoe"'}),(0,x.jsx)("li",{children:'\u2709\ufe0f Search by email: "john@example.com"'})]})]})]})]})]})}):null};const F=new class{constructor(){this.searchHistory=[],this.searchIndex=new Map,this.maxHistoryItems=50,this.loadSearchHistory()}async initIndexedDB(){return new Promise((e,t)=>{const n=indexedDB.open("QuibishSearchDB",1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("searchIndex")){t.createObjectStore("searchIndex",{keyPath:"term"}).createIndex("term","term",{unique:!0})}if(!t.objectStoreNames.contains("searchHistory")){const e=t.createObjectStore("searchHistory",{keyPath:"id",autoIncrement:!0});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("query","query",{unique:!1})}}})}async buildSearchIndex(e){console.log("\ud83d\udd0d Building search index from",e.length,"messages..."),this.searchIndex.clear();for(const n of e){if(!n.text)continue;const e=this.tokenize(n.text);for(const t of e)this.searchIndex.has(t)||this.searchIndex.set(t,[]),this.searchIndex.get(t).push({messageId:n.id,conversationId:n.conversationId,userId:n.userId,timestamp:n.timestamp,text:n.text,type:n.type||"text"})}try{const e=await this.initIndexedDB(),t=e.transaction(["searchIndex"],"readwrite").objectStore("searchIndex");t.clear();for(const[n,a]of this.searchIndex.entries())t.add({term:n,results:a});console.log("\u2705 Search index built with",this.searchIndex.size,"unique terms")}catch(t){console.error("\u274c Failed to save search index to IndexedDB:",t)}}tokenize(e){return e?e.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(e=>e.length>=2).filter(e=>!this.isStopWord(e)):[]}isStopWord(e){return new Set(["the","is","at","which","on","a","an","and","or","but","in","with","to","for","of","as","by","that","this","it"]).has(e)}calculateLevenshteinDistance(e,t){const n=[];for(let a=0;a<=t.length;a++)n[a]=[a];for(let a=0;a<=e.length;a++)n[0][a]=a;for(let a=1;a<=t.length;a++)for(let s=1;s<=e.length;s++)t.charAt(a-1)===e.charAt(s-1)?n[a][s]=n[a-1][s-1]:n[a][s]=Math.min(n[a-1][s-1]+1,n[a][s-1]+1,n[a-1][s]+1);return n[t.length][e.length]}findSimilarTerms(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const n=[];for(const a of this.searchIndex.keys()){const s=this.calculateLevenshteinDistance(e,a);s<=t&&n.push({term:a,distance:s})}return n.sort((e,t)=>e.distance-t.distance)}async search(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{conversationId:n=null,userId:a=null,messageType:s=null,dateFrom:r=null,dateTo:i=null,hasAttachments:l=null,fuzzyMatch:c=!0,limit:d=100,offset:u=0}=t;if(console.log("\ud83d\udd0d Searching for:",e,"with filters:",t),0===this.searchIndex.size){const e=b.getMessages();await this.buildSearchIndex(e)}const h=this.tokenize(e);let m=[];for(const f of h)if(this.searchIndex.has(f)&&m.push(...this.searchIndex.get(f)),c){const e=this.findSimilarTerms(f,2);for(const{term:t}of e)if(this.searchIndex.has(t)){const e=this.searchIndex.get(t).map(e=>o(o({},e),{},{fuzzyMatch:!0,matchedTerm:t}));m.push(...e)}}let p=Array.from(new Map(m.map(e=>[e.messageId,e])).values());if(n&&(p=p.filter(e=>e.conversationId===n)),a&&(p=p.filter(e=>e.userId===a)),s&&(p=p.filter(e=>e.type===s)),r){const e=new Date(r);p=p.filter(t=>new Date(t.timestamp)>=e)}if(i){const e=new Date(i);p=p.filter(t=>new Date(t.timestamp)<=e)}null!==l&&(p=p.filter(e=>{const t=e.attachments&&e.attachments.length>0;return l?t:!t})),p.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)),e.trim().length>0&&this.addToSearchHistory({query:e,filters:t,resultCount:p.length,timestamp:(new Date).toISOString()});return{success:!0,results:p.slice(u,u+d),total:p.length,query:e,filters:t,page:Math.floor(u/d)+1,totalPages:Math.ceil(p.length/d),hasMore:u+d<p.length}}async searchWithHighlights(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this.search(e,t),a=this.tokenize(e);return n.results=n.results.map(e=>o(o({},e),{},{highlightedText:this.highlightText(e.text,a)})),n}highlightText(e,t){let n=e;for(const a of t){const e=new RegExp("\\b(".concat(a,")\\b"),"gi");n=n.replace(e,"<mark>$1</mark>")}return n}async getSearchSuggestions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const n=new Set,a=e.toLowerCase();for(const s of this.searchIndex.keys())if(s.startsWith(a)&&(n.add(s),n.size>=t))break;return this.searchHistory.filter(e=>e.query.toLowerCase().includes(a)).slice(0,t-n.size).map(e=>e.query).forEach(e=>n.add(e)),Array.from(n).slice(0,t)}loadSearchHistory(){try{const e=localStorage.getItem("quibish_search_history");e&&(this.searchHistory=JSON.parse(e))}catch(e){console.error("Failed to load search history:",e),this.searchHistory=[]}}saveSearchHistory(){try{localStorage.setItem("quibish_search_history",JSON.stringify(this.searchHistory))}catch(e){console.error("Failed to save search history:",e)}}addToSearchHistory(e){this.searchHistory=this.searchHistory.filter(t=>t.query!==e.query),this.searchHistory.unshift(e),this.searchHistory.length>this.maxHistoryItems&&(this.searchHistory=this.searchHistory.slice(0,this.maxHistoryItems)),this.saveSearchHistory()}getSearchHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.searchHistory.slice(0,e)}clearSearchHistory(){this.searchHistory=[],this.saveSearchHistory()}async indexMessage(e){if(!e.text)return;const t=this.tokenize(e.text);for(const n of t)this.searchIndex.has(n)||this.searchIndex.set(n,[]),this.searchIndex.get(n).push({messageId:e.id,conversationId:e.conversationId,userId:e.userId,timestamp:e.timestamp,text:e.text,type:e.type||"text"})}async removeFromIndex(e){for(const[t,n]of this.searchIndex.entries()){const a=n.filter(t=>t.messageId!==e);0===a.length?this.searchIndex.delete(t):this.searchIndex.set(t,a)}}getSearchStats(){return{indexedTerms:this.searchIndex.size,totalMessages:Array.from(this.searchIndex.values()).reduce((e,t)=>e+t.length,0),historyCount:this.searchHistory.length,lastSearched:this.searchHistory.length>0?this.searchHistory[0].timestamp:null}}clearSearchIndex(){this.searchIndex.clear(),console.log("\ud83e\uddf9 Search index cleared")}},L=t=>{let{isOpen:n,onClose:a,onResultSelect:s,currentConversationId:r=null}=t;const[i,l]=(0,e.useState)(""),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)([]),[v,y]=(0,e.useState)([]),[b,w]=(0,e.useState)(1),[S,k]=(0,e.useState)(1),[j,N]=(0,e.useState)(0),[C,E]=(0,e.useState)(-1),T=(0,e.useRef)(null),A=(0,e.useRef)(null),[I,M]=(0,e.useState)({conversationId:r,userId:null,messageType:null,dateFrom:null,dateTo:null,hasAttachments:null,fuzzyMatch:!0,limit:20,offset:0});(0,e.useEffect)(()=>{n&&(y(F.getSearchHistory()),setTimeout(()=>{T.current&&T.current.focus()},100))},[n]),(0,e.useEffect)(()=>{if(i.length>=2){const e=setTimeout(async()=>{const e=await F.getSearchSuggestions(i,5);g(e)},300);return()=>clearTimeout(e)}g([])},[i]);const D=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.trim()){h(!0),E(-1);try{const n=o(o({},I),{},{offset:(t-1)*I.limit}),a=await F.searchWithHighlights(e,n);d(a.results),N(a.total),k(a.totalPages),w(t),console.log("\u2705 Found ".concat(a.total,' results for "').concat(e,'"'))}catch(n){console.error("Search failed:",n),d([])}finally{h(!1),g([])}}else d([])},[i,I]),P=(0,e.useCallback)(e=>{null===e||void 0===e||e.preventDefault(),D(i,1)},[i,D]),_=(0,e.useCallback)((e,t)=>{M(n=>o(o({},n),{},{[e]:t}))},[]),R=(0,e.useCallback)(()=>{D(i,1),p(!1)},[i,D]),z=(0,e.useCallback)(()=>{M({conversationId:r,userId:null,messageType:null,dateFrom:null,dateTo:null,hasAttachments:null,fuzzyMatch:!0,limit:20,offset:0})},[r]),L=(0,e.useCallback)(e=>{s&&s(e),a()},[s,a]),O=(0,e.useCallback)(e=>{e>=1&&e<=S&&D(i,e)},[i,S,D]);(0,e.useEffect)(()=>{const e=e=>{if(n)switch(e.key){case"Escape":a();break;case"ArrowDown":e.preventDefault(),E(e=>e<c.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),E(e=>e>0?e-1:-1);break;case"Enter":C>=0&&c[C]&&L(c[C])}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,c,C,a,L]),(0,e.useEffect)(()=>{if(C>=0&&A.current){const e=A.current.children[C];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[C]);const U=(0,e.useCallback)(e=>{l(e),D(e,1)},[D]),B=(0,e.useCallback)(e=>{l(e.query),M(t=>o(o({},t),e.filters)),D(e.query,1)},[D]),H=(0,e.useCallback)(()=>{F.clearSearchHistory(),y([])},[]);return n?(0,x.jsx)("div",{className:"advanced-search-modal-overlay",onClick:a,children:(0,x.jsxs)("div",{className:"advanced-search-modal",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"search-modal-header",children:[(0,x.jsx)("h2",{children:"\ud83d\udd0d Advanced Search"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\u2715"})]}),(0,x.jsxs)("form",{onSubmit:P,className:"search-form",children:[(0,x.jsxs)("div",{className:"search-input-wrapper",children:[(0,x.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,x.jsx)("input",{ref:T,type:"text",className:"search-input",placeholder:"Search messages, conversations, users...",value:i,onChange:e=>l(e.target.value),autoComplete:"off"}),i&&(0,x.jsx)("button",{type:"button",className:"clear-query-btn",onClick:()=>l(""),title:"Clear search",children:"\u2715"})]}),(0,x.jsxs)("div",{className:"search-actions",children:[(0,x.jsx)("button",{type:"submit",className:"search-btn primary",disabled:!i.trim()||u,children:u?"\u23f3 Searching...":"\ud83d\udd0d Search"}),(0,x.jsx)("button",{type:"button",className:"filter-toggle-btn ".concat(m?"active":""),onClick:()=>p(!m),children:"\ud83c\udf9b\ufe0f Filters"})]})]}),f.length>0&&!u&&(0,x.jsxs)("div",{className:"search-suggestions",children:[(0,x.jsx)("div",{className:"suggestions-label",children:"Suggestions:"}),f.map((e,t)=>(0,x.jsx)("button",{className:"suggestion-item",onClick:()=>U(e),children:e},t))]}),m&&(0,x.jsxs)("div",{className:"filters-panel",children:[(0,x.jsxs)("div",{className:"filters-grid",children:[(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{children:"Message Type"}),(0,x.jsxs)("select",{value:I.messageType||"",onChange:e=>_("messageType",e.target.value||null),children:[(0,x.jsx)("option",{value:"",children:"All Types"}),(0,x.jsx)("option",{value:"text",children:"Text"}),(0,x.jsx)("option",{value:"image",children:"Image"}),(0,x.jsx)("option",{value:"video",children:"Video"}),(0,x.jsx)("option",{value:"file",children:"File"}),(0,x.jsx)("option",{value:"voice",children:"Voice"})]})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{children:"From Date"}),(0,x.jsx)("input",{type:"date",value:I.dateFrom||"",onChange:e=>_("dateFrom",e.target.value||null)})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{children:"To Date"}),(0,x.jsx)("input",{type:"date",value:I.dateTo||"",onChange:e=>_("dateTo",e.target.value||null)})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{children:"Attachments"}),(0,x.jsxs)("select",{value:null===I.hasAttachments?"":I.hasAttachments.toString(),onChange:e=>{const t=e.target.value;_("hasAttachments",""===t?null:"true"===t)},children:[(0,x.jsx)("option",{value:"",children:"Any"}),(0,x.jsx)("option",{value:"true",children:"With Attachments"}),(0,x.jsx)("option",{value:"false",children:"Without Attachments"})]})]}),(0,x.jsx)("div",{className:"filter-group checkbox-group",children:(0,x.jsxs)("label",{children:[(0,x.jsx)("input",{type:"checkbox",checked:I.fuzzyMatch,onChange:e=>_("fuzzyMatch",e.target.checked)}),(0,x.jsx)("span",{children:"Enable fuzzy matching (typo tolerance)"})]})}),(0,x.jsx)("div",{className:"filter-group checkbox-group",children:(0,x.jsxs)("label",{children:[(0,x.jsx)("input",{type:"checkbox",checked:!!I.conversationId,onChange:e=>_("conversationId",e.target.checked?r:null)}),(0,x.jsx)("span",{children:"Search only in current conversation"})]})})]}),(0,x.jsxs)("div",{className:"filters-actions",children:[(0,x.jsx)("button",{className:"apply-filters-btn",onClick:R,children:"\u2705 Apply Filters"}),(0,x.jsx)("button",{className:"clear-filters-btn",onClick:z,children:"\ud83e\uddf9 Clear Filters"})]})]}),!i&&v.length>0&&(0,x.jsxs)("div",{className:"search-history",children:[(0,x.jsxs)("div",{className:"history-header",children:[(0,x.jsx)("h3",{children:"Recent Searches"}),(0,x.jsx)("button",{className:"clear-history-btn",onClick:H,children:"Clear"})]}),(0,x.jsx)("div",{className:"history-list",children:v.map((e,t)=>(0,x.jsxs)("div",{className:"history-item",onClick:()=>B(e),children:[(0,x.jsxs)("span",{className:"history-query",children:["\ud83d\udd0d ",e.query]}),(0,x.jsxs)("span",{className:"history-count",children:[e.resultCount," results"]})]},t))})]}),(0,x.jsxs)("div",{className:"search-results-container",children:[u&&(0,x.jsxs)("div",{className:"search-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Searching messages..."})]}),!u&&c.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"results-header",children:[(0,x.jsxs)("span",{className:"results-count",children:["Found ",j," result",1!==j?"s":"",' for "',i,'"']}),(0,x.jsxs)("span",{className:"results-page",children:["Page ",b," of ",S]})]}),(0,x.jsx)("div",{className:"search-results",ref:A,children:c.map((e,t)=>(0,x.jsxs)("div",{className:"search-result-item ".concat(t===C?"selected":""," ").concat(e.fuzzyMatch?"fuzzy-match":""),onClick:()=>L(e),children:[(0,x.jsxs)("div",{className:"result-header",children:[(0,x.jsx)("span",{className:"result-user",children:e.userId||"Unknown User"}),(0,x.jsx)("span",{className:"result-timestamp",children:new Date(e.timestamp).toLocaleString()})]}),(0,x.jsx)("div",{className:"result-text",dangerouslySetInnerHTML:{__html:e.highlightedText||e.text}}),e.fuzzyMatch&&(0,x.jsx)("div",{className:"fuzzy-badge",title:"Matched term: ".concat(e.matchedTerm),children:"~ Fuzzy Match"})]},e.messageId))}),S>1&&(0,x.jsxs)("div",{className:"search-pagination",children:[(0,x.jsx)("button",{className:"page-btn",onClick:()=>O(b-1),disabled:1===b,children:"\u2190 Previous"}),(0,x.jsx)("div",{className:"page-numbers",children:Array.from({length:Math.min(S,5)},(e,t)=>{let n;return n=S<=5||b<=3?t+1:b>=S-2?S-4+t:b-2+t,(0,x.jsx)("button",{className:"page-number ".concat(b===n?"active":""),onClick:()=>O(n),children:n},n)})}),(0,x.jsx)("button",{className:"page-btn",onClick:()=>O(b+1),disabled:b===S,children:"Next \u2192"})]})]}),!u&&i&&0===c.length&&(0,x.jsxs)("div",{className:"no-results",children:[(0,x.jsx)("div",{className:"no-results-icon",children:"\ud83d\udd0d"}),(0,x.jsx)("h3",{children:"No results found"}),(0,x.jsx)("p",{children:"Try different keywords or adjust your filters"})]}),!u&&!i&&0===c.length&&(0,x.jsxs)("div",{className:"search-tips",children:[(0,x.jsx)("h3",{children:"\ud83d\udca1 Search Tips"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Use specific keywords for better results"}),(0,x.jsx)("li",{children:"Enable fuzzy matching to find messages with typos"}),(0,x.jsx)("li",{children:"Use date filters to narrow down your search"}),(0,x.jsx)("li",{children:"Filter by message type (text, image, video, etc.)"}),(0,x.jsx)("li",{children:"Use keyboard shortcuts: \u2191\u2193 to navigate, Enter to select, Esc to close"})]})]})]}),(0,x.jsxs)("div",{className:"search-shortcuts",children:[(0,x.jsxs)("span",{className:"shortcut",children:[(0,x.jsx)("kbd",{children:"\u2191"})," ",(0,x.jsx)("kbd",{children:"\u2193"})," Navigate"]}),(0,x.jsxs)("span",{className:"shortcut",children:[(0,x.jsx)("kbd",{children:"Enter"})," Select"]}),(0,x.jsxs)("span",{className:"shortcut",children:[(0,x.jsx)("kbd",{children:"Esc"})," Close"]}),(0,x.jsxs)("span",{className:"shortcut",children:[(0,x.jsx)("kbd",{children:"Ctrl"})," + ",(0,x.jsx)("kbd",{children:"F"})," Search"]})]})]})}):null};const O=new class{constructor(){this.isInitialized=!1,this.smartReplyCache=new Map,this.translationCache=new Map,this.sentimentCache=new Map,this.replyPatterns={greetings:{patterns:[/\b(hi|hello|hey|good morning|good afternoon|good evening)\b/i],replies:["\ud83d\udc4b Hello! How are you?","Hey there! \ud83d\ude0a","Hi! What's up?","Hello! Nice to hear from you!","Hey! How's it going?"]},questions:{patterns:[/\bhow are you\b/i,/\bhow's it going\b/i,/\bwhat's up\b/i],replies:["I'm doing great, thanks! How about you?","Pretty good! What about you?","All good here! How are things with you?","Doing well! How's your day going?","Great! Thanks for asking! \ud83d\ude0a"]},thanks:{patterns:[/\b(thank you|thanks|thx|appreciate it)\b/i],replies:["You're welcome! \ud83d\ude0a","No problem!","Happy to help!","Anytime!","My pleasure! \ud83d\udc4d"]},agreement:{patterns:[/\b(yes|yeah|yep|sure|okay|ok|sounds good)\b/i],replies:["\ud83d\udc4d Perfect!","Great! \u2728","Awesome! \ud83c\udf89","Cool! \ud83d\ude0e","Sounds good! \ud83d\udc4c"]},disagreement:{patterns:[/\b(no|nope|nah|not really|disagree)\b/i],replies:["I understand.","No worries!","That's okay!","Got it. \ud83d\udc4d","Fair enough!"]},help:{patterns:[/\b(help|need|problem|issue|stuck)\b/i],replies:["I'm here to help! What's the issue?","What do you need help with?","I'd be happy to assist! What's up?","Let me help you with that!","Tell me more about the problem."]},apology:{patterns:[/\b(sorry|apologize|my bad|oops)\b/i],replies:["No worries at all! \ud83d\ude0a","It's all good!","Don't worry about it!","No problem whatsoever!","All is forgiven! \ud83d\udc99"]},meeting:{patterns:[/\b(meet|meeting|call|schedule|appointment)\b/i],replies:["\ud83d\udcc5 When works best for you?","Sure! What time is good?","Let's schedule it! When are you free?","I'm available. What day works?","Great! Let me know your availability."]},goodbye:{patterns:[/\b(bye|goodbye|see you|talk later|ttyl)\b/i],replies:["\ud83d\udc4b See you later!","Goodbye! Take care!","Talk to you soon! \ud83d\ude0a","Bye! Have a great day!","See ya! \ud83d\udc4b"]},excitement:{patterns:[/\b(awesome|amazing|great|fantastic|excellent|wonderful)\b/i],replies:["\ud83c\udf89 That's fantastic!","So happy for you! \u2728","Awesome! \ud83d\ude4c","That's wonderful news!","Incredible! \ud83d\ude04"]}},this.sentimentKeywords={positive:["happy","great","good","excellent","awesome","love","wonderful","fantastic","amazing","perfect","thanks","appreciate"],negative:["bad","terrible","awful","hate","angry","upset","disappointed","sad","sorry","problem","issue","wrong"],neutral:["okay","fine","alright","maybe","perhaps","think","consider","understand"]},this.emojiSuggestions={happy:["\ud83d\ude0a","\ud83d\ude04","\ud83c\udf89","\u2728","\ud83d\udc99","\ud83c\udf1f"],sad:["\ud83d\ude22","\ud83d\ude14","\ud83d\udc94","\ud83d\ude1e","\ud83e\udd7a"],angry:["\ud83d\ude20","\ud83d\ude21","\ud83d\udca2","\ud83e\udd2c"],love:["\u2764\ufe0f","\ud83d\udc95","\ud83d\udc96","\ud83d\ude0d","\ud83e\udd70"],laugh:["\ud83d\ude02","\ud83e\udd23","\ud83d\ude06","\ud83d\ude01"],thinking:["\ud83e\udd14","\ud83d\udcad","\ud83e\uddd0"],celebration:["\ud83c\udf89","\ud83c\udf8a","\ud83e\udd73","\ud83c\udf7e","\u2728"],work:["\ud83d\udcbc","\ud83d\udcca","\ud83d\udcbb","\ud83d\udcdd","\u2705"],food:["\ud83c\udf55","\ud83c\udf54","\ud83c\udf70","\u2615","\ud83c\udf5c"]},this.initialize()}async initialize(){try{console.log("\ud83e\udd16 Initializing AI Service..."),this.capabilities={translation:"Intl"in window,textAnalysis:!0,speechRecognition:"webkitSpeechRecognition"in window||"SpeechRecognition"in window},this.isInitialized=!0,console.log("\u2705 AI Service initialized",this.capabilities)}catch(e){console.error("\u274c Failed to initialize AI Service:",e)}}async generateSmartReplies(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const n="".concat(e,"-").concat(t.length);if(this.smartReplyCache.has(n))return this.smartReplyCache.get(n);const a=[],s=e.text||e,r=s.toLowerCase();for(const[e,t]of Object.entries(this.replyPatterns))for(const n of t.patterns)if(n.test(r)){const n=this.getRandomReplies(t.replies,2);a.push(...n.map(t=>({text:t,category:e,confidence:.8+.2*Math.random()})))}if(t.length>0){const e=this.generateContextualReplies(s,t);a.push(...e)}const i=this.suggestEmoji(s);i&&a.push(i);const o=this.deduplicateReplies(a).sort((e,t)=>t.confidence-e.confidence).slice(0,6);return this.smartReplyCache.set(n,o),o}catch(n){return console.error("Failed to generate smart replies:",n),[]}}generateContextualReplies(e,t){const n=[];return e.includes("?")&&n.push({text:"Yes, absolutely! \u2705",category:"contextual",confidence:.75},{text:"No, not really.",category:"contextual",confidence:.75},{text:"Let me think about it \ud83e\udd14",category:"contextual",confidence:.7}),/\b(when|time|date|schedule)\b/i.test(e)&&n.push({text:"How about tomorrow?",category:"contextual",confidence:.8},{text:"I'm free this week!",category:"contextual",confidence:.8}),/\b(confirm|verify|check|make sure)\b/i.test(e)&&n.push({text:"Confirmed! \u2705",category:"contextual",confidence:.85},{text:"Yes, I can confirm that.",category:"contextual",confidence:.85}),n}suggestEmoji(e){const t=e.toLowerCase();if(/\b(happy|joy|great|awesome|love|wonderful)\b/i.test(t)){return{text:this.emojiSuggestions.happy[0],category:"emoji",confidence:.7,isEmoji:!0}}if(/\b(haha|lol|funny|hilarious)\b/i.test(t)){return{text:this.emojiSuggestions.laugh[0],category:"emoji",confidence:.7,isEmoji:!0}}if(/\b(think|wonder|consider|maybe)\b/i.test(t)){return{text:this.emojiSuggestions.thinking[0],category:"emoji",confidence:.65,isEmoji:!0}}if(/\b(celebrate|party|congrats|yay)\b/i.test(t)){return{text:this.emojiSuggestions.celebration[0],category:"emoji",confidence:.75,isEmoji:!0}}return null}async analyzeSentiment(e){try{const t=e.text||e,n=t.toLowerCase().split(/\s+/);let a=0,s=0,r=0;n.forEach(e=>{this.sentimentKeywords.positive.some(t=>e.includes(t))&&a++,this.sentimentKeywords.negative.some(t=>e.includes(t))&&s++,this.sentimentKeywords.neutral.some(t=>e.includes(t))&&r++}),/!+/.test(t)&&(a+=.5),/\?{2,}/.test(t)&&(r+=.5),/\.{3,}/.test(t)&&(r+=.5);const i=t.match(/(?:\uD83D[\uDE00-\uDE4F])/g)||[];i.length>0&&(a+=.3*i.length);const o=a+s+r||1;return{positive:a/o,negative:s/o,neutral:r/o,overall:a>s?"positive":s>a?"negative":"neutral",confidence:Math.max(a,s,r)/o,score:(a-s)/o}}catch(t){return console.error("Failed to analyze sentiment:",t),{positive:.33,negative:.33,neutral:.34,overall:"neutral",confidence:.5,score:0}}}async translateMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";try{const a="".concat(e,"-").concat(n,"-").concat(t);if(this.translationCache.has(a))return this.translationCache.get(a);const s={text:e,sourceLanguage:"auto"===n?this.detectLanguage(e):n,targetLanguage:t,confidence:.85,translatedText:await this.mockTranslate(e,t)};return this.translationCache.set(a,s),s}catch(a){return console.error("Translation failed:",a),{text:e,sourceLanguage:"unknown",targetLanguage:t,confidence:0,translatedText:e,error:a.message}}}async mockTranslate(e,t){const n=e.toLowerCase(),a={es:{hello:"hola",goodbye:"adi\xf3s",thanks:"gracias"},fr:{hello:"bonjour",goodbye:"au revoir",thanks:"merci"},de:{hello:"hallo",goodbye:"auf wiedersehen",thanks:"danke"},it:{hello:"ciao",goodbye:"arrivederci",thanks:"grazie"},pt:{hello:"ol\xe1",goodbye:"tchau",thanks:"obrigado"},ja:{hello:"\u3053\u3093\u306b\u3061\u306f",goodbye:"\u3055\u3088\u3046\u306a\u3089",thanks:"\u3042\u308a\u304c\u3068\u3046"},zh:{hello:"\u4f60\u597d",goodbye:"\u518d\u89c1",thanks:"\u8c22\u8c22"}}[t];if(a){if(n.includes("hello")||n.includes("hi"))return a.hello;if(n.includes("bye")||n.includes("goodbye"))return a.goodbye;if(n.includes("thank"))return a.thanks}return"[".concat(t,"] ").concat(e)}detectLanguage(e){return/[\u4e00-\u9fa5]/.test(e)?"zh":/[\u3040-\u309f\u30a0-\u30ff]/.test(e)?"ja":/[\u0600-\u06ff]/.test(e)?"ar":/[\u0400-\u04ff]/.test(e)?"ru":/[\u0e00-\u0e7f]/.test(e)?"th":"en"}async enhanceMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{tone:n="neutral",fixGrammar:a=!0,addEmoji:s=!1}=t;try{let t=e;if(a&&(t=this.fixCommonGrammar(t)),t=this.adjustTone(t,n),s){const e=this.getSuggestedEmojiForTone(n);e&&(t+=" ".concat(e))}return{original:e,enhanced:t,changes:this.getChanges(e,t),tone:n}}catch(r){return console.error("Failed to enhance message:",r),{original:e,enhanced:e,changes:[],tone:n,error:r.message}}}fixCommonGrammar(e){let t=e;t=t.charAt(0).toUpperCase()+t.slice(1);return Object.entries({teh:"the",recieve:"receive",definately:"definitely",seperate:"separate",occured:"occurred",untill:"until",wierd:"weird"}).forEach(e=>{let[n,a]=e;const s=new RegExp("\\b".concat(n,"\\b"),"gi");t=t.replace(s,a)}),/[.!?]$/.test(t)||(t+="."),t}adjustTone(e,t){switch(t){case"professional":return e.replace(/\b(hey|hi)\b/gi,"Hello").replace(/\b(yeah|yep)\b/gi,"Yes").replace(/\b(nope|nah)\b/gi,"No").replace(/\b(gonna)\b/gi,"going to").replace(/\b(wanna)\b/gi,"want to");case"casual":return e.replace(/\bHello\b/g,"Hey").replace(/\bYes\b/g,"Yeah").replace(/\bNo\b/g,"Nope");case"friendly":return e.includes("!")||(e=e.replace(/\.$/,"!")),e;case"formal":return e.replace(/!/g,".").replace(/\b(hi|hey)\b/gi,"Greetings").replace(/\b(thanks)\b/gi,"Thank you");default:return e}}getSuggestedEmojiForTone(e){return{casual:"\ud83d\ude0a",professional:"\ud83d\udce7",friendly:"\ud83c\udf1f",formal:"",happy:"\ud83d\ude04",excited:"\ud83c\udf89"}[e]||""}getChanges(e,t){const n=[];return e!==t&&n.push({type:"text",from:e,to:t}),n}getRandomReplies(e,t){return[...e].sort(()=>Math.random()-.5).slice(0,t)}deduplicateReplies(e){const t=new Set;return e.filter(e=>{const n=e.text.toLowerCase();return!t.has(n)&&(t.add(n),!0)})}async autoComplete(e){const t=[],n=e.toLowerCase();return n.startsWith("how ")?t.push("How are you?","How can I help?","How about tomorrow?"):n.startsWith("what ")?t.push("What do you think?","What time works?","What about later?"):n.startsWith("can ")&&t.push("Can we schedule a call?","Can you help me?","Can we meet?"),t.slice(0,3)}clearCaches(){this.smartReplyCache.clear(),this.translationCache.clear(),this.sentimentCache.clear()}getStats(){return{initialized:this.isInitialized,capabilities:this.capabilities,cacheSize:{smartReplies:this.smartReplyCache.size,translations:this.translationCache.size,sentiment:this.sentimentCache.size}}}},U=t=>{let{lastMessage:n,conversationHistory:a=[],onReplySelect:s,onClose:r,isVisible:i=!1}=t;const[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(null);(0,e.useEffect)(()=>{n&&i&&(m(),p())},[n,i]);const m=(0,e.useCallback)(async()=>{if(n){d(!0);try{const e=await O.generateSmartReplies(n,a);l(e)}catch(e){console.error("Failed to generate smart replies:",e),l([])}finally{d(!1)}}},[n,a]),p=(0,e.useCallback)(async()=>{if(n)try{const e=await O.analyzeSentiment(n);h(e)}catch(e){console.error("Failed to analyze sentiment:",e)}},[n]);return i?(0,x.jsxs)("div",{className:"smart-replies-panel",children:[(0,x.jsxs)("div",{className:"smart-replies-header",children:[(0,x.jsxs)("div",{className:"header-left",children:[(0,x.jsx)("span",{className:"ai-icon",children:"\ud83e\udd16"}),(0,x.jsx)("h4",{children:"Smart Replies"})]}),u&&(0,x.jsxs)("div",{className:"sentiment-indicator",style:{color:u?"positive"===u.overall?"#10b981":"negative"===u.overall?"#ef4444":"#6b7280":"#9ca3af"},children:[(0,x.jsx)("span",{className:"sentiment-emoji",children:u?"positive"===u.overall?"\ud83d\ude0a":"negative"===u.overall?"\ud83d\ude1f":"\ud83d\ude10":"\ud83d\ude10"}),(0,x.jsx)("span",{className:"sentiment-label",children:u.overall})]})]}),c&&(0,x.jsxs)("div",{className:"smart-replies-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Generating suggestions..."})]}),!c&&o.length>0&&(0,x.jsx)("div",{className:"smart-replies-list",children:o.map((e,t)=>(0,x.jsxs)("button",{className:"smart-reply-btn ".concat(e.isEmoji?"emoji-reply":""),onClick:()=>(e=>{s&&s(e.text)})(e),title:"".concat(Math.round(100*e.confidence),"% confidence"),children:[(0,x.jsx)("span",{className:"reply-text",children:e.text}),e.confidence>.8&&!e.isEmoji&&(0,x.jsx)("span",{className:"confidence-badge",children:"\u2728"}),e.category&&!e.isEmoji&&(0,x.jsx)("span",{className:"category-tag",children:e.category})]},t))}),!c&&0===o.length&&(0,x.jsxs)("div",{className:"smart-replies-empty",children:[(0,x.jsx)("span",{className:"empty-icon",children:"\ud83d\udcad"}),(0,x.jsx)("p",{children:"No suggestions available"})]}),(0,x.jsxs)("div",{className:"smart-replies-footer",children:[(0,x.jsx)("button",{className:"refresh-btn",onClick:m,children:"\ud83d\udd04 Refresh"}),(0,x.jsx)("span",{className:"ai-powered",children:"Powered by AI"})]})]}):null},B=t=>{let{message:n,onTranslate:a,onEnhance:s,onClose:r,isVisible:i=!1}=t;const[o,l]=(0,e.useState)("translate"),[c,d]=(0,e.useState)("es"),[u,h]=(0,e.useState)("professional"),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(null);return i?(0,x.jsxs)("div",{className:"ai-enhancement-panel",children:[(0,x.jsxs)("div",{className:"enhancement-header",children:[(0,x.jsx)("h4",{children:"\ud83e\udd16 AI Enhancement"}),(0,x.jsx)("button",{className:"close-btn",onClick:r,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"enhancement-tabs",children:[(0,x.jsx)("button",{className:"tab-btn ".concat("translate"===o?"active":""),onClick:()=>l("translate"),children:"\ud83c\udf10 Translate"}),(0,x.jsx)("button",{className:"tab-btn ".concat("enhance"===o?"active":""),onClick:()=>l("enhance"),children:"\u2728 Enhance"})]}),(0,x.jsxs)("div",{className:"original-message",children:[(0,x.jsx)("div",{className:"message-label",children:"Original:"}),(0,x.jsx)("div",{className:"message-text",children:(null===n||void 0===n?void 0:n.text)||n})]}),"translate"===o&&(0,x.jsxs)("div",{className:"translate-content",children:[(0,x.jsxs)("div",{className:"language-selector",children:[(0,x.jsx)("label",{children:"Target Language:"}),(0,x.jsx)("div",{className:"language-grid",children:[{code:"es",name:"Spanish",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"fr",name:"French",flag:"\ud83c\uddeb\ud83c\uddf7"},{code:"de",name:"German",flag:"\ud83c\udde9\ud83c\uddea"},{code:"it",name:"Italian",flag:"\ud83c\uddee\ud83c\uddf9"},{code:"pt",name:"Portuguese",flag:"\ud83c\uddf5\ud83c\uddf9"},{code:"ja",name:"Japanese",flag:"\ud83c\uddef\ud83c\uddf5"},{code:"zh",name:"Chinese",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"ko",name:"Korean",flag:"\ud83c\uddf0\ud83c\uddf7"},{code:"ar",name:"Arabic",flag:"\ud83c\uddf8\ud83c\udde6"},{code:"ru",name:"Russian",flag:"\ud83c\uddf7\ud83c\uddfa"}].map(e=>(0,x.jsxs)("button",{className:"language-btn ".concat(c===e.code?"active":""),onClick:()=>d(e.code),children:[(0,x.jsx)("span",{className:"flag",children:e.flag}),(0,x.jsx)("span",{className:"lang-name",children:e.name})]},e.code))})]}),(0,x.jsx)("button",{className:"action-btn translate-btn",onClick:async()=>{if(n){p(!0);try{const e=n.text||n,t=await O.translateMessage(e,c);g(t),a&&a(t)}catch(e){console.error("Translation failed:",e)}finally{p(!1)}}},disabled:m,children:m?"\u23f3 Translating...":"\ud83c\udf10 Translate Now"})]}),"enhance"===o&&(0,x.jsxs)("div",{className:"enhance-content",children:[(0,x.jsxs)("div",{className:"tone-selector",children:[(0,x.jsx)("label",{children:"Select Tone:"}),(0,x.jsx)("div",{className:"tone-grid",children:[{value:"professional",label:"Professional",icon:"\ud83d\udcbc"},{value:"casual",label:"Casual",icon:"\ud83d\ude0a"},{value:"friendly",label:"Friendly",icon:"\ud83c\udf1f"},{value:"formal",label:"Formal",icon:"\ud83c\udfa9"}].map(e=>(0,x.jsxs)("button",{className:"tone-btn ".concat(u===e.value?"active":""),onClick:()=>h(e.value),children:[(0,x.jsx)("span",{className:"tone-icon",children:e.icon}),(0,x.jsx)("span",{className:"tone-label",children:e.label})]},e.value))})]}),(0,x.jsxs)("div",{className:"enhancement-options",children:[(0,x.jsxs)("label",{className:"checkbox-label",children:[(0,x.jsx)("input",{type:"checkbox",defaultChecked:!0}),(0,x.jsx)("span",{children:"Fix grammar & spelling"})]}),(0,x.jsxs)("label",{className:"checkbox-label",children:[(0,x.jsx)("input",{type:"checkbox",defaultChecked:!0}),(0,x.jsx)("span",{children:"Add appropriate emoji"})]})]}),(0,x.jsx)("button",{className:"action-btn enhance-btn",onClick:async()=>{if(n){p(!0);try{const e=n.text||n,t=await O.enhanceMessage(e,{tone:u,fixGrammar:!0,addEmoji:!0});g(t),s&&s(t)}catch(e){console.error("Enhancement failed:",e)}finally{p(!1)}}},disabled:m,children:m?"\u23f3 Enhancing...":"\u2728 Enhance Message"})]}),f&&(0,x.jsxs)("div",{className:"result-section",children:[(0,x.jsxs)("div",{className:"result-header",children:[(0,x.jsx)("span",{className:"result-label",children:"translate"===o?"\ud83c\udf10 Translation:":"\u2728 Enhanced:"}),(0,x.jsx)("button",{className:"copy-btn",onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),alert("Copied to clipboard!")}catch(t){console.error("Failed to copy:",t)}})("translate"===o?f.translatedText:f.enhanced),children:"\ud83d\udccb Copy"})]}),(0,x.jsx)("div",{className:"result-text",children:"translate"===o?f.translatedText:f.enhanced}),"translate"===o&&f.confidence&&(0,x.jsxs)("div",{className:"result-meta",children:[(0,x.jsxs)("span",{className:"confidence-badge",children:["Confidence: ",Math.round(100*f.confidence),"%"]}),(0,x.jsxs)("span",{className:"lang-badge",children:[f.sourceLanguage," \u2192 ",f.targetLanguage]})]}),"enhance"===o&&f.changes&&f.changes.length>0&&(0,x.jsxs)("div",{className:"result-meta",children:[(0,x.jsxs)("span",{className:"changes-badge",children:[f.changes.length," change",1!==f.changes.length?"s":""," made"]}),(0,x.jsxs)("span",{className:"tone-badge",children:["Tone: ",f.tone]})]})]}),(0,x.jsx)("div",{className:"enhancement-footer",children:(0,x.jsx)("span",{className:"ai-notice",children:"\u26a1 Powered by AI \u2022 Results may vary"})})]}):null},H=t=>{let{isOpen:n,onClose:a,onCall:s,initialNumber:r=""}=t;const[i,o]=(0,e.useState)(r),[l,c]=(0,e.useState)("US"),[d,u]=(0,e.useState)(""),[h,m]=(0,e.useState)(!1),[p,f]=(0,e.useState)([]),[g,v]=(0,e.useState)(!1),y=[{code:"US",name:"United States",dialCode:"+1",flag:"\ud83c\uddfa\ud83c\uddf8"},{code:"CA",name:"Canada",dialCode:"+1",flag:"\ud83c\udde8\ud83c\udde6"},{code:"GB",name:"United Kingdom",dialCode:"+44",flag:"\ud83c\uddec\ud83c\udde7"},{code:"DE",name:"Germany",dialCode:"+49",flag:"\ud83c\udde9\ud83c\uddea"},{code:"FR",name:"France",dialCode:"+33",flag:"\ud83c\uddeb\ud83c\uddf7"},{code:"IT",name:"Italy",dialCode:"+39",flag:"\ud83c\uddee\ud83c\uddf9"},{code:"ES",name:"Spain",dialCode:"+34",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"NL",name:"Netherlands",dialCode:"+31",flag:"\ud83c\uddf3\ud83c\uddf1"},{code:"AU",name:"Australia",dialCode:"+61",flag:"\ud83c\udde6\ud83c\uddfa"},{code:"JP",name:"Japan",dialCode:"+81",flag:"\ud83c\uddef\ud83c\uddf5"},{code:"KR",name:"South Korea",dialCode:"+82",flag:"\ud83c\uddf0\ud83c\uddf7"},{code:"CN",name:"China",dialCode:"+86",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"IN",name:"India",dialCode:"+91",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"BR",name:"Brazil",dialCode:"+55",flag:"\ud83c\udde7\ud83c\uddf7"},{code:"MX",name:"Mexico",dialCode:"+52",flag:"\ud83c\uddf2\ud83c\uddfd"},{code:"RU",name:"Russia",dialCode:"+7",flag:"\ud83c\uddf7\ud83c\uddfa"},{code:"ZA",name:"South Africa",dialCode:"+27",flag:"\ud83c\uddff\ud83c\udde6"},{code:"EG",name:"Egypt",dialCode:"+20",flag:"\ud83c\uddea\ud83c\uddec"},{code:"NG",name:"Nigeria",dialCode:"+234",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"KE",name:"Kenya",dialCode:"+254",flag:"\ud83c\uddf0\ud83c\uddea"},{code:"SG",name:"Singapore",dialCode:"+65",flag:"\ud83c\uddf8\ud83c\uddec"},{code:"TH",name:"Thailand",dialCode:"+66",flag:"\ud83c\uddf9\ud83c\uddad"},{code:"VN",name:"Vietnam",dialCode:"+84",flag:"\ud83c\uddfb\ud83c\uddf3"},{code:"PH",name:"Philippines",dialCode:"+63",flag:"\ud83c\uddf5\ud83c\uddad"},{code:"ID",name:"Indonesia",dialCode:"+62",flag:"\ud83c\uddee\ud83c\udde9"},{code:"MY",name:"Malaysia",dialCode:"+60",flag:"\ud83c\uddf2\ud83c\uddfe"},{code:"PK",name:"Pakistan",dialCode:"+92",flag:"\ud83c\uddf5\ud83c\uddf0"},{code:"BD",name:"Bangladesh",dialCode:"+880",flag:"\ud83c\udde7\ud83c\udde9"},{code:"LK",name:"Sri Lanka",dialCode:"+94",flag:"\ud83c\uddf1\ud83c\uddf0"},{code:"AE",name:"UAE",dialCode:"+971",flag:"\ud83c\udde6\ud83c\uddea"},{code:"SA",name:"Saudi Arabia",dialCode:"+966",flag:"\ud83c\uddf8\ud83c\udde6"},{code:"TR",name:"Turkey",dialCode:"+90",flag:"\ud83c\uddf9\ud83c\uddf7"},{code:"IL",name:"Israel",dialCode:"+972",flag:"\ud83c\uddee\ud83c\uddf1"},{code:"AR",name:"Argentina",dialCode:"+54",flag:"\ud83c\udde6\ud83c\uddf7"},{code:"CL",name:"Chile",dialCode:"+56",flag:"\ud83c\udde8\ud83c\uddf1"},{code:"CO",name:"Colombia",dialCode:"+57",flag:"\ud83c\udde8\ud83c\uddf4"},{code:"PE",name:"Peru",dialCode:"+51",flag:"\ud83c\uddf5\ud83c\uddea"}];(0,e.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("international_call_history")||"[]");f(e)},[]);const b=y.find(e=>e.code===l)||y[0],w=y.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.dialCode.includes(d)||e.code.toLowerCase().includes(d.toLowerCase())),S=e=>{o(t=>t+e)},k=()=>i.length>=3;return n?(0,x.jsx)("div",{className:"dialer-overlay",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,x.jsxs)("div",{className:"dialer-modal",children:[(0,x.jsxs)("div",{className:"dialer-header",children:[(0,x.jsx)("h3",{children:"\ud83c\udf0d International Dialer"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"dialer-content",children:[(0,x.jsxs)("div",{className:"country-selector",children:[(0,x.jsxs)("button",{className:"country-btn",onClick:()=>m(!h),children:[(0,x.jsx)("span",{className:"country-flag",children:b.flag}),(0,x.jsxs)("span",{className:"country-info",children:[(0,x.jsx)("span",{className:"country-name",children:b.name}),(0,x.jsx)("span",{className:"country-code",children:b.dialCode})]}),(0,x.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),h&&(0,x.jsxs)("div",{className:"country-dropdown",children:[(0,x.jsx)("div",{className:"country-search",children:(0,x.jsx)("input",{type:"text",placeholder:"Search countries...",value:d,onChange:e=>u(e.target.value),className:"country-search-input"})}),(0,x.jsx)("div",{className:"country-list",children:w.map(e=>(0,x.jsxs)("button",{className:"country-item",onClick:()=>(e=>{c(e.code),m(!1),u("")})(e),children:[(0,x.jsx)("span",{className:"country-flag",children:e.flag}),(0,x.jsxs)("span",{className:"country-details",children:[(0,x.jsx)("span",{className:"country-name",children:e.name}),(0,x.jsx)("span",{className:"country-code",children:e.dialCode})]})]},e.code))})]})]}),(0,x.jsxs)("div",{className:"number-display",children:[(0,x.jsx)("input",{type:"text",value:(j=i,N=b,j?"".concat(N.dialCode," ").concat(j):N.dialCode),readOnly:!0,className:"number-input",placeholder:"".concat(b.dialCode," Enter number")}),(0,x.jsxs)("div",{className:"display-actions",children:[i&&(0,x.jsx)("button",{className:"clear-btn",onClick:()=>{o("")},children:"\ud83d\uddd1\ufe0f"}),(0,x.jsx)("button",{className:"history-btn",onClick:()=>v(!g),title:"Call History",children:"\ud83d\udd70\ufe0f"})]})]}),g&&p.length>0&&(0,x.jsxs)("div",{className:"call-history",children:[(0,x.jsx)("h4",{children:"Recent Calls"}),(0,x.jsx)("div",{className:"history-list",children:p.slice(0,5).map(e=>(0,x.jsxs)("button",{className:"history-item",onClick:()=>{return c((t=e).country.code),o(t.localNumber),void v(!1);var t},children:[(0,x.jsx)("span",{className:"history-flag",children:e.country.flag}),(0,x.jsx)("span",{className:"history-number",children:e.number}),(0,x.jsx)("span",{className:"history-time",children:new Date(e.timestamp).toLocaleDateString()})]},e.id))})]}),(0,x.jsxs)("div",{className:"number-pad",children:[(0,x.jsxs)("div",{className:"pad-row",children:[(0,x.jsx)("button",{onClick:()=>S("1"),children:"1"}),(0,x.jsxs)("button",{onClick:()=>S("2"),children:["2",(0,x.jsx)("span",{children:"ABC"})]}),(0,x.jsxs)("button",{onClick:()=>S("3"),children:["3",(0,x.jsx)("span",{children:"DEF"})]})]}),(0,x.jsxs)("div",{className:"pad-row",children:[(0,x.jsxs)("button",{onClick:()=>S("4"),children:["4",(0,x.jsx)("span",{children:"GHI"})]}),(0,x.jsxs)("button",{onClick:()=>S("5"),children:["5",(0,x.jsx)("span",{children:"JKL"})]}),(0,x.jsxs)("button",{onClick:()=>S("6"),children:["6",(0,x.jsx)("span",{children:"MNO"})]})]}),(0,x.jsxs)("div",{className:"pad-row",children:[(0,x.jsxs)("button",{onClick:()=>S("7"),children:["7",(0,x.jsx)("span",{children:"PQRS"})]}),(0,x.jsxs)("button",{onClick:()=>S("8"),children:["8",(0,x.jsx)("span",{children:"TUV"})]}),(0,x.jsxs)("button",{onClick:()=>S("9"),children:["9",(0,x.jsx)("span",{children:"WXYZ"})]})]}),(0,x.jsxs)("div",{className:"pad-row",children:[(0,x.jsx)("button",{onClick:()=>S("*"),children:"*"}),(0,x.jsxs)("button",{onClick:()=>S("0"),children:["0",(0,x.jsx)("span",{children:"+"})]}),(0,x.jsx)("button",{onClick:()=>S("#"),children:"#"})]})]}),(0,x.jsxs)("div",{className:"dialer-actions",children:[(0,x.jsx)("button",{className:"backspace-btn",onClick:()=>{o(e=>e.slice(0,-1))},disabled:!i,children:"\u232b"}),(0,x.jsx)("button",{className:"call-btn ".concat(k()?"enabled":"disabled"),onClick:()=>{if(!k())return void alert("Please enter a valid phone number");const e="".concat(b.dialCode).concat(i),t=[{id:Date.now(),number:e,country:b,localNumber:i,timestamp:(new Date).toISOString(),type:"outgoing"},...p.slice(0,49)];f(t),localStorage.setItem("international_call_history",JSON.stringify(t)),s&&s({number:e,country:b,localNumber:i}),a()},disabled:!k(),children:"\ud83d\udcde Call"})]})]})]})}):null;var j,N};const q=new class{constructor(){this.threads=new Map,this.messageToThread=new Map,this.listeners={onThreadCreated:[],onReplyAdded:[],onThreadUpdated:[],onThreadDeleted:[]},this.initialized=!1,console.log("\ud83d\udcac Message Thread Service created")}async initialize(){try{return console.log("\ud83d\udd04 Initializing Message Thread Service..."),await this.loadThreadsFromStorage(),this.initialized=!0,console.log("\u2705 Message Thread Service initialized"),!0}catch(e){return console.error("\u274c Failed to initialize thread service:",e),!1}}createThread(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const a=e.id;if(!this.threads.has(a)){const t=o({id:a,parentMessage:e,replies:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),replyCount:0,participants:new Set([e.user.id]),isCollapsed:!1},n);this.threads.set(a,t),console.log("\ud83d\udcdd Created new thread:",a)}return this.addReply(a,t),this.emit("onThreadCreated",{threadId:a,thread:this.threads.get(a)}),this.threads.get(a)}catch(a){return console.error("\u274c Failed to create thread:",a),null}}addReply(e,t){try{const n=this.threads.get(e);if(!n)return console.warn("\u26a0\ufe0f Thread not found:",e),!1;const a=o(o({},t),{},{threadId:e,replyTo:e,depth:this.calculateReplyDepth(e,t.id),createdAt:t.timestamp||(new Date).toISOString()});return n.replies.push(a),n.replyCount=n.replies.length,n.updatedAt=(new Date).toISOString(),n.participants.add(t.user.id),this.messageToThread.set(t.id,e),this.saveThreadToStorage(n),this.emit("onReplyAdded",{threadId:e,reply:a,thread:n}),console.log("\ud83d\udcac Added reply to thread:",e,"Reply count:",n.replyCount),!0}catch(n){return console.error("\u274c Failed to add reply:",n),!1}}calculateReplyDepth(e,t){return 1}getThread(e){if(this.threads.has(e))return this.threads.get(e);const t=this.messageToThread.get(e);return t?this.threads.get(t):null}getAllThreads(){return Array.from(this.threads.values()).sort((e,t)=>new Date(t.updatedAt)-new Date(e.updatedAt))}getThreadsForConversation(e){return this.getAllThreads().filter(t=>t.parentMessage.conversationId===e)}getReplies(e){const t=this.threads.get(e);return t?t.replies:[]}toggleThreadCollapse(e){const t=this.threads.get(e);return!!t&&(t.isCollapsed=!t.isCollapsed,this.emit("onThreadUpdated",{threadId:e,thread:t}),t.isCollapsed)}deleteThread(e){try{const t=this.threads.get(e);return!!t&&(t.replies.forEach(e=>{this.messageToThread.delete(e.id)}),this.threads.delete(e),this.removeThreadFromStorage(e),this.emit("onThreadDeleted",{threadId:e}),console.log("\ud83d\uddd1\ufe0f Deleted thread:",e),!0)}catch(t){return console.error("\u274c Failed to delete thread:",t),!1}}deleteReply(e,t){try{const n=this.threads.get(e);if(!n)return!1;const a=n.replies.findIndex(e=>e.id===t);return a>-1&&(n.replies.splice(a,1),n.replyCount=n.replies.length,n.updatedAt=(new Date).toISOString(),this.messageToThread.delete(t),this.saveThreadToStorage(n),this.emit("onThreadUpdated",{threadId:e,thread:n}),console.log("\ud83d\uddd1\ufe0f Deleted reply from thread:",e),!0)}catch(n){return console.error("\u274c Failed to delete reply:",n),!1}}isInThread(e){return this.threads.has(e)||this.messageToThread.has(e)}hasReplies(e){const t=this.threads.get(e);return t&&t.replies.length>0}getReplyCount(e){const t=this.threads.get(e);return t?t.replyCount:0}getThreadParticipants(e){const t=this.threads.get(e);return t?Array.from(t.participants):[]}searchThreads(e){const t=e.toLowerCase();return this.getAllThreads().filter(e=>!!e.parentMessage.text.toLowerCase().includes(t)||e.replies.some(e=>e.text.toLowerCase().includes(t)))}getThreadStats(e){var t,n;const a=this.threads.get(e);return a?{replyCount:a.replyCount,participantCount:a.participants.size,firstReplyAt:null===(t=a.replies[0])||void 0===t?void 0:t.createdAt,lastReplyAt:null===(n=a.replies[a.replies.length-1])||void 0===n?void 0:n.createdAt,isActive:this.isThreadActive(a)}:null}isThreadActive(e){if(!e.updatedAt)return!1;const t=new Date(e.updatedAt);return(new Date-t)/36e5<24}async loadThreadsFromStorage(){try{const e=(await this.openDatabase()).transaction(["threads"],"readonly"),t=e.objectStore("threads").getAll();return new Promise((e,n)=>{t.onsuccess=()=>{const n=t.result;n.forEach(e=>{e.participants=new Set(e.participants),this.threads.set(e.id,e),e.replies.forEach(t=>{this.messageToThread.set(t.id,e.id)})}),console.log("\ud83d\udcda Loaded ".concat(n.length," threads from storage")),e()},t.onerror=()=>{console.error("\u274c Failed to load threads:",t.error),n(t.error)}})}catch(e){console.error("\u274c Error loading threads:",e)}}async saveThreadToStorage(e){try{const t=(await this.openDatabase()).transaction(["threads"],"readwrite"),n=t.objectStore("threads"),a=o(o({},e),{},{participants:Array.from(e.participants)});return n.put(a),new Promise((e,n)=>{t.oncomplete=()=>e(),t.onerror=()=>n(t.error)})}catch(t){console.error("\u274c Error saving thread:",t)}}async removeThreadFromStorage(e){try{const t=(await this.openDatabase()).transaction(["threads"],"readwrite");return t.objectStore("threads").delete(e),new Promise((e,n)=>{t.oncomplete=()=>e(),t.onerror=()=>n(t.error)})}catch(t){console.error("\u274c Error removing thread:",t)}}async openDatabase(){return new Promise((e,t)=>{const n=indexedDB.open("QuibishThreads",1);n.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("threads")){const e=t.createObjectStore("threads",{keyPath:"id"});e.createIndex("conversationId","parentMessage.conversationId",{unique:!1}),e.createIndex("updatedAt","updatedAt",{unique:!1})}},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})}async clearAllThreads(){try{this.threads.clear(),this.messageToThread.clear();const e=(await this.openDatabase()).transaction(["threads"],"readwrite");return e.objectStore("threads").clear(),console.log("\ud83d\uddd1\ufe0f Cleared all threads"),!0}catch(e){return console.error("\u274c Error clearing threads:",e),!1}}exportThreads(){return this.getAllThreads().map(e=>o(o({},e),{},{participants:Array.from(e.participants)}))}async importThreads(e){try{for(const t of e)t.participants=new Set(t.participants),this.threads.set(t.id,t),t.replies.forEach(e=>{this.messageToThread.set(e.id,t.id)}),await this.saveThreadToStorage(t);return console.log("\ud83d\udce5 Imported ".concat(e.length," threads")),!0}catch(t){return console.error("\u274c Error importing threads:",t),!1}}on(e,t){this.listeners[e]&&this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>e(t))}},V=t=>{var n;let{thread:a,onReply:s,onClose:r,currentUser:i,compact:o=!1}=t;const[l,c]=(0,e.useState)(!0),[d,u]=(0,e.useState)(""),[h,m]=(0,e.useState)(!1);if(!a)return null;const{parentMessage:p,replies:f=[],replyCount:g}=a,v=()=>{if(!d.trim())return;const e={id:Date.now(),text:d,user:i,timestamp:(new Date).toISOString(),reactions:[]};s&&s(a.id,e),q.addReply(a.id,e),u(""),m(!1)},y=e=>{if(!e)return"";const t=new Date(e),n=new Date-t,a=Math.floor(n/6e4),s=Math.floor(a/60),r=Math.floor(s/24);return a<1?"Just now":a<60?"".concat(a,"m ago"):s<24?"".concat(s,"h ago"):r<7?"".concat(r,"d ago"):t.toLocaleDateString()};return(0,x.jsxs)("div",{className:"thread-view ".concat(o?"compact":""," ").concat(l?"":"collapsed"),children:[(0,x.jsxs)("div",{className:"thread-header",children:[(0,x.jsxs)("div",{className:"thread-info",children:[(0,x.jsx)("button",{className:"thread-toggle",onClick:()=>c(!l),title:l?"Collapse thread":"Expand thread",children:l?"\u25bc":"\u25b6"}),(0,x.jsxs)("span",{className:"thread-title",children:["Thread: ",g," ",1===g?"reply":"replies"]}),(0,x.jsx)("div",{className:"thread-participants",children:Array.from(a.participants||[]).slice(0,3).map((e,t)=>(0,x.jsx)("div",{className:"participant-avatar",style:{zIndex:3-t},children:"\ud83d\udc64"},e))})]}),r&&(0,x.jsx)("button",{className:"thread-close",onClick:r,title:"Close thread view",children:"\u2715"})]}),l&&(0,x.jsxs)("div",{className:"thread-content",children:[(0,x.jsxs)("div",{className:"thread-parent-message",children:[(0,x.jsxs)("div",{className:"message-header",children:[(0,x.jsx)("span",{className:"message-avatar",children:"\ud83d\udc64"}),(0,x.jsxs)("div",{className:"message-info",children:[(0,x.jsx)("span",{className:"message-author",children:(null===(n=p.user)||void 0===n?void 0:n.name)||"Unknown"}),(0,x.jsx)("span",{className:"message-time",children:y(p.timestamp)})]})]}),(0,x.jsx)("div",{className:"message-text",children:p.text})]}),(0,x.jsxs)("div",{className:"thread-divider",children:[(0,x.jsx)("span",{className:"divider-line"}),(0,x.jsxs)("span",{className:"divider-text",children:[g," ",1===g?"Reply":"Replies"]}),(0,x.jsx)("span",{className:"divider-line"})]}),(0,x.jsx)("div",{className:"thread-replies",children:f.map((e,t)=>{var n;return(0,x.jsxs)("div",{className:"thread-reply",children:[(0,x.jsx)("div",{className:"reply-connector"}),(0,x.jsxs)("div",{className:"reply-content",children:[(0,x.jsxs)("div",{className:"message-header",children:[(0,x.jsx)("span",{className:"message-avatar",children:"\ud83d\udc64"}),(0,x.jsxs)("div",{className:"message-info",children:[(0,x.jsx)("span",{className:"message-author",children:(null===(n=e.user)||void 0===n?void 0:n.name)||"Unknown"}),(0,x.jsx)("span",{className:"message-time",children:y(e.timestamp)})]})]}),(0,x.jsx)("div",{className:"message-text",children:e.text})]})]},e.id||t)})}),h?(0,x.jsxs)("div",{className:"thread-reply-input",children:[(0,x.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Write a reply...",className:"reply-textarea",rows:"3",autoFocus:!0,onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())}}),(0,x.jsxs)("div",{className:"reply-actions",children:[(0,x.jsx)("button",{className:"reply-cancel-btn",onClick:()=>{m(!1),u("")},children:"Cancel"}),(0,x.jsx)("button",{className:"reply-send-btn",onClick:v,disabled:!d.trim(),children:"Send Reply"})]})]}):(0,x.jsx)("button",{className:"thread-reply-btn",onClick:()=>m(!0),children:"\ud83d\udcac Reply to thread"})]})]})},W=e=>{let{thread:t,onClick:n,compact:a=!1,showParticipants:s=!0}=e;if(!t)return null;const{replyCount:r=0,participants:i=new Set,updatedAt:o}=t,l=()=>{if(!o)return!1;return new Date-new Date(o)<864e5},c=()=>Array.from(i).length;return(0,x.jsxs)("div",{className:"thread-indicator ".concat(a?"compact":""," ").concat(l()?"active":""),onClick:n,role:"button",tabIndex:0,onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||null===n||void 0===n||n()},title:"".concat(r," ").concat(1===r?"reply":"replies"," \u2022 ").concat(c()," ").concat(1===c()?"participant":"participants"),children:[(0,x.jsx)("div",{className:"indicator-icon",children:"\ud83d\udcac"}),(0,x.jsxs)("div",{className:"indicator-content",children:[(0,x.jsx)("div",{className:"indicator-count",children:r}),!a&&(0,x.jsxs)("div",{className:"indicator-details",children:[s&&c()>0&&(0,x.jsxs)("span",{className:"indicator-participants",children:["\ud83d\udc65 ",c()]}),o&&(0,x.jsx)("span",{className:"indicator-time",children:(e=>{if(!e)return"";const t=new Date(e),n=new Date-t,a=Math.floor(n/6e4),s=Math.floor(a/60),r=Math.floor(s/24);return a<1?"Active now":a<60?"".concat(a,"m"):s<24?"".concat(s,"h"):r<7?"".concat(r,"d"):">1w"})(o)})]})]}),l()&&(0,x.jsx)("div",{className:"indicator-pulse"})]})},G=t=>{var n,a;let{isOpen:s,onClose:r,onDonate:i}=t;const[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(""),[h,m]=(0,e.useState)("one-time"),[p,f]=(0,e.useState)("card"),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)({email:"",name:"",cardNumber:"",expiryDate:"",cvv:"",anonymous:!1}),w=[{id:"card",name:"Credit/Debit Card",icon:"\ud83d\udcb3",popular:!0},{id:"paypal",name:"PayPal",icon:"\ud83c\udf10",popular:!0},{id:"applepay",name:"Apple Pay",icon:"\ud83c\udf4f",popular:!1},{id:"googlepay",name:"Google Pay",icon:"\ud83c\udf08",popular:!1},{id:"crypto",name:"Cryptocurrency",icon:"\u20bf",popular:!1}],S=()=>d&&!isNaN(parseFloat(d))?parseFloat(d):l,k=()=>{const e=S();return e&&e>=1&&e<=1e4},j=(e,t)=>{b(n=>o(o({},n),{},{[e]:t}))},N=()=>{const{email:e,name:t,cardNumber:n,expiryDate:a,cvv:s}=y;return"card"===p?e&&t&&n&&a&&s:e&&t},C=()=>{c(null),u(""),m("one-time"),f("card"),v(!1),b({email:"",name:"",cardNumber:"",expiryDate:"",cvv:"",anonymous:!1})};return s?(0,x.jsx)("div",{className:"donation-overlay",onClick:e=>{e.target===e.currentTarget&&r()},children:(0,x.jsxs)("div",{className:"donation-modal",children:[(0,x.jsxs)("div",{className:"donation-header",children:[(0,x.jsx)("h3",{children:"\ud83d\udc96 Support Quibish"}),(0,x.jsx)("button",{className:"close-btn",onClick:r,children:"\xd7"})]}),g?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"payment-content",children:[(0,x.jsxs)("div",{className:"payment-header",children:[(0,x.jsx)("button",{className:"back-btn",onClick:()=>{v(!1)},children:"\u2190 Back"}),(0,x.jsxs)("div",{className:"payment-summary",children:[(0,x.jsxs)("h4",{children:["monthly"===h?"Monthly":"One-time","$",S().toFixed(2)]}),(0,x.jsxs)("p",{children:["via ",null===(n=w.find(e=>e.id===p))||void 0===n?void 0:n.name]})]})]}),(0,x.jsxs)("div",{className:"payment-form",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Email Address *"}),(0,x.jsx)("input",{type:"email",placeholder:"your@email.com",value:y.email,onChange:e=>j("email",e.target.value)})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Full Name *"}),(0,x.jsx)("input",{type:"text",placeholder:"John Doe",value:y.name,onChange:e=>j("name",e.target.value),disabled:y.anonymous})]}),(0,x.jsx)("div",{className:"form-group checkbox-group",children:(0,x.jsxs)("label",{className:"checkbox-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:y.anonymous,onChange:e=>j("anonymous",e.target.checked)}),(0,x.jsx)("span",{className:"checkmark"}),"Donate anonymously"]})}),"card"===p&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Card Number *"}),(0,x.jsx)("input",{type:"text",placeholder:"1234 5678 9012 3456",value:y.cardNumber,onChange:e=>j("cardNumber",e.target.value),maxLength:"19"})]}),(0,x.jsxs)("div",{className:"form-row",children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"Expiry Date *"}),(0,x.jsx)("input",{type:"text",placeholder:"MM/YY",value:y.expiryDate,onChange:e=>j("expiryDate",e.target.value),maxLength:"5"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{children:"CVV *"}),(0,x.jsx)("input",{type:"text",placeholder:"123",value:y.cvv,onChange:e=>j("cvv",e.target.value),maxLength:"4"})]})]})]}),"card"!==p&&(0,x.jsx)("div",{className:"external-payment-info",children:(0,x.jsxs)("p",{children:["You will be redirected to ",null===(a=w.find(e=>e.id===p))||void 0===a?void 0:a.name,"to complete your payment securely."]})})]})]}),(0,x.jsxs)("div",{className:"payment-footer",children:[(0,x.jsxs)("div",{className:"security-info",children:[(0,x.jsx)("span",{className:"security-icon",children:"\ud83d\udd12"}),(0,x.jsx)("span",{children:"Your payment information is secure and encrypted"})]}),(0,x.jsxs)("button",{className:"submit-btn ".concat(N()?"enabled":"disabled"),onClick:()=>{if(!N())return void alert("Please fill in all required fields");const e={amount:S(),type:h,method:p,email:y.email,name:y.anonymous?"Anonymous":y.name,anonymous:y.anonymous,timestamp:(new Date).toISOString()};console.log("Processing donation:",e),i&&i(e),alert("Thank you for your ".concat(h," donation of $").concat(S(),"!")),r(),C()},disabled:!N(),children:["Complete ","monthly"===h?"Subscription":"Donation"]})]})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"donation-content",children:[(0,x.jsx)("div",{className:"donation-intro",children:(0,x.jsx)("p",{children:"Your support helps us keep Quibish free and continuously improve your communication experience. Every contribution matters!"})}),(0,x.jsx)("div",{className:"donation-type",children:(0,x.jsxs)("div",{className:"type-toggle",children:[(0,x.jsx)("button",{className:"type-btn ".concat("one-time"===h?"active":""),onClick:()=>m("one-time"),children:"One-time"}),(0,x.jsx)("button",{className:"type-btn ".concat("monthly"===h?"active":""),onClick:()=>m("monthly"),children:"Monthly"})]})}),(0,x.jsxs)("div",{className:"amount-selection",children:[(0,x.jsx)("h4",{children:"Choose Amount"}),(0,x.jsx)("div",{className:"amount-grid",children:[{value:5,label:"$5",description:"Coffee for the dev team"},{value:10,label:"$10",description:"Support server costs"},{value:25,label:"$25",description:"Help with development"},{value:50,label:"$50",description:"Sponsor new features"},{value:100,label:"$100",description:"Major contribution"},{value:250,label:"$250",description:"VIP supporter"}].map(e=>(0,x.jsxs)("button",{className:"amount-btn ".concat(l===e.value?"selected":""),onClick:()=>(e=>{c(e),u("")})(e.value),children:[(0,x.jsx)("span",{className:"amount-label",children:e.label}),(0,x.jsx)("span",{className:"amount-desc",children:e.description})]},e.value))}),(0,x.jsxs)("div",{className:"custom-amount",children:[(0,x.jsx)("label",{children:"Or enter custom amount:"}),(0,x.jsxs)("div",{className:"custom-input",children:[(0,x.jsx)("span",{className:"currency",children:"$"}),(0,x.jsx)("input",{type:"number",min:"1",max:"10000",step:"0.01",placeholder:"0.00",value:d,onChange:e=>{return t=e.target.value,u(t),void c(null);var t}})]})]})]}),(0,x.jsxs)("div",{className:"payment-methods",children:[(0,x.jsx)("h4",{children:"Payment Method"}),(0,x.jsx)("div",{className:"methods-grid",children:w.map(e=>(0,x.jsxs)("button",{className:"method-btn ".concat(p===e.id?"selected":""," ").concat(e.popular?"popular":""),onClick:()=>f(e.id),children:[(0,x.jsx)("span",{className:"method-icon",children:e.icon}),(0,x.jsx)("span",{className:"method-name",children:e.name}),e.popular&&(0,x.jsx)("span",{className:"popular-badge",children:"Popular"})]},e.id))})]})]}),(0,x.jsxs)("div",{className:"donation-footer",children:[(0,x.jsx)("div",{className:"donation-summary",children:S()&&(0,x.jsx)("p",{children:(0,x.jsxs)("strong",{children:["monthly"===h?"Monthly":"One-time"," donation: $",S().toFixed(2)]})})}),(0,x.jsxs)("button",{className:"donate-btn ".concat(k()?"enabled":"disabled"),onClick:()=>{k()?v(!0):alert("Please select a valid donation amount")},disabled:!k(),children:["monthly"===h?"Subscribe":"Donate",S()?"$".concat(S().toFixed(2)):""]})]})]})]})}):null},K=t=>{let{isVisible:n,onClose:a,onOpenDonation:s,onDismiss:r}=t;const[i,o]=(0,e.useState)(0),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(10),[h,m]=(0,e.useState)(!1),p=[{id:"support",emoji:"\u2764\ufe0f",title:"Love Quibish?",message:"Help us keep the app free and add amazing new features!",buttonText:"Support Us",color:"#ff6b6b"},{id:"coffee",emoji:"\u2615",title:"Buy us a coffee?",message:"Your support helps fuel late-night coding sessions and server costs.",buttonText:"Get Coffee",color:"#8b4513"},{id:"growth",emoji:"\ud83d\ude80",title:"Help Quibish grow!",message:"Every contribution helps us reach more users and build better features.",buttonText:"Contribute",color:"#667eea"},{id:"community",emoji:"\ud83c\udf89",title:"Join our supporters!",message:"Be part of the community that makes Quibish possible for everyone.",buttonText:"Join Community",color:"#28a745"},{id:"future",emoji:"\ud83c\udf1f",title:"Shape our future!",message:"Your support helps prioritize features and improvements you want to see.",buttonText:"Shape Future",color:"#ffc107"}];(0,e.useEffect)(()=>{if(!n)return;const e=setInterval(()=>{c(!0),setTimeout(()=>{o(e=>(e+1)%p.length),c(!1)},300)},4e3);return()=>clearInterval(e)},[n,p.length]),(0,e.useEffect)(()=>{if(!n||!h)return;const e=setInterval(()=>{u(e=>e<=1?(r("auto"),m(!1),10):e-1)},1e3);return()=>clearInterval(e)},[n,h,r]);if(!n)return null;const f=p[i];return(0,x.jsx)("div",{className:"donation-prompt-overlay",children:(0,x.jsxs)("div",{className:"donation-prompt",style:{"--prompt-color":f.color},children:[(0,x.jsx)("button",{className:"prompt-close",onClick:a,children:"\xd7"}),(0,x.jsxs)("div",{className:"prompt-content ".concat(l?"animating":""),children:[(0,x.jsx)("div",{className:"prompt-emoji",children:f.emoji}),(0,x.jsx)("h3",{className:"prompt-title",children:f.title}),(0,x.jsx)("p",{className:"prompt-message",children:f.message})]}),(0,x.jsxs)("div",{className:"prompt-actions",children:[(0,x.jsx)("button",{className:"prompt-btn secondary",onClick:h?()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"manual";m(!1),u(10),r(e)}("manual"):()=>{m(!0)},children:h?"Dismiss (".concat(d,"s)"):"Maybe Later"}),(0,x.jsx)("button",{className:"prompt-btn primary",onClick:()=>{s(),a()},children:f.buttonText})]}),(0,x.jsx)("div",{className:"prompt-indicators",children:p.map((e,t)=>(0,x.jsx)("div",{className:"indicator ".concat(t===i?"active":""),onClick:()=>o(t)},t))}),(0,x.jsx)("div",{className:"prompt-footer",children:(0,x.jsx)("span",{className:"prompt-note",children:"\ud83d\udd12 Secure donation \u2022 Cancel anytime"})})]})})},Q={BASE_URL:"http://localhost:5000/api",WS_URL:"ws://localhost:5000",TIMEOUT:1e4},Y=e=>{const t=e.startsWith("/")?e.slice(1):e;return"".concat(Q.BASE_URL,"/").concat(t)};const $=new class{constructor(){this.vapidPublicKey=null,this.subscription=null,this.isSupported="serviceWorker"in navigator&&"PushManager"in window,this.permission="default",this.userId=null}async initialize(e){if(console.log("\ud83d\udd14 Initializing push notification service..."),this.userId=e,!this.isSupported)return console.warn("Push notifications not supported"),!1;try{return this.permission=await Notification.permission,console.log("Current notification permission:",this.permission),await this.registerServiceWorker(),"granted"===this.permission&&await this.setupPushSubscription(),!0}catch(t){return console.error("Failed to initialize push notifications:",t),!1}}async registerServiceWorker(){try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("\u2705 Service Worker registered for notifications"),e}catch(e){throw console.error("Service Worker registration failed:",e),e}}async requestPermission(){if(!this.isSupported)throw new Error("Push notifications not supported");try{const e=await Notification.requestPermission();if(this.permission=e,console.log("Notification permission result:",e),"granted"===e)return await this.setupPushSubscription(),!0;throw"denied"===e?new Error("Notification permission denied"):new Error("Notification permission not granted")}catch(e){throw console.error("Failed to request notification permission:",e),e}}async setupPushSubscription(){try{const e=await navigator.serviceWorker.ready;await this.getVapidKey();const t=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(this.vapidPublicKey)});return this.subscription=t,console.log("\u2705 Push subscription created"),await this.sendSubscriptionToBackend(t),t}catch(e){throw console.error("Failed to setup push subscription:",e),e}}async getVapidKey(){try{const e=await fetch(Y("notifications/vapid-key"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to get VAPID key");const t=await e.json();this.vapidPublicKey=t.publicKey,console.log("\u2705 VAPID key retrieved")}catch(e){console.error("Failed to get VAPID key:",e),this.vapidPublicKey="BMqSvZyI8NzEp_G-Jw5i5L7-8K9yJ8xI7qU6vN2mL4kP3oT8fF1R9eA2cX5nH7jQ6wE4dY9pM8vL3zK2aB1sC0f"}}async sendSubscriptionToBackend(e){try{if(!(await fetch(Y("notifications/subscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({subscription:e.toJSON(),userId:this.userId})})).ok)throw new Error("Failed to send subscription to backend");console.log("\u2705 Subscription sent to backend")}catch(t){throw console.error("Failed to send subscription to backend:",t),t}}async testNotification(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Test notification from Quibish!";if("granted"!==this.permission)throw new Error("Notification permission not granted");try{const t=new Notification("Quibish",{body:e,icon:"/logo192.png",badge:"/logo192.png",tag:"test-notification",requireInteraction:!1,actions:[{action:"open",title:"Open App"},{action:"dismiss",title:"Dismiss"}]});return t.onclick=()=>{window.focus(),t.close()},console.log("\u2705 Test notification sent"),t}catch(t){throw console.error("Failed to send test notification:",t),t}}showMessageNotification(e){if("granted"!==this.permission)return void console.warn("Cannot show notification: permission not granted");const t=new Notification("New message from ".concat(e.sender),{body:e.text||"You have a new message",icon:e.senderAvatar||"/logo192.png",badge:"/logo192.png",tag:"message-".concat(e.id),requireInteraction:!0,actions:[{action:"reply",title:"Reply"},{action:"view",title:"View"}],data:{messageId:e.id,conversationId:e.conversationId,senderId:e.senderId}});return t.onclick=()=>{window.focus(),window.postMessage({type:"OPEN_CONVERSATION",conversationId:e.conversationId},"*"),t.close()},t}async unsubscribe(){try{this.subscription&&(await this.subscription.unsubscribe(),console.log("\u2705 Unsubscribed from push notifications")),await fetch(Y("notifications/unsubscribe"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({userId:this.userId})}),this.subscription=null}catch(e){throw console.error("Failed to unsubscribe:",e),e}}getSubscriptionStatus(){return{isSupported:this.isSupported,permission:this.permission,hasSubscription:!!this.subscription,userId:this.userId}}urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),a=new Uint8Array(n.length);for(let s=0;s<n.length;++s)a[s]=n.charCodeAt(s);return a}isUserOnline(){return navigator.onLine&&"visible"===document.visibilityState}setupPresenceDetection(){document.addEventListener("visibilitychange",()=>{const e="visible"===document.visibilityState;console.log("User visibility changed:",e?"visible":"hidden"),this.updateUserPresence(e)}),window.addEventListener("online",()=>{console.log("User came online"),this.updateUserPresence(!0)}),window.addEventListener("offline",()=>{console.log("User went offline"),this.updateUserPresence(!1)})}async updateUserPresence(e){try{await fetch(Y("users/presence"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({userId:this.userId,isOnline:e,lastSeen:(new Date).toISOString()})})}catch(t){console.error("Failed to update user presence:",t)}}},J=t=>{let{isOpen:n,onClose:a,user:s}=t;const[r,i]=(0,e.useState)({pushEnabled:!1,emailEnabled:!0,soundEnabled:!0,vibrationEnabled:!0,showPreview:!0,quietHours:{enabled:!1,start:"22:00",end:"08:00"},emailFrequency:"immediate",notifyOnMention:!0,notifyOnDM:!0,notifyOnGroupMessage:!1}),[l,c]=(0,e.useState)({isSupported:!1,permission:"default",hasSubscription:!1}),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(""),[p,f]=(0,e.useState)("");(0,e.useEffect)(()=>{n&&(g(),v())},[n]);const g=async()=>{try{const e=await fetch("/api/users/notification-preferences",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){const t=await e.json();i(e=>o(o({},e),t))}}catch(h){console.error("Failed to load notification settings:",h)}},v=()=>{const e=$.getSubscriptionStatus();c(e)},y=(e,t)=>{i(n=>o(o({},n),{},{[e]:t}))},b=(e,t)=>{i(n=>o(o({},n),{},{quietHours:o(o({},n.quietHours),{},{[e]:t})}))};return n?(0,x.jsx)("div",{className:"notification-settings-overlay",children:(0,x.jsxs)("div",{className:"notification-settings-modal",children:[(0,x.jsxs)("div",{className:"notification-settings-header",children:[(0,x.jsx)("h2",{children:"\ud83d\udd14 Notification Settings"}),(0,x.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"notification-settings-content",children:[h&&(0,x.jsx)("div",{className:"alert alert-error",children:(0,x.jsxs)("span",{children:["\u26a0\ufe0f ",h]})}),p&&(0,x.jsx)("div",{className:"alert alert-success",children:(0,x.jsxs)("span",{children:["\u2705 ",p]})}),(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udcf1 Push Notifications"}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Enable Push Notifications"}),(0,x.jsx)("span",{className:"setting-description",children:"Get notifications even when the app is closed"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.pushEnabled,onChange:async()=>{if(l.isSupported){u(!0),m("");try{r.pushEnabled?(await $.unsubscribe(),i(e=>o(o({},e),{},{pushEnabled:!1})),v()):(await $.requestPermission(),i(e=>o(o({},e),{},{pushEnabled:!0})),v())}catch(h){console.error("Failed to toggle push notifications:",h),m("Failed to enable push notifications. Please check your browser settings.")}finally{u(!1)}}else m("Push notifications are not supported in this browser")},disabled:d||!l.isSupported}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),!l.isSupported&&(0,x.jsx)("div",{className:"warning-message",children:"Push notifications are not supported in this browser"}),r.pushEnabled&&(0,x.jsxs)("div",{className:"push-status",children:[(0,x.jsxs)("p",{children:["Status: ",l.hasSubscription?"\u2705 Active":"\u26a0\ufe0f Not subscribed"]}),(0,x.jsx)("button",{className:"test-btn",onClick:async()=>{u(!0),m("");try{r.pushEnabled&&l.hasSubscription?(await $.testNotification("Test notification from Quibish! \ud83c\udf89"),f("Test notification sent!"),setTimeout(()=>f(""),3e3)):m("Push notifications must be enabled first")}catch(h){console.error("Failed to send test notification:",h),m("Failed to send test notification")}finally{u(!1)}},disabled:d||!l.hasSubscription,children:"Send Test Notification"})]})]}),(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udce7 Email Notifications"}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Enable Email Notifications"}),(0,x.jsx)("span",{className:"setting-description",children:"Receive email alerts when you're offline"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.emailEnabled,onChange:e=>y("emailEnabled",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),r.emailEnabled&&(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Email Frequency"}),(0,x.jsx)("span",{className:"setting-description",children:"How often to send email notifications"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("select",{value:r.emailFrequency,onChange:e=>y("emailFrequency",e.target.value),className:"frequency-select",children:[(0,x.jsx)("option",{value:"immediate",children:"Immediate"}),(0,x.jsx)("option",{value:"hourly",children:"Hourly digest"}),(0,x.jsx)("option",{value:"daily",children:"Daily digest"}),(0,x.jsx)("option",{value:"weekly",children:"Weekly digest"})]})})]})]}),(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udccb Notification Types"}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Direct Messages"}),(0,x.jsx)("span",{className:"setting-description",children:"Notify when you receive a direct message"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.notifyOnDM,onChange:e=>y("notifyOnDM",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Mentions"}),(0,x.jsx)("span",{className:"setting-description",children:"Notify when someone mentions you"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.notifyOnMention,onChange:e=>y("notifyOnMention",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Group Messages"}),(0,x.jsx)("span",{className:"setting-description",children:"Notify for all group messages"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.notifyOnGroupMessage,onChange:e=>y("notifyOnGroupMessage",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]})]}),(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"\ud83d\udd0a Notification Behavior"}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Sound"}),(0,x.jsx)("span",{className:"setting-description",children:"Play sound for notifications"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.soundEnabled,onChange:e=>y("soundEnabled",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Vibration"}),(0,x.jsx)("span",{className:"setting-description",children:"Vibrate on mobile devices"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.vibrationEnabled,onChange:e=>y("vibrationEnabled",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Show Message Preview"}),(0,x.jsx)("span",{className:"setting-description",children:"Show message content in notifications"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.showPreview,onChange:e=>y("showPreview",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]})]}),(0,x.jsxs)("div",{className:"settings-section",children:[(0,x.jsx)("h3",{children:"\ud83c\udf19 Quiet Hours"}),(0,x.jsxs)("div",{className:"setting-item",children:[(0,x.jsxs)("div",{className:"setting-info",children:[(0,x.jsx)("label",{children:"Enable Quiet Hours"}),(0,x.jsx)("span",{className:"setting-description",children:"No notifications during specified hours"})]}),(0,x.jsx)("div",{className:"setting-controls",children:(0,x.jsxs)("label",{className:"toggle-switch",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.quietHours.enabled,onChange:e=>b("enabled",e.target.checked)}),(0,x.jsx)("span",{className:"toggle-slider"})]})})]}),r.quietHours.enabled&&(0,x.jsxs)("div",{className:"quiet-hours-times",children:[(0,x.jsxs)("div",{className:"time-input-group",children:[(0,x.jsx)("label",{children:"From:"}),(0,x.jsx)("input",{type:"time",value:r.quietHours.start,onChange:e=>b("start",e.target.value),className:"time-input"})]}),(0,x.jsxs)("div",{className:"time-input-group",children:[(0,x.jsx)("label",{children:"To:"}),(0,x.jsx)("input",{type:"time",value:r.quietHours.end,onChange:e=>b("end",e.target.value),className:"time-input"})]})]})]})]}),(0,x.jsxs)("div",{className:"notification-settings-footer",children:[(0,x.jsx)("button",{className:"cancel-btn",onClick:a,disabled:d,children:"Cancel"}),(0,x.jsx)("button",{className:"save-btn",onClick:async()=>{u(!0),m(""),f("");try{if(!(await fetch("/api/users/notification-preferences",{method:"PUT",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Failed to save settings");f("Notification settings saved successfully!"),setTimeout(()=>f(""),3e3)}catch(h){console.error("Failed to save notification settings:",h),m("Failed to save notification settings. Please try again.")}finally{u(!1)}},disabled:d,children:d?"Saving...":"Save Settings"})]})]})}):null};class X{constructor(){this.mediaRecorder=null,this.audioStream=null,this.audioChunks=[],this.isRecording=!1,this.isPaused=!1,this.recordingStartTime=0,this.pausedDuration=0,this.audioContext=null,this.analyser=null,this.microphone=null,this.dataArray=null,this.animationFrame=null,this.config={mimeType:this.getSupportedMimeType(),audioBitsPerSecond:128e3,videoBitsPerSecond:null,sampleRate:44100,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},this.listeners={onStart:[],onStop:[],onPause:[],onResume:[],onDataAvailable:[],onError:[],onVolumeChange:[]},console.log("\ud83c\udfa4 Voice Recorder Service created, awaiting initialization...")}async initialize(){try{if(console.log("\ud83d\udd04 Initializing Voice Recorder Service..."),!window.MediaRecorder)throw new Error("MediaRecorder is not supported in this browser");if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("getUserMedia is not supported in this browser");if(!this.getSupportedMimeType())throw new Error("No supported audio formats found");return console.log("\u2705 Voice Recorder Service initialized successfully"),console.log("\ud83d\udcca Configuration:",this.config),!0}catch(e){return console.error("\u274c Voice Recorder Service initialization failed:",e),this.emit("onError",{type:"initialization",error:e}),!1}}getSupportedMimeType(){const e=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg","audio/wav","audio/mp4","audio/aac"];for(const t of e)if(MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported(t))return console.log("\ud83d\udcf1 Using MIME type: ".concat(t)),t;return console.warn("\u26a0\ufe0f No preferred audio MIME type supported, using default"),MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm"),"audio/webm"}async testMicrophoneAccess(){try{console.log("\ud83d\udd0d Testing microphone access...");const e=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:22050,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return console.log("\u2705 Microphone access test successful"),e.getTracks().forEach(e=>e.stop()),{success:!0,message:"Microphone access granted"}}catch(e){console.error("\u274c Microphone access test failed:",e);let t=e.message;switch(e.name){case"NotAllowedError":t="Microphone permission denied. Please allow microphone access in your browser settings.";break;case"NotFoundError":t="No microphone found. Please connect a microphone and try again.";break;case"NotSupportedError":t="Voice recording is not supported in this browser.";break;case"AbortError":t="Microphone access was aborted. Please try again.";break;case"NotReadableError":t="Microphone is already in use by another application."}return{success:!1,error:e.name,message:t}}}async startRecording(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{if(this.isRecording)return console.warn("\u26a0\ufe0f Recording already in progress"),this.emit("onError",{type:"start",error:new Error("Recording already in progress")}),!1;if(e&&(e.bitrate&&(this.config.audioBitsPerSecond=e.bitrate),e.sampleRate&&(this.config.sampleRate=e.sampleRate),console.log("\ufffd\ufe0f Using quality config:",e)),console.log("\ufffd\ud83c\udfa4 Requesting microphone permission..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("getUserMedia is not supported in this browser");let n;try{n=await navigator.mediaDevices.getUserMedia({audio:{channelCount:this.config.channelCount,sampleRate:this.config.sampleRate,echoCancellation:this.config.echoCancellation,noiseSuppression:this.config.noiseSuppression,autoGainControl:this.config.autoGainControl}})}catch(t){console.warn("\u26a0\ufe0f Advanced audio settings failed, trying basic settings..."),n=await navigator.mediaDevices.getUserMedia({audio:!0})}return console.log("\u2705 Microphone permission granted"),this.audioStream=n,this.audioChunks=[],this.recordingStartTime=Date.now(),this.pausedDuration=0,this.mediaRecorder=new MediaRecorder(n,{mimeType:this.config.mimeType,audioBitsPerSecond:this.config.audioBitsPerSecond}),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&(this.audioChunks.push(e.data),this.emit("onDataAvailable",{data:e.data}))},this.mediaRecorder.onstop=()=>{this.handleRecordingStop()},this.mediaRecorder.onerror=e=>{console.error("\u274c MediaRecorder error:",e.error),this.emit("onError",{type:"recording",error:e.error})},await this.setupAudioAnalysis(n),this.mediaRecorder.start(100),this.isRecording=!0,this.isPaused=!1,this.startVolumeMonitoring(),console.log("\ud83c\udfa4 Recording started successfully"),this.emit("onStart",{startTime:this.recordingStartTime,config:this.config}),!0}catch(n){console.error("\u274c Failed to start recording:",n);let e=n.message;"NotAllowedError"===n.name?e="Microphone permission denied. Please allow microphone access and try again.":"NotFoundError"===n.name?e="No microphone found. Please connect a microphone and try again.":"NotSupportedError"===n.name?e="Voice recording is not supported in this browser.":"AbortError"===n.name&&(e="Recording was aborted. Please try again.");const t=new Error(e);return t.originalError=n,this.emit("onError",{type:"start",error:t}),!1}}async stopRecording(){try{return this.isRecording?(this.mediaRecorder&&"recording"===this.mediaRecorder.state&&this.mediaRecorder.stop(),this.stopVolumeMonitoring(),this.audioStream&&(this.audioStream.getTracks().forEach(e=>e.stop()),this.audioStream=null),this.isRecording=!1,this.isPaused=!1,console.log("\ud83d\uded1 Recording stopped successfully"),new Promise(e=>{this.recordingStopResolver=e})):(console.warn("\u26a0\ufe0f No recording in progress"),null)}catch(e){return console.error("\u274c Failed to stop recording:",e),this.emit("onError",{type:"stop",error:e}),null}}handleRecordingStop(){try{const e=new Blob(this.audioChunks,{type:this.config.mimeType}),t=this.getRecordingDuration(),n=e.size;console.log("\ud83c\udfb5 Audio recorded: ".concat(t,"ms, ").concat((n/1024).toFixed(2),"KB"));const a={blob:e,duration:t,size:n,mimeType:this.config.mimeType,url:URL.createObjectURL(e),timestamp:(new Date).toISOString()};return this.emit("onStop",a),this.recordingStopResolver&&(this.recordingStopResolver(a),this.recordingStopResolver=null),a}catch(e){return console.error("\u274c Failed to process recording:",e),this.emit("onError",{type:"processing",error:e}),null}}pauseRecording(){try{return!(!this.isRecording||this.isPaused)&&(!(!this.mediaRecorder||"recording"!==this.mediaRecorder.state)&&(this.mediaRecorder.pause(),this.isPaused=!0,this.pauseStartTime=Date.now(),console.log("\u23f8\ufe0f Recording paused"),this.emit("onPause",{pauseTime:this.pauseStartTime}),!0))}catch(e){return console.error("\u274c Failed to pause recording:",e),this.emit("onError",{type:"pause",error:e}),!1}}resumeRecording(){try{return!(!this.isRecording||!this.isPaused)&&(!(!this.mediaRecorder||"paused"!==this.mediaRecorder.state)&&(this.mediaRecorder.resume(),this.isPaused=!1,this.pauseStartTime&&(this.pausedDuration+=Date.now()-this.pauseStartTime,this.pauseStartTime=0),console.log("\u25b6\ufe0f Recording resumed"),this.emit("onResume",{resumeTime:Date.now()}),!0))}catch(e){return console.error("\u274c Failed to resume recording:",e),this.emit("onError",{type:"resume",error:e}),!1}}cancelRecording(){try{return this.audioChunks=[],this.stopRecording(),console.log("\u274c Recording cancelled"),!0}catch(e){return console.error("\u274c Failed to cancel recording:",e),!1}}async setupAudioAnalysis(e){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.microphone=this.audioContext.createMediaStreamSource(e),this.analyser.fftSize=256,this.analyser.smoothingTimeConstant=.3,this.microphone.connect(this.analyser),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),console.log("\ud83c\udfb5 Audio analysis setup complete")}catch(t){console.error("\u274c Failed to setup audio analysis:",t)}}startVolumeMonitoring(){if(!this.analyser||!this.dataArray)return;const e=()=>{if(!this.isRecording)return;this.analyser.getByteFrequencyData(this.dataArray);const t=this.dataArray.reduce((e,t)=>e+t,0)/this.dataArray.length,n=Math.round(t/255*100);this.emit("onVolumeChange",{volume:n,rawData:this.dataArray}),this.animationFrame=requestAnimationFrame(e)};e()}stopVolumeMonitoring(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null),this.audioContext&&"closed"!==this.audioContext.state&&(this.audioContext.close(),this.audioContext=null)}getRecordingDuration(){if(!this.isRecording&&0===this.recordingStartTime)return 0;const e=this.isRecording?Date.now():this.recordingStartTime;return Math.max(0,e-this.recordingStartTime-this.pausedDuration)}formatDuration(e){const t=Math.floor(e/1e3),n=Math.floor(t/60),a=t%60;return n>0?"".concat(n,":").concat(a.toString().padStart(2,"0")):"0:".concat(a.toString().padStart(2,"0"))}getState(){return{isRecording:this.isRecording,isPaused:this.isPaused,duration:this.getRecordingDuration(),formattedDuration:this.formatDuration(this.getRecordingDuration()),hasPermission:!!this.audioStream,mimeType:this.config.mimeType}}async convertAudio(e,t){try{return e.type===t||console.warn("\u26a0\ufe0f Audio conversion from ".concat(e.type," to ").concat(t," not implemented")),e}catch(n){return console.error("\u274c Audio conversion failed:",n),e}}static isSupported(){return!!(window.MediaRecorder&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}static getCapabilities(){if(!X.isSupported())return{supported:!1};const e={supported:!0,mimeTypes:[],features:{pause:!0,resume:!0,volumeMonitoring:!(!window.AudioContext&&!window.webkitAudioContext),realTimeAnalysis:!0}};return["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg","audio/wav","audio/mp4","audio/aac"].forEach(t=>{MediaRecorder.isTypeSupported(t)&&e.mimeTypes.push(t)}),e}on(e,t){this.listeners[e]&&this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach(n=>{try{n(t)}catch(a){console.error("\u274c Error in event listener for ".concat(e,":"),a)}})}cleanup(){this.cancelRecording(),this.stopVolumeMonitoring(),Object.keys(this.listeners).forEach(e=>{this.listeners[e]=[]}),console.log("\ud83e\uddf9 Voice Recorder Service cleaned up")}}const Z=new X,ee=t=>{let{audioUrl:n,duration:a,className:s="",compact:r=!1}=t;const[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(0),[d,u]=(0,e.useState)(a||0),h=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=h.current;if(!e)return;const t=()=>{c(1e3*e.currentTime)},n=()=>{u(1e3*e.duration)},a=()=>{o(!1),c(0)};return e.addEventListener("timeupdate",t),e.addEventListener("durationchange",n),e.addEventListener("ended",a),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("durationchange",n),e.removeEventListener("ended",a)}},[]);const m=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),a=t%60;return"".concat(n,":").concat(a.toString().padStart(2,"0"))};return(0,x.jsxs)("div",{className:"voice-message-player ".concat(r?"compact":""," ").concat(s),children:[(0,x.jsx)("audio",{ref:h,src:n,preload:"metadata"}),(0,x.jsx)("button",{className:"play-pause-btn",onClick:()=>{const e=h.current;e&&(i?(e.pause(),o(!1)):(e.play(),o(!0)))},title:i?"Pause":"Play",children:(0,x.jsx)("span",{className:"btn-icon",children:i?"\u23f8\ufe0f":"\u25b6\ufe0f"})}),(0,x.jsxs)("div",{className:"playback-info",children:[(0,x.jsx)("div",{className:"progress-container",onClick:e=>{const t=h.current;if(!t)return;const n=e.currentTarget.getBoundingClientRect(),a=(e.clientX-n.left)/n.width*(d/1e3);t.currentTime=a,c(1e3*a)},children:(0,x.jsx)("div",{className:"progress-track",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"".concat(d>0?l/d*100:0,"%")}})})}),(0,x.jsxs)("div",{className:"time-display",children:[(0,x.jsx)("span",{className:"current-time",children:m(l)}),(0,x.jsx)("span",{className:"duration",children:m(d)})]})]})]})},te=t=>{let{onRecordingComplete:n,onRecordingCancel:a,onRecordingStart:s,onClose:r,maxDuration:i=3e5,minDuration:o=1e3,className:l="",compact:c=!1,autoStart:d=!1}=t;const[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(0),[v,y]=(0,e.useState)(0),[b,w]=(0,e.useState)(!1),[S,k]=(0,e.useState)(null),[j,N]=(0,e.useState)(!1),[C,E]=(0,e.useState)(0),[T,A]=(0,e.useState)(null),[I,M]=(0,e.useState)("standard"),D=(0,e.useRef)(null),P=(0,e.useRef)(null),_=(0,e.useRef)(null);(0,e.useEffect)(()=>{(async()=>{try{if(console.log("\ud83c\udfa4 Initializing voice recorder..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Voice recording not supported. Please use Chrome, Firefox, Edge, or Safari.");const e=await Z.initialize();if(N(e),e)console.log("\u2705 Voice recorder initialized successfully"),k(null);else{const e="Voice recording is not supported in your browser";console.error("\u274c Voice recorder initialization failed:",e),k(e)}}catch(S){console.error("\u274c Voice recorder initialization error:",S),k("Failed to initialize: ".concat(S.message)),N(!1)}})();const e=e=>{h(!0),p(!1),k(null),w(!0),s&&s(e)},t=e=>{h(!1),p(!1),g(0),y(0),n&&n(e)},a=()=>{p(!0)},r=()=>{p(!1)},i=e=>{let{volume:t}=e;y(t),W(t)},o=e=>{let{error:t,type:n}=e;k("Recording error (".concat(n,"): ").concat(t.message||t)),h(!1),p(!1),"start"===n&&w(!1)};return Z.on("onStart",e),Z.on("onStop",t),Z.on("onPause",a),Z.on("onResume",r),Z.on("onVolumeChange",i),Z.on("onError",o),d&&j&&z(),()=>{Z.off("onStart",e),Z.off("onStop",t),Z.off("onPause",a),Z.off("onResume",r),Z.off("onVolumeChange",i),Z.off("onError",o),D.current&&clearInterval(D.current)}},[d,s,n]),(0,e.useEffect)(()=>(u&&!m?D.current=setInterval(()=>{const e=Z.getRecordingDuration();g(e),e>=i&&L()},100):D.current&&(clearInterval(D.current),D.current=null),()=>{D.current&&clearInterval(D.current)}),[u,m,i]);const R=(0,e.useCallback)(async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return k("MediaDevices API not supported in this browser"),!1;if(navigator.permissions){const e=await navigator.permissions.query({name:"microphone"});if("denied"===e.state)return k("Microphone permission denied. Please enable in browser settings."),!1;"prompt"===e.state&&k("Click record to allow microphone access")}return!0}catch(S){return console.warn("Permission check failed:",S),!0}},[]);(0,e.useEffect)(()=>{j&&R()},[j,R]);const z=(0,e.useCallback)(async()=>{if(!j){console.log("\ud83d\udd04 Service not initialized, initializing now...");try{const e=await Z.initialize();if(N(e),!e)return void k("Failed to initialize voice recorder")}catch(S){return console.error("\u274c Initialization failed:",S),void k("Initialization failed: ".concat(S.message))}}try{console.log("\ud83c\udfa4 Testing microphone access first..."),k("Testing microphone access...");const e=await Z.testMicrophoneAccess();if(!e.success)return console.error("\u274c Microphone test failed:",e.message),void k(e.message);console.log("\u2705 Microphone test passed, starting recording..."),k(null),E(0);const t={low:{bitrate:64e3,sampleRate:22050},standard:{bitrate:128e3,sampleRate:44100},high:{bitrate:256e3,sampleRate:48e3}}[I];if(!await Z.startRecording(t))throw new Error("Failed to start recording - unknown error");console.log("\u2705 Recording started successfully")}catch(S){console.error("\u274c Recording start error:",S),k("Recording failed: ".concat(S.message)),h(!1)}},[j,I]),F=(0,e.useCallback)(()=>{Z.cancelRecording(),g(0),y(0),A(null),k(null),a&&a()},[a]),L=(0,e.useCallback)(async()=>{if(f<o)return k("Recording too short. Minimum duration is ".concat(o/1e3," seconds.")),setTimeout(()=>k(null),3e3),void F();try{console.log("\ud83d\uded1 Stopping recording...");const e=await Z.stopRecording();e&&e.url&&A(e),console.log("\u2705 Recording stopped successfully")}catch(S){console.error("\u274c Stop recording error:",S),k("Stop failed: ".concat(S.message)),setTimeout(()=>k(null),5e3)}},[f,o,F]),O=(0,e.useCallback)(()=>{Z.pauseRecording()},[]),U=(0,e.useCallback)(()=>{Z.resumeRecording()},[]),B=(0,e.useCallback)(async()=>{const e=C+1;E(e),e>3?k("Too many failed attempts. Please check your microphone settings and refresh the page."):(k("Retrying..."),setTimeout(()=>{z()},1e3*e))},[C,z]),H=(0,e.useCallback)(()=>{T&&n&&(n(T),A(null))},[T,n]),q=(0,e.useCallback)(()=>{T&&T.url&&URL.revokeObjectURL(T.url),A(null)},[T]),V=(0,e.useCallback)(e=>{const t=P.current;if(!t)return;const n=t.getContext("2d"),a=t.width,s=t.height,r=n.getImageData(2,0,a-2,s);n.putImageData(r,0,0),n.clearRect(a-2,0,2,s);const i=e/100*s,o=n.createLinearGradient(0,s,0,s-i);o.addColorStop(0,"#ef4444"),o.addColorStop(.5,"#f59e0b"),o.addColorStop(1,"#22c55e"),n.fillStyle=o,n.fillRect(a-2,s-i,2,i)},[]),W=(0,e.useCallback)(e=>{if(_.current){const t=Math.min(100,Math.max(0,e));_.current.style.width="".concat(t,"%")}P.current&&u&&V(e)},[u,V]),G=e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),a=t%60;return"".concat(n,":").concat(a.toString().padStart(2,"0"))};return j?!S||b||u?(0,x.jsxs)("div",{className:"voice-recorder ".concat(u?"recording":""," ").concat(m?"paused":""," ").concat(c?"compact":""," ").concat(l),children:[r&&(0,x.jsx)("button",{className:"recorder-close-btn",onClick:r,title:"Close",children:"\u2715"}),u&&(0,x.jsxs)("div",{className:"recording-status",children:[(0,x.jsxs)("div",{className:"recording-indicator",children:[(0,x.jsx)("div",{className:"recording-dot"}),(0,x.jsx)("span",{className:"recording-text",children:m?"Paused":"Recording"})]}),(0,x.jsx)("div",{className:"recording-duration",children:G(f)})]}),u&&!c&&(0,x.jsxs)("div",{className:"volume-visualization",children:[(0,x.jsxs)("div",{className:"volume-meter",children:[(0,x.jsx)("div",{className:"volume-label",children:"Volume"}),(0,x.jsx)("div",{className:"volume-bar-container",children:(0,x.jsx)("div",{ref:_,className:"volume-bar",style:{backgroundColor:v<20?"#6b7280":v<50?"#22c55e":v<80?"#f59e0b":"#ef4444"}})}),(0,x.jsxs)("div",{className:"volume-value",children:[v,"%"]})]}),(0,x.jsx)("div",{className:"waveform-container",children:(0,x.jsx)("canvas",{ref:P,className:"waveform-canvas",width:"200",height:"60"})})]}),u&&(0,x.jsxs)("div",{className:"recording-progress",children:[(0,x.jsx)("div",{className:"progress-bar",style:{width:"".concat(Math.min(100,f/i*100),"%")}}),(0,x.jsxs)("div",{className:"progress-time",children:[G(i-f)," remaining"]})]}),T&&!u&&(0,x.jsxs)("div",{className:"audio-preview",children:[(0,x.jsxs)("div",{className:"preview-header",children:[(0,x.jsx)("span",{className:"preview-title",children:"\ud83c\udfb5 Recording Preview"}),(0,x.jsxs)("span",{className:"preview-info",children:[G(T.duration)," \u2022 ",(T.size/1024).toFixed(0),"KB"]})]}),(0,x.jsx)(ee,{audioUrl:T.url,duration:T.duration,compact:!1}),(0,x.jsxs)("div",{className:"preview-actions",children:[(0,x.jsxs)("button",{className:"preview-btn save-btn",onClick:H,title:"Save recording",children:[(0,x.jsx)("span",{className:"btn-icon",children:"\u2705"}),(0,x.jsx)("span",{className:"btn-text",children:"Save & Send"})]}),(0,x.jsxs)("button",{className:"preview-btn discard-btn",onClick:q,title:"Record again",children:[(0,x.jsx)("span",{className:"btn-icon",children:"\ud83d\udd04"}),(0,x.jsx)("span",{className:"btn-text",children:"Record Again"})]})]})]}),!u&&!T&&!c&&(0,x.jsxs)("div",{className:"quality-selector",children:[(0,x.jsx)("label",{className:"quality-label",children:"Recording Quality:"}),(0,x.jsxs)("div",{className:"quality-options",children:[(0,x.jsx)("button",{className:"quality-btn ".concat("low"===I?"active":""),onClick:()=>M("low"),title:"Low quality - Smaller file size",children:"\ud83d\udcc9 Low"}),(0,x.jsx)("button",{className:"quality-btn ".concat("standard"===I?"active":""),onClick:()=>M("standard"),title:"Standard quality - Balanced",children:"\ud83d\udcca Standard"}),(0,x.jsx)("button",{className:"quality-btn ".concat("high"===I?"active":""),onClick:()=>M("high"),title:"High quality - Larger file size",children:"\ud83d\udcc8 High"})]}),(0,x.jsxs)("div",{className:"quality-info",children:["low"===I&&"22kHz, 64kbps - Best for voice notes","standard"===I&&"44kHz, 128kbps - Recommended","high"===I&&"48kHz, 256kbps - Best quality"]})]}),(0,x.jsx)("div",{className:"recording-controls",children:u?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("button",{className:"control-btn pause-resume-btn",onClick:m?U:O,title:m?"Resume recording":"Pause recording",children:[(0,x.jsx)("span",{className:"btn-icon",children:m?"\u25b6\ufe0f":"\u23f8\ufe0f"}),(0,x.jsx)("span",{className:"btn-text",children:m?"Resume":"Pause"})]}),(0,x.jsxs)("button",{className:"control-btn stop-btn",onClick:L,title:"Stop and save recording",children:[(0,x.jsx)("span",{className:"btn-icon",children:"\u23f9\ufe0f"}),(0,x.jsx)("span",{className:"btn-text",children:"Stop"})]}),(0,x.jsxs)("button",{className:"control-btn cancel-btn",onClick:F,title:"Cancel recording",children:[(0,x.jsx)("span",{className:"btn-icon",children:"\u274c"}),(0,x.jsx)("span",{className:"btn-text",children:"Cancel"})]})]}):(0,x.jsxs)("button",{className:"control-btn record-btn",onClick:z,title:"Start recording",children:[(0,x.jsx)("span",{className:"btn-icon",children:"\ud83c\udfa4"}),(0,x.jsx)("span",{className:"btn-text",children:"Record"})]})}),S&&(0,x.jsxs)("div",{className:"recorder-error",children:[(0,x.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)("span",{className:"error-text",children:S})]}),!u&&!c&&(0,x.jsxs)("div",{className:"recorder-info",children:[(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("span",{className:"info-label",children:"Max Duration:"}),(0,x.jsx)("span",{className:"info-value",children:G(i)})]}),(0,x.jsxs)("div",{className:"info-item",children:[(0,x.jsx)("span",{className:"info-label",children:"Format:"}),(0,x.jsx)("span",{className:"info-value",children:Z.config.mimeType.split(";")[0]})]})]})]}):(0,x.jsxs)("div",{className:"voice-recorder error ".concat(l),children:[r&&(0,x.jsx)("button",{className:"recorder-close-btn",onClick:r,title:"Close",children:"\u2715"}),(0,x.jsxs)("div",{className:"recorder-message",children:[(0,x.jsx)("span",{className:"error-icon",children:"\ud83c\udfa4\u274c"}),(0,x.jsx)("span",{className:"error-message",children:S}),(0,x.jsx)("div",{className:"error-help",children:(0,x.jsxs)("details",{children:[(0,x.jsx)("summary",{children:"How to fix microphone issues"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"\u2705 Click the lock icon in your browser's address bar"}),(0,x.jsx)("li",{children:"\u2705 Allow microphone permissions for this site"}),(0,x.jsx)("li",{children:"\u2705 Check your system microphone settings"}),(0,x.jsx)("li",{children:"\u2705 Make sure no other app is using the microphone"}),(0,x.jsx)("li",{children:"\u2705 Try refreshing the page"})]})]})}),(0,x.jsxs)("div",{className:"error-actions",children:[(0,x.jsxs)("button",{className:"retry-btn primary",onClick:B,disabled:C>=3,children:["\ud83d\udd04 ",C>0?"Retry (".concat(3-C," left)"):"Try Again"]}),(0,x.jsx)("button",{className:"test-btn secondary",onClick:async()=>{const e=await Z.testMicrophoneAccess();e.success?(k('\u2705 Microphone test passed! Click "Try Again" to record.'),w(!0),setTimeout(()=>k(null),3e3)):k(e.message)},children:"\ud83d\udd0d Test Microphone"})]})]})]}):(0,x.jsx)("div",{className:"voice-recorder loading ".concat(l),children:(0,x.jsxs)("div",{className:"recorder-message",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("span",{children:"Initializing voice recorder..."})]})})};class ne{constructor(){if(ne.instance)return ne.instance;this.db=null,this.dbName="QuibishFileShare",this.version=1,this.initialized=!1,this.maxFileSize=104857600,this.allowedTypes={images:["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"],videos:["video/mp4","video/webm","video/ogg"],audio:["audio/mpeg","audio/wav","audio/ogg","audio/webm"],documents:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/csv"],archives:["application/zip","application/x-rar-compressed","application/x-7z-compressed"]},this.activeTransfers=new Map,this.listeners={onUploadProgress:[],onUploadComplete:[],onUploadError:[],onDownloadProgress:[],onDownloadComplete:[],onFileDeleted:[],onFileShared:[]},ne.instance=this}async initialize(){return!!this.initialized||new Promise((e,t)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>{console.error("FileShareService: Failed to open database"),t(new Error("Failed to open database"))},n.onsuccess=t=>{this.db=t.target.result,this.initialized=!0,console.log("FileShareService: Database initialized"),e(!0)},n.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("files")){const e=t.createObjectStore("files",{keyPath:"id"});e.createIndex("userId","userId",{unique:!1}),e.createIndex("conversationId","conversationId",{unique:!1}),e.createIndex("uploadDate","uploadDate",{unique:!1}),e.createIndex("fileType","fileType",{unique:!1})}if(!t.objectStoreNames.contains("fileChunks")){t.createObjectStore("fileChunks",{keyPath:"id"}).createIndex("fileId","fileId",{unique:!1})}if(!t.objectStoreNames.contains("sharedFiles")){const e=t.createObjectStore("sharedFiles",{keyPath:"id"});e.createIndex("fileId","fileId",{unique:!1}),e.createIndex("sharedWith","sharedWith",{unique:!1})}console.log("FileShareService: Database schema created")}})}validateFile(e){const t=[];e.size>this.maxFileSize&&t.push("File size exceeds ".concat(this.maxFileSize/1048576,"MB limit"));return Object.values(this.allowedTypes).flat().includes(e.type)||t.push("File type ".concat(e.type," is not allowed")),/^[\w\-. ]+$/.test(e.name)||t.push("File name contains invalid characters"),{valid:0===t.length,errors:t}}getFileCategory(e){for(const[t,n]of Object.entries(this.allowedTypes))if(n.includes(e))return t;return"other"}async generateThumbnail(e){return new Promise(t=>{const n=new FileReader;n.onload=n=>{if(e.type.startsWith("image/")){const e=new Image;e.onload=()=>{const n=document.createElement("canvas"),a=n.getContext("2d"),s=200;let r=e.width,i=e.height;r>i?r>s&&(i*=s/r,r=s):i>s&&(r*=s/i,i=s),n.width=r,n.height=i,a.drawImage(e,0,0,r,i),t(n.toDataURL("image/jpeg",.7))},e.src=n.target.result}else if(e.type.startsWith("video/")){const e=document.createElement("video");e.onloadeddata=()=>{e.currentTime=1},e.onseeked=()=>{const n=document.createElement("canvas"),a=n.getContext("2d"),s=200;let r=e.videoWidth,i=e.videoHeight;r>i?r>s&&(i*=s/r,r=s):i>s&&(r*=s/i,i=s),n.width=r,n.height=i,a.drawImage(e,0,0,r,i),t(n.toDataURL("image/jpeg",.7))},e.src=n.target.result}else t(null)},n.readAsDataURL(e)})}async uploadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await this.initialize();const n=this.validateFile(e);if(!n.valid){const t=new Error(n.errors.join(", "));throw this.emitEvent("onUploadError",{file:e,error:t}),t}const a="file_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s={id:a,name:e.name,size:e.size,type:e.type,category:this.getFileCategory(e.type),uploadDate:(new Date).toISOString(),userId:t.userId||"anonymous",conversationId:t.conversationId||null,description:t.description||"",tags:t.tags||[],thumbnail:null,progress:0,status:"uploading"};if(e.type.startsWith("image/")||e.type.startsWith("video/"))try{s.thumbnail=await this.generateThumbnail(e)}catch(r){console.warn("Failed to generate thumbnail:",r)}this.activeTransfers.set(a,s);try{const t=await e.arrayBuffer(),n=65536;let r=0;const i=()=>new Promise(t=>{setTimeout(()=>{r+=n;const o=Math.min(100,r/e.size*100);s.progress=o,this.emitEvent("onUploadProgress",{fileId:a,progress:o,file:s}),o>=100?t():i().then(t)},50)});await i();const o=this.db.transaction(["files","fileChunks"],"readwrite"),l=o.objectStore("files"),c=o.objectStore("fileChunks");return s.status="completed",s.progress=100,l.put(s),c.put({id:"".concat(a,"_data"),fileId:a,data:t}),await new Promise((e,t)=>{o.oncomplete=e,o.onerror=t}),this.activeTransfers.delete(a),this.emitEvent("onUploadComplete",{fileId:a,file:s}),s}catch(i){throw s.status="error",s.error=i.message,this.emitEvent("onUploadError",{fileId:a,file:s,error:i}),this.activeTransfers.delete(a),i}}async uploadFiles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];for(const s of e)try{const e=await this.uploadFile(s,t);n.push({success:!0,file:e})}catch(a){n.push({success:!1,file:s.name,error:a.message})}return n}async downloadFile(e){await this.initialize();const t=this.db.transaction(["files","fileChunks"],"readonly"),n=t.objectStore("files"),a=t.objectStore("fileChunks"),s=n.get(e),r=await new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=t});if(!r)throw new Error("File not found");const i=a.get("".concat(e,"_data")),o=await new Promise((e,t)=>{i.onsuccess=()=>e(i.result),i.onerror=t});if(!o)throw new Error("File data not found");const l=new Blob([o.data],{type:r.type}),c=URL.createObjectURL(l),d=document.createElement("a");return d.href=c,d.download=r.name,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),this.emitEvent("onDownloadComplete",{fileId:e,file:r}),r}async getFile(e){await this.initialize();const t=this.db.transaction(["files"],"readonly").objectStore("files").get(e);return new Promise((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=n})}async getUserFiles(e){await this.initialize();const t=this.db.transaction(["files"],"readonly").objectStore("files").index("userId").getAll(e);return new Promise((e,n)=>{t.onsuccess=()=>{const n=t.result||[];e(n.sort((e,t)=>new Date(t.uploadDate)-new Date(e.uploadDate)))},t.onerror=n})}async getConversationFiles(e){await this.initialize();const t=this.db.transaction(["files"],"readonly").objectStore("files").index("conversationId").getAll(e);return new Promise((e,n)=>{t.onsuccess=()=>{const n=t.result||[];e(n.sort((e,t)=>new Date(t.uploadDate)-new Date(e.uploadDate)))},t.onerror=n})}async searchFiles(e){await this.initialize();const t=this.db.transaction(["files"],"readonly").objectStore("files").getAll();return new Promise((n,a)=>{t.onsuccess=()=>{const a=t.result||[],s=e.toLowerCase(),r=a.filter(e=>e.name.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)||e.tags.some(e=>e.toLowerCase().includes(s)));n(r.sort((e,t)=>new Date(t.uploadDate)-new Date(e.uploadDate)))},t.onerror=a})}async deleteFile(e){await this.initialize();const t=this.db.transaction(["files","fileChunks"],"readwrite"),n=t.objectStore("files"),a=t.objectStore("fileChunks"),s=n.get(e),r=await new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=t});return n.delete(e),a.delete("".concat(e,"_data")),await new Promise((e,n)=>{t.oncomplete=e,t.onerror=n}),this.emitEvent("onFileDeleted",{fileId:e,file:r}),!0}async getFileBlob(e){await this.initialize();const t=this.db.transaction(["files","fileChunks"],"readonly"),n=t.objectStore("files"),a=t.objectStore("fileChunks"),s=n.get(e),r=await new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=t});if(!r)throw new Error("File not found");const i=a.get("".concat(e,"_data")),o=await new Promise((e,t)=>{i.onsuccess=()=>e(i.result),i.onerror=t});if(!o)throw new Error("File data not found");return{blob:new Blob([o.data],{type:r.type}),metadata:r}}formatFileSize(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}on(e,t){this.listeners[e]&&this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}emitEvent(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>e(t))}async clearAllFiles(){await this.initialize();const e=this.db.transaction(["files","fileChunks","sharedFiles"],"readwrite");return e.objectStore("files").clear(),e.objectStore("fileChunks").clear(),e.objectStore("sharedFiles").clear(),await new Promise((t,n)=>{e.oncomplete=t,e.onerror=n}),console.log("FileShareService: All files cleared"),!0}}const ae=new ne,se=t=>{let{userId:n,conversationId:a,onClose:s,onFileSelect:r}=t;const[i,l]=(0,e.useState)([]),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)("all"),[f,g]=(0,e.useState)(""),[v,y]=(0,e.useState)(new Set),b=(0,e.useRef)(null);(0,e.useEffect)(()=>(document.body.classList.add("file-share-open"),()=>{document.body.classList.remove("file-share-open")}),[]),(0,e.useEffect)(()=>{w();const e=e=>{let{fileId:t,progress:n,file:a}=e;d(e=>{const s=e.findIndex(e=>e.id===t);if(s>=0){const t=[...e];return t[s]=o(o({},t[s]),{},{progress:n}),t}return[...e,o(o({},a),{},{progress:n})]})},t=e=>{let{file:t}=e;d(e=>e.filter(e=>e.id!==t.id)),w()},n=e=>{let{fileId:t}=e;d(e=>e.filter(e=>e.id!==t))},a=()=>{w()};return ae.on("onUploadProgress",e),ae.on("onUploadComplete",t),ae.on("onUploadError",n),ae.on("onFileDeleted",a),()=>{ae.off("onUploadProgress",e),ae.off("onUploadComplete",t),ae.off("onUploadError",n),ae.off("onFileDeleted",a)}},[a,n]);const w=(0,e.useCallback)(async()=>{try{let e;e=a?await ae.getConversationFiles(a):await ae.getUserFiles(n),l(e)}catch(e){console.error("Failed to load files:",e)}},[a,n]),S=(0,e.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?h(!0):"dragleave"===e.type&&h(!1)},[]),k=(0,e.useCallback)(async e=>{e.preventDefault(),e.stopPropagation(),h(!1);const t=Array.from(e.dataTransfer.files);t.length>0&&await N(t)},[n,a]),j=(0,e.useCallback)(async e=>{const t=Array.from(e.target.files);t.length>0&&await N(t),e.target.value=""},[n,a]),N=async e=>{try{await ae.uploadFiles(e,{userId:n,conversationId:a})}catch(t){console.error("Upload error:",t)}},C=e=>{const t={images:"\ud83d\uddbc\ufe0f",videos:"\ud83c\udfa5",audio:"\ud83c\udfb5",documents:"\ud83d\udcc4",archives:"\ud83d\udce6",other:"\ud83d\udcce"};return t[e.category]||t.other},E=i.filter(e=>{if("all"!==m&&e.category!==m)return!1;if(f){const t=f.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))}return!0});return(0,x.jsxs)("div",{className:"file-share-panel",children:[(0,x.jsxs)("div",{className:"file-share-header",children:[(0,x.jsx)("h2",{children:"\ud83d\udcc1 File Sharing"}),(0,x.jsx)("button",{className:"close-btn",onClick:s,children:"\u2715"})]}),(0,x.jsxs)("div",{className:"upload-area ".concat(u?"drag-active":""),onDragEnter:S,onDragLeave:S,onDragOver:S,onDrop:k,onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},children:[(0,x.jsx)("input",{ref:b,type:"file",multiple:!0,onChange:j,style:{display:"none"}}),(0,x.jsx)("div",{className:"upload-icon",children:"\ud83d\udce4"}),(0,x.jsx)("p",{className:"upload-text",children:u?"Drop files here":"Click or drag files to upload"}),(0,x.jsx)("p",{className:"upload-hint",children:"Max 100MB \u2022 Images, Videos, Audio, Documents, Archives"})]}),c.length>0&&(0,x.jsxs)("div",{className:"uploading-section",children:[(0,x.jsxs)("h3",{children:["Uploading (",c.length,")"]}),c.map(e=>(0,x.jsxs)("div",{className:"upload-progress-item",children:[(0,x.jsxs)("div",{className:"upload-info",children:[(0,x.jsx)("span",{className:"file-icon",children:C(e)}),(0,x.jsxs)("div",{className:"upload-details",children:[(0,x.jsx)("div",{className:"upload-name",children:e.name}),(0,x.jsx)("div",{className:"upload-size",children:ae.formatFileSize(e.size)})]})]}),(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"".concat(e.progress,"%")}})}),(0,x.jsxs)("div",{className:"progress-text",children:[Math.round(e.progress),"%"]})]},e.id))]}),(0,x.jsxs)("div",{className:"file-controls",children:[(0,x.jsxs)("div",{className:"filter-tabs",children:[(0,x.jsx)("button",{className:"all"===m?"active":"",onClick:()=>p("all"),children:"All"}),(0,x.jsx)("button",{className:"images"===m?"active":"",onClick:()=>p("images"),children:"\ud83d\uddbc\ufe0f Images"}),(0,x.jsx)("button",{className:"videos"===m?"active":"",onClick:()=>p("videos"),children:"\ud83c\udfa5 Videos"}),(0,x.jsx)("button",{className:"documents"===m?"active":"",onClick:()=>p("documents"),children:"\ud83d\udcc4 Docs"}),(0,x.jsx)("button",{className:"audio"===m?"active":"",onClick:()=>p("audio"),children:"\ud83c\udfb5 Audio"})]}),(0,x.jsx)("div",{className:"search-box",children:(0,x.jsx)("input",{type:"text",placeholder:"Search files...",value:f,onChange:e=>g(e.target.value)})})]}),v.size>0&&(0,x.jsxs)("div",{className:"bulk-actions",children:[(0,x.jsxs)("span",{children:[v.size," selected"]}),(0,x.jsx)("button",{onClick:async()=>{if(window.confirm("Delete ".concat(v.size," selected files?")))try{for(const e of v)await ae.deleteFile(e);y(new Set)}catch(e){console.error("Bulk delete error:",e)}},className:"bulk-delete-btn",children:"\ud83d\uddd1\ufe0f Delete Selected"}),(0,x.jsx)("button",{onClick:()=>y(new Set),className:"bulk-clear-btn",children:"Clear Selection"})]}),(0,x.jsx)("div",{className:"file-list",children:0===E.length?(0,x.jsxs)("div",{className:"empty-state",children:[(0,x.jsx)("div",{className:"empty-icon",children:"\ud83d\udced"}),(0,x.jsx)("p",{children:"No files found"}),(0,x.jsx)("p",{className:"empty-hint",children:"Upload files to get started"})]}):(0,x.jsx)("div",{className:"file-grid",children:E.map(e=>(0,x.jsxs)("div",{className:"file-item ".concat(v.has(e.id)?"selected":""),onClick:()=>(e=>{r&&r(e)})(e),children:[(0,x.jsx)("div",{className:"file-checkbox",children:(0,x.jsx)("input",{type:"checkbox",checked:v.has(e.id),onChange:t=>((e,t)=>{t.stopPropagation(),y(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})})(e.id,t)})}),e.thumbnail?(0,x.jsx)("div",{className:"file-thumbnail",style:{backgroundImage:"url(".concat(e.thumbnail,")")}}):(0,x.jsx)("div",{className:"file-icon-large",children:C(e)}),(0,x.jsxs)("div",{className:"file-details",children:[(0,x.jsx)("div",{className:"file-name",title:e.name,children:e.name}),(0,x.jsxs)("div",{className:"file-meta",children:[(0,x.jsx)("span",{children:ae.formatFileSize(e.size)}),(0,x.jsx)("span",{children:"\u2022"}),(0,x.jsx)("span",{children:new Date(e.uploadDate).toLocaleDateString()})]})]}),(0,x.jsxs)("div",{className:"file-actions",children:[(0,x.jsx)("button",{className:"file-action-btn download",onClick:t=>(async(e,t)=>{t.stopPropagation();try{await ae.downloadFile(e)}catch(n){console.error("Download error:",n)}})(e.id,t),title:"Download",children:"\u2b07\ufe0f"}),(0,x.jsx)("button",{className:"file-action-btn delete",onClick:t=>(async(e,t)=>{if(t.stopPropagation(),window.confirm("Are you sure you want to delete this file?"))try{await ae.deleteFile(e)}catch(n){console.error("Delete error:",n)}})(e.id,t),title:"Delete",children:"\ud83d\uddd1\ufe0f"})]})]},e.id))})})]})},re=t=>{let{fileId:n,onClose:a}=t;const[s,r]=(0,e.useState)(null),[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(!0),[d,u]=(0,e.useState)(null);(0,e.useEffect)(()=>(h(),()=>{i&&URL.revokeObjectURL(i)}),[n]);const h=async()=>{try{c(!0);const{blob:e,metadata:t}=await ae.getFileBlob(n),a=URL.createObjectURL(e);o(a),r(t),c(!1)}catch(e){console.error("Failed to load file:",e),u(e.message),c(!1)}},m=async()=>{try{await ae.downloadFile(n)}catch(e){console.error("Download failed:",e)}};return l?(0,x.jsx)("div",{className:"file-preview-modal",children:(0,x.jsxs)("div",{className:"file-preview-content loading",children:[(0,x.jsx)("div",{className:"loader-spinner"}),(0,x.jsx)("p",{children:"Loading preview..."})]})}):d?(0,x.jsx)("div",{className:"file-preview-modal",children:(0,x.jsxs)("div",{className:"file-preview-content error",children:[(0,x.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)("h3",{children:"Failed to load file"}),(0,x.jsx)("p",{children:d}),(0,x.jsx)("button",{onClick:a,children:"Close"})]})}):(0,x.jsx)("div",{className:"file-preview-modal",onClick:a,children:(0,x.jsxs)("div",{className:"file-preview-content",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"preview-header",children:[(0,x.jsxs)("div",{className:"preview-info",children:[(0,x.jsx)("h2",{children:s.name}),(0,x.jsxs)("div",{className:"preview-meta",children:[(0,x.jsx)("span",{children:ae.formatFileSize(s.size)}),(0,x.jsx)("span",{children:"\u2022"}),(0,x.jsx)("span",{children:new Date(s.uploadDate).toLocaleString()})]})]}),(0,x.jsx)("button",{className:"preview-close-btn",onClick:a,children:"\u2715"})]}),(()=>{if(!s||!i)return null;const{category:e,type:t}=s;return"images"===e?(0,x.jsx)("div",{className:"preview-content image-preview",children:(0,x.jsx)("img",{src:i,alt:s.name})}):"videos"===e?(0,x.jsx)("div",{className:"preview-content video-preview",children:(0,x.jsx)("video",{controls:!0,src:i,children:"Your browser does not support video playback."})}):"audio"===e?(0,x.jsxs)("div",{className:"preview-content audio-preview",children:[(0,x.jsx)("div",{className:"audio-icon",children:"\ud83c\udfb5"}),(0,x.jsx)("audio",{controls:!0,src:i,children:"Your browser does not support audio playback."})]}):"application/pdf"===t?(0,x.jsx)("div",{className:"preview-content pdf-preview",children:(0,x.jsx)("iframe",{src:i,title:s.name})}):"text/plain"===t?(0,x.jsx)("div",{className:"preview-content text-preview",children:(0,x.jsx)("iframe",{src:i,title:s.name})}):(0,x.jsxs)("div",{className:"preview-content generic-preview",children:[(0,x.jsx)("div",{className:"generic-icon",children:"\ud83d\udcc4"}),(0,x.jsx)("h3",{children:s.name}),(0,x.jsx)("p",{className:"generic-hint",children:"This file type cannot be previewed in the browser"}),(0,x.jsx)("button",{className:"download-preview-btn",onClick:m,children:"\u2b07\ufe0f Download to View"})]})})(),(0,x.jsxs)("div",{className:"preview-actions",children:[(0,x.jsx)("button",{className:"preview-btn download-btn",onClick:m,children:"\u2b07\ufe0f Download"}),(0,x.jsx)("button",{className:"preview-btn delete-btn",onClick:async()=>{if(window.confirm("Are you sure you want to delete this file?"))try{await ae.deleteFile(n),a()}catch(e){console.error("Delete failed:",e)}},children:"\ud83d\uddd1\ufe0f Delete"})]}),s.description&&(0,x.jsxs)("div",{className:"preview-description",children:[(0,x.jsx)("h4",{children:"Description"}),(0,x.jsx)("p",{children:s.description})]}),s.tags&&s.tags.length>0&&(0,x.jsxs)("div",{className:"preview-tags",children:[(0,x.jsx)("h4",{children:"Tags"}),(0,x.jsx)("div",{className:"tag-list",children:s.tags.map((e,t)=>(0,x.jsx)("span",{className:"tag",children:e},t))})]})]})})};class ie{constructor(){if(ie.instance)return ie.instance;this.peerConnection=null,this.localStream=null,this.remoteStream=null,this.screenStream=null,this.mediaRecorder=null,this.recordedChunks=[],this.callState={active:!1,participants:[],callId:null,startTime:null,duration:0,isScreenSharing:!1,isRecording:!1,isMuted:!1,isVideoOff:!1,layout:"grid",quality:"auto"},this.devices={cameras:[],microphones:[],speakers:[],selectedCamera:null,selectedMicrophone:null,selectedSpeaker:null},this.virtualBackground={enabled:!1,type:"none",image:null,blurAmount:10},this.stats={bytesReceived:0,bytesSent:0,packetsLost:0,jitter:0,roundTripTime:0,bandwidth:0,quality:"good"},this.listeners={onCallStart:[],onCallEnd:[],onParticipantJoin:[],onParticipantLeave:[],onStreamUpdate:[],onScreenShare:[],onRecordingUpdate:[],onQualityChange:[],onError:[]},this.rtcConfig={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]},ie.instance=this}async initialize(){try{return await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),await this.enumerateDevices(),console.log("EnhancedVideoCallService: Initialized"),!0}catch(e){return console.error("Failed to initialize video call service:",e),this.emitEvent("onError",{error:"Failed to initialize devices"}),!1}}async enumerateDevices(){try{const e=await navigator.mediaDevices.enumerateDevices();return this.devices.cameras=e.filter(e=>"videoinput"===e.kind),this.devices.microphones=e.filter(e=>"audioinput"===e.kind),this.devices.speakers=e.filter(e=>"audiooutput"===e.kind),!this.devices.selectedCamera&&this.devices.cameras.length>0&&(this.devices.selectedCamera=this.devices.cameras[0].deviceId),!this.devices.selectedMicrophone&&this.devices.microphones.length>0&&(this.devices.selectedMicrophone=this.devices.microphones[0].deviceId),!this.devices.selectedSpeaker&&this.devices.speakers.length>0&&(this.devices.selectedSpeaker=this.devices.speakers[0].deviceId),this.devices}catch(e){return console.error("Failed to enumerate devices:",e),this.devices}}getQualityConstraints(){const e={high:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},medium:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:24}},low:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:15}},auto:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:24}}};return e[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto"]||e.auto}async startCall(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const{callId:t="call_".concat(Date.now()),participants:n=[],quality:a="auto"}=e,s={video:o(o({},this.getQualityConstraints(a)),{},{deviceId:this.devices.selectedCamera?{exact:this.devices.selectedCamera}:void 0}),audio:{deviceId:this.devices.selectedMicrophone?{exact:this.devices.selectedMicrophone}:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}};return this.localStream=await navigator.mediaDevices.getUserMedia(s),this.callState={active:!0,participants:[{id:"local",name:"You",stream:this.localStream}],callId:t,startTime:new Date,duration:0,isScreenSharing:!1,isRecording:!1,isMuted:!1,isVideoOff:!1,layout:"grid",quality:a},this.startDurationTimer(),this.virtualBackground.enabled&&await this.applyVirtualBackground(),this.emitEvent("onCallStart",{callId:t,stream:this.localStream}),{success:!0,callId:t,stream:this.localStream}}catch(t){return console.error("Failed to start video call:",t),this.emitEvent("onError",{error:t.message}),{success:!1,error:t.message}}}async endCall(){try{this.localStream&&(this.localStream.getTracks().forEach(e=>e.stop()),this.localStream=null),this.remoteStream&&(this.remoteStream.getTracks().forEach(e=>e.stop()),this.remoteStream=null),this.screenStream&&(this.screenStream.getTracks().forEach(e=>e.stop()),this.screenStream=null),this.callState.isRecording&&await this.stopRecording(),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.stopDurationTimer();const e=o({},this.callState);return this.callState={active:!1,participants:[],callId:null,startTime:null,duration:0,isScreenSharing:!1,isRecording:!1,isMuted:!1,isVideoOff:!1,layout:"grid",quality:"auto"},this.emitEvent("onCallEnd",e),!0}catch(e){return console.error("Failed to end call:",e),!1}}toggleMute(){if(!this.localStream)return!1;return this.localStream.getAudioTracks().forEach(e=>{e.enabled=!e.enabled}),this.callState.isMuted=!this.callState.isMuted,this.emitEvent("onStreamUpdate",{type:"audio",muted:this.callState.isMuted}),this.callState.isMuted}toggleVideo(){if(!this.localStream)return!1;return this.localStream.getVideoTracks().forEach(e=>{e.enabled=!e.enabled}),this.callState.isVideoOff=!this.callState.isVideoOff,this.emitEvent("onStreamUpdate",{type:"video",off:this.callState.isVideoOff}),this.callState.isVideoOff}async startScreenShare(){try{return this.screenStream=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",displaySurface:"monitor"},audio:!0}),this.screenStream.getVideoTracks()[0].onended=()=>{this.stopScreenShare()},this.callState.isScreenSharing=!0,this.emitEvent("onScreenShare",{started:!0,stream:this.screenStream}),this.screenStream}catch(e){return console.error("Failed to start screen share:",e),this.emitEvent("onError",{error:"Screen sharing failed"}),null}}stopScreenShare(){this.screenStream&&(this.screenStream.getTracks().forEach(e=>e.stop()),this.screenStream=null),this.callState.isScreenSharing=!1,this.emitEvent("onScreenShare",{started:!1})}async startRecording(){try{if(!this.localStream)throw new Error("No active stream to record");const e=document.createElement("canvas");e.width=1280,e.height=720;const t=e.getContext("2d"),n=document.createElement("video");n.srcObject=this.localStream,n.play();const a=e.captureStream(30);this.localStream.getAudioTracks().forEach(e=>a.addTrack(e)),this.mediaRecorder=new MediaRecorder(a,{mimeType:"video/webm;codecs=vp9",videoBitsPerSecond:25e5}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.recordedChunks.push(e.data)},this.mediaRecorder.onstop=()=>{const e=new Blob(this.recordedChunks,{type:"video/webm"}),t=URL.createObjectURL(e);this.emitEvent("onRecordingUpdate",{recording:!1,blob:e,url:t,duration:this.callState.duration})};const s=()=>{this.callState.isRecording&&(t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),n.readyState===n.HAVE_ENOUGH_DATA&&t.drawImage(n,0,0,e.width,e.height),requestAnimationFrame(s))};return this.mediaRecorder.start(1e3),s(),this.callState.isRecording=!0,this.emitEvent("onRecordingUpdate",{recording:!0}),!0}catch(e){return console.error("Failed to start recording:",e),this.emitEvent("onError",{error:"Recording failed"}),!1}}async stopRecording(){return!(!this.mediaRecorder||"inactive"===this.mediaRecorder.state)&&(this.mediaRecorder.stop(),this.callState.isRecording=!1,!0)}async pauseRecording(){return!(!this.mediaRecorder||"recording"!==this.mediaRecorder.state)&&(this.mediaRecorder.pause(),!0)}async resumeRecording(){return!(!this.mediaRecorder||"paused"!==this.mediaRecorder.state)&&(this.mediaRecorder.resume(),!0)}setRecordingQuality(e){const t={low:1e6,medium:25e5,high:5e6};return this.recordingBitrate=t[e]||t.high,!0}downloadRecording(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video-call-recording.webm";const n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)}async changeQuality(e){if(!this.localStream)return!1;try{const t=this.localStream.getVideoTracks()[0],n=this.getQualityConstraints(e);return await t.applyConstraints(n),this.callState.quality=e,this.emitEvent("onQualityChange",{quality:e}),!0}catch(t){return console.error("Failed to change quality:",t),!1}}async switchCamera(e){if(!this.localStream)return!1;try{const t=this.localStream.getVideoTracks()[0];t.stop();const n={video:o(o({},this.getQualityConstraints(this.callState.quality)),{},{deviceId:{exact:e}})},a=(await navigator.mediaDevices.getUserMedia(n)).getVideoTracks()[0];if(this.localStream.removeTrack(t),this.localStream.addTrack(a),this.peerConnection){const e=this.peerConnection.getSenders().find(e=>"video"===e.track.kind);e&&await e.replaceTrack(a)}return this.devices.selectedCamera=e,this.emitEvent("onStreamUpdate",{type:"camera",deviceId:e}),!0}catch(t){return console.error("Failed to switch camera:",t),!1}}async switchMicrophone(e){if(!this.localStream)return!1;try{const t=this.localStream.getAudioTracks()[0];t.stop();const n={audio:{deviceId:{exact:e},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},a=(await navigator.mediaDevices.getUserMedia(n)).getAudioTracks()[0];if(this.localStream.removeTrack(t),this.localStream.addTrack(a),this.peerConnection){const e=this.peerConnection.getSenders().find(e=>"audio"===e.track.kind);e&&await e.replaceTrack(a)}return this.devices.selectedMicrophone=e,this.emitEvent("onStreamUpdate",{type:"microphone",deviceId:e}),!0}catch(t){return console.error("Failed to switch microphone:",t),!1}}async enableBackgroundBlur(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.virtualBackground={enabled:!0,type:"blur",image:null,blurAmount:e},this.localStream&&await this.applyVirtualBackground(),!0}async disableVirtualBackground(){return this.virtualBackground={enabled:!1,type:"none",image:null,blurAmount:10},this.callState.active,!0}async applyVirtualBackground(){return console.log("Virtual background applied:",this.virtualBackground.type),!0}changeLayout(e){return!!["grid","speaker","pip"].includes(e)&&(this.callState.layout=e,this.emitEvent("onStreamUpdate",{type:"layout",layout:e}),!0)}startDurationTimer(){this.durationInterval=setInterval(()=>{this.callState.startTime&&(this.callState.duration=Math.floor((new Date-this.callState.startTime)/1e3))},1e3)}stopDurationTimer(){this.durationInterval&&(clearInterval(this.durationInterval),this.durationInterval=null)}formatDuration(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=e%60;return t>0?"".concat(t,":").concat(String(n).padStart(2,"0"),":").concat(String(a).padStart(2,"0")):"".concat(n,":").concat(String(a).padStart(2,"0"))}getCallState(){return o({},this.callState)}getDevices(){return o({},this.devices)}getStats(){return o({},this.stats)}on(e,t){this.listeners[e]&&this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}emitEvent(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>e(t))}}const oe=new ie;class le{constructor(){if(le.instance)return le.instance;this.canvas=null,this.ctx=null,this.videoElement=null,this.outputStream=null,this.animationFrame=null,this.filters={smoothSkin:0,brighten:0,eyeEnhance:!1,lipEnhance:!1,slimFace:0,brightness:0,contrast:0,saturation:0,temperature:0,tint:0,exposure:0,highlights:0,shadows:0,vibrance:0,blur:0,sharpen:0,vignette:0,grain:0,arEffect:"none",arColor:"#ffffff",preset:"none"},this.presets={none:{},natural:{smoothSkin:30,brighten:10,saturation:5,vibrance:10},vivid:{brightness:10,contrast:15,saturation:30,vibrance:25,sharpen:20},dramatic:{contrast:35,shadows:-20,highlights:20,saturation:20,vignette:40},vintage:{saturation:-30,temperature:20,grain:30,vignette:50,contrast:-10},cool:{temperature:-40,tint:10,brightness:5,saturation:10},warm:{temperature:40,brightness:10,saturation:15,smoothSkin:20}},this.faceDetected=!1,this.facePosition=null,le.instance=this}initialize(e){return this.videoElement=e,this.canvas=document.createElement("canvas"),this.canvas.width=1280,this.canvas.height=720,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),console.log("VideoFiltersService: Initialized"),!0}startProcessing(){return this.videoElement&&this.canvas?(this.outputStream=this.canvas.captureStream(30),this.renderFrame(),this.outputStream):(console.error("Video filters not initialized"),null)}stopProcessing(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null),this.outputStream&&(this.outputStream.getTracks().forEach(e=>e.stop()),this.outputStream=null)}renderFrame(){if(!this.videoElement||this.videoElement.paused||this.videoElement.ended)return;this.ctx.drawImage(this.videoElement,0,0,this.canvas.width,this.canvas.height);let e=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);e=this.applyBeautyFilters(e),e=this.applyColorAdjustments(e),e=this.applyEffects(e),this.ctx.putImageData(e,0,0),this.applyAREffects(),this.animationFrame=requestAnimationFrame(()=>this.renderFrame())}applyBeautyFilters(e){const t=e.data;if(this.filters.smoothSkin>0){const t=Math.floor(this.filters.smoothSkin/20)+1;e=this.applyGaussianBlur(e,t)}if(this.filters.brighten>0){const e=1.5*this.filters.brighten;for(let n=0;n<t.length;n+=4)t[n]=Math.min(255,t[n]+e),t[n+1]=Math.min(255,t[n+1]+e),t[n+2]=Math.min(255,t[n+2]+e)}return e}applyColorAdjustments(e){const t=e.data;for(let n=0;n<t.length;n+=4){let e=t[n],a=t[n+1],s=t[n+2];if(0!==this.filters.brightness){const t=2.55*this.filters.brightness;e=Math.max(0,Math.min(255,e+t)),a=Math.max(0,Math.min(255,a+t)),s=Math.max(0,Math.min(255,s+t))}if(0!==this.filters.contrast){const t=259*(this.filters.contrast+255)/(255*(259-this.filters.contrast));e=Math.max(0,Math.min(255,t*(e-128)+128)),a=Math.max(0,Math.min(255,t*(a-128)+128)),s=Math.max(0,Math.min(255,t*(s-128)+128))}if(0!==this.filters.saturation){const t=.2989*e+.587*a+.114*s,n=1+this.filters.saturation/100;e=Math.max(0,Math.min(255,t+n*(e-t))),a=Math.max(0,Math.min(255,t+n*(a-t))),s=Math.max(0,Math.min(255,t+n*(s-t)))}if(0!==this.filters.temperature){const t=this.filters.temperature/100;t>0?(e=Math.min(255,e+30*t),s=Math.max(0,s-30*t)):(e=Math.max(0,e+30*t),s=Math.min(255,s-30*t))}if(0!==this.filters.tint){const t=this.filters.tint/100;t>0?a=Math.min(255,a+30*t):(e=Math.min(255,e-15*t),s=Math.min(255,s-15*t),a=Math.max(0,a+30*t))}if(0!==this.filters.exposure){const t=Math.pow(2,this.filters.exposure/100);e=Math.min(255,e*t),a=Math.min(255,a*t),s=Math.min(255,s*t)}if(0!==this.filters.vibrance){const t=Math.max(e,a,s),n=(e+a+s)/3,r=this.filters.vibrance/100*(1-t/255)*(t-n)/128;e=Math.max(0,Math.min(255,e+(e-n)*r)),a=Math.max(0,Math.min(255,a+(a-n)*r)),s=Math.max(0,Math.min(255,s+(s-n)*r))}t[n]=e,t[n+1]=a,t[n+2]=s}return e}applyEffects(e){return this.filters.sharpen>0&&(e=this.applySharpen(e,this.filters.sharpen/100)),this.filters.vignette>0&&(e=this.applyVignette(e,this.filters.vignette/100)),this.filters.grain>0&&(e=this.applyGrain(e,this.filters.grain/100)),e}applyGaussianBlur(e,t){const n=e.data,a=e.width,s=e.height,r=new Uint8ClampedArray(n);for(let i=0;i<s;i++)for(let e=0;e<a;e++){let o=0,l=0,c=0,d=0;for(let n=-t;n<=t;n++)for(let u=-t;u<=t;u++){const t=Math.min(a-1,Math.max(0,e+u)),h=4*(Math.min(s-1,Math.max(0,i+n))*a+t);o+=r[h],l+=r[h+1],c+=r[h+2],d++}const u=4*(i*a+e);n[u]=o/d,n[u+1]=l/d,n[u+2]=c/d}return e}applySharpen(e,t){const n=e.data,a=e.width,s=e.height,r=new Uint8ClampedArray(n),i=[0,-t,0,-t,1+4*t,-t,0,-t,0];for(let o=1;o<s-1;o++)for(let e=1;e<a-1;e++){let t=0,s=0,l=0;for(let n=-1;n<=1;n++)for(let c=-1;c<=1;c++){const d=4*((o+n)*a+(e+c)),u=i[3*(n+1)+(c+1)];t+=r[d]*u,s+=r[d+1]*u,l+=r[d+2]*u}const c=4*(o*a+e);n[c]=Math.max(0,Math.min(255,t)),n[c+1]=Math.max(0,Math.min(255,s)),n[c+2]=Math.max(0,Math.min(255,l))}return e}applyVignette(e,t){const n=e.data,a=e.width,s=e.height,r=a/2,i=s/2,o=Math.sqrt(r*r+i*i);for(let l=0;l<s;l++)for(let e=0;e<a;e++){const s=e-r,c=l-i,d=1-Math.sqrt(s*s+c*c)/o*t,u=4*(l*a+e);n[u]*=d,n[u+1]*=d,n[u+2]*=d}return e}applyGrain(e,t){const n=e.data,a=50*t;for(let s=0;s<n.length;s+=4){const e=(Math.random()-.5)*a;n[s]=Math.max(0,Math.min(255,n[s]+e)),n[s+1]=Math.max(0,Math.min(255,n[s+1]+e)),n[s+2]=Math.max(0,Math.min(255,n[s+2]+e))}return e}applyAREffects(){if("none"===this.filters.arEffect)return;const e=this.canvas.width,t=this.canvas.height,n=e/2,a=t/2.5,s=e/4,r=t/3;switch(this.ctx.save(),this.filters.arEffect){case"glasses":this.drawGlasses(n,a,s);break;case"hat":this.drawHat(n,a,s);break;case"mask":this.drawMask(n,a,s,r);break;case"ears":this.drawEars(n,a,s,r);break;case"mustache":this.drawMustache(n,a+r/3,s)}this.ctx.restore()}drawGlasses(e,t,n){const a=1.2*n,s=n/3,r=a/2.5;this.ctx.strokeStyle=this.filters.arColor,this.ctx.lineWidth=8,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.beginPath(),this.ctx.roundRect(e-a/2+20,t-s/2,r,s,10),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.roundRect(e+a/2-r-20,t-s/2,r,s,10),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(e-20,t),this.ctx.lineTo(e+20,t),this.ctx.stroke(),this.ctx.fillStyle="rgba(100, 100, 100, 0.3)",this.ctx.beginPath(),this.ctx.roundRect(e-a/2+20,t-s/2,r,s,10),this.ctx.fill(),this.ctx.beginPath(),this.ctx.roundRect(e+a/2-r-20,t-s/2,r,s,10),this.ctx.fill()}drawHat(e,t,n){const a=1.5*n,s=1.2*n;this.ctx.fillStyle=this.filters.arColor,this.ctx.strokeStyle="#000",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.ellipse(e,t-s,a/3,s/4,0,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.ellipse(e,t-s/2,a/2,s/8,0,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke()}drawMask(e,t,n,a){this.ctx.fillStyle=this.filters.arColor,this.ctx.strokeStyle="#000",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.ellipse(e,t,n/1.8,a/2.5,0,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.fillStyle="#000",this.ctx.beginPath(),this.ctx.ellipse(e-n/4,t-a/12,n/8,a/10,0,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.ellipse(e+n/4,t-a/12,n/8,a/10,0,0,2*Math.PI),this.ctx.fill()}drawEars(e,t,n,a){this.ctx.fillStyle=this.filters.arColor,this.ctx.strokeStyle="#000",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.ellipse(e-n/1.5,t-a/3,n/4,a/2.5,-.3,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.ellipse(e+n/1.5,t-a/3,n/4,a/2.5,.3,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.fillStyle="rgba(255, 182, 193, 0.7)",this.ctx.beginPath(),this.ctx.ellipse(e-n/1.5,t-a/3,n/6,a/4,-.3,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.ellipse(e+n/1.5,t-a/3,n/6,a/4,.3,0,2*Math.PI),this.ctx.fill()}drawMustache(e,t,n){this.ctx.fillStyle=this.filters.arColor,this.ctx.strokeStyle="#000",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.bezierCurveTo(e-n/3,t-n/6,e-n/2,t+n/12,e-n/1.5,t),this.ctx.bezierCurveTo(e-n/1.5,t+n/8,e-n/4,t+n/10,e,t+n/20),this.ctx.bezierCurveTo(e+n/4,t+n/10,e+n/1.5,t+n/8,e+n/1.5,t),this.ctx.bezierCurveTo(e+n/2,t+n/12,e+n/3,t-n/6,e,t),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}setFilter(e,t){return!!this.filters.hasOwnProperty(e)&&(this.filters[e]=t,!0)}applyPreset(e){if(!this.presets[e])return!1;this.resetFilters();const t=this.presets[e];return Object.keys(t).forEach(e=>{this.filters[e]=t[e]}),this.filters.preset=e,!0}resetFilters(){this.filters={smoothSkin:0,brighten:0,eyeEnhance:!1,lipEnhance:!1,slimFace:0,brightness:0,contrast:0,saturation:0,temperature:0,tint:0,exposure:0,highlights:0,shadows:0,vibrance:0,blur:0,sharpen:0,vignette:0,grain:0,arEffect:"none",arColor:"#ffffff",preset:"none"}}getFilters(){return o({},this.filters)}getPresets(){return Object.keys(this.presets)}getAREffects(){return["none","glasses","hat","mask","ears","mustache"]}}const ce=new le,de=t=>{let{onClose:n,callId:a,participants:s=[]}=t;const[r,i]=(0,e.useState)(null),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)("grid"),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(null),[b,w]=(0,e.useState)("none"),[S,k]=(0,e.useState)("good"),[j,N]=(0,e.useState)(0),[C,E]=(0,e.useState)(0),[T,A]=(0,e.useState)(!1),[I,M]=(0,e.useState)(0),[D,P]=(0,e.useState)(!1),[_,R]=(0,e.useState)(""),[z,F]=(0,e.useState)(!1),[L,O]=(0,e.useState)(null),[U,B]=(0,e.useState)(!0),[H,q]=(0,e.useState)([]),[V,W]=(0,e.useState)(null),[G,K]=(0,e.useState)(!1),[Q,Y]=(0,e.useState)(!1),[$,J]=(0,e.useState)(!1),[X,Z]=(0,e.useState)("high"),ee=(0,e.useRef)(null),te=(0,e.useRef)(null),ne=(0,e.useRef)(null),ae=(0,e.useRef)(null),se=(0,e.useRef)(null),re=(0,e.useRef)(null),ie=(0,e.useRef)([]),le=(0,e.useRef)(null),de=(0,e.useRef)(null),ue=(0,e.useRef)(null);(0,e.useEffect)(()=>{he();const e=()=>{n()},t=e=>{me()},a=e=>{e.started&&ne.current&&(ne.current.srcObject=e.stream)},s=e=>{if(!e.recording&&e.blob){window.confirm("Recording complete! Download now?")&&oe.downloadRecording(e.blob)}};oe.on("onCallEnd",e),oe.on("onStreamUpdate",t),oe.on("onScreenShare",a),oe.on("onRecordingUpdate",s);const r=setInterval(()=>{const e=["excellent","good","poor"],t=e[Math.floor(Math.random()*e.length)];k(t)},1e4);return()=>{oe.off("onCallEnd",e),oe.off("onStreamUpdate",t),oe.off("onScreenShare",a),oe.off("onRecordingUpdate",s),clearInterval(r),le.current&&clearInterval(le.current),re.current&&"inactive"!==re.current.state&&re.current.stop(),de.current&&de.current.stop(),ue.current&&clearInterval(ue.current)}},[]),(0,e.useEffect)(()=>{const e=se.current;if(!e)return;const t=e=>{N(e.touches[0].clientY)},n=e=>{const t=e.touches[0].clientY-j;t>0&&E(t)},a=()=>{C>100&&g(!0),E(0)};return e.addEventListener("touchstart",t),e.addEventListener("touchmove",n),e.addEventListener("touchend",a),()=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n),e.removeEventListener("touchend",a)}},[j,C]);const he=async()=>{try{await oe.initialize();const e=await oe.startCall({callId:a,participants:s,quality:"auto"});if(e.success){if(y(ce.getFilters()),ae.current){ae.current.srcObject=e.stream,await ae.current.play(),ce.initialize(ae.current);const t=ce.startProcessing();ee.current&&t&&(ee.current.srcObject=t)}}else y(ce.getFilters())}catch(e){console.error("Failed to initialize call:",e),y(ce.getFilters())}me(),pe()},me=()=>{i(oe.getCallState())},pe=()=>{l(oe.getDevices())},fe=(0,e.useCallback)(()=>{oe.endCall()},[]),ge=(0,e.useCallback)(()=>{oe.toggleMute(),me()},[]),ve=(0,e.useCallback)(()=>{oe.toggleVideo(),me()},[]),ye=(0,e.useCallback)(async()=>{null!==r&&void 0!==r&&r.isScreenSharing?oe.stopScreenShare():await oe.startScreenShare(),me()},[r]),be=(0,e.useCallback)(async()=>{null!==r&&void 0!==r&&r.isRecording?await oe.stopRecording():await oe.startRecording(),me()},[r]),xe=(0,e.useCallback)(e=>{oe.changeLayout(e),p(e),me()},[]),we=(0,e.useCallback)(async e=>{await oe.changeQuality(e),me()},[]),Se=(0,e.useCallback)(async e=>{await oe.switchCamera(e),pe()},[]),ke=(0,e.useCallback)(async e=>{await oe.switchMicrophone(e),pe()},[]),je=(0,e.useCallback)(async()=>{await oe.enableBackgroundBlur(15),me()},[]),Ne=(0,e.useCallback)((e,t)=>{ce.setFilter(e,t),y(ce.getFilters())},[]),Ce=(0,e.useCallback)(e=>{ce.applyPreset(e),y(ce.getFilters()),w(e)},[]),Ee=(0,e.useCallback)(e=>{ce.setFilter("arEffect",e),y(ce.getFilters())},[]),Te=(0,e.useCallback)(()=>{ce.resetFilters(),y(ce.getFilters()),w("none")},[]),Ae=(0,e.useCallback)(async()=>{if(T)re.current&&"inactive"!==re.current.state&&re.current.stop(),le.current&&(clearInterval(le.current),le.current=null),A(!1),M(0);else try{const e=await navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"monitor",cursor:"always",width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30}},audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});if(!window.MediaRecorder)throw new Error("Screen recording not supported in this browser");let t={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(t.mimeType)||(t={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(t.mimeType)||(t={mimeType:"video/webm"})),ie.current=[],re.current=new MediaRecorder(e,t),re.current.ondataavailable=e=>{e.data&&e.data.size>0&&ie.current.push(e.data)},re.current.onstop=()=>{const t=new Blob(ie.current,{type:"video/webm"}),n=URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=n,a.download="screen-recording-".concat((new Date).toISOString().slice(0,19).replace(/:/g,"-"),".webm"),document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(n)},100),e.getTracks().forEach(e=>e.stop()),ie.current=[]},e.getVideoTracks()[0].onended=()=>{T&&Ae()},re.current.start(1e3),A(!0),M(0),le.current=setInterval(()=>{M(e=>e+1)},1e3)}catch(e){console.error("Failed to start screen recording:",e),alert(e.message||"Failed to start screen recording. Please ensure you granted permission.")}},[T]),Ie=e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n.toString().padStart(2,"0"))},Me=(0,e.useCallback)(()=>{if(D)de.current&&(de.current.stop(),de.current=null),R("");else{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window))return void alert("Speech recognition not supported in this browser");{const e=window.SpeechRecognition||window.webkitSpeechRecognition;de.current=new e,de.current.continuous=!0,de.current.interimResults=!0,de.current.lang="en-US",de.current.onresult=e=>{let t="",n="";for(let a=e.resultIndex;a<e.results.length;a++){const s=e.results[a][0].transcript;e.results[a].isFinal?n+=s+" ":t+=s}R(n||t)},de.current.onerror=e=>{console.error("Speech recognition error:",e.error)},de.current.start()}}P(!D)},[D]),De=(0,e.useCallback)(()=>{if(B(!U),null!==r&&void 0!==r&&r.localStream){const e=r.localStream.getAudioTracks()[0];e&&e.applyConstraints({noiseSuppression:!U,echoCancellation:!0,autoGainControl:!0})}},[U,r]),Pe=(0,e.useCallback)(()=>{z?(ue.current&&(clearInterval(ue.current),ue.current=null),O(null)):ue.current=setInterval(()=>{const e=oe.getStats();O({bandwidth:"".concat((e.bandwidth/1e3).toFixed(1)," kbps"),fps:"30",packetLoss:"".concat(e.packetsLost||0),latency:"".concat(e.roundTripTime||0," ms"),jitter:"".concat(e.jitter||0," ms"),quality:S})},1e3),F(!z)},[z,S]),_e=(0,e.useCallback)(e=>{const t={id:Date.now(),emoji:e,timestamp:Date.now()};q(e=>[...e,t]),setTimeout(()=>{q(e=>e.filter(e=>e.id!==t.id))},3e3)},[]),Re=(0,e.useCallback)(()=>{K(!G),p(G?"grid":"speaker")},[G]),ze=(0,e.useCallback)(()=>{Y(!Q),we(Q?"auto":"low")},[Q]),Fe=(0,e.useCallback)(()=>{null!==r&&void 0!==r&&r.isRecording&&($?oe.resumeRecording():oe.pauseRecording(),J(!$))},[$,r]),Le=(0,e.useCallback)(e=>{Z(e),oe.setRecordingQuality(e)},[]),Oe=(0,e.useCallback)(()=>{if(!f){window.confirm("End video call?")&&fe()}},[f,fe]),Ue=v&&("none"!==b||v.smoothSkin>0||v.brighten>0||0!==v.brightness||0!==v.contrast||0!==v.saturation||0!==v.temperature||v.vibrance>0||v.sharpen>0||v.vignette>0||v.grain>0||"none"!==v.arEffect);if(!r)return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"video-call-backdrop",onClick:Oe}),(0,x.jsxs)("div",{className:"video-call-panel loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Starting video call..."})]})]});const Be=s.length+1;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"video-call-backdrop",onClick:Oe}),(0,x.jsxs)("div",{className:"video-call-panel ".concat(f?"minimized":""," layout-").concat(m),children:[(0,x.jsxs)("div",{className:"video-call-header",ref:se,children:[(0,x.jsxs)("div",{className:"call-info",children:[(0,x.jsxs)("span",{className:"call-status",children:["\ud83d\udd34 ",r.isRecording?"Recording":"Live"]}),(0,x.jsxs)("span",{className:"participant-badge",children:[(0,x.jsx)("span",{className:"badge-icon",children:"\ud83d\udc65"}),Be]}),(0,x.jsx)("span",{className:"call-duration",children:oe.formatDuration(r.duration)})]}),(0,x.jsxs)("div",{className:"connection-quality",children:[(0,x.jsx)("span",{className:"quality-dot ".concat(S)}),(0,x.jsx)("span",{children:"excellent"===S?"Excellent":"good"===S?"Good":"Poor"})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsx)("button",{className:"header-btn ".concat(Ue?"has-filters":""),onClick:()=>{console.log("Filters button clicked. Current state:",u,"Filters:",v),h(!u)},title:"Filters & Effects",children:"\u2728"}),(0,x.jsx)("button",{className:"header-btn",onClick:()=>g(!f),title:f?"Maximize":"Minimize",children:f?"\ud83d\udd3c":"\ud83d\udd3d"}),(0,x.jsx)("button",{className:"header-btn",onClick:()=>d(!c),title:"Settings",children:"\u2699\ufe0f"})]})]}),!f&&(0,x.jsxs)("div",{className:"video-grid",children:[(0,x.jsx)("video",{ref:ae,style:{display:"none"},autoPlay:!0,playsInline:!0,muted:!0}),r.isScreenSharing&&(0,x.jsxs)("div",{className:"video-container screen-share",children:[(0,x.jsx)("video",{ref:ne,autoPlay:!0,playsInline:!0}),(0,x.jsx)("div",{className:"video-label",children:"\ud83d\udcfa Screen Share"})]}),(0,x.jsxs)("div",{className:"video-container local ".concat(r.isVideoOff?"video-off":""),children:[(0,x.jsx)("video",{ref:ee,autoPlay:!0,playsInline:!0,muted:!0}),r.isVideoOff&&(0,x.jsxs)("div",{className:"video-placeholder",children:[(0,x.jsx)("div",{className:"avatar-placeholder",children:"\ud83d\udc64"}),(0,x.jsx)("div",{className:"video-off-label",children:"Camera Off"})]}),(0,x.jsxs)("div",{className:"video-label",children:["You ",r.isMuted&&"\ud83d\udd07"]}),(0,x.jsx)("div",{className:"quality-badge",children:r.quality.toUpperCase()})]}),s.map((e,t)=>(0,x.jsxs)("div",{className:"video-container remote",children:[(0,x.jsx)("video",{ref:te,autoPlay:!0,playsInline:!0}),(0,x.jsx)("div",{className:"video-label",children:e.name})]},e.id||t)),0===s.length&&(0,x.jsx)("div",{className:"video-container waiting",children:(0,x.jsxs)("div",{className:"waiting-content",children:[(0,x.jsx)("div",{className:"waiting-icon",children:"\u23f3"}),(0,x.jsx)("p",{children:"Waiting for others to join..."})]})})]}),u&&!f&&(0,x.jsx)("div",{className:"filters-panel",children:v?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"filters-header",children:[(0,x.jsx)("h3",{children:"\u2728 Filters & Effects"}),(0,x.jsx)("button",{className:"reset-btn",onClick:Te,children:"Reset All"})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsx)("label",{className:"section-label",children:"Presets"}),(0,x.jsx)("div",{className:"preset-grid",children:ce.getPresets().map(e=>(0,x.jsxs)("button",{className:"preset-btn ".concat(b===e?"active":""),onClick:()=>Ce(e),children:[(0,x.jsxs)("div",{className:"preset-icon",children:["none"===e&&"\u25cb","natural"===e&&"\ud83c\udf3f","vivid"===e&&"\ud83c\udf08","dramatic"===e&&"\ud83c\udfad","vintage"===e&&"\ud83d\udcfd\ufe0f","cool"===e&&"\u2744\ufe0f","warm"===e&&"\u2600\ufe0f"]}),(0,x.jsx)("div",{className:"preset-name",children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsx)("label",{className:"section-label",children:"\ud83d\udc84 Beauty"}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Smooth Skin"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.smoothSkin,onChange:e=>Ne("smoothSkin",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.smoothSkin})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Brighten"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.brighten,onChange:e=>Ne("brighten",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.brighten})]})]})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsx)("label",{className:"section-label",children:"\ud83c\udfa8 Color"}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Brightness"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"-100",max:"100",value:v.brightness,onChange:e=>Ne("brightness",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.brightness})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Contrast"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"-100",max:"100",value:v.contrast,onChange:e=>Ne("contrast",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.contrast})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Saturation"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"-100",max:"100",value:v.saturation,onChange:e=>Ne("saturation",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.saturation})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Temperature"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"-100",max:"100",value:v.temperature,onChange:e=>Ne("temperature",parseInt(e.target.value))}),(0,x.jsxs)("span",{className:"slider-value",children:[v.temperature<0?"\u2744\ufe0f":"\ud83d\udd25"," ",Math.abs(v.temperature)]})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Vibrance"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.vibrance,onChange:e=>Ne("vibrance",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.vibrance})]})]})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsx)("label",{className:"section-label",children:"\u2728 Effects"}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Sharpen"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.sharpen,onChange:e=>Ne("sharpen",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.sharpen})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Vignette"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.vignette,onChange:e=>Ne("vignette",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.vignette})]})]}),(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Film Grain"}),(0,x.jsxs)("div",{className:"slider-container",children:[(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:v.grain,onChange:e=>Ne("grain",parseInt(e.target.value))}),(0,x.jsx)("span",{className:"slider-value",children:v.grain})]})]})]}),(0,x.jsxs)("div",{className:"filter-section",children:[(0,x.jsx)("label",{className:"section-label",children:"\ud83c\udfad AR Effects"}),(0,x.jsx)("div",{className:"ar-effects-grid",children:ce.getAREffects().map(e=>(0,x.jsxs)("button",{className:"ar-effect-btn ".concat(v.arEffect===e?"active":""),onClick:()=>Ee(e),children:["none"===e&&"\u25cb","glasses"===e&&"\ud83d\udc53","hat"===e&&"\ud83c\udfa9","mask"===e&&"\ud83c\udfad","ears"===e&&"\ud83d\udc30","mustache"===e&&"\ud83d\udc68",(0,x.jsx)("div",{className:"ar-effect-name",children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))}),"none"!==v.arEffect&&(0,x.jsxs)("div",{className:"slider-group",children:[(0,x.jsx)("label",{children:"Effect Color"}),(0,x.jsx)("input",{type:"color",value:v.arColor,onChange:e=>Ne("arColor",e.target.value),className:"color-picker"})]})]})]}):(0,x.jsxs)("div",{className:"filters-loading",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("p",{children:"Initializing filters..."})]})}),c&&!f&&(0,x.jsxs)("div",{className:"settings-panel",children:[(0,x.jsx)("h3",{children:"Call Settings"}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Camera"}),(0,x.jsx)("select",{value:(null===o||void 0===o?void 0:o.selectedCamera)||"",onChange:e=>Se(e.target.value),children:null===o||void 0===o?void 0:o.cameras.map(e=>(0,x.jsx)("option",{value:e.deviceId,children:e.label||"Camera ".concat(e.deviceId.slice(0,8))},e.deviceId))})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Microphone"}),(0,x.jsx)("select",{value:(null===o||void 0===o?void 0:o.selectedMicrophone)||"",onChange:e=>ke(e.target.value),children:null===o||void 0===o?void 0:o.microphones.map(e=>(0,x.jsx)("option",{value:e.deviceId,children:e.label||"Microphone ".concat(e.deviceId.slice(0,8))},e.deviceId))})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Video Quality"}),(0,x.jsx)("div",{className:"quality-buttons",children:["low","medium","high","auto"].map(e=>(0,x.jsx)("button",{className:"quality-btn ".concat(r.quality===e?"active":""),onClick:()=>we(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Layout"}),(0,x.jsxs)("div",{className:"layout-buttons",children:[(0,x.jsx)("button",{className:"layout-btn ".concat("grid"===m?"active":""),onClick:()=>xe("grid"),title:"Grid View",children:"\u229e"}),(0,x.jsx)("button",{className:"layout-btn ".concat("speaker"===m?"active":""),onClick:()=>xe("speaker"),title:"Speaker View",children:"\u25ad"}),(0,x.jsx)("button",{className:"layout-btn ".concat("pip"===m?"active":""),onClick:()=>xe("pip"),title:"Picture in Picture",children:"\u22a1"})]})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Background Blur"}),(0,x.jsx)("button",{className:"toggle-btn",onClick:je,children:"Enable Blur"})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"\ud83c\udfaf Noise Cancellation"}),(0,x.jsx)("button",{className:"toggle-btn ".concat(U?"active":""),onClick:De,children:U?"\u2713 Enabled":"Enable"})]}),(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"\ud83d\udc64 Spotlight Mode"}),(0,x.jsx)("button",{className:"toggle-btn ".concat(G?"active":""),onClick:Re,children:G?"\u2713 Active":"Activate"})]}),(0,x.jsxs)("div",{className:"setting-group mobile-only",children:[(0,x.jsx)("label",{children:"\ud83d\udd0b Battery Saver"}),(0,x.jsx)("button",{className:"toggle-btn ".concat(Q?"active":""),onClick:ze,children:Q?"\u2713 Enabled":"Enable"})]}),r.isRecording&&(0,x.jsxs)("div",{className:"setting-group",children:[(0,x.jsx)("label",{children:"Recording Quality"}),(0,x.jsx)("div",{className:"quality-buttons",children:["low","medium","high"].map(e=>(0,x.jsx)("button",{className:"quality-btn ".concat(X===e?"active":""),onClick:()=>Le(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),D&&_&&(0,x.jsx)("div",{className:"captions-overlay",children:(0,x.jsx)("div",{className:"captions-text",children:_})}),z&&L&&(0,x.jsxs)("div",{className:"stats-dashboard",children:[(0,x.jsxs)("div",{className:"stats-header",children:[(0,x.jsx)("h4",{children:"\ud83d\udcca Call Statistics"}),(0,x.jsx)("button",{className:"close-stats",onClick:Pe,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"stats-grid",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"Bandwidth"}),(0,x.jsx)("div",{className:"stat-value",children:L.bandwidth})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"FPS"}),(0,x.jsx)("div",{className:"stat-value",children:L.fps})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"Packet Loss"}),(0,x.jsx)("div",{className:"stat-value",children:L.packetLoss})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"Latency"}),(0,x.jsx)("div",{className:"stat-value",children:L.latency})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"Jitter"}),(0,x.jsx)("div",{className:"stat-value",children:L.jitter})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("div",{className:"stat-label",children:"Quality"}),(0,x.jsx)("div",{className:"stat-value quality-".concat(L.quality),children:L.quality.toUpperCase()})]})]})]}),H.length>0&&(0,x.jsx)("div",{className:"gestures-overlay",children:H.map(e=>(0,x.jsx)("div",{className:"gesture-emoji",style:{animationDelay:"".concat((Date.now()-e.timestamp)/1e3,"s")},children:e.emoji},e.id))}),(0,x.jsxs)("div",{className:"video-controls",children:[(0,x.jsx)("button",{className:"control-btn ".concat(r.isMuted?"active":""),onClick:ge,title:r.isMuted?"Unmute":"Mute",children:r.isMuted?"\ud83d\udd07":"\ud83c\udfa4"}),(0,x.jsx)("button",{className:"control-btn ".concat(r.isVideoOff?"active":""),onClick:ve,title:r.isVideoOff?"Turn On Camera":"Turn Off Camera",children:r.isVideoOff?"\ud83d\udcf7\u274c":"\ud83d\udcf9"}),(0,x.jsx)("button",{className:"control-btn ".concat(r.isScreenSharing?"active":""),onClick:ye,title:r.isScreenSharing?"Stop Sharing":"Share Screen",children:"\ud83d\udda5\ufe0f"}),(0,x.jsx)("button",{className:"control-btn ".concat(r.isRecording?"active recording":""),onClick:be,title:r.isRecording?"Stop Recording":"Start Recording",children:r.isRecording?"\u23f9\ufe0f":"\u23fa\ufe0f"}),r.isRecording&&(0,x.jsx)("button",{className:"control-btn ".concat($?"active":""),onClick:Fe,title:$?"Resume Recording":"Pause Recording",children:$?"\u25b6\ufe0f":"\u23f8\ufe0f"}),(0,x.jsx)("button",{className:"control-btn screen-record-btn ".concat(T?"active recording":""),onClick:Ae,title:T?"Stop Screen Recording (".concat(Ie(I),")"):"Record Screen",children:T?(0,x.jsxs)("span",{className:"recording-indicator",children:["\u23fa\ufe0f",(0,x.jsx)("span",{className:"recording-time",children:Ie(I)})]}):"\ud83c\udfac"}),(0,x.jsx)("button",{className:"control-btn ".concat(D?"active":""),onClick:Me,title:D?"Hide Captions":"Show Live Captions",children:"\ud83d\udcac"}),(0,x.jsx)("button",{className:"control-btn ".concat(z?"active":""),onClick:Pe,title:z?"Hide Statistics":"Show Statistics",children:"\ud83d\udcca"}),(0,x.jsxs)("div",{className:"reactions-menu",children:[(0,x.jsx)("button",{className:"control-btn reactions-btn",title:"Send Reaction",children:"\u270b"}),(0,x.jsxs)("div",{className:"reactions-dropdown",children:[(0,x.jsx)("button",{onClick:()=>_e("\ud83d\udc4d"),children:"\ud83d\udc4d"}),(0,x.jsx)("button",{onClick:()=>_e("\u2764\ufe0f"),children:"\u2764\ufe0f"}),(0,x.jsx)("button",{onClick:()=>_e("\ud83d\ude02"),children:"\ud83d\ude02"}),(0,x.jsx)("button",{onClick:()=>_e("\ud83d\udc4f"),children:"\ud83d\udc4f"}),(0,x.jsx)("button",{onClick:()=>_e("\ud83c\udf89"),children:"\ud83c\udf89"}),(0,x.jsx)("button",{onClick:()=>_e("\u270b"),children:"\u270b"})]})]}),(0,x.jsx)("button",{className:"control-btn end-call",onClick:fe,title:"End Call",children:"\ud83d\udcde\u274c"})]})]})]})};const ue=new class{constructor(){this.messages=[],this.persistentStorage=b}loadMessagesFromStorage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=this.persistentStorage.getMessages();return e?t.filter(t=>t.conversationId===e):t}catch(t){return console.error("\u274c Failed to load messages from storage:",t),[]}}saveMessagesToStorage(e){try{return this.persistentStorage.setMessages(e)}catch(t){return console.error("\u274c Failed to save messages to storage:",t),!1}}async getMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{conversationId:t,limit:n=50,offset:a=0}=e;try{const e=await fetch("/api/messages?conversationId=".concat(t,"&limit=").concat(n,"&offset=").concat(a));if(e.ok){return await e.json()}}catch(s){console.warn("API unavailable, loading from storage:",s)}return this.loadMessagesFromStorage(t)}async sendMessage(e){const t=o({id:Date.now().toString(),timestamp:(new Date).toISOString()},e);try{const e=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok){const t=await e.json();return this.persistentStorage.addMessage(t),t}}catch(n){console.warn("\u26a0\ufe0f API unavailable, saving locally:",n)}return this.persistentStorage.addMessage(t),console.log("\ud83d\udcbe Message saved to persistent storage"),t}async addReaction(e,t){try{const n=await fetch("/api/messages/".concat(e,"/reactions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emoji:t})});if(n.ok){const t=await n.json();return this.persistentStorage.updateMessage(e,t),t}}catch(a){console.warn("\u26a0\ufe0f API unavailable for reactions:",a)}const n=this.loadMessagesFromStorage().find(t=>t.id===e);return n?(n.reactions||(n.reactions=[]),n.reactions.push({emoji:t,userId:"current-user",timestamp:(new Date).toISOString()}),this.persistentStorage.updateMessage(e,n),{success:!0}):{success:!1}}async deleteMessage(e){try{if((await fetch("/api/messages/".concat(e),{method:"DELETE"})).ok)return this.persistentStorage.deleteMessage(e),{success:!0}}catch(t){console.warn("\u26a0\ufe0f API unavailable for deletion:",t)}return this.persistentStorage.deleteMessage(e)?{success:!0}:{success:!1}}searchMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.loadMessagesFromStorage(t).filter(t=>{var n,a;return(null===(n=t.text)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||(null===(a=t.user)||void 0===a?void 0:a.toLowerCase().includes(e.toLowerCase()))})}clearMessages(){this.persistentStorage.setMessages([]),console.log("\ud83e\uddf9 All messages cleared from persistent storage")}};var he=n(210),me=n.n(he);const pe=new class{constructor(){this.encryptionKey=null,this.isInitialized=!1,this.encryptionEnabled=!1}async initializeEncryption(e){try{const t=localStorage.getItem("encryption_key_".concat(e));return t?this.encryptionKey=t:(this.encryptionKey=me().lib.WordArray.random(32).toString(),localStorage.setItem("encryption_key_".concat(e),this.encryptionKey)),this.isInitialized=!0,this.encryptionEnabled=!0,{success:!0,message:"Encryption initialized successfully",keyGenerated:!t}}catch(t){return console.error("Encryption initialization failed:",t),{success:!1,message:"Failed to initialize encryption",error:t.message}}}getEncryptionStatus(){return{initialized:this.isInitialized,enabled:this.encryptionEnabled,hasKey:!!this.encryptionKey}}encryptMessage(e){if(!this.isInitialized||!this.encryptionKey)throw new Error("Encryption not initialized");try{return me().AES.encrypt(e,this.encryptionKey).toString()}catch(t){throw console.error("Message encryption failed:",t),t}}decryptMessage(e){if(!this.isInitialized||!this.encryptionKey)throw new Error("Encryption not initialized");try{return me().AES.decrypt(e,this.encryptionKey).toString(me().enc.Utf8)}catch(t){throw console.error("Message decryption failed:",t),t}}async sendMessage(e){try{let t=o({},e);this.encryptionEnabled&&e.text&&(t.text=this.encryptMessage(e.text),t.encrypted=!0),t.id=Date.now().toString(),t.timestamp=(new Date).toISOString(),t.encryptionStatus=this.getEncryptionStatus();const n=await fetch("/api/messages/encrypted",{method:"POST",headers:{"Content-Type":"application/json","X-Encryption-Enabled":this.encryptionEnabled.toString()},body:JSON.stringify(t)});if(n.ok)return await n.json();throw new Error("API request failed")}catch(t){return console.warn("Encrypted message API unavailable, using fallback:",t),o(o({},e),{},{id:Date.now().toString(),timestamp:(new Date).toISOString(),encrypted:this.encryptionEnabled,fallback:!0})}}async getMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{limit:t=50,conversationId:n}=e;try{const e=await fetch("/api/messages/encrypted?limit=".concat(t,"&conversationId=").concat(n),{headers:{"X-Encryption-Key":this.encryptionKey||""}});if(e.ok){return(await e.json()).map(e=>{if(e.encrypted&&this.encryptionEnabled)try{return o(o({},e),{},{text:this.decryptMessage(e.text),decrypted:!0})}catch(t){return console.error("Failed to decrypt message:",t),o(o({},e),{},{text:"[Decryption Failed]",decryptionError:!0})}return e})}}catch(a){console.warn("Encrypted messages API unavailable:",a)}return[]}toggleEncryption(){return this.encryptionEnabled=!this.encryptionEnabled,this.encryptionEnabled}resetEncryption(e){localStorage.removeItem("encryption_key_".concat(e)),this.encryptionKey=null,this.isInitialized=!1,this.encryptionEnabled=!1}};const fe=new class{constructor(){this.currentCall=null,this.localStream=null,this.remoteStream=null,this.peerConnection=null,this.isCallActive=!1,this.isMuted=!1,this.isVideoEnabled=!1,this.callHistory=[]}async initializeCall(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{video:a=!1,audio:s=!0}=t;if(console.log("\ud83c\udfa4 Requesting media permissions - video:",a,"audio:",s),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.warn("\u26a0\ufe0f getUserMedia not supported"),this.currentCall={id:Date.now().toString(),targetUserId:e,startTime:new Date,type:a?"video":"voice",status:"connecting"},this.isCallActive=!0,{success:!0,callId:this.currentCall.id,localStream:null};try{this.localStream=await navigator.mediaDevices.getUserMedia({video:a,audio:s}),console.log("\u2705 Media stream obtained:",this.localStream)}catch(n){console.warn("\u26a0\ufe0f Failed to get media stream:",n.message),this.localStream=null}return this.peerConnection=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]}),this.localStream&&this.localStream.getTracks().forEach(e=>{this.peerConnection.addTrack(e,this.localStream)}),this.peerConnection.ontrack=e=>{this.remoteStream=e.streams[0]},this.currentCall={id:Date.now().toString(),targetUserId:e,startTime:new Date,type:a?"video":"voice",status:"connecting"},this.isCallActive=!0,this.isVideoEnabled=a,console.log("\ud83d\udcde Call initialized successfully:",this.currentCall),{success:!0,callId:this.currentCall.id,localStream:this.localStream}}catch(a){return console.error("\u274c Call initialization failed:",a),{success:!1,error:a.message}}}async endCall(){try{return this.localStream&&(this.localStream.getTracks().forEach(e=>e.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.currentCall&&(this.currentCall.endTime=new Date,this.currentCall.duration=this.currentCall.endTime-this.currentCall.startTime,this.currentCall.status="ended",this.callHistory.push(o({},this.currentCall)),this.currentCall=null),this.isCallActive=!1,this.isMuted=!1,this.isVideoEnabled=!1,{success:!0}}catch(e){return console.error("Error ending call:",e),{success:!1,error:e.message}}}toggleMute(){if(this.localStream){const e=this.localStream.getAudioTracks()[0];e&&(e.enabled=!e.enabled,this.isMuted=!e.enabled)}return this.isMuted}toggleVideo(){if(this.localStream){const e=this.localStream.getVideoTracks()[0];e&&(e.enabled=!e.enabled,this.isVideoEnabled=e.enabled)}return this.isVideoEnabled}getCallState(){return{active:this.isCallActive,muted:this.isMuted,videoEnabled:this.isVideoEnabled,currentCall:this.currentCall,hasLocalStream:!!this.localStream,hasRemoteStream:!!this.remoteStream}}getCallHistory(){return this.callHistory}async acceptCall(e){try{const t=await this.initializeCall(e.callerId,{video:e.hasVideo,audio:!0});return t.success&&(this.currentCall.status="active",this.currentCall.type="incoming"),t}catch(t){return console.error("Error accepting call:",t),{success:!1,error:t.message}}}rejectCall(e){return this.callHistory.push({id:e.id,targetUserId:e.callerId,startTime:new Date(e.timestamp),endTime:new Date,type:"incoming",status:"rejected",duration:0}),{success:!0}}async checkDeviceCapabilities(){try{const e=await navigator.mediaDevices.enumerateDevices(),t=e.some(e=>"videoinput"===e.kind);return{camera:t,microphone:e.some(e=>"audioinput"===e.kind),webRTC:!!window.RTCPeerConnection}}catch(e){return console.error("Error checking device capabilities:",e),{camera:!1,microphone:!1,webRTC:!1,error:e.message}}}async getAvailableCallMethods(e){console.log("\ud83d\udd0d Getting available call methods for user:",e);const t=await this.checkDeviceCapabilities();console.log("\ud83c\udfa4 Device capabilities:",t);const n=[];return t.microphone&&t.webRTC&&n.push({type:"voice",icon:"\ud83d\udcde",description:"Voice Call",quality:"high",estimated_quality:"HD Audio",latency:50+100*Math.random(),note:"High-quality voice call using WebRTC"}),t.camera&&t.microphone&&t.webRTC&&n.push({type:"video",icon:"\ud83d\udcf9",description:"Video Call",quality:"premium",estimated_quality:"HD Video",latency:80+120*Math.random(),note:"HD video call with voice"}),0===n.length&&n.push({type:"fallback",icon:"\ud83d\udcf1",description:"Audio Call (Fallback)",quality:"standard",estimated_quality:"Standard Audio",latency:200,note:"Basic audio call - check your device permissions"}),console.log("\ud83d\udcde Available methods:",n),n}async initiateEnhancedCall(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";try{const n=await this.getAvailableCallMethods(e);let a;a="auto"===t?n[0]:n.find(e=>e.type===t)||n[0];const s="video"===a.type,r=await this.initializeCall(e.id||e.username,{video:s,audio:!0});if(r.success)return{success:!0,callId:r.callId,method:a,status:"connecting",connectionStatus:{quality:"good",latency:a.latency}};throw new Error(r.error)}catch(n){return console.error("Failed to initiate enhanced call:",n),{success:!1,error:n.message}}}};const ge=new class{constructor(){this.isConnected=navigator.onLine,this.connectionType="unknown",this.lastConnectionCheck=Date.now(),this.connectionHistory=[],this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.websocket=null,this.eventListeners=new Map}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const{autoReconnect:t=!0,websocketUrl:n=null}=e;this.setupNetworkMonitoring(),n&&await this.connectWebSocket(n);const a=await this.checkConnectionQuality();return this.connectionHistory.push({timestamp:new Date,status:"connected",quality:a,type:this.connectionType}),{connected:!0,quality:a,type:this.connectionType,websocketConnected:!!this.websocket}}catch(t){return console.error("Connection failed:",t),{connected:!1,error:t.message}}}async disconnect(){try{return this.websocket&&(this.websocket.close(),this.websocket=null),this.removeNetworkMonitoring(),this.connectionHistory.push({timestamp:new Date,status:"disconnected",manual:!0}),{success:!0}}catch(e){return console.error("Disconnect error:",e),{success:!1,error:e.message}}}getStatus(){var e;return{connected:this.isConnected,type:this.connectionType,lastCheck:this.lastConnectionCheck,websocketConnected:(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN,reconnectAttempts:this.reconnectAttempts}}async checkConnectionQuality(){try{const e=Date.now(),t=(await fetch("/api/ping",{method:"HEAD",cache:"no-cache"}),Date.now()-e);let n="excellent";return t>1e3?n="poor":t>500?n="fair":t>200&&(n="good"),{latency:t,quality:n,timestamp:new Date}}catch(e){return{latency:-1,quality:"offline",error:e.message,timestamp:new Date}}}setupNetworkMonitoring(){const e=()=>{this.isConnected=!0,this.connectionType=this.getConnectionType(),this.emit("online",{timestamp:new Date}),this.reconnectAttempts>0&&(this.reconnectAttempts=0,this.emit("reconnected",{attempts:this.reconnectAttempts}))},t=()=>{this.isConnected=!1,this.emit("offline",{timestamp:new Date}),this.attemptReconnect()};window.addEventListener("online",e),window.addEventListener("offline",t),this.networkHandlers={handleOnline:e,handleOffline:t}}removeNetworkMonitoring(){this.networkHandlers&&(window.removeEventListener("online",this.networkHandlers.handleOnline),window.removeEventListener("offline",this.networkHandlers.handleOffline))}async attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts)return void this.emit("reconnectFailed",{attempts:this.reconnectAttempts});this.reconnectAttempts++,this.emit("reconnecting",{attempt:this.reconnectAttempts});const e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);setTimeout(async()=>{try{(await this.connect()).connected?(this.reconnectAttempts=0,this.emit("reconnected",{attempts:this.reconnectAttempts})):this.attemptReconnect()}catch(e){this.attemptReconnect()}},e)}async connectWebSocket(e){return new Promise((t,n)=>{try{this.websocket=new WebSocket(e),this.websocket.onopen=()=>{this.emit("websocketConnected",{url:e}),t()},this.websocket.onerror=e=>{this.emit("websocketError",{error:e}),n(e)},this.websocket.onclose=()=>{this.emit("websocketDisconnected",{})},this.websocket.onmessage=e=>{this.emit("websocketMessage",{data:e.data})}}catch(a){n(a)}})}getConnectionType(){return"connection"in navigator&&navigator.connection.effectiveType||"unknown"}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t)}off(e,t){if(this.eventListeners.has(e)){var n,a;const s=this.eventListeners.get(e),r=null!==(n=null===s||void 0===s||null===(a=s.indexOf)||void 0===a?void 0:a.call(s,t))&&void 0!==n?n:-1;r>-1&&s.splice(r,1)}}emit(e,t){this.eventListeners.has(e)&&this.eventListeners.get(e).forEach(n=>{try{n(t)}catch(a){console.error("Error in event listener for ".concat(e,":"),a)}})}getConnectionHistory(){return this.connectionHistory}getConnectionStatus(){const e=navigator.onLine&&this.isConnected,t=this.getConnectionQuality(),n=this.connectionType||"unknown";let a="#10b981";return e?("poor"===t||"fair"===t)&&(a="#f59e0b"):a="#ef4444",{quality:e?t:"offline",type:e?n:"offline",color:a,connected:e,websocketConnected:!!this.websocket}}getConnectionQuality(){if(!navigator.onLine)return"offline";const e=this.connectionHistory.filter(e=>Date.now()-e.timestamp.getTime()<3e4).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime());if(e.length>0&&e[0].quality)return e[0].quality;const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(t){const e=t.effectiveType;if("4g"===e)return"excellent";if("3g"===e)return"good";if("2g"===e)return"fair";if("slow-2g"===e)return"poor"}return"good"}};const ve=new class{constructor(){this.features={camera:!1,microphone:!1,geolocation:!1,notifications:!1,vibration:!1,deviceMotion:!1,touchSupport:!1,fullscreen:!1},this.permissions={},this.isInitialized=!1}async initialize(){try{return await this.detectFeatures(),await this.checkPermissions(),this.isInitialized=!0,{success:!0,features:this.features,permissions:this.permissions}}catch(e){return console.error("Failed to initialize device features:",e),{success:!1,error:e.message}}}async detectFeatures(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const e=await navigator.mediaDevices.enumerateDevices();this.features.camera=e.some(e=>"videoinput"===e.kind),this.features.microphone=e.some(e=>"audioinput"===e.kind)}catch(e){console.warn("Could not enumerate devices:",e)}this.features.geolocation="geolocation"in navigator,this.features.notifications="Notification"in window,this.features.vibration="vibrate"in navigator,this.features.deviceMotion="DeviceMotionEvent"in window,this.features.touchSupport="ontouchstart"in window||navigator.maxTouchPoints>0,this.features.fullscreen=!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled)}async checkPermissions(){if("permissions"in navigator){const t=["camera","microphone","geolocation","notifications"];for(const n of t)try{const e=await navigator.permissions.query({name:n});this.permissions[n]=e.state}catch(e){this.permissions[n]="unknown"}}}getFeatures(){return o(o({},this.features),{},{permissions:this.permissions,initialized:this.isInitialized})}async requestCamera(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{video:!0};if(!this.features.camera)return{success:!1,error:"Camera not available"};try{var t;const n=await navigator.mediaDevices.getUserMedia(e);return{success:!0,stream:n,deviceId:null===(t=n.getVideoTracks()[0])||void 0===t?void 0:t.getSettings().deviceId}}catch(n){return{success:!1,error:n.message,name:n.name}}}async requestMicrophone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0};if(!this.features.microphone)return{success:!1,error:"Microphone not available"};try{var t;const n=await navigator.mediaDevices.getUserMedia(e);return{success:!0,stream:n,deviceId:null===(t=n.getAudioTracks()[0])||void 0===t?void 0:t.getSettings().deviceId}}catch(n){return{success:!1,error:n.message,name:n.name}}}async requestGeolocation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.features.geolocation?new Promise(t=>{navigator.geolocation.getCurrentPosition(e=>{t({success:!0,coords:{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy},timestamp:e.timestamp})},e=>{t({success:!1,error:e.message,code:e.code})},o({enableHighAccuracy:!1,timeout:1e4,maximumAge:3e5},e))}):{success:!1,error:"Geolocation not available"}}async requestNotifications(){if(!this.features.notifications)return{success:!1,error:"Notifications not available"};try{const e=await Notification.requestPermission();return this.permissions.notifications=e,{success:"granted"===e,permission:e}}catch(e){return{success:!1,error:e.message}}}sendNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.features.notifications||"granted"!==this.permissions.notifications)return{success:!1,error:"Notification permission not granted"};try{return{success:!0,notification:new Notification(e,o({icon:"/logo192.png",badge:"/logo192.png"},t))}}catch(n){return{success:!1,error:n.message}}}vibrate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[200,100,200];if(!this.features.vibration)return{success:!1,error:"Vibration not available"};try{return navigator.vibrate(e),{success:!0}}catch(t){return{success:!1,error:t.message}}}async enterFullscreen(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.documentElement;if(!this.features.fullscreen)return{success:!1,error:"Fullscreen not available"};try{return e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.mozRequestFullScreen&&await e.mozRequestFullScreen(),{success:!0}}catch(t){return{success:!1,error:t.message}}}async exitFullscreen(){try{return document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen&&await document.mozCancelFullScreen(),{success:!0}}catch(e){return{success:!1,error:e.message}}}startDeviceMotionListening(e){if(!this.features.deviceMotion)return{success:!1,error:"Device motion not available"};const t=t=>{e({acceleration:t.acceleration,accelerationIncludingGravity:t.accelerationIncludingGravity,rotationRate:t.rotationRate,interval:t.interval})};return window.addEventListener("devicemotion",t),{success:!0,stop:()=>window.removeEventListener("devicemotion",t)}}isSupported(e){const t={camera:"camera",microphone:"microphone",geolocation:"geolocation",notifications:"notifications",vibration:"vibration",deviceMotion:"deviceMotion",motion:"deviceMotion",touch:"touchSupport",touchSupport:"touchSupport",fullscreen:"fullscreen",contacts:!1}[e];return!1!==t&&(!(!t||!this.features.hasOwnProperty(t))&&this.features[t])}getSupportedFeatures(){return Object.keys(this.features).filter(e=>this.features[e])}getFeatureStatus(e){const t=this.isSupported(e),n=this.permissions[e]||"unknown";return{supported:t,permission:n,available:t&&"denied"!==n}}};const ye=new class{constructor(){this.storageKey="quibish_conversations",this.conversations=this.loadConversationsFromStorage()}loadConversationsFromStorage(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading conversations from storage:",e),[]}}saveConversationsToStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.conversations))}catch(e){console.error("Error saving conversations to storage:",e)}}getAllConversations(){return this.conversations}getConversationById(e){return this.conversations.find(t=>t.id===e)}createConversationWithUser(e,t){const n=this.conversations.find(t=>t.participantId===e.id||t.participants&&t.participants.includes(e.id));if(n)return{success:!0,conversation:n,isNew:!1};const a={id:Date.now().toString(),name:e.name||e.username,avatar:e.avatar||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.name||e.username),"&background=667eea&color=fff&size=40"),lastMessage:"",lastMessageTime:"now",unreadCount:0,isOnline:"online"===e.status,isPinned:!1,isMuted:!1,messageStatus:null,timestamp:new Date,participantId:e.id,participants:[t,e.id],type:"direct",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),user:{id:e.id,name:e.name,username:e.username,avatar:e.avatar,status:e.status},messages:[]};return this.conversations.unshift(a),this.saveConversationsToStorage(),{success:!0,conversation:a,isNew:!0}}updateConversation(e,t){const n=this.conversations.findIndex(t=>t.id===e);return-1!==n?(this.conversations[n]=o(o(o({},this.conversations[n]),t),{},{updatedAt:(new Date).toISOString()}),this.saveConversationsToStorage(),this.conversations[n]):null}deleteConversation(e){const t=this.conversations.findIndex(t=>t.id===e);return-1!==t&&(this.conversations.splice(t,1),this.saveConversationsToStorage(),!0)}addMessageToConversation(e,t){const n=this.getConversationById(e);return n?(n.messages||(n.messages=[]),n.messages.push(t),n.lastMessage=t.text||t.content||"",n.lastMessageTime="now",n.timestamp=new Date,n.updatedAt=(new Date).toISOString(),this.saveConversationsToStorage(),n):null}searchConversations(e){if(!e||0===e.trim().length)return this.conversations;const t=e.toLowerCase().trim();return this.conversations.filter(e=>{var n,a,s,r,i,o;return(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(a=e.lastMessage)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(s=e.user)||void 0===s||null===(r=s.name)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(i=e.user)||void 0===i||null===(o=i.username)||void 0===o?void 0:o.toLowerCase().includes(t))})}getStats(){return{total:this.conversations.length,unread:this.conversations.filter(e=>e.unreadCount>0).length,groups:this.conversations.filter(e=>"group"===e.type).length,direct:this.conversations.filter(e=>"direct"===e.type).length,pinned:this.conversations.filter(e=>e.isPinned).length}}initializeDefaultConversations(){if(0===this.conversations.length){const e=[{id:"welcome-1",name:"Welcome to Quibish",avatar:"https://ui-avatars.com/api/?name=Quibish&background=667eea&color=fff&size=40",lastMessage:"Welcome! Start chatting by searching for users above.",lastMessageTime:"now",unreadCount:1,isOnline:!1,isPinned:!0,isMuted:!1,messageStatus:"delivered",timestamp:new Date,type:"system",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),messages:[{id:"welcome-msg-1",text:"\ud83d\udc4b Welcome to Quibish! To start chatting with other users, click the \ud83d\udc65 button in the search bar above and search for people by name.",sender:"System",timestamp:(new Date).toISOString(),type:"system"}]}];this.conversations=e,this.saveConversationsToStorage()}}subscribe(e){this.updateCallback=e}notifyUpdate(){this.updateCallback&&this.updateCallback(this.conversations)}clearConversations(){this.conversations=[],this.saveConversationsToStorage()}},be=t=>{var n,a,s;let{user:r={id:"user1",name:"Current User",avatar:null},conversations:i=[],currentConversation:l=null,onLogout:c=()=>{},darkMode:d=!1,onToggleDarkMode:u=()=>{}}=t;const{user:h,updateUser:m,isAuthenticated:p}=k(),f=h||r;(0,e.useEffect)(()=>{f&&f.id&&(b.updateUserData(f),console.log("\ud83d\udcbe User data synced to persistent storage"))},[f]);const[g]=(0,e.useState)(!0),[v,y]=(0,e.useState)(!1),[w,S]=(0,e.useState)(()=>{const e=ye.getAllConversations();return e.length>0?e:i.length>0?i:(ye.initializeDefaultConversations(),ye.getAllConversations())}),[R,Q]=(0,e.useState)((null===(n=w[0])||void 0===n?void 0:n.id)||null),[X,Z]=(0,e.useState)(""),[ne,ae]=(0,e.useState)("conversations"),[ie,le]=(0,e.useState)(!1),[ce,he]=(0,e.useState)("all"),[me,be]=(0,e.useState)("recent"),[xe,we]=(0,e.useState)(!0),[Se,ke]=(0,e.useState)(null),[je,Ne]=(0,e.useState)({visible:!1,x:0,y:0,conversation:null}),[Ce,Ee]=(0,e.useState)(!1),[Te,Ae]=(0,e.useState)(new Set),[Ie,Me]=(0,e.useState)(null),[De,Pe]=(0,e.useState)(!1),[_e,Re]=(0,e.useState)(!1),[ze,Fe]=(0,e.useState)(!1),[Le,Oe]=(0,e.useState)({open:!1,imageUrl:null,imageName:null,zoom:1,pan:{x:0,y:0},isDragging:!1,currentIndex:0,images:[],isLoading:!1}),[Ue,Be]=(0,e.useState)({open:!1,videoUrl:null,videoName:null,poster:null,type:null}),[He,qe]=(0,e.useState)(!1),[Ve,We]=(0,e.useState)(!1),[Ge,Ke]=(0,e.useState)(!1),[Qe,Ye]=(0,e.useState)(!1),[$e,Je]=(0,e.useState)("photo"),[Xe,Ze]=(0,e.useState)(!1),[et,tt]=(0,e.useState)(!1),[nt,at]=(0,e.useState)(null),[st,rt]=(0,e.useState)(!1),[it,ot]=(0,e.useState)(!1),[lt,ct]=(0,e.useState)(!1),[dt,ut]=(0,e.useState)(!1),[ht,mt]=(0,e.useState)([]),[pt,ft]=(0,e.useState)(!1),[gt,vt]=(0,e.useState)(""),[yt,bt]=(0,e.useState)(null),[xt,wt]=(0,e.useState)(!1),[St,kt]=(0,e.useState)(new Map),[jt,Nt]=(0,e.useState)(!1),[Ct,Et]=(0,e.useState)(!1),[Tt,At]=(0,e.useState)(null),[It,Mt]=(0,e.useState)(!1),[Dt,Pt]=(0,e.useState)({enabled:!1}),[_t,Rt]=(0,e.useState)(!0),[zt,Ft]=(0,e.useState)({isUploading:!1,fileName:"",progress:0,fileSize:0,uploadedSize:0}),[Lt,Ot]=(0,e.useState)(null),[Ut,Bt]=(0,e.useState)(null),Ht=(0,e.useRef)(null),qt=(0,e.useRef)(null),Vt=(0,e.useRef)(null),Wt=(0,e.useRef)(null),Gt=(0,e.useRef)(null),Kt=(0,e.useRef)(null),Qt=(0,e.useRef)(null),[Yt,$t]=(0,e.useState)([]),[Jt,Xt]=(0,e.useState)(!0),[Zt,en]=(0,e.useState)(null),[tn,nn]=(0,e.useState)(null),[an,sn]=(0,e.useState)(!1),rn=R&&w.find(e=>e.id===R)||null;(0,e.useEffect)(()=>{(async()=>{try{Xt(!0),en(null);try{const e=await pe.initializeEncryption(f.id);if(Mt(e),e){const e=pe.getEncryptionStatus();Pt(e),console.log("\ud83d\udd12 Encryption initialized for ProChat")}}catch(e){console.warn("\u26a0\ufe0f Encryption initialization failed:",e),Mt(!1)}const t=await pe.getMessages({limit:50});Array.isArray(t)?$t(t):(console.warn("Invalid messages format received:",t),$t([]))}catch(t){console.error("Failed to load messages:",t),en("Failed to load messages");try{const e=b.getMessages();Array.isArray(e)&&e.length>0&&($t(e),console.log("\ud83d\udcf1 Loaded messages from persistent storage"))}catch(n){console.error("\u274c Failed to load from persistent storage:",n)}}finally{Xt(!1)}})()},[f.id]);const on=(0,e.useCallback)(()=>{Gt.current&&Gt.current.scrollIntoView({behavior:"smooth",block:"end"})},[]);(0,e.useEffect)(()=>{on()},[Yt,on]),(0,e.useEffect)(()=>{const e=()=>{La(ge.getConnectionStatus())};e();const t=setInterval(e,1e4);return()=>clearInterval(t)},[]),(0,e.useEffect)(()=>(null!==f&&void 0!==f&&f.id&&(async()=>{try{console.log("\ud83d\udd14 Initializing notification system..."),await $.initialize(f.id)&&(console.log("\u2705 Push notification service initialized"),$.setupPresenceDetection(),await fetch(Y("/notifications/presence"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({userId:f.id,isOnline:!0,lastSeen:(new Date).toISOString()})}))}catch(e){console.error("\u274c Failed to initialize notifications:",e)}})(),()=>{null!==f&&void 0!==f&&f.id&&fetch(Y("/notifications/presence"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({userId:f.id,isOnline:!1,lastSeen:(new Date).toISOString()})}).catch(console.error)}),[null===f||void 0===f?void 0:f.id]),(0,e.useEffect)(()=>{(async()=>{try{console.log("\ud83d\udd0d Initializing search index...");const e=b.getMessages();await F.buildSearchIndex(e),console.log("\u2705 Search index built successfully"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"INDEX_MESSAGES"})}catch(e){console.error("\u274c Failed to initialize search index:",e)}})()},[]),(0,e.useEffect)(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"f"===e.key&&(e.preventDefault(),tt(!0)),"Escape"===e.key&&(et?tt(!1):Ve&&We(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[et,Ve]),(0,e.useEffect)(()=>{const e=()=>{window.innerWidth<=480?y(!0):window.innerWidth>768&&y(!1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,e.useEffect)(()=>{if(window.innerWidth<=480&&(De||an)){document.body.classList.add("emoji-picker-open");const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.classList.remove("emoji-picker-open"),document.body.style.overflow=e}}},[De,an]);const ln=(0,e.useCallback)(()=>{y(e=>!e)},[]),cn=(0,e.useCallback)(e=>{window.innerWidth<=768&&(Bt(null),Ot(e.targetTouches[0].clientX))},[]),dn=(0,e.useCallback)(e=>{window.innerWidth<=768&&Bt(e.targetTouches[0].clientX)},[]),un=(0,e.useCallback)(()=>{if(!Lt||!Ut)return;const e=Lt-Ut,t=e>50,n=e<-50;window.innerWidth<=768&&(t&&!v?y(!0):n&&v&&y(!1)),Ot(null),Bt(null)},[Lt,Ut,v]),hn=(0,e.useCallback)(()=>{window.innerWidth<=480&&y(!0)},[]),mn=(0,e.useCallback)(async e=>{if(!e)return void console.warn("Invalid conversation ID provided");const t=w.find(t=>t.id===e);if(!t)return console.warn("Conversation not found:",e),void en("Conversation not found");Q(e);try{Xt(!0),en(null),console.log("Loading messages for conversation:",t.name,e);const n=await ue.getMessages({conversationId:e,limit:50});Array.isArray(n)?($t(n),console.log("Loaded conversation messages:",n.length),t.unreadCount>0&&console.log("Marked conversation as read:",t.name),setTimeout(()=>{on()},100)):(console.warn("Invalid conversation messages format received:",n),$t([]))}catch(n){console.error("Failed to load conversation messages:",n),en("Failed to load conversation messages");try{const t=ue.loadMessagesFromStorage(e);Array.isArray(t)&&t.length>0?($t(t),console.log("Loaded conversation messages from cache")):$t([])}catch(a){console.error("Error loading conversation messages from storage:",a),$t([])}}finally{Xt(!1),window.innerWidth<=768&&y(!0)}},[w,ue,on]),pn=(0,e.useCallback)(e=>{try{var t;const n=(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||"";Z(n)}catch(n){console.error("Error handling search change:",n),Z("")}},[]),fn=((0,e.useCallback)(()=>{const e="conversations"===ne?"users":"conversations";ae(e),Z(""),"users"===e&&le(!0)},[ne]),(0,e.useCallback)(()=>{ae("users"),le(!0)},[])),gn=(0,e.useCallback)(async e=>{console.log("User selected for chat:",e);try{const t=ye.createConversationWithUser(e,f.id);if(t.success){const n=ye.getAllConversations();return S(n),Q(t.conversation.id),le(!1),t.isNew?console.log("\u2705 Started new chat with ".concat(e.name||e.username)):console.log("\u2705 Opened existing chat with ".concat(e.name||e.username)),setTimeout(()=>{const e=document.querySelector(".pro-chat-container");e&&(e.scrollTop=0)},100),Promise.resolve(t)}return console.error("Failed to create conversation:",t.error),Promise.reject(new Error("Failed to start chat. Please try again."))}catch(t){return console.error("Error creating conversation:",t),Promise.reject(t)}},[f.id]);(0,e.useEffect)(()=>(ye.subscribe(e=>{S(e)}),()=>{ye.subscribe(null)}),[]),(0,e.useEffect)(()=>{w.length>0&&(ye.conversations=w,ye.saveConversationsToStorage())},[w]);const vn=(0,e.useCallback)((e,t)=>{ke(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.id),e.currentTarget.classList.add("dragging")},[]),yn=(0,e.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),bn=(0,e.useCallback)((e,t)=>{if(e.preventDefault(),!Se||Se.id===t.id)return;const n=w.findIndex(e=>e.id===Se.id),a=w.findIndex(e=>e.id===t.id),s=[...w];s.splice(n,1),s.splice(a,0,Se),S(s),ke(null),be("custom")},[Se,w]),xn=(0,e.useCallback)(e=>{e.currentTarget.classList.remove("dragging"),ke(null)},[]),wn=(0,e.useCallback)((e,t)=>{e.preventDefault(),Ne({visible:!0,x:e.clientX,y:e.clientY,conversation:t})},[]),Sn=(0,e.useCallback)(()=>{Ne({visible:!1,x:0,y:0,conversation:null})},[]),kn=(0,e.useCallback)(e=>{S(t=>t.map(t=>t.id===e?o(o({},t),{},{isPinned:!t.isPinned}):t)),Sn()},[Sn]),jn=(0,e.useCallback)(e=>{S(t=>t.map(t=>t.id===e?o(o({},t),{},{isMuted:!t.isMuted}):t)),Sn()},[Sn]),Nn=(0,e.useCallback)(e=>{S(t=>t.map(t=>t.id===e?o(o({},t),{},{isArchived:!t.isArchived}):t)),Sn()},[Sn]),Cn=(0,e.useCallback)(e=>{var t;window.confirm("Are you sure you want to delete this conversation?")&&(S(t=>t.filter(t=>t.id!==e)),R===e&&Q((null===(t=w[0])||void 0===t?void 0:t.id)||null));Sn()},[R,w,Sn]),En=(0,e.useCallback)(e=>{S(t=>t.map(t=>t.id===e?o(o({},t),{},{unreadCount:0}):t)),Sn()},[Sn]),Tn=(0,e.useCallback)(()=>{Ee(e=>!e),Ae(new Set)},[]),An=(0,e.useCallback)(e=>{Ae(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),In=(0,e.useCallback)(()=>{S(e=>e.map(e=>Te.has(e.id)?o(o({},e),{},{unreadCount:0}):e)),Ae(new Set),Ee(!1)},[Te]),Mn=(0,e.useCallback)(()=>{S(e=>e.map(e=>Te.has(e.id)?o(o({},e),{},{isArchived:!0}):e)),Ae(new Set),Ee(!1)},[Te]),Dn=(0,e.useCallback)(()=>{window.confirm("Delete ".concat(Te.size," conversations?"))&&(S(e=>e.filter(e=>!Te.has(e.id))),Ae(new Set),Ee(!1))},[Te]);(0,e.useEffect)(()=>{if(je.visible){const e=()=>Sn();return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}},[je.visible,Sn]);const Pn=(0,e.useCallback)(e=>{he(e)},[]),_n=(0,e.useCallback)(()=>{Ca(!0)},[]),Rn=(0,e.useCallback)(()=>{Ca(!0),console.log("Create group clicked - opening new chat modal")},[]),zn=(0,e.useCallback)(async e=>{try{var t,n,a,s;console.log("New chat created:",e);const r={id:e.id||"conv_".concat(Date.now()),name:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e||null===(t=e.participants)||void 0===t||null===(n=t.find(e=>(null===e||void 0===e?void 0:e.id)!==(null===f||void 0===f?void 0:f.id)))||void 0===n?void 0:n.name)||"New Chat",type:e.type,participants:e.participants,lastMessage:{text:"Chat created",timestamp:e.createdAt||(new Date).toISOString(),user:{name:"System"}},unreadCount:0,isOnline:!0,avatar:"group"===e.type?null:null===e||void 0===e||null===(a=e.participants)||void 0===a||null===(s=a.find(e=>(null===e||void 0===e?void 0:e.id)!==(null===f||void 0===f?void 0:f.id)))||void 0===s?void 0:s.avatar};console.log("Formatted conversation:",r),Q(r.id)}catch(r){throw console.error("Failed to handle new chat:",r),r}},[f]),Fn=(0,e.useCallback)(()=>{console.log("\u2699\ufe0f Settings button clicked!"),ja({open:!0,section:"general"}),console.log("\u2705 Settings modal state set to open"),window.innerWidth<=1024&&y(!0)},[]),Ln=(0,e.useCallback)(e=>{const t=e.target.files;t&&t.length>0&&(Array.from(t).forEach(e=>{if(console.log("Processing file:",e.name,e.type),e.type.startsWith("image/")){const t=new FileReader;t.onload=t=>{var n;console.log("Image loaded, creating message with URL:",(null===(n=t.target.result)||void 0===n?void 0:n.substring(0,50))+"...");const a={id:Date.now()+Math.random(),text:"\ufffd ".concat(e.name),user:f,timestamp:(new Date).toISOString(),reactions:[],file:{name:e.name,size:e.size,type:e.type,url:t.target.result}};$t(e=>[...e,a]),setTimeout(()=>{on()},100)},t.onerror=e=>{console.error("Error reading file:",e)},t.readAsDataURL(e)}else{const t={id:Date.now()+Math.random(),text:"\ud83d\udcce ".concat(e.name," (").concat((e.size/1024).toFixed(1)," KB)"),user:f,timestamp:(new Date).toISOString(),reactions:[],file:{name:e.name,size:e.size,type:e.type,url:URL.createObjectURL(e)}};$t(e=>[...e,t]),setTimeout(()=>{on()},100)}}),e.target.value="")},[f,on]),On=(0,e.useCallback)(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[]),Un=(0,e.useCallback)(()=>{qe(!0)},[]),Bn=(0,e.useCallback)(()=>{const e=document.createElement("input");e.type="file",e.accept="image/gif",e.multiple=!0,e.onchange=e=>{Ln(e)},e.click()},[Ln]),Hn=(0,e.useCallback)(e=>{const t={id:Date.now()+Math.random(),text:"\ud83c\udfad ".concat(e.name),user:f,timestamp:(new Date).toISOString(),reactions:[],file:{name:e.name||"selected.gif",size:e.size||0,type:"image/gif",url:e.url,isGif:!0}};$t(e=>[...e,t]),qe(!1),setTimeout(()=>{on()},100)},[f,$t,on]),qn=(0,e.useCallback)(()=>{qe(!1)},[]),Vn=(0,e.useCallback)(()=>{},[]),Wn=(0,e.useCallback)(function(){Je(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"photo"),Ke(!0)},[]),Gn=(0,e.useCallback)(()=>{Ke(!1)},[]),Kn=(0,e.useCallback)(async(e,t,n)=>{try{const a=new File([e],"".concat(t,"-").concat(Date.now(),".").concat("photo"===t?"jpg":"mp4"),{type:e.type});await Ln({target:{files:[a]}}),Ke(!1),qa({text:"\ud83d\udcf8 ".concat("photo"===t?"Photo":"Video"," captured from camera"),type:"system",metadata:n})}catch(a){console.error("Failed to handle camera capture:",a),qa({text:"\u274c Failed to upload captured media",type:"system"})}},[]),Qn=(0,e.useCallback)(()=>{Ye(!0)},[]),Yn=(0,e.useCallback)(()=>{Ye(!1)},[]),$n=(0,e.useCallback)(e=>{try{const t=e.map(e=>{const t=[];return e.name&&t.push(e.name),e.phone&&t.push("\ud83d\udcf1 ".concat(e.phone)),e.email&&t.push("\ud83d\udce7 ".concat(e.email)),t.join("\n")}).join("\n\n");qa({text:"\ud83d\udc65 Shared Contact".concat(e.length>1?"s":"",":\n\n").concat(t),type:"contact",metadata:{contacts:e,shared:!0}}),Ye(!1)}catch(t){console.error("Failed to share contacts:",t),qa({text:"\u274c Failed to share contacts",type:"system"})}},[]),Jn=(0,e.useCallback)(()=>{Re(!0)},[]),Xn=(0,e.useCallback)(()=>{We(e=>!e)},[]),Zn=(0,e.useCallback)(()=>{const e={conversation:(null===rn||void 0===rn?void 0:rn.name)||"Chat Export",messages:Yt,exportDate:(new Date).toISOString(),totalMessages:Yt.length},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download="chat-export-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),We(!1);const s={id:"export_".concat(Date.now()),text:"\ud83d\udce5 Chat exported successfully",user:"System",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"system",isSystemMessage:!0};$t(e=>[...e,s])},[Yt,rn]),ea=(0,e.useCallback)(()=>{const e=!("true"===localStorage.getItem("notificationsMuted"));localStorage.setItem("notificationsMuted",e.toString()),We(!1);const t={id:"mute_".concat(Date.now()),text:"\ud83d\udd14 Notifications ".concat(e?"muted":"unmuted"),user:"System",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"system",isSystemMessage:!0};$t(e=>[...e,t])},[]),ta=(0,e.useCallback)(()=>{if(window.confirm("Are you sure you want to clear this chat? This action cannot be undone.")){$t([]),We(!1);const e={id:"clear_".concat(Date.now()),text:"\ud83e\uddf9 Chat cleared",user:"System",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"system",isSystemMessage:!0};$t([e])}},[]),na=(0,e.useCallback)(()=>{Ze(!0),We(!1)},[]),aa=(0,e.useCallback)(async e=>{try{const t={id:"contact_chat_".concat(Date.now()),text:"\ud83d\udcac Starting chat with ".concat(e.name),user:"System",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"system",isSystemMessage:!0,contactId:e.id};$t(e=>[...e,t]),Ze(!1),await E.updateContactInteraction(e.id,"chat_started")}catch(t){console.error("Error starting chat with contact:",t)}},[]),sa=(0,e.useCallback)(async e=>{try{if(e.phoneNumbers&&e.phoneNumbers.length>0){const t=e.phoneNumbers[0],n={id:"contact_call_".concat(Date.now()),text:"\ud83d\udcde Calling ".concat(e.name," at ").concat(t.number),user:"System",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"system",isSystemMessage:!0,contactId:e.id};$t(e=>[...e,n]),await E.updateContactInteraction(e.id,"call_made"),Ze(!1)}else alert("No phone number available for this contact")}catch(t){console.error("Error calling contact:",t)}},[]),ra=(0,e.useCallback)(()=>{tt(!0),We(!1)},[]),ia=(0,e.useCallback)(e=>{console.log("Search result selected:",e),e.conversationId&&e.conversationId!==R&&Q(e.conversationId),at(e.messageId),setTimeout(()=>{const t=document.getElementById("message-".concat(e.messageId));t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{at(null)},3e3))},300)},[R]),oa=(0,e.useCallback)(()=>{Yt.map(e=>"[".concat(e.timestamp,"] ").concat(e.user,": ").concat(e.text)).join("\n");const e=window.open("","_blank");e.document.write("\n      <html>\n        <head>\n          <title>Chat Print - ".concat((null===rn||void 0===rn?void 0:rn.name)||"Chat",'</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            .header { border-bottom: 2px solid #ccc; margin-bottom: 20px; padding-bottom: 10px; }\n            .message { margin-bottom: 10px; padding: 8px; border-left: 3px solid #007bff; }\n            .timestamp { color: #666; font-size: 0.9em; }\n            .user { font-weight: bold; color: #333; }\n            .text { margin-top: 5px; }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <h1>Chat: ').concat((null===rn||void 0===rn?void 0:rn.name)||"Conversation","</h1>\n            <p>Exported on: ").concat((new Date).toLocaleString(),"</p>\n            <p>Total Messages: ").concat(Yt.length,'</p>\n          </div>\n          <div class="messages">\n            ').concat(Yt.map(e=>'\n              <div class="message">\n                <div class="timestamp">'.concat(e.timestamp,'</div>\n                <div class="user">').concat(e.user,'</div>\n                <div class="text">').concat(e.text,"</div>\n              </div>\n            ")).join(""),"\n          </div>\n        </body>\n      </html>\n    ")),e.document.close(),e.print(),We(!1)},[Yt,rn]);(0,e.useEffect)(()=>{const e=e=>{!Ve||e.target.closest(".header-menu")||e.target.classList.contains("menu-btn")||e.target.classList.contains("action-btn")||(console.log("Closing menu due to outside click"),We(!1))},t=setTimeout(()=>{document.addEventListener("click",e)},100);return()=>{clearTimeout(t),document.removeEventListener("click",e)}},[Ve]);const la=(0,e.useCallback)(async(e,t)=>{$t(n=>n.map(n=>{if(n.id===e){var a;const e=null===n||void 0===n||null===(a=n.reactions)||void 0===a?void 0:a.find(e=>(null===e||void 0===e?void 0:e.emoji)===t);return o(o({},n),{},e?{reactions:n.reactions.map(e=>e.emoji===t?o(o({},e),{},{count:e.count+1}):e)}:{reactions:[...n.reactions,{emoji:t,count:1,userId:f.id}]})}return n}));try{ue.addReaction&&await ue.addReaction(e,t)}catch(n){console.error("Failed to sync reaction with backend:",n)}},[f.id]),ca=(0,e.useCallback)(e=>{tn?la(tn,e):xa(t=>t+e),Pe(!1),sn(!1),nn(null)},[tn,la]),da=(0,e.useCallback)(e=>{nn(e),sn(!0),Pe(!1)},[]),ua=(0,e.useCallback)(e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),a=t%60;return"".concat(n,":").concat(a.toString().padStart(2,"0"))},[]),ha=(0,e.useCallback)(e=>{Fe(!0),Pe(!1),console.log("Enhanced voice recording started",e)},[]),ma=(0,e.useCallback)(e=>{if(Fe(!1),e&&e.audioBlob&&e.duration>1e3){const t=URL.createObjectURL(e.audioBlob),n={id:Date.now(),text:"\ud83c\udfa4 Voice message (".concat(ua(e.duration),")"),user:f,timestamp:(new Date).toISOString(),reactions:[],type:"voice",duration:e.duration,audioUrl:t,audioBlob:e.audioBlob,mimeType:e.mimeType};$t(e=>[...e,n]),setTimeout(()=>{on()},100),console.log("Voice message sent:",e)}},[ua,f,on]),pa=(0,e.useCallback)(()=>{Fe(!1),console.log("Voice recording cancelled")},[]);(0,e.useCallback)(()=>{console.log("startRecording called - handled by VoiceRecorder component")},[]),(0,e.useCallback)(function(){console.log("stopRecording called - handled by VoiceRecorder component")},[]);(0,e.useEffect)(()=>()=>{},[]);const fa=(0,e.useMemo)(()=>{if(!Array.isArray(w))return console.warn("Conversations is not an array:",w),[];let e=w.filter(e=>!!(e&&"object"===typeof e&&e.id&&e.name)&&(!e.isArchived||"archived"===ce));if(null!==X&&void 0!==X&&X.trim()){const t=X.toLowerCase().trim();e=e.filter(e=>{var n,a;const s=(null===(n=e.name)||void 0===n?void 0:n.toLowerCase())||"",r=(null===(a=e.lastMessage)||void 0===a?void 0:a.toLowerCase())||"";return s.includes(t)||r.includes(t)})}try{switch(ce){case"unread":e=e.filter(e=>(e.unreadCount||0)>0);break;case"groups":e=e.filter(e=>{const t=e.name||"";return t.includes("Team")||t.includes("Group")});break;case"archived":e=e.filter(e=>!0===e.isArchived)}}catch(t){console.error("Error applying conversation filter:",t)}try{switch(me){case"unread":e.sort((e,t)=>(t.unreadCount||0)-(e.unreadCount||0));break;case"alphabetical":e.sort((e,t)=>(e.name||"").localeCompare(t.name||""));break;case"recent":e.sort((e,t)=>{const n=new Date(e.lastMessageTime||0).getTime();return new Date(t.lastMessageTime||0).getTime()-n})}e.sort((e,t)=>e.isPinned&&!t.isPinned?-1:!e.isPinned&&t.isPinned?1:0)}catch(t){console.error("Error sorting conversations:",t)}return e},[w,X,ce,me]),ga=(0,e.useMemo)(()=>{if(!xe)return{"All Conversations":fa};const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(t);n.setDate(n.getDate()-1);const a=new Date(t);a.setDate(a.getDate()-7);const s=new Date(t);s.setMonth(s.getMonth()-1);const r={Today:[],Yesterday:[],"This Week":[],"This Month":[],Older:[]};return fa.forEach(e=>{const i=new Date(e.lastMessageTime||0),o=new Date(i.getFullYear(),i.getMonth(),i.getDate());o.getTime()===t.getTime()?r.Today.push(e):o.getTime()===n.getTime()?r.Yesterday.push(e):o>=a?r["This Week"].push(e):o>=s?r["This Month"].push(e):r.Older.push(e)}),Object.keys(r).forEach(e=>{0===r[e].length&&delete r[e]}),r},[fa,xe]);(0,e.useEffect)(()=>{const e=e=>{if(v||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return;const t=fa.findIndex(e=>e.id===R);switch(e.key){case"ArrowUp":e.preventDefault(),t>0&&mn(fa[t-1].id);break;case"ArrowDown":e.preventDefault(),t<fa.length-1&&mn(fa[t+1].id);break;case"Delete":R&&e.shiftKey&&Cn(R);break;case"p":R&&e.ctrlKey&&(e.preventDefault(),kn(R));break;case"m":R&&e.ctrlKey&&(e.preventDefault(),jn(R))}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[R,fa,v,mn,Cn,kn,jn]);const va=(0,e.useMemo)(()=>{if(!Array.isArray(w))return{all:0,unread:0,groups:0};try{return{all:w.length,unread:w.filter(e=>e&&(e.unreadCount||0)>0).length,groups:w.filter(e=>{const t=(null===e||void 0===e?void 0:e.name)||"";return t.includes("Team")||t.includes("Group")}).length}}catch(e){return console.error("Error calculating filter counts:",e),{all:w.length,unread:0,groups:0}}},[w]),ya=(0,e.useMemo)(()=>w.reduce((e,t)=>e+t.unreadCount,0),[w]),[ba,xa]=(0,e.useState)(""),[wa,Sa]=(0,e.useState)({open:!1,userId:null,username:null}),[ka,ja]=(0,e.useState)({open:!1,section:"profile"}),[Na,Ca]=(0,e.useState)(!1),[Ea,Ta]=(0,e.useState)(!1),[Aa,Ia]=(0,e.useState)(!1),[Ma,Da]=(0,e.useState)(!1),[Pa,_a]=(0,e.useState)({active:!1,withUser:null,minimized:!1,audioOnly:!1}),[Ra,za]=(0,e.useState)({active:!1,withUser:null,minimized:!1,audioOnly:!0}),[Fa,La]=(0,e.useState)(null),[Oa,Ua]=(0,e.useState)([]),[Ba,Ha]=(0,e.useState)(!1),qa=(0,e.useCallback)(async()=>{if(ba.trim())try{const e={text:ba.trim(),conversationId:R,user:(null===f||void 0===f?void 0:f.name)||"User"},t=(null===rn||void 0===rn?void 0:rn.participants)||[],n=t.find(e=>e!==f.id),a=await pe.sendMessage(e,{encrypt:_t&&It,recipientId:n,conversationParticipants:t}),s={id:a.id||Date.now(),text:ba.trim(),user:f,timestamp:a.timestamp||(new Date).toISOString(),reactions:a.reactions||[],conversationId:R,isEncrypted:a.isEncrypted||!1,encryptionStatus:a.encryptionStatus};$t(e=>[...e,s]),xa(""),await F.indexMessage(s),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"INDEX_NEW_MESSAGE",message:s}),setTimeout(()=>{on()},100)}catch(e){console.error("Failed to send message:",e);const t={id:Date.now(),text:ba.trim(),user:f,timestamp:(new Date).toISOString(),reactions:[],pending:!0,conversationId:R};$t(e=>[...e,t]),xa(""),setTimeout(()=>{on()},100),console.warn("Message sent offline, will sync when connection is restored")}},[ba,f,R,on,rn,_t,It]),Va=(0,e.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),qa())},[qa]),Wa=(0,e.useCallback)(e=>{xa(e),ut(!1)},[]),Ga=(0,e.useCallback)(()=>{ba.trim()&&(vt(ba),ft(!0))},[ba]),Ka=(0,e.useCallback)(e=>{xa(e),ft(!1)},[]);(0,e.useEffect)(()=>{(async()=>{if(Yt.length>0){var e;const n=Yt[Yt.length-1];if((null===(e=n.user)||void 0===e?void 0:e.id)===f.id)return void ut(!1);try{const e=await O.generateSmartReplies(n.text,{conversationHistory:Yt.slice(-5).map(e=>e.text),userName:f.name});mt(e),ut(e.length>0)}catch(t){console.error("Failed to generate smart replies:",t),mt([]),ut(!1)}}})()},[Yt,f]),(0,e.useEffect)(()=>{if(q.onThreadCreated=e=>{kt(t=>new Map(t).set(e.id,e))},q.onReplyAdded=e=>{const t=q.getThread(e);t&&kt(n=>new Map(n).set(e,t))},q.onThreadUpdated=e=>{kt(t=>new Map(t).set(e.id,e))},q.onThreadDeleted=e=>{kt(t=>{const n=new Map(t);return n.delete(e),n}),(null===yt||void 0===yt?void 0:yt.id)===e&&(bt(null),wt(!1))},R){const e=q.getThreadsForConversation(R),t=new Map;e.forEach(e=>t.set(e.id,e)),kt(t)}return()=>{q.onThreadCreated=null,q.onReplyAdded=null,q.onThreadUpdated=null,q.onThreadDeleted=null}},[R,yt]);const Qa=(0,e.useCallback)(e=>{try{const t=q.createThread(e,R);bt(t),wt(!0),console.log("Thread created:",t)}catch(t){console.error("Failed to create thread:",t),alert("Failed to create thread. Please try again.")}},[R]),Ya=(0,e.useCallback)(e=>{const t=q.getThread(e);t&&(bt(t),wt(!0))},[]),$a=(0,e.useCallback)(()=>{bt(null),wt(!1)},[]),Ja=(0,e.useCallback)((e,t)=>{try{q.addReply(e,t),console.log("Reply added to thread:",e)}catch(n){console.error("Failed to add reply:",n),alert("Failed to add reply. Please try again.")}},[]),Xa=(0,e.useCallback)(e=>Array.from(St.values()).find(t=>t.parentMessage.id===e),[St]),Za=(0,e.useCallback)((e,t)=>{console.log("\ud83c\udfaf Profile button clicked!",{userId:e,username:t,user:f}),console.log("\ud83d\udcf1 Current user data:",f),Sa({open:!0,userId:e,username:t}),console.log("\u2705 Profile modal state set to open"),window.innerWidth<=1024&&y(!0)},[f]),es=(0,e.useCallback)(()=>{Sa({open:!1,userId:null,username:null})},[]),ts=(0,e.useCallback)(()=>{ja({open:!1,section:"profile"})},[]),ns=(0,e.useCallback)(async e=>{try{console.log("Feedback submitted:",e);const t=A.formatFeedbackData(e);if(!A.validateFeedback(t).isValid)throw new Error("Please check your feedback and try again.");const n=await A.submitFeedback(t);return console.log("\u2705 Feedback submitted successfully:",n),n}catch(t){throw console.error("\u274c Failed to submit feedback:",t),t}},[]),as=(0,e.useCallback)(()=>Yt.filter(e=>e.file&&e.file.type.startsWith("image/")).map(e=>({url:e.file.url,name:e.file.name,messageId:e.id})),[Yt]),ss=(0,e.useCallback)((e,t)=>{const n=as(),a=n.findIndex(t=>t.url===e);Oe({open:!0,imageUrl:e,imageName:t,zoom:1,pan:{x:0,y:0},isDragging:!1,currentIndex:Math.max(0,a),images:n})},[as]),rs=(0,e.useCallback)((e,t,n,a)=>{Be({open:!0,videoUrl:e,videoName:t,poster:n,type:a})},[]),is=(0,e.useCallback)(()=>{Be({open:!1,videoUrl:null,videoName:null,poster:null,type:null})},[]),os=(0,e.useCallback)(e=>{Oe(t=>{const n="next"===e?Math.min(t.currentIndex+1,t.images.length-1):Math.max(t.currentIndex-1,0),a=t.images[n];return a?o(o({},t),{},{currentIndex:n,imageUrl:a.url,imageName:a.name,zoom:1,pan:{x:0,y:0},isLoading:!0}):t})},[]),ls=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{isLoading:!1}))},[]),cs=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{isLoading:!1}))},[]),ds=(0,e.useCallback)(()=>{Oe({open:!1,imageUrl:null,imageName:null,zoom:1,pan:{x:0,y:0},isDragging:!1,currentIndex:0,images:[],isLoading:!1})},[]),us=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{zoom:Math.min(1.2*e.zoom,3)}))},[]),hs=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{zoom:Math.max(e.zoom/1.2,.5),pan:e.zoom<=1?{x:0,y:0}:e.pan}))},[]),ms=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{zoom:1,pan:{x:0,y:0}}))},[]),ps=(0,e.useCallback)(e=>{Le.zoom>1&&Oe(e=>o(o({},e),{},{isDragging:!0}))},[Le.zoom]),fs=(0,e.useCallback)(e=>{Le.isDragging&&Le.zoom>1&&Oe(t=>o(o({},t),{},{pan:{x:t.pan.x+e.movementX,y:t.pan.y+e.movementY}}))},[Le.isDragging,Le.zoom]),gs=(0,e.useCallback)(()=>{Oe(e=>o(o({},e),{},{isDragging:!1}))},[]);(0,e.useEffect)(()=>{const e=e=>{if(Le.open)switch(e.key){case"Escape":ds();break;case"ArrowLeft":e.preventDefault(),os("prev");break;case"ArrowRight":e.preventDefault(),os("next");break;case"+":case"=":e.preventDefault(),us();break;case"-":e.preventDefault(),hs();break;case"0":e.preventDefault(),ms()}else if(Ue.open&&"Escape"===e.key)is()},t=e=>{Le.open&&(e.preventDefault(),e.deltaY<0?us():hs())};return document.addEventListener("keydown",e),document.addEventListener("wheel",t,{passive:!1}),()=>{document.removeEventListener("keydown",e),document.removeEventListener("wheel",t)}},[Le.open,ds,os,us,hs,ms]);const vs=(0,e.useCallback)(()=>{_a(e=>o(o({},e),{},{active:!1}))},[]),ys=(0,e.useCallback)(()=>{_a(e=>o(o({},e),{},{minimized:!e.minimized}))},[]),bs=(0,e.useCallback)(async()=>{let e=rn||l;!e&&w.length>0&&(e=w[0],console.log("\ufffd Using first conversation as fallback:",e)),e||(e={id:"demo-user",name:"Demo User",username:"demo",avatar:null,phone:"+1-555-0123"},console.log("\ud83d\udcde Using demo user for voice call test")),console.log("\ufffd\ud83d\udd0d Voice call debug - currentUser:",e),console.log("\ud83d\udd0d Voice call debug - currentSelectedConversation:",rn),console.log("\ud83d\udd0d Voice call debug - currentConversation:",l),console.log("\ud83d\udd0d Voice call debug - conversations:",w);try{console.log("\ud83d\udcde Starting voice call with user:",e.name||e.username);const t=await fe.getAvailableCallMethods(e);if(console.log("\ud83d\udcde Available call methods:",t),Ua(t),t.length>1)return console.log("\ud83d\udcde Multiple methods available, showing selector"),void Ha(!0);console.log("\ud83d\udcde Starting enhanced voice call with auto method"),await xs(e,"auto")}catch(t){console.error("\u274c Failed to start voice call:",t),alert("Failed to start voice call: ".concat(t.message))}},[rn,l,w]),xs=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";try{console.log("\ud83d\ude80 Starting enhanced voice call - targetUser:",e,"method:",t);const n=await fe.initiateEnhancedCall(e,t);if(console.log("\ud83d\udcde Call instance result:",n),!n.success)throw new Error(n.error||"Failed to initiate call");za({active:!0,withUser:{name:e.name||e.username,avatar:e.avatar,phone:e.phone},minimized:!1,audioOnly:!0,callInstance:n});const a={id:n.callId,text:"\ud83d\udcde ".concat(n.method.description," with ").concat(e.name||e.username),user:"You",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"voice_call_enhanced",callStatus:n.status,callMethod:n.method,connectionQuality:n.connectionStatus.quality,isSystemMessage:!0};console.log("\ud83d\udcde Adding voice call message to chat:",a),$t(e=>[...e,a]),Ha(!1),alert("\ud83d\udcde Voice call initiated successfully!\n\nNote: This is a demo implementation. In a real app, you would hear audio and see call controls.")}catch(n){console.error("\u274c Failed to start enhanced voice call:",n),alert("Failed to start voice call: ".concat(n.message))}},[]),ws=(0,e.useCallback)(()=>{za(e=>o(o({},e),{},{active:!1}))},[]),Ss=(0,e.useCallback)(()=>{rt(!0)},[]),ks=(0,e.useCallback)(()=>{rt(!1),ot(!0)},[]),js=(0,e.useCallback)(e=>{console.log("\ud83d\udcde International call initiated:",e);const t={id:"call_".concat(Date.now()),text:"\ud83d\udcde Calling ".concat(e.number," (").concat(e.country.name,")"),user:"You",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"international_call",callData:e,isSystemMessage:!0};$t(e=>[...e,t]),alert("\ud83d\udcde Calling ".concat(e.number,"\n\nNote: This is a demo implementation. In a real app, this would connect to a VoIP service provider like Twilio, WebRTC, or similar service to handle the actual phone call.")),ot(!1)},[]),Ns=(0,e.useCallback)(async()=>{console.log("\ud83c\udfaf handleAppCall called"),alert("App call clicked! Check console for debug info."),rt(!1),await bs()},[bs]),Cs=(0,e.useCallback)(()=>{za(e=>o(o({},e),{},{minimized:!e.minimized}))},[]),Es=(0,e.useCallback)(async()=>{const e=rn||l;if(e)try{await oe.initialize(),_a({active:!0,withUser:{name:e.name,avatar:e.avatar,id:e.id},minimized:!1,audioOnly:!1,callId:"call_".concat(Date.now())});const t={id:"call_".concat(Date.now()),text:"\ud83d\udcf9 Video call with ".concat(e.name),user:"You",timestamp:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),type:"video_call",callStatus:"connecting",isSystemMessage:!0};$t(e=>[...e,t])}catch(t){console.error("Failed to start video call:",t),alert("Failed to start video call. Please check your camera and microphone permissions.")}else alert("Please select a conversation to start a video call")},[rn,l]),Ts=(0,e.useMemo)(()=>null,[Pa,vs,ys]),As=(0,e.useMemo)(()=>null,[Ra,ws,Cs]),Is=((0,e.useCallback)(e=>{const{text:t,file:n,reactions:a}=e;if(null!==n&&void 0!==n&&n.type.startsWith("image/"))return"\ud83d\udcf8 Image: ".concat(n.name);if(null!==n&&void 0!==n&&n.type.startsWith("video/"))return"\ud83c\udfa5 Video: ".concat(n.name);if(null!==n&&void 0!==n&&n.type.startsWith("audio/"))return"\ud83c\udfb5 Audio: ".concat(n.name);if(n&&!n.type.startsWith("image/")&&!n.type.startsWith("video/")&&!n.type.startsWith("audio/"))return"\ud83d\udcce File: ".concat(n.name);if(t.includes("```"))return"\ud83d\udcbb Code snippet";if(t.match(/https?:\/\/[^\s]+/))return"\ud83d\udd17 ".concat(t.substring(0,60),"...");if(t.includes("@")){const e=t.match(/@\w+/g);return"\ud83d\udcac ".concat(t.replace(/@\w+/g,"@user")).concat((null===e||void 0===e?void 0:e.length)>1?" (+".concat(e.length-1," mentions)"):"")}return(null===a||void 0===a?void 0:a.length)>0?"".concat(t.substring(0,60),"... (").concat(a.length," ").concat(1===a.length?"reaction":"reactions",")"):t.length>100?t.substring(0,100)+"...":t},[]),(0,e.useCallback)(e=>{const{text:t,file:n,user:a,reactions:s=[]}=e,r=t.length;return{length:r<=50?"short":r<=200?"medium":r<=500?"long":"very-long",type:n?n.type.startsWith("image/")?"image":n.type.startsWith("video/")?"video":n.type.startsWith("audio/")?"audio":"file":"text",priority:"admin"===a.role?"high":"moderator"===a.role?"medium":"normal",hasMedia:!!n,hasReactions:s.length>0,hasCode:t.includes("```")||t.includes("`"),hasLinks:/https?:\/\/[^\s]+/.test(t),hasMentions:/@\w+/.test(t),sentiment:t.includes("!")&&t.includes("urgent")?"urgent":t.includes("?")?"question":/[\ud83d\ude00\ud83d\ude03\ud83d\ude04\ud83d\ude01\ud83d\ude06\ud83d\ude05\ud83d\ude02\ud83e\udd23\ud83d\ude0a\ud83d\ude07\ud83d\ude42\ud83d\ude09\ud83d\ude0c\ud83d\ude0d\ud83e\udd70\ud83d\ude18\ud83d\ude17\ud83d\ude19\ud83d\ude1a\ud83d\ude0b\ud83d\ude1b\ud83d\ude1d\ud83d\ude1c\ud83e\udd2a\ud83e\udd28\ud83e\uddd0\ud83e\udd13\ud83d\ude0e\ud83e\udd29\ud83e\udd73\ud83d\ude0f\ud83d\ude12\ud83d\ude1e\ud83d\ude14\ud83d\ude1f\ud83d\ude15\ud83d\ude41\u2639\ufe0f\ud83d\ude23\ud83d\ude16\ud83d\ude2b\ud83d\ude29\ud83e\udd7a\ud83d\ude22\ud83d\ude2d\ud83d\ude24\ud83d\ude20\ud83d\ude21\ud83e\udd2c\ud83e\udd2f\ud83d\ude33\ud83e\udd75\ud83e\udd76\ud83d\ude31\ud83d\ude28\ud83d\ude30\ud83d\ude25\ud83d\ude13\ud83e\udd17\ud83e\udd14\ud83e\udd2d\ud83e\udd2b\ud83e\udd25\ud83d\ude36\ud83d\ude10\ud83d\ude11\ud83d\ude2c\ud83d\ude44\ud83d\ude2f\ud83d\ude26\ud83d\ude27\ud83d\ude2e\ud83d\ude32\ud83e\udd71\ud83d\ude34\ud83e\udd24\ud83d\ude2a\ud83d\ude35\ud83e\udd10\ud83e\udd74\ud83e\udd22\ud83e\udd2e\ud83e\udd27\ud83d\ude37\ud83e\udd12\ud83e\udd15\ud83e\udd11\ud83e\udd20\ud83d\ude08\ud83d\udc7f\ud83d\udc79\ud83d\udc7a\ud83e\udd21\ud83d\udca9\ud83d\udc7b\ud83d\udc80\u2620\ufe0f\ud83d\udc7d\ud83d\udc7e\ud83e\udd16\ud83c\udf83\ud83d\ude3a\ud83d\ude38\ud83d\ude39\ud83d\ude3b\ud83d\ude3c\ud83d\ude3d\ud83d\ude40\ud83d\ude3f\ud83d\ude3e]/.test(t)?"emoji":"neutral"}},[])),Ms=(0,e.useCallback)(e=>{const t=e.length;return t<=50?"short":t<=200?"medium":t<=500?"long":"very-long"},[]);return(0,x.jsxs)("div",{className:"pro-layout mobile-optimized smartphone-optimized",children:[(0,x.jsxs)("div",{className:"dynamic-background",children:[(0,x.jsx)("div",{className:"gradient-orb orb-1"}),(0,x.jsx)("div",{className:"gradient-orb orb-2"}),(0,x.jsx)("div",{className:"gradient-orb orb-3"}),(0,x.jsx)("div",{className:"gradient-orb orb-4"}),(0,x.jsx)("div",{className:"gradient-orb orb-5"}),(0,x.jsx)("div",{className:"floating-particles",children:[...Array(20)].map((e,t)=>(0,x.jsx)("div",{className:"particle particle-".concat(t+1)},t))})]}),(0,x.jsx)("div",{className:"content-backdrop"}),Ts,As,(0,x.jsxs)("div",{ref:Kt,className:"pro-sidebar enhanced-sidebar ".concat(v?"collapsed":""),onTouchStart:cn,onTouchMove:dn,onTouchEnd:un,children:[(0,x.jsxs)("div",{className:"pro-sidebar-header",children:[(0,x.jsxs)("div",{className:"sidebar-logo",children:[(0,x.jsxs)("div",{className:"logo-icon","data-tooltip":"Quibish Chat",children:[(0,x.jsx)("span",{className:"logo-emoji",children:"\ud83d\udcac"}),ya>0&&(0,x.jsx)("div",{className:"logo-unread-badge",children:ya>99?"99+":ya})]}),!v&&(0,x.jsxs)("div",{className:"logo-text",children:[(0,x.jsx)("h2",{children:"Quibish"}),(0,x.jsx)("span",{className:"version",children:"v2.0"})]})]}),(0,x.jsx)("button",{onClick:ln,className:"sidebar-toggle-btn",title:v?"Expand sidebar":"Collapse sidebar",children:v?"\u2b9e":"\u2b9c"})]}),(0,x.jsxs)("div",{className:"sidebar-user-profile",children:[(0,x.jsxs)("div",{className:"user-avatar ".concat("admin"===(null===f||void 0===f?void 0:f.role)?"admin-user":""),"data-tooltip":"admin"===(null===f||void 0===f?void 0:f.role)?"".concat((null===f||void 0===f?void 0:f.name)||"Admin"," (Administrator)"):(null===f||void 0===f?void 0:f.name)||"User Profile",children:[(0,x.jsx)("img",{src:_e?"/default-avatar.png":(null===f||void 0===f?void 0:f.avatar)||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent((null===f||void 0===f?void 0:f.name)||"User"),"&background=4f46e5&color=fff&size=80&bold=true&format=png"),alt:(null===f||void 0===f?void 0:f.name)||"User",onError:e=>{_e||(console.log("Avatar load failed, trying fallback:",e.target.src),Jn(),e.target.src.includes("ui-avatars.com")?e.target.src="/default-avatar.png":e.target.src="https://ui-avatars.com/api/?name=".concat(encodeURIComponent((null===f||void 0===f?void 0:f.name)||"User"),"&background=4f46e5&color=fff&size=80&bold=true&format=png"))},onLoad:()=>Re(!1)}),(0,x.jsx)("div",{className:"status-indicator online"}),"admin"===(null===f||void 0===f?void 0:f.role)&&(0,x.jsx)("div",{className:"admin-badge",title:"Administrator",children:"\ud83d\udc51"})]}),!v&&(0,x.jsxs)("div",{className:"user-info",children:[(0,x.jsx)("h3",{className:"user-name",children:(null===f||void 0===f?void 0:f.name)||"User"}),(0,x.jsx)("p",{className:"user-status",children:"Online"})]}),!v&&(0,x.jsxs)("div",{className:"user-actions",children:[(0,x.jsxs)("button",{className:"action-btn settings-btn",title:"Settings",onClick:Fn,children:[(0,x.jsx)("span",{className:"action-icon",children:"\u2699\ufe0f"}),(0,x.jsx)("span",{className:"action-label",children:"Settings"})]}),(0,x.jsxs)("button",{className:"action-btn profile-btn",title:"Profile",onClick:()=>Za(null===f||void 0===f?void 0:f.id,null===f||void 0===f?void 0:f.name),children:[(0,x.jsx)("span",{className:"action-icon",children:"\ud83d\udc64"}),(0,x.jsx)("span",{className:"action-label",children:"Profile"})]})]})]}),!v&&(0,x.jsxs)("div",{className:"sidebar-quick-actions",children:[(0,x.jsxs)("button",{className:"quick-action-btn primary",onClick:_n,children:[(0,x.jsx)("span",{className:"icon",children:"\u2795"}),(0,x.jsx)("span",{className:"text",children:"New Chat"})]}),(0,x.jsxs)("button",{className:"quick-action-btn secondary",onClick:Rn,children:[(0,x.jsx)("span",{className:"icon",children:"\ud83d\udc65"}),(0,x.jsx)("span",{className:"text",children:"Create Group"})]})]}),!v&&(0,x.jsx)("div",{className:"sidebar-search",children:(0,x.jsxs)("div",{className:"search-container",children:[(0,x.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,x.jsx)("input",{type:"text",placeholder:"conversations"===ne?"Search conversations...":"Click to search users...",className:"search-input",value:"conversations"===ne?X:"",onChange:"conversations"===ne?pn:void 0,onClick:"users"===ne?fn:void 0,readOnly:"users"===ne}),(0,x.jsxs)("div",{className:"search-mode-toggle",children:[(0,x.jsx)("button",{className:"search-mode-btn ".concat("conversations"===ne?"active":""),onClick:()=>ae("conversations"),title:"Search conversations",children:"\ud83d\udcac"}),(0,x.jsx)("button",{className:"search-mode-btn ".concat("users"===ne?"active":""),onClick:fn,title:"Search users",children:"\ud83d\udc65"})]})]})}),!v&&(0,x.jsxs)("div",{className:"sidebar-filters",children:[(0,x.jsxs)("button",{className:"filter-tab ".concat("all"===ce?"active":""),onClick:()=>Pn("all"),children:[(0,x.jsx)("span",{className:"tab-text",children:"All"}),(0,x.jsx)("span",{className:"tab-count",children:va.all})]}),(0,x.jsxs)("button",{className:"filter-tab ".concat("unread"===ce?"active":""),onClick:()=>Pn("unread"),children:[(0,x.jsx)("span",{className:"tab-text",children:"Unread"}),(0,x.jsx)("span",{className:"tab-count",children:va.unread})]}),(0,x.jsxs)("button",{className:"filter-tab ".concat("groups"===ce?"active":""),onClick:()=>Pn("groups"),children:[(0,x.jsx)("span",{className:"tab-text",children:"Groups"}),(0,x.jsx)("span",{className:"tab-count",children:va.groups})]})]}),!v&&(0,x.jsxs)("div",{className:"sidebar-toolbar",children:[(0,x.jsxs)("div",{className:"toolbar-left",children:[(0,x.jsx)("button",{className:"toolbar-btn ".concat("recent"===me?"active":""),onClick:()=>be("recent"),title:"Sort by recent",children:"\ud83d\udd52"}),(0,x.jsx)("button",{className:"toolbar-btn ".concat("unread"===me?"active":""),onClick:()=>be("unread"),title:"Sort by unread",children:"\ud83d\udcec"}),(0,x.jsx)("button",{className:"toolbar-btn ".concat("alphabetical"===me?"active":""),onClick:()=>be("alphabetical"),title:"Sort alphabetically",children:"\ud83d\udd24"}),(0,x.jsx)("button",{className:"toolbar-btn ".concat(xe?"active":""),onClick:()=>we(!xe),title:xe?"Ungroup":"Group by date",children:"\ud83d\udcc5"})]}),(0,x.jsx)("div",{className:"toolbar-right",children:(0,x.jsx)("button",{className:"toolbar-btn ".concat(Ce?"active":""),onClick:Tn,title:"Batch select",children:"\u2611\ufe0f"})})]}),!v&&Ce&&Te.size>0&&(0,x.jsxs)("div",{className:"batch-operations-bar",children:[(0,x.jsx)("div",{className:"batch-info",children:(0,x.jsxs)("span",{children:[Te.size," selected"]})}),(0,x.jsxs)("div",{className:"batch-actions",children:[(0,x.jsx)("button",{onClick:In,title:"Mark as read",children:"\u2705"}),(0,x.jsx)("button",{onClick:Mn,title:"Archive",children:"\ud83d\udce6"}),(0,x.jsx)("button",{onClick:Dn,title:"Delete",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,x.jsxs)("div",{className:"pro-sidebar-content",children:[(0,x.jsx)("div",{className:"conversations-list",children:xe?Object.entries(ga).map(e=>{let[t,n]=e;return(0,x.jsxs)("div",{className:"conversation-group",children:[!v&&(0,x.jsx)("div",{className:"group-header",children:t}),n.map(e=>(0,x.jsxs)("div",{className:"conversation-item enhanced ".concat(R===e.id?"active":""),onClick:()=>!Ce&&mn(e.id),onContextMenu:t=>wn(t,e),onMouseEnter:()=>Me(e.id),onMouseLeave:()=>Me(null),children:[Ce&&!v&&(0,x.jsx)("div",{className:"batch-checkbox",children:(0,x.jsx)("input",{type:"checkbox",checked:Te.has(e.id),onChange:()=>An(e.id),onClick:e=>e.stopPropagation()})}),(0,x.jsxs)("div",{className:"conversation-avatar","data-tooltip":e.name,children:[(0,x.jsx)("img",{src:e.avatar||"https://ui-avatars.com/api/?name=".concat(e.name,"&background=random&size=40"),alt:e.name}),e.isOnline&&(0,x.jsx)("div",{className:"online-dot"}),e.unreadCount>0&&(0,x.jsx)("div",{className:"unread-badge",children:e.unreadCount})]}),!v&&(0,x.jsxs)("div",{className:"conversation-details",children:[(0,x.jsxs)("div",{className:"conversation-header",children:[(0,x.jsxs)("h5",{className:"conversation-name",children:[e.isPinned&&(0,x.jsx)("span",{className:"pin-indicator",children:"\ud83d\udccc"}),e.name]}),(0,x.jsx)("span",{className:"conversation-time",children:e.lastMessageTime||"2m"})]}),(0,x.jsxs)("div",{className:"conversation-preview",children:[(0,x.jsx)("p",{className:"last-message",children:e.lastMessage||"Hey there! How are you doing?"}),(0,x.jsxs)("div",{className:"conversation-meta",children:[e.isMuted&&(0,x.jsx)("span",{className:"mute-icon",children:"\ud83d\udd07"}),e.messageStatus&&(0,x.jsx)("span",{className:"message-status ".concat(e.messageStatus),children:"\u2713"})]})]})]}),v&&e.unreadCount>0&&(0,x.jsx)("div",{className:"collapsed-unread-indicator"})]},e.id))]},t)}):fa.map((e,t)=>(0,x.jsxs)("div",{className:"conversation-item enhanced ".concat(R===e.id?"active":""," ").concat((null===Se||void 0===Se?void 0:Se.id)===e.id?"dragging":""),onClick:()=>!Ce&&mn(e.id),onContextMenu:t=>wn(t,e),draggable:"custom"===me&&!Ce,onDragStart:t=>vn(t,e),onDragOver:yn,onDrop:t=>bn(t,e),onDragEnd:xn,onMouseEnter:()=>Me(e.id),onMouseLeave:()=>Me(null),children:[Ce&&!v&&(0,x.jsx)("div",{className:"batch-checkbox",children:(0,x.jsx)("input",{type:"checkbox",checked:Te.has(e.id),onChange:()=>An(e.id),onClick:e=>e.stopPropagation()})}),(0,x.jsxs)("div",{className:"conversation-avatar","data-tooltip":e.name,children:[(0,x.jsx)("img",{src:e.avatar||"https://ui-avatars.com/api/?name=".concat(e.name,"&background=random&size=40"),alt:e.name}),e.isOnline&&(0,x.jsx)("div",{className:"online-dot"}),e.unreadCount>0&&(0,x.jsx)("div",{className:"unread-badge",children:e.unreadCount})]}),!v&&(0,x.jsxs)("div",{className:"conversation-details",children:[(0,x.jsxs)("div",{className:"conversation-header",children:[(0,x.jsxs)("h5",{className:"conversation-name",children:[e.isPinned&&(0,x.jsx)("span",{className:"pin-indicator",children:"\ud83d\udccc"}),e.name]}),(0,x.jsx)("span",{className:"conversation-time",children:e.lastMessageTime||"2m"})]}),(0,x.jsxs)("div",{className:"conversation-preview",children:[(0,x.jsx)("p",{className:"last-message",children:e.lastMessage||"Hey there! How are you doing?"}),(0,x.jsxs)("div",{className:"conversation-meta",children:[e.isMuted&&(0,x.jsx)("span",{className:"mute-icon",children:"\ud83d\udd07"}),e.messageStatus&&(0,x.jsx)("span",{className:"message-status ".concat(e.messageStatus),children:"\u2713"})]})]})]}),v&&e.unreadCount>0&&(0,x.jsx)("div",{className:"collapsed-unread-indicator"}),"custom"===me&&!v&&!Ce&&(0,x.jsx)("div",{className:"drag-handle",title:"Drag to reorder",children:"\u22ee\u22ee"})]},e.id))}),!v&&(0,x.jsx)("div",{className:"placeholder-content"})]}),je.visible&&(0,x.jsxs)("div",{className:"conversation-context-menu",style:{position:"fixed",left:"".concat(je.x,"px"),top:"".concat(je.y,"px"),zIndex:9999},children:[(0,x.jsxs)("div",{className:"context-menu-item",onClick:()=>kn(je.conversation.id),children:[(0,x.jsx)("span",{className:"menu-icon",children:je.conversation.isPinned?"\ud83d\udccd":"\ud83d\udccc"}),(0,x.jsx)("span",{className:"menu-text",children:je.conversation.isPinned?"Unpin":"Pin"})]}),(0,x.jsxs)("div",{className:"context-menu-item",onClick:()=>jn(je.conversation.id),children:[(0,x.jsx)("span",{className:"menu-icon",children:je.conversation.isMuted?"\ud83d\udd14":"\ud83d\udd07"}),(0,x.jsx)("span",{className:"menu-text",children:je.conversation.isMuted?"Unmute":"Mute"})]}),(0,x.jsxs)("div",{className:"context-menu-item",onClick:()=>En(je.conversation.id),children:[(0,x.jsx)("span",{className:"menu-icon",children:"\u2705"}),(0,x.jsx)("span",{className:"menu-text",children:"Mark as Read"})]}),(0,x.jsx)("div",{className:"context-menu-divider"}),(0,x.jsxs)("div",{className:"context-menu-item",onClick:()=>Nn(je.conversation.id),children:[(0,x.jsx)("span",{className:"menu-icon",children:je.conversation.isArchived?"\ud83d\udce5":"\ud83d\udce6"}),(0,x.jsx)("span",{className:"menu-text",children:je.conversation.isArchived?"Unarchive":"Archive"})]}),(0,x.jsxs)("div",{className:"context-menu-item danger",onClick:()=>Cn(je.conversation.id),children:[(0,x.jsx)("span",{className:"menu-icon",children:"\ud83d\uddd1\ufe0f"}),(0,x.jsx)("span",{className:"menu-text",children:"Delete"})]})]}),(0,x.jsxs)("div",{className:"sidebar-footer",children:[!v&&(0,x.jsxs)("div",{className:"footer-stats",children:[(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-label",children:"Active"}),(0,x.jsx)("span",{className:"stat-value",children:"12"})]}),(0,x.jsxs)("div",{className:"stat-item",children:[(0,x.jsx)("span",{className:"stat-label",children:"Total"}),(0,x.jsx)("span",{className:"stat-value",children:"156"})]})]}),(0,x.jsxs)("div",{className:"footer-actions",children:[(0,x.jsx)("button",{className:"footer-btn",title:d?"Light Mode":"Dark Mode",onClick:u,"data-mobile-action":"theme",children:d?"\u2600\ufe0f":"\ud83c\udf19"}),(0,x.jsx)("button",{className:"footer-btn",title:"Profile",onClick:()=>Za(null===f||void 0===f?void 0:f.id,null===f||void 0===f?void 0:f.name),"data-mobile-action":"profile",children:"\ud83d\udc64"}),(0,x.jsx)("button",{className:"footer-btn",title:"Settings",onClick:Fn,"data-mobile-action":"settings",children:"\u2699\ufe0f"}),!v&&(0,x.jsx)("button",{className:"footer-btn",title:"Help",onClick:()=>Ia(!0),children:"\u2753"}),!v&&(0,x.jsx)("button",{className:"footer-btn",title:"Feedback",onClick:()=>Ta(!0),children:"\ud83d\udcac"})]})]})]}),!v&&(0,x.jsx)("div",{className:"pro-sidebar-overlay",onClick:hn,"aria-hidden":"true"}),(0,x.jsx)("div",{className:"pro-main ".concat(v?"collapsed":""),children:(0,x.jsx)("div",{className:"pro-header enhanced-chat-header",children:(0,x.jsxs)("div",{className:"header-left",children:[(0,x.jsx)("button",{className:"mobile-menu-btn",onClick:ln,title:"Toggle sidebar","aria-label":"Toggle sidebar",children:"\u2630"}),(0,x.jsxs)("div",{className:"conversation-avatar",children:[(0,x.jsx)("img",{src:(null===rn||void 0===rn?void 0:rn.avatar)||(null===l||void 0===l?void 0:l.avatar)||"https://images.unsplash.com/photo-1516726817505-f5ed825624d8?w=40&h=40&fit=crop&crop=face",alt:(null===rn||void 0===rn?void 0:rn.name)||(null===l||void 0===l?void 0:l.name)||"Chat"}),(0,x.jsx)("div",{className:"online-indicator ".concat(g?"online":"offline")})]}),(0,x.jsxs)("div",{className:"conversation-info",children:[(0,x.jsx)("h3",{className:"conversation-title",children:(null===rn||void 0===rn?void 0:rn.name)||(null===l||void 0===l?void 0:l.name)||(R?"Loading conversation...":"Select a conversation")}),(0,x.jsxs)("div",{className:"conversation-status",children:[(0,x.jsx)("span",{className:"connection-status ".concat(g?"connected":"disconnected"),children:g?"\u25cf Online":"\u25cf Disconnected"}),(0,x.jsxs)("span",{className:"participant-count",children:[(null===rn||void 0===rn?void 0:rn.participants)||(null===l||void 0===l?void 0:l.participants)||(rn?2:0)," participants"]})]})]}),(0,x.jsxs)("div",{className:"header-actions",children:[(0,x.jsx)("button",{className:"action-btn invite-user-btn",title:"\ud83d\udc65 Invite Users - Search and invite people to chat",onClick:fn,children:"\ud83d\udc65"}),(0,x.jsxs)("button",{className:"action-btn unified-call-btn",title:"\ud83d\udcde Make Calls - International phone calls & app-to-app voice calls",onClick:Ss,children:["\ud83d\udcde",Fa&&(0,x.jsx)("span",{className:"connection-indicator",style:{color:Fa.color},children:Fa.icon})]}),(0,x.jsxs)("button",{className:"action-btn video-call-btn enhanced-video-btn",title:"Start Video Call",onClick:Es,children:[(0,x.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"video-icon",children:[(0,x.jsx)("rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,x.jsx)("path",{d:"M16 10L22 7V17L16 14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,x.jsx)("circle",{cx:"7",cy:"11",r:"1.5",fill:"currentColor",opacity:"0.5"})]}),(0,x.jsx)("span",{className:"btn-label",children:"Video"})]}),(0,x.jsx)("button",{className:"action-btn file-share-btn",title:"\ud83d\udcce File Sharing - Upload, manage, and share files",onClick:()=>Nt(!0),children:"\ud83d\udcce"}),(0,x.jsx)("button",{className:"action-btn donation-btn",title:"\ud83d\udc9d Support Our Free App - Help us keep it free for everyone!",onClick:()=>ct(!0),children:"\ud83d\udc9d"}),(0,x.jsx)("div",{className:"header-menu",children:(0,x.jsx)("button",{className:"action-btn menu-btn",title:"More options",onClick:Xn,style:{position:"relative",zIndex:10},children:"\u22ee"})}),Ve&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{onClick:()=>We(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)",zIndex:2147483646,WebkitTapHighlightColor:"transparent",WebkitUserSelect:"none",userSelect:"none"}}),(0,x.jsxs)("div",{className:"more-options-dropdown",style:{backgroundColor:"rgba(255, 255, 255, 0.98)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(226, 232, 240, 0.8)",borderRadius:"12px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",zIndex:2147483647,pointerEvents:"auto",touchAction:"manipulation"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid rgba(226, 232, 240, 0.5)",fontWeight:"600",fontSize:"14px",color:"#374151",backgroundColor:"rgba(249, 250, 251, 0.8)"},children:[(0,x.jsx)("span",{children:"More Options"}),(0,x.jsx)("button",{onClick:()=>We(!1),style:{background:"none",border:"none",fontSize:"18px",color:"#6b7280",cursor:"pointer",padding:"0",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px"},children:"\xd7"})]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:ra,onMouseEnter:e=>e.target.style.backgroundColor="rgba(59, 130, 246, 0.08)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer",transition:"background-color 0.2s ease"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udd0d"}),"Search in Chat"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:na,onMouseEnter:e=>e.target.style.backgroundColor="rgba(59, 130, 246, 0.08)",onMouseLeave:e=>e.target.style.backgroundColor="transparent",style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer",transition:"background-color 0.2s ease",minHeight:"44px"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udc65"}),"Contacts"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:Zn,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udce5"}),"Export Chat"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:oa,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udda8\ufe0f"}),"Print Chat"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:ea,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"true"===localStorage.getItem("notificationsMuted")?"\ufffd":"\ud83d\udd15"}),"true"===localStorage.getItem("notificationsMuted")?"Unmute":"Mute"," Notifications"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:ta,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\uddd1\ufe0f"}),"Clear Chat"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:()=>Ia(!0),style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\u2753"}),"Help & Support"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:()=>Ta(!0),style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ufffd"}),"Send Feedback"]}),(0,x.jsx)("hr",{style:{height:"1px",background:"rgba(226, 232, 240, 0.8)",border:"none",margin:"4px 0"}}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:()=>Da(!0),style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udd14"}),"Notifications"]}),(0,x.jsxs)("button",{className:"dropdown-item",onClick:Fn,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#374151",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\u2699\ufe0f"}),"Settings"]}),(0,x.jsx)("hr",{style:{height:"1px",background:"rgba(226, 232, 240, 0.8)",border:"none",margin:"4px 0"}}),(0,x.jsxs)("button",{onClick:c,style:{display:"flex",alignItems:"center",gap:"12px",width:"100%",padding:"12px 16px",border:"none",background:"none",textAlign:"left",fontSize:"14px",color:"#dc2626",cursor:"pointer"},children:[(0,x.jsx)("span",{style:{fontSize:"16px",width:"20px"},children:"\ud83d\udeaa"}),"Logout"]})]})]})]})]})})}),(0,x.jsxs)("div",{className:"pro-message-list mobile-optimized pull-to-refresh",ref:Qt,children:[Jt&&(0,x.jsxs)("div",{className:"message-loading-indicator",children:[(0,x.jsx)("div",{className:"loading-spinner"}),(0,x.jsx)("span",{children:"Loading messages..."})]}),Zt&&!Jt&&(0,x.jsxs)("div",{className:"message-error-indicator",children:[(0,x.jsxs)("span",{children:["\u26a0\ufe0f ",Zt]}),(0,x.jsx)("button",{className:"retry-button",onClick:()=>window.location.reload(),children:"Retry"})]}),!Jt&&!Zt&&0===Yt.length&&(0,x.jsx)("div",{className:"no-messages-indicator",children:R?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{children:"\ud83d\udcac No messages yet in this conversation"}),(0,x.jsx)("p",{children:"Be the first to send a message!"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{children:"\ud83d\udc48 Select a conversation to view messages"}),(0,x.jsx)("p",{children:"Choose a conversation from the sidebar to start chatting."})]})}),Yt.map(e=>{var t,n,a,s,r;return(0,x.jsxs)("div",{id:"message-".concat(e.id),className:"pro-message-blurb ".concat(nt===e.id?"search-highlighted":""),"data-message-id":e.id,children:[(0,x.jsx)("div",{className:"message-avatar",children:(0,x.jsx)("img",{src:e.user.avatar||"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=32&h=32&fit=crop&crop=face",alt:e.user.name,onClick:()=>Za(e.user.id,e.user.name)})}),(0,x.jsxs)("div",{className:"message-content",onClick:()=>da(e.id),children:[(0,x.jsxs)("div",{className:"message-header",children:[(0,x.jsx)("span",{className:"user-name",children:e.user.name}),e.isEncrypted&&(0,x.jsx)("span",{className:"encryption-indicator ".concat(e.encryptionStatus),title:"Message is encrypted (".concat(e.encryptionStatus,")"),children:"decrypted"===e.encryptionStatus?"\ud83d\udd13":"failed"===e.encryptionStatus?"\u26a0\ufe0f":"sent"===e.encryptionStatus?"\ud83d\udd12":"\ud83d\udd10"})]}),(0,x.jsx)("div",{className:"message-text","data-length":Ms(e.text),"data-content-type":Is(e).type,"data-has-code":Is(e).hasCode,"data-has-links":Is(e).hasLinks,"data-has-mentions":Is(e).hasMentions,"data-sentiment":Is(e).sentiment,children:(0,x.jsx)("span",{className:"message-smart-text",children:e.text})}),e.file&&(0,x.jsx)("div",{className:"message-attachment",children:e.file.type.startsWith("image/")?(0,x.jsxs)("div",{className:"image-attachment ".concat(e.file.isGif?"gif-attachment":""),children:[e.file.isGif&&(0,x.jsx)("div",{className:"gif-badge",children:(0,x.jsx)("span",{className:"gif-label",children:"GIF"})}),(0,x.jsx)("img",{src:e.file.url,alt:e.file.name,className:"attached-image ".concat(e.file.isGif?"gif-image":""),onClick:()=>{ss(e.file.url,e.file.name)}}),(0,x.jsxs)("div",{className:"image-caption ".concat(e.file.isGif?"gif-caption":""),children:[e.file.isGif&&"\ud83c\udfad ",e.file.name," (",(e.file.size/1024).toFixed(1)," KB)",e.file.isGif&&(0,x.jsx)("span",{className:"gif-info",children:" \u2022 Animated GIF"})]})]}):e.file.type.startsWith("video/")?(0,x.jsxs)("div",{className:"video-attachment",children:[(0,x.jsxs)("div",{className:"video-container",children:[(0,x.jsxs)("video",{src:e.file.url,poster:e.file.thumbnail,controls:!0,preload:"metadata",muted:!1,playsInline:!0,"webkit-playsinline":"true",onClick:()=>{rs(e.file.url,e.file.name,e.file.thumbnail,e.file.type)},onError:t=>{console.error("Video playback error:",t),console.log("Video details:",{src:e.file.url,type:e.file.type,poster:e.file.thumbnail?"Has thumbnail":"No thumbnail",error:t.target.error})},onLoadedMetadata:e=>{console.log("Video loaded for playback:",{duration:e.target.duration,videoWidth:e.target.videoWidth,videoHeight:e.target.videoHeight,readyState:e.target.readyState})},onLoadStart:()=>console.log("Video load started"),onCanPlay:()=>console.log("Video can play"),onCanPlayThrough:()=>console.log("Video can play through"),style:{maxWidth:"400px",maxHeight:"300px",borderRadius:"8px",width:"100%",height:"auto",cursor:"pointer"},children:[(0,x.jsx)("source",{src:e.file.url,type:e.file.type}),"Your browser does not support the video tag."]}),e.file.duration&&(0,x.jsx)("div",{className:"video-duration-badge",children:e.file.duration})]}),(0,x.jsxs)("div",{className:"video-caption",children:["\ud83c\udfa5 ",e.file.name,e.file.size&&" (".concat((e.file.size/1048576).toFixed(1)," MB)"),e.file.width&&e.file.height&&" \u2022 ".concat(e.file.width,"\xd7").concat(e.file.height)]})]}):(0,x.jsxs)("div",{className:"file-attachment",children:[(0,x.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,x.jsxs)("div",{className:"file-info",children:[(0,x.jsx)("div",{className:"file-name",children:e.file.name}),(0,x.jsxs)("div",{className:"file-size",children:[(e.file.size/1024).toFixed(1)," KB"]})]}),(0,x.jsx)("button",{className:"download-btn",onClick:()=>{const t=document.createElement("a");t.href=e.file.url,t.download=e.file.name,t.click()},children:"Download"})]})}),"voice"===e.type&&(0,x.jsx)("div",{className:"voice-message enhanced",children:e.audioUrl?(0,x.jsx)(ee,{audioUrl:e.audioUrl,duration:e.duration,compact:!0,className:"chat-voice-player"}):(0,x.jsxs)("div",{className:"voice-message-fallback",children:[(0,x.jsx)("div",{className:"voice-icon",children:"\ud83c\udfa4"}),(0,x.jsx)("div",{className:"voice-duration",children:ua(e.duration||0)}),(0,x.jsx)("div",{className:"voice-placeholder",children:"Legacy voice message"})]})}),"voice_call"===e.type&&(0,x.jsxs)("div",{className:"voice-call-message",children:[(0,x.jsx)("div",{className:"voice-call-icon",children:"\ud83d\udcde"}),(0,x.jsxs)("div",{className:"voice-call-info",children:[(0,x.jsx)("div",{className:"voice-call-text",children:e.text}),(0,x.jsxs)("div",{className:"voice-call-status",children:["Status: ",e.callStatus]})]}),(0,x.jsx)("div",{className:"voice-call-controls",children:"connecting"===e.callStatus&&(0,x.jsx)("button",{className:"voice-call-btn-small end-call",onClick:()=>ws(),title:"End call",children:"End"})})]}),"voice_call_enhanced"===e.type&&(0,x.jsxs)("div",{className:"voice-call-enhanced-message",children:[(0,x.jsxs)("div",{className:"voice-call-enhanced-header",children:[(0,x.jsx)("div",{className:"voice-call-method-icon",children:(null===(t=e.callMethod)||void 0===t?void 0:t.icon)||"\ud83d\udcde"}),(0,x.jsxs)("div",{className:"voice-call-enhanced-info",children:[(0,x.jsx)("div",{className:"voice-call-enhanced-text",children:e.text}),(0,x.jsx)("div",{className:"voice-call-method-description",children:null===(n=e.callMethod)||void 0===n?void 0:n.description}),(0,x.jsxs)("div",{className:"voice-call-quality-info",children:[(0,x.jsxs)("span",{className:"connection-quality",style:{color:ge.getConnectionStatus().color},children:[null===(a=e.callMethod)||void 0===a?void 0:a.estimated_quality," ",e.connectionQuality]}),(null===(s=e.callMethod)||void 0===s?void 0:s.latency)&&(0,x.jsxs)("span",{className:"latency-info",children:["\u2022 ",Math.round(e.callMethod.latency),"ms"]})]})]})]}),(0,x.jsxs)("div",{className:"voice-call-enhanced-controls",children:[(0,x.jsxs)("div",{className:"call-status-indicator",children:[(0,x.jsx)("div",{className:"status-dot ".concat(e.callStatus)}),(0,x.jsx)("span",{className:"status-text",children:e.callStatus})]}),("connecting"===e.callStatus||"connected"===e.callStatus)&&(0,x.jsx)("button",{className:"voice-call-btn-small end-call-enhanced",onClick:()=>ws(),title:"End call",children:"End Call"})]}),(null===(r=e.callMethod)||void 0===r?void 0:r.note)&&(0,x.jsxs)("div",{className:"call-method-note",children:["\u2139\ufe0f ",e.callMethod.note]})]})]}),(0,x.jsxs)("div",{className:"message-timestamp-with-reactions",children:[(0,x.jsx)("div",{className:"message-timestamp",children:new Date(e.timestamp).toLocaleTimeString()}),e.reactions&&e.reactions.length>0&&(0,x.jsx)("div",{className:"message-reactions-inline",children:e.reactions.map((t,n)=>(0,x.jsxs)("button",{className:"reaction-bubble-inline",onClick:n=>{n.stopPropagation(),la(e.id,t.emoji)},title:"".concat(t.emoji," ").concat(t.count),children:[(0,x.jsx)("span",{className:"reaction-emoji",children:t.emoji}),(0,x.jsx)("span",{className:"reaction-count",children:t.count})]},n))})]}),(0,x.jsx)("div",{className:"message-threading-actions",children:(()=>{const t=Xa(e.id);return t?(0,x.jsx)(W,{thread:t,onClick:()=>Ya(t.id),compact:!1,showParticipants:!0}):(0,x.jsx)("button",{className:"reply-in-thread-btn icon-only",onClick:t=>{t.stopPropagation(),Qa(e)},title:"Reply in thread",children:"\ud83d\udcac"})})()})]},e.id)}),(0,x.jsx)("div",{ref:Gt})]}),(0,x.jsxs)("div",{className:"pro-chat-input-container enhanced mobile-input-bar keyboard-avoiding",children:[(0,x.jsxs)("div",{className:"input-wrapper enhanced touch-target",children:[ze&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"recording-overlay",onClick:()=>Fe(!1),title:"Click to close"}),(0,x.jsx)("div",{className:"enhanced-recording-container",children:(0,x.jsx)(te,{onRecordingComplete:ma,onRecordingCancel:pa,onRecordingStart:ha,onClose:()=>Fe(!1),maxDuration:3e5,minDuration:1e3,compact:!0,autoStart:!1,className:"chat-voice-recorder"})})]}),!ze&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("input",{ref:Ht,type:"file",accept:"image/*,image/gif,video/*,audio/*,.pdf,.doc,.docx,.txt",style:{display:"none"},multiple:!0,onChange:Ln}),(0,x.jsx)("input",{ref:qt,id:"mobile-camera-photo",type:"file",accept:"image/*",capture:"environment",style:{display:"none"},onChange:Ln}),(0,x.jsx)("input",{ref:Vt,id:"mobile-camera-video",type:"file",accept:"video/*",capture:"environment",style:{display:"none"},onChange:Ln}),(0,x.jsx)("input",{ref:Wt,id:"mobile-gallery",type:"file",accept:"image/*,video/*,image/gif",style:{display:"none"},multiple:!0,onChange:Ln}),(0,x.jsxs)("div",{className:"input-actions-row",children:[(0,x.jsx)("button",{className:"input-btn attachment-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:On()?Vn:()=>{var e;return null===(e=Ht.current)||void 0===e?void 0:e.click()},type:"button",title:On()?"Upload menu":"Attach files",children:"\ud83d\udcce"}),(0,x.jsx)("button",{className:"input-btn gif-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:Un,type:"button",title:"Choose GIF",children:"\ud83c\udfad"}),(0,x.jsx)("button",{className:"input-btn gif-upload-btn",onClick:Bn,type:"button",title:"Upload your own GIF",children:"\ud83d\udce4"}),!ze&&(0,x.jsx)("button",{className:"input-btn voice-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:()=>Fe(!0),type:"button",title:"Record voice message",children:"\ud83c\udfa4"}),ve.isSupported("camera")&&(0,x.jsx)("button",{className:"input-btn camera-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:()=>Wn("photo"),type:"button",title:"Take photo/video",children:"\ud83d\udcf7"}),ve.isSupported("contacts")&&(0,x.jsx)("button",{className:"input-btn contact-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:Qn,type:"button",title:"Share contacts",children:"\ud83d\udc65"}),(0,x.jsx)("button",{className:"input-btn emoji-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:()=>Pe(!De),type:"button",title:"Add emoji",children:"\ud83d\ude0a"}),(0,x.jsx)("button",{className:"input-btn ai-btn mobile-action-button touch-target touch-ripple haptic-light",onClick:Ga,disabled:!ba.trim(),type:"button",title:"AI Enhance & Translate",children:"\u2728"}),It&&(0,x.jsx)("button",{className:"input-btn encryption-btn mobile-action-button touch-target touch-ripple haptic-light ".concat(_t?"active":""),onClick:()=>Rt(!_t),type:"button",title:_t?"Encryption enabled":"Encryption disabled",children:_t?"\ud83d\udd12":"\ud83d\udd13"})]}),(0,x.jsxs)("div",{className:"message-input-row",children:[(0,x.jsx)("textarea",{value:ba,onChange:e=>xa(e.target.value),onKeyPress:Va,placeholder:"Type your message...",className:"message-input enhanced mobile-message-input touch-target",rows:"1",autoComplete:"off",autoCorrect:"on",autoCapitalize:"sentences",spellCheck:"true",inputMode:"text","aria-label":"Type your message","data-testid":"message-input"}),(0,x.jsx)("button",{onClick:qa,disabled:!ba.trim(),className:"send-button enhanced mobile-action-button touch-target touch-ripple haptic-light",type:"button","aria-label":"Send message",title:"Send message","data-testid":"send-button",children:(0,x.jsx)("span",{className:"send-icon","aria-hidden":"true",children:"\u27a4"})})]})]})]}),De&&(0,x.jsx)("div",{className:"emoji-picker-overlay",onClick:()=>Pe(!1),children:(0,x.jsxs)("div",{className:"emoji-picker",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"emoji-picker-header",children:[(0,x.jsx)("span",{children:"Choose an emoji"}),(0,x.jsx)("button",{className:"emoji-close",onClick:()=>Pe(!1),children:"\u2715"})]}),(0,x.jsx)("div",{className:"emoji-grid",children:["\ud83d\ude0a","\ud83d\ude02","\ud83e\udd70","\ud83d\ude0d","\ud83e\udd14","\ud83d\ude2e","\ud83d\ude05","\ud83d\udc4d","\ud83d\udc4e","\u2764\ufe0f","\ud83d\udd25","\ud83c\udf89","\ud83d\udc4f","\ud83d\ude4c","\u2728","\ud83d\udcaf","\ud83d\ude80","\ud83d\udca1","\ud83c\udfaf","\u2705","\u274c","\u26a1","\ud83c\udf1f","\ud83e\udd1d","\ud83d\udcaa","\ud83c\udf08","\u2600\ufe0f","\ud83c\udf19","\u2b50","\ud83d\udc9d","\ud83c\udf88"].map(e=>(0,x.jsx)("button",{className:"emoji-item",onClick:()=>ca(e),children:e},e))})]})}),an&&tn&&(0,x.jsx)("div",{className:"emoji-picker-overlay",onClick:()=>{sn(!1),nn(null)},children:(0,x.jsxs)("div",{className:"emoji-picker",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"emoji-picker-header",children:[(0,x.jsx)("span",{children:"Add Reaction"}),(0,x.jsx)("button",{className:"emoji-close",onClick:()=>{sn(!1),nn(null)},children:"\u2715"})]}),(0,x.jsx)("div",{className:"emoji-grid",children:["\ud83d\ude0a","\ud83d\ude02","\ud83e\udd70","\ud83d\ude0d","\ud83e\udd14","\ud83d\ude2e","\ud83d\ude05","\ud83d\udc4d","\ud83d\udc4e","\u2764\ufe0f","\ud83d\udd25","\ud83c\udf89","\ud83d\udc4f","\ud83d\ude4c","\u2728","\ud83d\udcaf","\ud83d\ude80","\ud83d\udca1","\ud83c\udfaf","\u2705","\u274c","\u26a1","\ud83c\udf1f","\ud83e\udd1d","\ud83d\udcaa","\ud83c\udf08","\u2600\ufe0f","\ud83c\udf19","\u2b50","\ud83d\udc9d","\ud83c\udf88"].map(e=>(0,x.jsx)("button",{className:"emoji-item",onClick:()=>ca(e),children:e},e))})]})})]}),(0,x.jsxs)("div",{className:"pro-chat-input-container",children:[dt&&ht.length>0&&(0,x.jsx)(U,{replies:ht,onSelectReply:Wa,onClose:()=>ut(!1),lastMessage:Yt[Yt.length-1]}),pt&&(0,x.jsx)(B,{message:gt,onEnhance:Ka,onClose:()=>ft(!1)})]}),wa.open&&(0,x.jsxs)(x.Fragment,{children:[console.log("\ud83d\udd0d Rendering UserProfileModal:",{profileModal:wa,user:f}),(0,x.jsx)(j,{isOpen:wa.open,user:f,onClose:es,onUpdateProfile:e=>{console.log("Profile updated:",e)}})]}),ka.open&&(0,x.jsxs)(x.Fragment,{children:[console.log("\ud83d\udd27 Rendering SettingsModal:",{settingsModal:ka}),(0,x.jsx)(N,{isOpen:ka.open,onClose:ts,initialSection:ka.section})]}),Ma&&(0,x.jsx)(J,{isOpen:Ma,onClose:()=>Da(!1),user:f}),Le.open&&(0,x.jsx)("div",{className:"pro-lightbox-overlay",onClick:ds,children:(0,x.jsxs)("div",{className:"pro-lightbox-content",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"pro-lightbox-header",children:[(0,x.jsxs)("div",{className:"pro-lightbox-info",children:[(0,x.jsx)("div",{className:"pro-lightbox-title",children:Le.imageName}),(0,x.jsxs)("div",{className:"pro-lightbox-meta",children:[(0,x.jsxs)("span",{className:"pro-lightbox-zoom-info",children:[Math.round(100*Le.zoom),"%"]}),Le.images.length>1&&(0,x.jsxs)("span",{className:"pro-lightbox-counter",children:[Le.currentIndex+1," / ",Le.images.length]})]})]}),(0,x.jsxs)("div",{className:"pro-lightbox-controls",children:[(0,x.jsx)("button",{className:"pro-lightbox-btn",onClick:hs,title:"Zoom out (-)",children:"\ud83d\udd0d-"}),(0,x.jsx)("button",{className:"pro-lightbox-btn",onClick:ms,title:"Reset zoom (0)",children:"\u22a1"}),(0,x.jsx)("button",{className:"pro-lightbox-btn",onClick:us,title:"Zoom in (+)",children:"\ud83d\udd0d+"}),(0,x.jsx)("button",{className:"pro-lightbox-btn pro-lightbox-download",onClick:()=>{const e=document.createElement("a");e.href=Le.imageUrl,e.download=Le.imageName,e.click()},title:"Download image",children:"\ud83d\udcbe"})]}),(0,x.jsx)("button",{className:"pro-lightbox-close",onClick:ds,children:"\xd7"})]}),(0,x.jsxs)("div",{className:"pro-lightbox-image-container",onMouseDown:ps,onMouseMove:fs,onMouseUp:gs,onMouseLeave:gs,style:{cursor:Le.zoom>1?Le.isDragging?"grabbing":"grab":"zoom-in"},children:[Le.images.length>1&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"pro-lightbox-nav pro-lightbox-nav-prev",onClick:()=>os("prev"),disabled:0===Le.currentIndex,title:"Previous image (\u2190)",children:"\u2190"}),(0,x.jsx)("button",{className:"pro-lightbox-nav pro-lightbox-nav-next",onClick:()=>os("next"),disabled:Le.currentIndex===Le.images.length-1,title:"Next image (\u2192)",children:"\u2192"})]}),(0,x.jsx)("img",{src:Le.imageUrl,alt:Le.imageName,className:"pro-lightbox-image ".concat(Le.isLoading?"loading":"loaded"),style:{transform:"scale(".concat(Le.zoom,") translate(").concat(Le.pan.x,"px, ").concat(Le.pan.y,"px)"),transition:Le.isDragging?"none":"transform 0.3s ease",opacity:Le.isLoading?.3:1},onLoad:ls,onError:cs,onDoubleClick:()=>{1===Le.zoom?us():ms()},draggable:!1}),Le.isLoading&&(0,x.jsxs)("div",{className:"pro-lightbox-loading",children:[(0,x.jsx)("div",{className:"pro-lightbox-spinner"}),(0,x.jsx)("span",{children:"Loading..."})]})]}),(0,x.jsx)("div",{className:"pro-lightbox-help",children:(0,x.jsx)("span",{children:"ESC to close \u2022 Arrow keys to navigate \u2022 Mouse wheel to zoom \u2022 Drag to pan \u2022 Double-click to zoom"})})]})}),Ue.open&&(0,x.jsx)("div",{className:"pro-lightbox-overlay",onClick:is,children:(0,x.jsxs)("div",{className:"pro-lightbox-content",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"pro-lightbox-header",children:[(0,x.jsx)("div",{className:"pro-lightbox-info",children:(0,x.jsx)("div",{className:"pro-lightbox-title",children:(0,x.jsx)("h3",{children:Ue.videoName})})}),(0,x.jsx)("div",{className:"pro-lightbox-controls",children:(0,x.jsx)("button",{className:"pro-lightbox-btn pro-lightbox-download",onClick:()=>{const e=document.createElement("a");e.href=Ue.videoUrl,e.download=Ue.videoName,e.click()},title:"Download video",children:"\ud83d\udcbe"})}),(0,x.jsx)("button",{className:"pro-lightbox-close",onClick:is,children:"\xd7"})]}),(0,x.jsx)("div",{className:"pro-lightbox-video-container",children:(0,x.jsxs)("video",{src:Ue.videoUrl,poster:Ue.poster,controls:!0,autoPlay:!0,playsInline:!0,className:"pro-lightbox-video",style:{maxWidth:"100%",maxHeight:"80vh",width:"auto",height:"auto"},children:[(0,x.jsx)("source",{src:Ue.videoUrl,type:Ue.type}),"Your browser does not support the video tag."]})}),(0,x.jsx)("div",{className:"pro-lightbox-help",children:(0,x.jsx)("span",{children:"ESC to close \u2022 Click outside to close \u2022 Download available"})})]})}),(0,x.jsx)(C,{isOpen:He,onGifSelect:Hn,onClose:qn}),(0,x.jsx)(T,{isOpen:Na,onClose:()=>Ca(!1),onCreateChat:zn,currentUser:f,darkMode:d}),(0,x.jsx)(I,{isOpen:Ea,onClose:()=>Ta(!1),onSubmit:ns}),(0,x.jsx)(M,{isOpen:Aa,onClose:()=>Ia(!1)}),Ba&&(0,x.jsx)("div",{className:"call-method-selector-overlay",children:(0,x.jsxs)("div",{className:"call-method-selector-modal",children:[(0,x.jsxs)("div",{className:"call-method-header",children:[(0,x.jsx)("h3",{children:"Choose Call Method"}),(0,x.jsx)("button",{className:"close-btn",onClick:()=>Ha(!1),children:"\xd7"})]}),(0,x.jsx)("div",{className:"call-method-list",children:Oa.map((e,t)=>(0,x.jsxs)("div",{className:"call-method-option ".concat(e.quality),onClick:()=>{xs(rn||l,e.type)},children:[(0,x.jsx)("div",{className:"method-icon",children:e.icon}),(0,x.jsxs)("div",{className:"method-info",children:[(0,x.jsx)("div",{className:"method-title",children:e.description}),(0,x.jsx)("div",{className:"method-quality",children:e.estimated_quality}),e.targetPhone&&(0,x.jsxs)("div",{className:"method-phone",children:["\ud83d\udcf1 ",e.targetPhone]}),e.note&&(0,x.jsx)("div",{className:"method-note",children:e.note}),e.estimatedLatency&&(0,x.jsxs)("div",{className:"method-latency",children:["\u26a1 ",Math.round(e.estimatedLatency),"ms"]})]}),(0,x.jsx)("div",{className:"method-quality-badge",children:e.quality})]},t))}),(0,x.jsx)("div",{className:"connection-info",children:(0,x.jsxs)("div",{className:"current-connection",children:["\ud83d\udcf6 Current: ",ge.getConnectionStatus().quality,"(",ge.getConnectionStatus().type,")"]})})]})}),Ge&&(0,x.jsx)(D,{mode:$e,onCapture:Kn,onClose:Gn}),Qe&&(0,x.jsx)(P,{onContactSelect:$n,onClose:Yn}),Xe&&(0,x.jsx)(_,{isOpen:Xe,onClose:()=>Ze(!1),onStartChat:aa,onStartCall:sa,currentUser:f,darkMode:d}),st&&(0,x.jsx)("div",{className:"modal-overlay",onClick:()=>rt(!1),children:(0,x.jsxs)("div",{className:"modal-content call-options-modal",onClick:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{className:"modal-header",children:[(0,x.jsx)("h3",{children:"Choose Call Type"}),(0,x.jsx)("button",{className:"close-btn",onClick:()=>rt(!1),children:"\xd7"})]}),(0,x.jsxs)("div",{className:"call-options-content",children:[(0,x.jsxs)("button",{className:"call-option-btn international-option",onClick:ks,children:[(0,x.jsx)("span",{className:"call-option-icon",children:"\ud83c\udf0d"}),(0,x.jsxs)("div",{className:"call-option-info",children:[(0,x.jsx)("h4",{children:"International Phone Call"}),(0,x.jsx)("p",{children:"Call any phone number worldwide - completely FREE!"})]})]}),(0,x.jsxs)("button",{className:"call-option-btn app-call-option",onClick:Ns,children:[(0,x.jsx)("span",{className:"call-option-icon",children:"\ud83d\udcac"}),(0,x.jsxs)("div",{className:"call-option-info",children:[(0,x.jsx)("h4",{children:"App-to-App Voice Call"}),(0,x.jsx)("p",{children:"High-quality voice call with other Quibish users"})]})]})]})]})}),it&&(0,x.jsx)(H,{isOpen:it,onClose:()=>ot(!1),onCall:js,darkMode:d}),lt&&(0,x.jsx)(G,{isOpen:lt,onClose:()=>ct(!1),darkMode:d,userStats:{callsMade:0,messagesSent:(null===l||void 0===l||null===(a=l.messages)||void 0===a?void 0:a.length)||0,daysUsed:1}}),(0,x.jsx)(K,{userStats:{callsMade:0,messagesSent:(null===l||void 0===l||null===(s=l.messages)||void 0===s?void 0:s.length)||0,daysUsed:1},darkMode:d,onOpenDonation:()=>ct(!0),position:"bottom-right",autoShow:!0}),ie&&(0,x.jsx)(z,{isOpen:ie,onClose:()=>le(!1),onUserSelect:gn,searchQuery:"users"===ne?X:"",onSearchQueryChange:Z}),et&&(0,x.jsx)(L,{isOpen:et,onClose:()=>tt(!1),onResultSelect:ia,currentConversationId:R}),xt&&yt&&(0,x.jsx)("div",{className:"thread-view-overlay",onClick:$a,children:(0,x.jsx)("div",{className:"thread-view-panel",onClick:e=>e.stopPropagation(),children:(0,x.jsx)(V,{thread:yt,onReply:Ja,onClose:$a,currentUser:f,compact:!1})})}),jt&&(0,x.jsx)(se,{userId:f.id,conversationId:R,onClose:()=>Nt(!1),onFileSelect:e=>{At(e.id),Et(!0)}}),Ct&&Tt&&(0,x.jsx)(re,{fileId:Tt,onClose:()=>{Et(!1),At(null)}}),Pa.active&&(0,x.jsx)(de,{callId:Pa.callId,participants:Pa.withUser?[Pa.withUser]:[],onClose:()=>{_a({active:!1,withUser:null,minimized:!1,audioOnly:!1,callId:null})}})]})},xe=Q.BASE_URL;const we=new class{constructor(){this.baseURL=xe,this.token=localStorage.getItem("authToken")}setToken(e){this.token=e,e?localStorage.setItem("authToken",e):localStorage.removeItem("authToken")}getHeaders(){const e={"Content-Type":"application/json"};return this.token&&(e.Authorization="Bearer ".concat(this.token)),e}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="".concat(this.baseURL).concat(e),a=o(o({},t),{},{headers:o(o({},this.getHeaders()),t.headers)});try{const e=await fetch(n,a);if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));const t=e.headers.get("content-type");return t&&t.includes("application/json")?await e.json():await e.text()}catch(s){throw console.error("API request failed:",s),s}}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}},Se={async login(e,t){try{if(await ke()){const n=await we.post("/auth/login",{email:e,password:t});return n.token&&we.setToken(n.token),n}{if(console.log("\ud83d\udd04 Backend unavailable - using offline mode login"),!e||!t)throw new Error("Please enter both username and password");if(t.length<3)throw new Error("Password too short for demo");const n={id:Date.now().toString(),username:e,email:e,name:e.charAt(0).toUpperCase()+e.slice(1),avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e),"&background=6366f1&color=fff&size=40"),theme:"light",language:"en",isDemo:!0,joinedAt:(new Date).toISOString()},a=btoa(JSON.stringify({userId:n.id,username:e,timestamp:Date.now()}));return console.log("\u2705 Offline login successful for demo user:",e),{success:!0,user:n,token:a,message:"Logged in successfully (offline mode)"}}}catch(n){if(n.message.includes("fetch")||n.message.includes("network")||n.message.includes("Failed to fetch")){if(console.log("\ud83d\udd04 Network error detected - falling back to offline mode"),!e||!t)throw new Error("Please enter both username and password");const n={id:Date.now().toString(),username:e,email:e,name:e.charAt(0).toUpperCase()+e.slice(1),avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e),"&background=6366f1&color=fff&size=40"),theme:"light",language:"en",isDemo:!0,joinedAt:(new Date).toISOString()};return{success:!0,user:n,token:btoa(JSON.stringify({userId:n.id,username:e,timestamp:Date.now()})),message:"Logged in successfully (offline mode)"}}throw new Error(n.message||"Login failed. Please check your credentials.")}},async register(e){try{if(await ke()){const t=await we.post("/auth/register",e);return t.token&&we.setToken(t.token),t}{console.log("\ud83d\udd04 Backend unavailable - using offline mode registration");const{username:t,email:n,password:a,confirmPassword:s}=e;if(!t||!n||!a)throw new Error("Please fill in all required fields");if(a!==s)throw new Error("Passwords do not match");if(a.length<3)throw new Error("Password too short for demo");const r={id:Date.now().toString(),username:t,email:n,name:t.charAt(0).toUpperCase()+t.slice(1),avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(t),"&background=6366f1&color=fff&size=40"),theme:"light",language:"en",isDemo:!0,joinedAt:(new Date).toISOString()},i=btoa(JSON.stringify({userId:r.id,username:t,timestamp:Date.now()}));return console.log("\u2705 Offline registration successful for demo user:",t),{success:!0,user:r,token:i,message:"Registered successfully (offline mode)"}}}catch(t){if(t.message.includes("fetch")||t.message.includes("network")||t.message.includes("Failed to fetch")){console.log("\ud83d\udd04 Network error detected - falling back to offline mode registration");const{username:t,email:n,password:a,confirmPassword:s}=e;if(!t||!n||!a)throw new Error("Please fill in all required fields");if(a!==s)throw new Error("Passwords do not match");const r={id:Date.now().toString(),username:t,email:n,name:t.charAt(0).toUpperCase()+t.slice(1),avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(t),"&background=6366f1&color=fff&size=40"),theme:"light",language:"en",isDemo:!0,joinedAt:(new Date).toISOString()};return{success:!0,user:r,token:btoa(JSON.stringify({userId:r.id,username:t,timestamp:Date.now()})),message:"Registered successfully (offline mode)"}}throw new Error(t.message||"Registration failed. Please try again.")}},async logout(){try{await we.post("/auth/logout")}catch(e){console.warn("Logout API call failed:",e)}finally{we.setToken(null)}},async getCurrentUser(){try{return await we.get("/auth/me")}catch(e){throw new Error("Failed to get current user.")}},async refreshToken(){try{const e=await we.post("/auth/refresh");return e.token&&we.setToken(e.token),e}catch(e){throw new Error("Token refresh failed.")}}},ke=async()=>{try{return(await fetch("".concat(xe,"/health"))).ok}catch(e){return console.warn("API connection check failed:",e),!1}},je=()=>{window.innerWidth<=430&&"ontouchstart"in window&&((()=>{const e=()=>{const e=.01*window.innerHeight;if(document.documentElement.style.setProperty("--vh","".concat(e,"px")),window.navigator.userAgent.includes("iPhone")&&window.screen.height>=844&&3===window.devicePixelRatio){document.documentElement.classList.add("iphone-pro");const e=document.querySelector(".auth-form");e&&e.classList.add("iphone-pro-optimized")}};e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",()=>{setTimeout(e,100)})})(),(()=>{let e=window.innerHeight;const t=()=>{const t=window.innerHeight;if(e-t>150){document.body.classList.add("keyboard-open");const e=document.activeElement;e&&"INPUT"===e.tagName&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},300)}else document.body.classList.remove("keyboard-open")};window.addEventListener("resize",t),document.addEventListener("focusin",e=>{"INPUT"===e.target.tagName&&setTimeout(t,300)}),document.addEventListener("focusout",()=>{setTimeout(()=>{document.body.classList.remove("keyboard-open")},300)})})(),document.addEventListener("touchstart",e=>{e.target.matches('button, .text-button, input[type="submit"]')&&e.target.classList.add("touch-active")}),document.addEventListener("touchend",e=>{e.target.matches('button, .text-button, input[type="submit"]')&&setTimeout(()=>{e.target.classList.remove("touch-active")},150)}),document.querySelectorAll("input").forEach(e=>{e.addEventListener("focus",()=>{e.style.fontSize="16px"})}),new MutationObserver(e=>{e.forEach(e=>{if("childList"===e.type){const t=document.querySelector(".auth-container");t&&e.target.contains(t)&&setTimeout(()=>{t.scrollIntoView({behavior:"smooth",block:"start"})},100)}})}).observe(document.body,{childList:!0,subtree:!0}),console.log("iPhone Pro authentication enhancements initialized"))},Ne={addIPhoneProClass:()=>!!(window.navigator.userAgent.includes("iPhone")&&window.screen.height>=844&&3===window.devicePixelRatio)&&(document.documentElement.classList.add("iphone-pro"),!0),isKeyboardOpen:()=>document.body.classList.contains("keyboard-open"),scrollToAuthForm:()=>{const e=document.querySelector(".auth-form");e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},Ce=t=>{let{onLogin:n,switchToRegister:a}=t;const{login:s}=k(),[r,i]=(0,e.useState)(""),[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(null),[m,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(!1),[b,w]=(0,e.useState)("checking"),[S,j]=(0,e.useState)(!1),[N,C]=(0,e.useState)(null),[E,T]=(0,e.useState)(""),A=(0,e.useRef)(null);(0,e.useEffect)(()=>{A.current&&A.current.focus(),je(),Ne.addIPhoneProClass();(async()=>{await ke()?(console.log("API server is online"),w("online")):(console.log("API server appears to be offline"),h("\ud83c\udf10 Unable to connect to server. Please check your connection and try again."),w("offline"))})()},[]);return(0,x.jsx)("div",{className:"login-container",children:(0,x.jsxs)("div",{className:"auth-form",children:[(0,x.jsxs)("div",{className:"elegant-header",children:[(0,x.jsxs)("div",{className:"brand-section",children:[(0,x.jsx)("div",{className:"brand-icon",children:(0,x.jsx)("span",{className:"brand-emoji",children:"\ud83d\udcac"})}),(0,x.jsxs)("div",{className:"brand-content",children:[(0,x.jsx)("h2",{className:"brand-title",children:"Welcome Back"}),(0,x.jsx)("p",{className:"brand-subtitle",children:"Sign in to continue your conversation"})]})]}),(0,x.jsx)("div",{className:"decorative-line"})]}),"checking"!==b&&(0,x.jsxs)("div",{className:"server-status ".concat(b),children:[(0,x.jsx)("div",{className:"status-indicator"}),(0,x.jsx)("div",{className:"status-text",children:"online"===b?"Server Online":"Server Offline"})]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),y(!0),r.trim()?o?!(o.length<6)||(h("Password must be at least 6 characters"),0):(h("Password is required"),0):(h("Username or email is required"),0)){p(!0),h(null);try{console.log("Login Component - Attempting login with:",{username:r});const e=await Se.login(r,o);if(console.log("Login Component - Login response:",e),!e)throw console.error("Login Component - Empty response received"),new Error("No response from server");if(e.requiresTwoFactor)return console.log("Login Component - 2FA required for user:",e.userId),C(e.userId),T(r),j(!0),void p(!1);if(!e.user)throw console.error("Login Component - Missing user data in response"),new Error("User data missing from response");if(!e.token)throw console.error("Login Component - Missing token in response"),new Error("Authentication token missing from response");console.log("Login Component - Login successful, saving session"),s(e.user,e.token,c),n(e.user,e.token),console.log("Login Component - Session saved and parent notified")}catch(t){if(console.error("Login Component - Login error:",t),t.response){const e=t.response.data;console.error("Login Component - Server error response:",e),e.error?h(e.error):e.message?h(e.message):401===t.response.status?h("Invalid username or password. Please try again."):404===t.response.status?h("Server endpoint not found. Is the server running?"):h("Server error (".concat(t.response.status,"). Please try again later."))}else t.request?(console.error("Login Component - Network error, no response received"),h("Unable to connect to server. Please check your internet connection and try again."),ke().then(e=>{e||h("Server appears to be offline. Please try again later.")})):(console.error("Login Component - Other error:",t.message),h(t.message||"Login failed. Please try again."))}finally{p(!1)}}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"username",children:"Username or Email"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"username",type:"text",value:r,onChange:e=>i(e.target.value),onBlur:()=>y(!0),ref:A,required:!0,autoComplete:"username email",placeholder:"Enter your username or email",className:v&&!r.trim()?"error-input":""}),r&&(0,x.jsx)("button",{type:"button",className:"clear-input",onClick:()=>i(""),"aria-label":"Clear username",children:"\u2715"})]}),v&&!r.trim()&&(0,x.jsx)("div",{className:"field-error",children:"Username or email is required"})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"password",children:"Password"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"password",type:f?"text":"password",value:o,onChange:e=>l(e.target.value),onBlur:()=>y(!0),required:!0,autoComplete:"current-password",placeholder:"Enter your password",className:v&&!o?"error-input":""}),(0,x.jsx)("button",{type:"button",className:"toggle-password",onClick:()=>g(!f),"aria-label":f?"Hide password":"Show password",children:f?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]}),v&&!o&&(0,x.jsx)("div",{className:"field-error",children:"Password is required"}),v&&o&&o.length<6&&(0,x.jsx)("div",{className:"field-error",children:"Password must be at least 6 characters"})]}),(0,x.jsxs)("div",{className:"form-options",children:[(0,x.jsxs)("label",{className:"checkbox-container",children:[(0,x.jsx)("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked)}),(0,x.jsx)("span",{className:"checkmark"}),"Remember me"]}),(0,x.jsx)("button",{type:"button",className:"forgot-password",onClick:()=>console.log("Forgot password clicked"),children:"Forgot password?"})]}),(0,x.jsx)("button",{type:"submit",className:"auth-button",disabled:m,children:m?(0,x.jsxs)("span",{className:"button-with-loader",children:[(0,x.jsx)("span",{className:"loader"}),(0,x.jsx)("span",{children:"Signing in..."})]}):(0,x.jsx)("span",{children:"Sign In"})}),u&&(0,x.jsxs)("div",{className:"auth-error",children:[(0,x.jsx)("div",{className:"error-icon",children:"\u2757"}),(0,x.jsx)("div",{className:"error-message",children:u})]})]}),(0,x.jsxs)("div",{className:"auth-switch",children:["Don't have an account?"," ",(0,x.jsx)("button",{className:"text-button",onClick:a,children:"Sign Up"})]})]})})};const Ee=new class{constructor(){this.emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,this.disposableEmailDomains=["10minutemail.com","tempmail.org","guerrillamail.com","mailinator.com","throwaway.email"]}isValidFormat(e){return!(!e||"string"!==typeof e)&&this.emailRegex.test(e.trim().toLowerCase())}isDisposableEmail(e){if(!this.isValidFormat(e))return!1;const t=e.split("@")[1].toLowerCase();return this.disposableEmailDomains.includes(t)}validateEmail(e){const t={isValid:!1,errors:[],warnings:[]};if(!e||""===e.trim())return t.errors.push("Email is required"),t;const n=e.trim().toLowerCase();return this.isValidFormat(n)?n.length>254?(t.errors.push("Email is too long"),t):n.includes("..")?(t.errors.push("Email cannot contain consecutive dots"),t):n.startsWith(".")||n.endsWith(".")?(t.errors.push("Email cannot start or end with a dot"),t):(this.isDisposableEmail(n)&&t.warnings.push("Disposable email addresses are not recommended"),t.isValid=!0,t):(t.errors.push("Invalid email format"),t)}suggestCorrection(e){if(!e)return null;const t=e.split("@");if(2!==t.length)return null;const[n,a]=t,s={"gmail.co":"gmail.com","gmail.cm":"gmail.com","gmial.com":"gmail.com","gmai.com":"gmail.com","yahoo.co":"yahoo.com","yahoo.cm":"yahoo.com","hotmai.com":"hotmail.com","hotmial.com":"hotmail.com","outlook.co":"outlook.com","outlok.com":"outlook.com"}[a.toLowerCase()];return s?"".concat(n,"@").concat(s):null}validateRealTime(e){if(!e)return{isValid:!1,message:""};if(e.length<3)return{isValid:!1,message:"Email is too short"};if(!e.includes("@"))return{isValid:!1,message:"Email must contain @"};const t=this.validateEmail(e);return t.isValid?t.warnings.length>0?{isValid:!0,message:t.warnings[0],isWarning:!0}:{isValid:!0,message:"Valid email"}:{isValid:!1,message:t.errors[0]||"Invalid email"}}async validateEmailAsync(e){const t=this.validateEmail(e);if(!t.isValid)return t;await new Promise(e=>setTimeout(e,500));return o(o({},t),{},{deliverable:Math.random()>.1,riskScore:Math.floor(100*Math.random()),suggestedCorrection:this.suggestCorrection(e)})}},Te=t=>{let{onRegisterSuccess:n,switchToLogin:a}=t;const[s,r]=(0,e.useState)(""),[i,o]=(0,e.useState)(""),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)(""),[h,m]=(0,e.useState)(null),[p,f]=(0,e.useState)(!1),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)(!1),[w,S]=(0,e.useState)(!1),[k,j]=(0,e.useState)({}),[N,C]=(0,e.useState)("checking"),[E,T]=(0,e.useState)(!1),[A,I]=(0,e.useState)(null),[M,D]=(0,e.useState)(!1),[P,_]=(0,e.useState)({score:0,feedback:[]}),R=(0,e.useRef)(null);(0,e.useEffect)(()=>{R.current&&R.current.focus(),je(),Ne.addIPhoneProClass(),ke().then(e=>{e?(console.log("API server is online"),C("online")):(console.log("API server appears to be offline"),m("Server connection failed. Please try again later."),C("offline"))})},[]),(0,e.useEffect)(()=>{if(i){const e=z(i);_(e)}else _({score:0,feedback:[]})},[i]);const z=e=>{let t=0;const n=[];return e.length>=8?t+=1:n.push("Use at least 8 characters"),/[a-z]/.test(e)?t+=1:n.push("Include lowercase letters"),/[A-Z]/.test(e)?t+=1:n.push("Include uppercase letters"),/\d/.test(e)?t+=1:n.push("Include numbers"),/[^\w\s]/.test(e)?t+=1:n.push("Include special characters"),{score:t,feedback:n}};return(0,x.jsx)("div",{className:"login-container",children:(0,x.jsxs)("div",{className:"auth-form tall-form",children:[(0,x.jsxs)("div",{className:"elegant-header",children:[(0,x.jsxs)("div",{className:"brand-section",children:[(0,x.jsx)("div",{className:"brand-icon",children:(0,x.jsx)("span",{className:"brand-emoji",children:"\u2728"})}),(0,x.jsxs)("div",{className:"brand-content",children:[(0,x.jsx)("h2",{className:"brand-title",children:"Create Account"}),(0,x.jsx)("p",{className:"brand-subtitle",children:"Join the conversation and get started"})]})]}),(0,x.jsx)("div",{className:"decorative-line"})]}),"checking"!==N&&(0,x.jsxs)("div",{className:"server-status ".concat(N),children:[(0,x.jsx)("div",{className:"status-indicator"}),(0,x.jsx)("div",{className:"status-text",children:"online"===N?"Server Online":"Server Offline - Demo Mode"})]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{S(!0);const e={};return s.trim()?s.length<3?e.username="Username must be at least 3 characters":s.length>20?e.username="Username must be less than 20 characters":/^[a-zA-Z0-9_]+$/.test(s)?/^\d/.test(s)&&(e.username="Username cannot start with a number"):e.username="Username can only contain letters, numbers and underscore":e.username="Username is required",d.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)?d.length>254&&(e.email="Email address is too long"):e.email="Please enter a valid email address":e.email="Email is required",i?i.length<8?e.password="Password must be at least 8 characters":P.score<3&&(e.password="Password is too weak. Please strengthen it."):e.password="Password is required",l?i!==l&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",j(e),0===Object.keys(e).length})())if(f(!0),m(null),E)setTimeout(()=>{console.log("Using demo mode registration");const e={id:Date.now(),username:s,email:d},t="offline-token-"+Date.now().toString().slice(-6);Se.saveUserSession(e,t,!0),n(e,t),f(!1)},1e3);else try{console.log("Register Component - Starting email verification for:",{username:s,email:d});const e=await Ee.sendVerificationEmail(d,s,i);e.success&&(I({verificationId:e.verificationId,email:d,expiresAt:e.expiresAt}),D(!0))}catch(t){console.error("Register Component - Email verification error:",t),m(t.message||"Failed to send verification email. Please try again.")}finally{f(!1)}},children:[(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"username",children:"Username"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"username",type:"text",value:s,onChange:e=>r(e.target.value),onBlur:()=>S(!0),ref:R,required:!0,placeholder:"Choose a username",className:w&&k.username?"error-input":""}),s&&(0,x.jsx)("button",{type:"button",className:"clear-input",onClick:()=>r(""),"aria-label":"Clear username",children:"\u2715"})]}),w&&k.username&&(0,x.jsx)("div",{className:"field-error",children:k.username})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"email",children:"Email"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"email",type:"email",value:d,onChange:e=>u(e.target.value),onBlur:()=>S(!0),required:!0,placeholder:"Your email address",className:w&&k.email?"error-input":""}),d&&(0,x.jsx)("button",{type:"button",className:"clear-input",onClick:()=>u(""),"aria-label":"Clear email",children:"\u2715"})]}),w&&k.email&&(0,x.jsx)("div",{className:"field-error",children:k.email})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"password",children:"Password"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"password",type:g?"text":"password",value:i,onChange:e=>o(e.target.value),onBlur:()=>S(!0),required:!0,placeholder:"Choose a password",className:w&&k.password?"error-input":""}),(0,x.jsx)("button",{type:"button",className:"toggle-password",onClick:()=>v(!g),"aria-label":g?"Hide password":"Show password",children:g?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]}),w&&k.password&&(0,x.jsx)("div",{className:"field-error",children:k.password})]}),(0,x.jsxs)("div",{className:"form-group",children:[(0,x.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,x.jsxs)("div",{className:"input-wrapper",children:[(0,x.jsx)("input",{id:"confirmPassword",type:y?"text":"password",value:l,onChange:e=>c(e.target.value),onBlur:()=>S(!0),required:!0,placeholder:"Confirm your password",className:w&&k.confirmPassword?"error-input":""}),(0,x.jsx)("button",{type:"button",className:"toggle-password",onClick:()=>b(!y),"aria-label":y?"Hide password":"Show password",children:y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]}),w&&k.confirmPassword&&(0,x.jsx)("div",{className:"field-error",children:k.confirmPassword})]}),(0,x.jsx)("button",{type:"submit",className:"auth-button",disabled:p,children:p?(0,x.jsxs)("span",{className:"button-with-loader",children:[(0,x.jsx)("span",{className:"loader"}),(0,x.jsx)("span",{children:"Creating account..."})]}):(0,x.jsx)("span",{children:"Sign Up"})}),h&&(0,x.jsxs)("div",{className:"auth-error",children:[(0,x.jsx)("div",{className:"error-icon",children:"\u2757"}),(0,x.jsx)("div",{className:"error-message",children:h})]})]}),(0,x.jsxs)("div",{className:"auth-switch",children:["Already have an account?"," ",(0,x.jsx)("button",{className:"text-button",onClick:a,children:"Log In"})]}),(0,x.jsx)("div",{className:"demo-mode-switch",children:(0,x.jsxs)("label",{className:"checkbox-container",children:[(0,x.jsx)("input",{type:"checkbox",checked:E,onChange:e=>T(e.target.checked)}),(0,x.jsx)("span",{className:"checkmark"}),"Use Demo Mode ",E&&"(Account will be stored locally)"]})})]})})},Ae=e=>{let{size:t="medium",message:n="Loading..."}=e;return(0,x.jsxs)("div",{className:"loading-spinner-container ".concat(t),children:[(0,x.jsxs)("div",{className:"loading-spinner",children:[(0,x.jsx)("div",{className:"spinner-ring"}),(0,x.jsx)("div",{className:"spinner-ring"}),(0,x.jsx)("div",{className:"spinner-ring"})]}),n&&(0,x.jsx)("p",{className:"loading-message",children:n})]})},Ie=t=>{let{isVisible:n=!0,darkMode:a=!1,appVersion:s="1.0.0",onComplete:r}=t;const[i,o]=(0,e.useState)(0),[l,c]=(0,e.useState)("Initializing..."),[d,u]=(0,e.useState)([]);return(0,e.useEffect)(()=>{const e=Array.from({length:20},(e,t)=>({id:t,left:100*Math.random(),top:100*Math.random(),size:4*Math.random()+2,duration:3*Math.random()+2,delay:2*Math.random()}));u(e)},[]),(0,e.useEffect)(()=>{if(!n)return;const e=[{progress:20,text:"Loading components..."},{progress:40,text:"Connecting to services..."},{progress:60,text:"Preparing interface..."},{progress:80,text:"Finalizing setup..."},{progress:100,text:"Ready!"}];let t=0;const a=setInterval(()=>{t<e.length?(o(e[t].progress),c(e[t].text),t++):(clearInterval(a),setTimeout(()=>{r&&r()},500))},300);return()=>clearInterval(a)},[n,r]),n?(0,x.jsxs)("div",{className:"dynamic-splash-screen ".concat(a?"dark-mode":""),children:[(0,x.jsx)("div",{className:"splash-particles",children:d.map(e=>(0,x.jsx)("div",{className:"particle",style:{left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.size,"px"),height:"".concat(e.size,"px"),animationDuration:"".concat(e.duration,"s"),animationDelay:"".concat(e.delay,"s")}},e.id))}),(0,x.jsxs)("div",{className:"splash-ripples",children:[(0,x.jsx)("div",{className:"ripple ripple-1"}),(0,x.jsx)("div",{className:"ripple ripple-2"}),(0,x.jsx)("div",{className:"ripple ripple-3"})]}),(0,x.jsxs)("div",{className:"floating-shapes",children:[(0,x.jsx)("div",{className:"shape shape-circle"}),(0,x.jsx)("div",{className:"shape shape-triangle"}),(0,x.jsx)("div",{className:"shape shape-square"})]}),(0,x.jsxs)("div",{className:"splash-content",children:[(0,x.jsxs)("div",{className:"splash-logo",children:[(0,x.jsxs)("div",{className:"logo-wrapper",children:[(0,x.jsx)("div",{className:"logo-glow"}),(0,x.jsxs)("h1",{className:"logo-text",children:[(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0s"},children:"Q"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.1s"},children:"u"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.2s"},children:"i"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.3s"},children:"b"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.4s"},children:"i"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.5s"},children:"s"}),(0,x.jsx)("span",{className:"letter",style:{animationDelay:"0.6s"},children:"h"})]})]}),(0,x.jsxs)("p",{className:"version",children:["v",s]}),(0,x.jsx)("div",{className:"tagline",children:"Connect. Chat. Create."})]}),(0,x.jsxs)("div",{className:"splash-progress",children:[(0,x.jsx)("div",{className:"progress-bar",children:(0,x.jsx)("div",{className:"progress-fill",style:{width:"".concat(i,"%")},children:(0,x.jsx)("div",{className:"progress-shimmer"})})}),(0,x.jsxs)("p",{className:"loading-text",children:[(0,x.jsx)("span",{className:"loading-icon",children:"\u26a1"}),l]}),(0,x.jsxs)("div",{className:"loading-dots",children:[(0,x.jsx)("span",{className:"dot"}),(0,x.jsx)("span",{className:"dot"}),(0,x.jsx)("span",{className:"dot"})]})]})]})]}):null};class Me extends e.Component{constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleReload=()=>{window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,x.jsx)("div",{className:"error-boundary",children:(0,x.jsxs)("div",{className:"error-content",children:[(0,x.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)("h2",{children:"Something went wrong"}),(0,x.jsx)("p",{children:"We're sorry, but something unexpected happened."}),!1,(0,x.jsxs)("div",{className:"error-actions",children:[(0,x.jsx)("button",{onClick:this.handleReset,className:"retry-btn",children:"Try Again"}),(0,x.jsx)("button",{onClick:this.handleReload,className:"reload-btn",children:"Reload Page"})]})]})}):this.props.children}}const De=Me,Pe=()=>{const[t,n]=(0,e.useState)(navigator.onLine),[a,s]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",()=>{s(!0)}),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);const r=()=>{window.location.reload()};return t?a?(0,x.jsxs)("div",{className:"pwa-status update-available",children:[(0,x.jsx)("span",{className:"status-icon",children:"\ud83d\udd04"}),(0,x.jsx)("span",{className:"status-text",children:"Update Available"}),(0,x.jsx)("button",{onClick:r,className:"refresh-btn",children:"Refresh"})]}):null:(0,x.jsxs)("div",{className:"pwa-status offline",children:[(0,x.jsx)("span",{className:"status-icon",children:"\ud83d\udce1"}),(0,x.jsx)("span",{className:"status-text",children:"Offline Mode"})]})},_e=()=>{const[t,n]=(0,e.useState)(null),[a,s]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=e=>{e.preventDefault(),n(e),s(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);return a&&t?(0,x.jsx)("div",{className:"install-prompt",children:(0,x.jsxs)("div",{className:"install-prompt-content",children:[(0,x.jsx)("div",{className:"install-icon",children:"\ud83d\udcf1"}),(0,x.jsxs)("div",{className:"install-text",children:[(0,x.jsx)("h3",{children:"Install Quibish"}),(0,x.jsx)("p",{children:"Add to your home screen for a better experience"})]}),(0,x.jsxs)("div",{className:"install-actions",children:[(0,x.jsx)("button",{onClick:async()=>{if(!t)return;t.prompt();"accepted"===(await t.userChoice).outcome&&console.log("PWA install accepted"),n(null),s(!1)},className:"install-btn",children:"Install"}),(0,x.jsx)("button",{onClick:()=>{s(!1),n(null)},className:"dismiss-btn",children:"\u2715"})]})]})}):null};const Re=new class{constructor(){this.currentTheme="default",this.backgroundType="static",this.seasonalThemes=this.getSeasonalThemes(),this.customThemes=new Map,this.backgroundAnimations=new Map,this.init()}init(){this.detectAndApplySeason(),this.setupTimeBasedThemes(),this.initBackgroundEffects()}getSeasonalThemes(){return{spring:{name:"Spring Bloom",colors:{primary:"#10b981",secondary:"#34d399",accent:"#f59e0b",background:"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 50%, #a7f3d0 100%)",particles:["\ud83c\udf38","\ud83c\udf31","\ud83e\udd8b","\ud83c\udf3f"]},effects:["floating-petals","gentle-breeze"]},summer:{name:"Summer Vibes",colors:{primary:"#3b82f6",secondary:"#60a5fa",accent:"#f59e0b",background:"linear-gradient(135deg, #dbeafe 0%, #93c5fd 50%, #60a5fa 100%)",particles:["\u2600\ufe0f","\ud83c\udf0a","\ud83c\udfd6\ufe0f","\ud83c\udf1e"]},effects:["sun-rays","wave-motion"]},autumn:{name:"Autumn Leaves",colors:{primary:"#f59e0b",secondary:"#fb923c",accent:"#dc2626",background:"linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fdba74 100%)",particles:["\ud83c\udf42","\ud83c\udf41","\ud83c\udf30","\ud83c\udf44"]},effects:["falling-leaves","wind-rustle"]},winter:{name:"Winter Wonder",colors:{primary:"#6366f1",secondary:"#818cf8",accent:"#06b6d4",background:"linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #cbd5e1 100%)",particles:["\u2744\ufe0f","\u2b50","\ud83c\udf28\ufe0f","\u2728"]},effects:["snowfall","twinkling-stars"]}}}detectAndApplySeason(){const e=(new Date).getMonth();let t;t=e>=2&&e<=4?"spring":e>=5&&e<=7?"summer":e>=8&&e<=10?"autumn":"winter";const n=localStorage.getItem("quibish-theme-preference");n&&"auto"!==n?this.applyTheme(n):this.applySeasonalTheme(t)}applySeasonalTheme(e){const t=this.seasonalThemes[e];t&&(this.currentTheme=e,this.updateCSSVariables(t.colors),this.setBackground(t.colors.background),this.updateParticles(t.colors.particles),this.applyEffects(t.effects),console.log("\ud83c\udfa8 Applied ".concat(t.name," theme")))}applyTheme(e){if(this.seasonalThemes[e])this.applySeasonalTheme(e);else if(this.customThemes.has(e)){const t=this.customThemes.get(e);this.updateCSSVariables(t.colors),this.setBackground(t.background)}localStorage.setItem("quibish-theme-preference",e)}updateCSSVariables(e){const t=document.documentElement;Object.entries(e).forEach(e=>{let[n,a]=e;"background"!==n&&"particles"!==n&&t.style.setProperty("--theme-".concat(n),a)})}setBackground(e){const t=document.querySelector(".app");t&&(t.style.background=e,t.style.transition="background 1s ease-in-out")}initBackgroundEffects(){this.createParticleSystem(),this.createAnimatedShapes()}createParticleSystem(){const e=document.createElement("div");e.className="dynamic-particles",e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: -1;\n      overflow: hidden;\n    ",document.body.appendChild(e),this.particleContainer=e}updateParticles(e){if(this.particleContainer){this.particleContainer.innerHTML="";for(let t=0;t<20;t++){const t=this.createParticle(e);this.particleContainer.appendChild(t)}}}createParticle(e){const t=document.createElement("div"),n=e[Math.floor(Math.random()*e.length)],a=20*Math.random()+10,s=100*Math.random(),r=10*Math.random()+15,i=5*Math.random();return t.textContent=n,t.style.cssText="\n      position: absolute;\n      font-size: ".concat(a,"px;\n      left: ").concat(s,"%;\n      top: -50px;\n      animation: particleFall ").concat(r,"s linear infinite;\n      animation-delay: ").concat(i,"s;\n      opacity: 0.7;\n    "),t}createAnimatedShapes(){const e=document.createElement("div");e.className="animated-shapes",e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: -2;\n      overflow: hidden;\n    ";for(let t=0;t<5;t++){const t=this.createAnimatedShape();e.appendChild(t)}document.body.appendChild(e)}createAnimatedShape(){const e=document.createElement("div"),t=100*Math.random()+50,n=100*Math.random(),a=100*Math.random(),s=360*Math.random(),r=20*Math.random()+10,i=Math.random();let o="0";return i<.33?o="50%":i<.66&&(o="25%"),e.style.cssText="\n      position: absolute;\n      width: ".concat(t,"px;\n      height: ").concat(t,"px;\n      left: ").concat(n,"%;\n      top: ").concat(a,"%;\n      background: linear-gradient(45deg, \n        rgba(99, 102, 241, 0.1), \n        rgba(139, 92, 246, 0.1));\n      border-radius: ").concat(o,";\n      transform: rotate(").concat(s,"deg);\n      animation: floatShape ").concat(r,"s ease-in-out infinite;\n      opacity: 0.3;\n    "),e}applyEffects(e){e.forEach(e=>{switch(e){case"floating-petals":this.createFloatingPetals();break;case"snowfall":this.createSnowfall();break;case"sun-rays":this.createSunRays();break;case"falling-leaves":this.createFallingLeaves()}})}createFloatingPetals(){const e=document.createElement("style");e.textContent="\n      @keyframes petalFloat {\n        0% { transform: translateY(100vh) rotateZ(0deg); }\n        100% { transform: translateY(-100px) rotateZ(360deg); }\n      }\n      .petal-particle {\n        animation: petalFloat 8s linear infinite !important;\n      }\n    ",document.head.appendChild(e)}createSnowfall(){const e=document.createElement("style");e.textContent="\n      @keyframes snowfall {\n        0% { transform: translateY(-100px) translateX(0px); }\n        100% { transform: translateY(100vh) translateX(100px); }\n      }\n      .snow-particle {\n        animation: snowfall 6s linear infinite !important;\n      }\n    ",document.head.appendChild(e)}createSunRays(){const e=document.createElement("div");e.className="sun-rays",e.style.cssText="\n      position: fixed;\n      top: -50%;\n      left: -50%;\n      width: 200%;\n      height: 200%;\n      background: radial-gradient(\n        circle at 70% 20%, \n        rgba(251, 191, 36, 0.1) 0%, \n        transparent 50%\n      );\n      animation: sunRotate 30s linear infinite;\n      pointer-events: none;\n      z-index: -1;\n    ",document.body.appendChild(e);const t=document.createElement("style");t.textContent="\n      @keyframes sunRotate {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n    ",document.head.appendChild(t)}createFallingLeaves(){const e=document.createElement("style");e.textContent="\n      @keyframes leafFall {\n        0% { \n          transform: translateY(-100px) rotateZ(0deg) translateX(0px);\n          opacity: 1;\n        }\n        50% { \n          transform: translateY(50vh) rotateZ(180deg) translateX(50px);\n          opacity: 0.8;\n        }\n        100% { \n          transform: translateY(100vh) rotateZ(360deg) translateX(-50px);\n          opacity: 0;\n        }\n      }\n      .leaf-particle {\n        animation: leafFall 10s ease-in-out infinite !important;\n      }\n    ",document.head.appendChild(e)}setupTimeBasedThemes(){setInterval(()=>{const e=(new Date).getHours();"true"===localStorage.getItem("quibish-auto-dark")&&(e>=20||e<=6?this.enableDarkMode():this.disableDarkMode())},6e4)}enableDarkMode(){document.body.classList.add("dark-theme");document.documentElement.style.setProperty("--theme-background","linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%)")}disableDarkMode(){document.body.classList.remove("dark-theme"),this.detectAndApplySeason()}createCustomTheme(e,t,n){this.customThemes.set(e,{colors:t,background:n}),localStorage.setItem("quibish-custom-theme-".concat(e),JSON.stringify({colors:t,background:n}))}getAvailableThemes(){return{seasonal:Object.keys(this.seasonalThemes).map(e=>({id:e,name:this.seasonalThemes[e].name,preview:this.seasonalThemes[e].colors.background})),custom:Array.from(this.customThemes.keys()).map(e=>({id:e,name:e,preview:this.customThemes.get(e).background}))}}addAnimationStyles(){const e=document.createElement("style");e.textContent="\n      @keyframes particleFall {\n        0% {\n          transform: translateY(-100px) rotate(0deg);\n          opacity: 0;\n        }\n        10% {\n          opacity: 1;\n        }\n        90% {\n          opacity: 1;\n        }\n        100% {\n          transform: translateY(100vh) rotate(360deg);\n          opacity: 0;\n        }\n      }\n\n      @keyframes floatShape {\n        0%, 100% {\n          transform: translateY(0px) rotate(0deg);\n        }\n        33% {\n          transform: translateY(-20px) rotate(120deg);\n        }\n        66% {\n          transform: translateY(10px) rotate(240deg);\n        }\n      }\n\n      .dynamic-particles {\n        transition: opacity 0.5s ease;\n      }\n\n      .animated-shapes {\n        transition: opacity 0.5s ease;\n      }\n\n      @media (prefers-reduced-motion: reduce) {\n        .dynamic-particles,\n        .animated-shapes,\n        .sun-rays {\n          display: none !important;\n        }\n      }\n    ",document.head.appendChild(e)}toggleEffects(e){const t=document.querySelector(".dynamic-particles"),n=document.querySelector(".animated-shapes");t&&(t.style.opacity=e?"1":"0"),n&&(n.style.opacity=e?"1":"0")}cleanup(){const e=document.querySelector(".dynamic-particles"),t=document.querySelector(".animated-shapes"),n=document.querySelector(".sun-rays");e&&e.remove(),t&&t.remove(),n&&n.remove(),this.backgroundAnimations.forEach(e=>{e.cancel&&e.cancel()}),this.backgroundAnimations.clear()}},ze=Re,Fe=()=>{var t,n;const[a,s]=(0,e.useState)("auto"),[r,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(!0),[c,d]=(0,e.useState)(!0);(0,e.useEffect)(()=>{const e=localStorage.getItem("quibish-theme-preference")||"auto",t=localStorage.getItem("quibish-effects-enabled"),n=localStorage.getItem("quibish-auto-mode");s(e),l("false"!==t),d("false"!==n),"false"===t&&ze.toggleEffects(!1),ze.addAnimationStyles()},[]);const u=[{id:"auto",name:"Auto (Seasonal)",icon:"\ud83c\udf1f",description:"Automatically changes with seasons"},{id:"spring",name:"Spring Bloom",icon:"\ud83c\udf38",description:"Fresh greens and blooming flowers"},{id:"summer",name:"Summer Vibes",icon:"\u2600\ufe0f",description:"Bright blues and sunny vibes"},{id:"autumn",name:"Autumn Leaves",icon:"\ud83c\udf42",description:"Warm oranges and falling leaves"},{id:"winter",name:"Winter Wonder",icon:"\u2744\ufe0f",description:"Cool blues and snowy effects"},{id:"dark",name:"Dark Mode",icon:"\ud83c\udf19",description:"Easy on the eyes"},{id:"cosmic",name:"Cosmic",icon:"\ud83c\udf0c",description:"Deep space vibes"},{id:"ocean",name:"Ocean Depths",icon:"\ud83c\udf0a",description:"Calming ocean blues"}],h=e=>{s(e),"auto"===e?(d(!0),localStorage.setItem("quibish-auto-mode","true"),ze.detectAndApplySeason()):(d(!1),localStorage.setItem("quibish-auto-mode","false"),ze.applyTheme(e)),localStorage.setItem("quibish-theme-preference",e)};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:"theme-toggle ".concat(r?"active":""),onClick:()=>i(!r),title:"Theme Settings",children:(0,x.jsx)("span",{className:"theme-icon",children:"\ud83c\udfa8"})}),r&&(0,x.jsxs)("div",{className:"theme-panel",children:[(0,x.jsxs)("div",{className:"theme-panel-header",children:[(0,x.jsx)("h3",{children:"\ud83c\udfa8 Themes & Effects"}),(0,x.jsx)("button",{className:"close-btn",onClick:()=>i(!1),children:"\u2715"})]}),(0,x.jsxs)("div",{className:"theme-panel-content",children:[(0,x.jsxs)("div",{className:"theme-section",children:[(0,x.jsx)("h4",{children:"Choose Theme"}),(0,x.jsx)("div",{className:"theme-grid",children:u.map(e=>(0,x.jsxs)("div",{className:"theme-card ".concat(a===e.id?"active":""),onClick:()=>h(e.id),children:[(0,x.jsx)("div",{className:"theme-preview",children:(0,x.jsx)("span",{className:"theme-emoji",children:e.icon})}),(0,x.jsxs)("div",{className:"theme-info",children:[(0,x.jsx)("div",{className:"theme-name",children:e.name}),(0,x.jsx)("div",{className:"theme-description",children:e.description})]})]},e.id))})]}),(0,x.jsxs)("div",{className:"theme-section",children:[(0,x.jsx)("h4",{children:"Visual Effects"}),(0,x.jsxs)("div",{className:"effects-controls",children:[(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:o,onChange:()=>{const e=!o;l(e),ze.toggleEffects(e),localStorage.setItem("quibish-effects-enabled",e.toString())}}),(0,x.jsx)("span",{className:"toggle-slider"}),(0,x.jsx)("span",{className:"toggle-text",children:o?"\u2728 Effects On":"\ud83d\udeab Effects Off"})]}),(0,x.jsxs)("label",{className:"toggle-label",children:[(0,x.jsx)("input",{type:"checkbox",checked:c,onChange:e=>{d(e.target.checked),localStorage.setItem("quibish-auto-mode",e.target.checked.toString()),e.target.checked&&h("auto")}}),(0,x.jsx)("span",{className:"toggle-slider"}),(0,x.jsx)("span",{className:"toggle-text",children:c?"\ud83c\udf1f Auto Season":"\ud83d\udd12 Manual Mode"})]})]})]}),(0,x.jsxs)("div",{className:"theme-section",children:[(0,x.jsx)("h4",{children:"Personalization"}),(0,x.jsxs)("button",{className:"custom-theme-btn",onClick:()=>{const e=prompt("Enter custom theme name:");if(!e)return;const t=prompt("Enter primary color (hex):")||"#3b82f6",n=prompt("Enter secondary color (hex):")||"#60a5fa",a=prompt("Enter accent color (hex):")||"#f59e0b",s={primary:t,secondary:n,accent:a},r="linear-gradient(135deg, ".concat(t,"20 0%, ").concat(n,"20 50%, ").concat(a,"20 100%)");ze.createCustomTheme(e,s,r),h(e)},children:[(0,x.jsx)("span",{children:"\ud83c\udfa8"}),"Create Custom Theme"]})]}),(0,x.jsx)("div",{className:"theme-section",children:(0,x.jsxs)("div",{className:"current-theme-info",children:[(0,x.jsx)("h4",{children:"Current Theme"}),(0,x.jsxs)("div",{className:"current-theme-display",children:[(0,x.jsx)("span",{className:"current-theme-icon",children:(null===(t=u.find(e=>e.id===a))||void 0===t?void 0:t.icon)||"\ud83c\udfa8"}),(0,x.jsx)("span",{className:"current-theme-name",children:(null===(n=u.find(e=>e.id===a))||void 0===n?void 0:n.name)||"Custom Theme"})]})]})})]})]}),r&&(0,x.jsx)("div",{className:"theme-panel-overlay",onClick:()=>i(!1)})]})},Le=()=>{const[t,n]=(0,e.useState)(navigator.onLine),[a,s]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{const e=()=>{n(!0),s(!0),setTimeout(()=>s(!1),3e3)},t=()=>{n(!1),s(!0)};return window.addEventListener("online",e),window.addEventListener("offline",t),navigator.onLine||s(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),a?(0,x.jsx)("div",{className:"connection-status ".concat(t?"online":"offline"),children:(0,x.jsxs)("div",{className:"status-content",children:[(0,x.jsx)("span",{className:"status-icon",children:t?"\ud83d\udfe2":"\ud83d\udd34"}),(0,x.jsx)("span",{className:"status-text",children:t?"Back online":"No internet connection"})]})}):null};const Oe=new class{constructor(){this.isSupported="serviceWorker"in navigator,this.shortcuts=new Map,this.initialize()}initialize(){this.isSupported?(this.registerServiceWorker(),this.initializeShortcuts(),this.handleAppInstall()):console.warn("PWA: Service Workers not supported in this browser")}async registerServiceWorker(){try{if("serviceWorker"in navigator){const e=await navigator.serviceWorker.register("/sw.js");console.log("PWA: Service Worker registered successfully:",e.scope),e.addEventListener("updatefound",()=>{console.log("PWA: Service Worker update found")})}}catch(e){console.error("PWA: Service Worker registration failed:",e)}}initializeShortcuts(){this.shortcuts.set("voice-call",{name:"Voice Call",shortName:"Call",description:"Start a voice call",url:"/?action=voice-call",icons:[{src:"/icons/voice-call-96x96.png",sizes:"96x96"}]}),this.shortcuts.set("video-call",{name:"Video Call",shortName:"Video",description:"Start a video call",url:"/?action=video-call",icons:[{src:"/icons/video-call-96x96.png",sizes:"96x96"}]}),this.shortcuts.set("new-message",{name:"New Message",shortName:"Message",description:"Compose a new message",url:"/?action=new-message",icons:[{src:"/icons/message-96x96.png",sizes:"96x96"}]})}handleAppInstall(){let e;window.addEventListener("beforeinstallprompt",t=>{console.log("PWA: Install prompt available"),t.preventDefault(),e=t,this.showInstallButton(e)}),window.addEventListener("appinstalled",t=>{console.log("PWA: App installed successfully"),e=null})}showInstallButton(e){if(!document.getElementById("pwa-install-button")){const t=document.createElement("button");t.id="pwa-install-button",t.textContent="Install App",t.className="pwa-install-btn",t.addEventListener("click",async()=>{if(e){e.prompt();const n=await e.userChoice;console.log("PWA: Install prompt result:",n),e=null,t.style.display="none"}});const n=()=>{const e=document.querySelector("header")||document.body;e&&e.appendChild(t)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()}}triggerShortcut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.shortcuts.get(e);if(!n)return console.warn("PWA: Unknown shortcut: ".concat(e)),!1;console.log("PWA: Triggering shortcut: ".concat(n.name),t);const a=new CustomEvent("pwa-shortcut-".concat(e),{detail:{shortcut:n,options:t}});return window.dispatchEvent(a),!0}async share(e){if(!navigator.share)return console.warn("PWA: Web Share API not supported"),this.fallbackShare(e);try{return await navigator.share(e),console.log("PWA: Content shared successfully"),!0}catch(t){return"AbortError"===t.name?console.log("PWA: Share cancelled by user"):console.error("PWA: Share failed:",t),!1}}fallbackShare(e){if(navigator.clipboard&&e.text)return navigator.clipboard.writeText(e.text),console.log("PWA: Content copied to clipboard"),!0;const t=e.url||window.location.href,n=e.text||e.title||"Check this out!",a=document.createElement("input");return a.value="".concat(n," ").concat(t),document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),console.log("PWA: Content copied to clipboard (fallback)"),!0}async requestNotificationPermission(){if(!("Notification"in window))return console.warn("PWA: Notifications not supported"),!1;if("granted"===Notification.permission)return!0;if("denied"===Notification.permission)return console.warn("PWA: Notification permission denied"),!1;return"granted"===await Notification.requestPermission()}async showNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!await this.requestNotificationPermission())return console.warn("PWA: Cannot show notification - permission denied"),!1;const n=o(o({},{icon:"/icons/icon-192x192.png",badge:"/icons/badge-72x72.png",tag:"quibish-notification",requireInteraction:!1,silent:!1}),t);try{const a=new Notification(e,n);return a.onclick=()=>{window.focus(),a.close(),t.onClick&&t.onClick()},a}catch(a){return console.error("PWA: Failed to show notification:",a),!1}}isStandalone(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://")}getCapabilities(){return{serviceWorker:"serviceWorker"in navigator,notifications:"Notification"in window,share:"share"in navigator,clipboard:"clipboard"in navigator,geolocation:"geolocation"in navigator,camera:"mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices,standalone:this.isStandalone(),online:navigator.onLine}}setupNetworkHandling(){window.addEventListener("online",()=>{console.log("PWA: Back online"),document.body.classList.remove("offline"),document.body.classList.add("online")}),window.addEventListener("offline",()=>{console.log("PWA: Gone offline"),document.body.classList.remove("online"),document.body.classList.add("offline")}),navigator.onLine?document.body.classList.add("online"):document.body.classList.add("offline")}};const Ue=new class{constructor(){this.shortcuts=[],this.isInitialized=!1}init(){if(!this.isInitialized)try{"serviceWorker"in navigator&&"shortcuts"in navigator&&this.registerShortcuts(),this.isInitialized=!0}catch(e){console.warn("PWA Shortcuts not supported:",e)}}registerShortcuts(){this.shortcuts=[{name:"New Chat",short_name:"Chat",description:"Start a new conversation",url:"/?action=new-chat",icons:[{src:"/logo192.png",sizes:"192x192"}]},{name:"Profile",short_name:"Profile",description:"View your profile",url:"/?action=profile",icons:[{src:"/logo192.png",sizes:"192x192"}]}]}getShortcuts(){return this.shortcuts}updateShortcuts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];try{const t=e.slice(0,3).map((e,t)=>({name:"Chat with ".concat(e.name),short_name:e.name,description:"Start conversation with ".concat(e.name),url:"/?action=chat&contact=".concat(e.id),icons:[{src:e.avatar||"/logo192.png",sizes:"192x192"}]}));this.shortcuts=[...this.shortcuts.slice(0,2),...t],console.log("\ud83d\udd17 PWA shortcuts updated with frequent contacts")}catch(t){console.warn("Failed to update PWA shortcuts:",t)}}};const Be=new class{constructor(){this.migrationVersion="1.0.0",this.migrationKey="quibish_migration_status"}needsMigration(){try{const e=localStorage.getItem(this.migrationKey);return!e||e!==this.migrationVersion}catch(e){return console.warn("\u26a0\ufe0f Could not check migration status:",e),!0}}async performMigration(){console.log("\ud83d\udd04 Starting data migration to persistent storage...");try{const e={userMigrated:!1,messagesMigrated:!1,tokenMigrated:!1,settingsMigrated:!1,conversationsMigrated:!1};return e.userMigrated=this.migrateUserData(),e.messagesMigrated=this.migrateMessages(),e.tokenMigrated=this.migrateAuthTokens(),e.settingsMigrated=this.migrateSettings(),e.conversationsMigrated=this.migrateConversations(),localStorage.setItem(this.migrationKey,this.migrationVersion),console.log("\u2705 Data migration completed:",e),this.cleanupOldData(),e}catch(e){throw console.error("\u274c Data migration failed:",e),e}}migrateUserData(){try{const t=[localStorage.getItem("user"),sessionStorage.getItem("user"),localStorage.getItem("currentUser"),sessionStorage.getItem("currentUser")];for(const n of t)if(n)try{const e=JSON.parse(n);if(e&&e.id){const t=b.getUserData();if(!t||t.id!==e.id)return b.setUserData(e),console.log("\ud83d\udc64 Migrated user data:",e.username||e.name),!0}}catch(e){console.warn("\u26a0\ufe0f Could not parse user data from source:",e)}return!1}catch(t){return console.error("\u274c User data migration failed:",t),!1}}migrateMessages(){try{const t=[localStorage.getItem("quibish_messages"),localStorage.getItem("messages"),sessionStorage.getItem("quibish_messages"),sessionStorage.getItem("messages")];for(const n of t)if(n)try{const e=JSON.parse(n);if(Array.isArray(e)&&e.length>0){if(0===b.getMessages().length)return b.setMessages(e),console.log("\ud83d\udcac Migrated messages:",e.length),!0}}catch(e){console.warn("\u26a0\ufe0f Could not parse messages from source:",e)}return!1}catch(t){return console.error("\u274c Messages migration failed:",t),!1}}migrateAuthTokens(){try{const e=[localStorage.getItem("authToken"),localStorage.getItem("token"),sessionStorage.getItem("authToken"),sessionStorage.getItem("token")];for(const t of e)if(t){if(!b.getAuthToken())return b.setAuthToken(t),console.log("\ud83d\udd11 Migrated auth token"),!0}return!1}catch(e){return console.error("\u274c Auth token migration failed:",e),!1}}migrateSettings(){try{const t=[localStorage.getItem("settings"),localStorage.getItem("userSettings"),localStorage.getItem("preferences"),sessionStorage.getItem("settings")];for(const n of t)if(n)try{const e=JSON.parse(n);if(e&&"object"===typeof e){const t=b.getSettings();if(0===Object.keys(t).length)return b.setSettings(e),console.log("\u2699\ufe0f Migrated settings:",Object.keys(e)),!0}}catch(e){console.warn("\u26a0\ufe0f Could not parse settings from source:",e)}return!1}catch(t){return console.error("\u274c Settings migration failed:",t),!1}}migrateConversations(){try{const t=[localStorage.getItem("conversations"),localStorage.getItem("chats"),sessionStorage.getItem("conversations")];for(const n of t)if(n)try{const e=JSON.parse(n);if(Array.isArray(e)&&e.length>0){if(0===b.getConversations().length)return b.setConversations(e),console.log("\ud83d\udcac Migrated conversations:",e.length),!0}}catch(e){console.warn("\u26a0\ufe0f Could not parse conversations from source:",e)}return!1}catch(t){return console.error("\u274c Conversations migration failed:",t),!1}}cleanupOldData(){try{let e=0;["user","currentUser","authToken","token","quibish_messages","messages","settings","userSettings","preferences","conversations","chats"].forEach(t=>{localStorage.getItem(t)&&(localStorage.removeItem(t),e++),sessionStorage.getItem(t)&&(sessionStorage.removeItem(t),e++)}),e>0&&console.log("\ud83e\uddf9 Cleaned up ".concat(e," old storage entries"))}catch(e){console.warn("\u26a0\ufe0f Error during cleanup:",e)}}createBackup(){try{const e=b.exportAllData(),t="quibish_backup_".concat(Date.now());return localStorage.setItem(t,JSON.stringify(e)),console.log("\ud83d\udcbe Created data backup:",t),this.cleanupOldBackups(),t}catch(e){return console.error("\u274c Failed to create backup:",e),null}}cleanupOldBackups(){try{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith("quibish_backup_")&&e.push(n)}e.sort((e,t)=>{const n=parseInt(e.split("_")[2]);return parseInt(t.split("_")[2])-n}),e.length>3&&e.slice(3).forEach(e=>{localStorage.removeItem(e),console.log("\ud83d\uddd1\ufe0f Removed old backup: ".concat(e))})}catch(e){console.warn("\u26a0\ufe0f Error during backup cleanup:",e)}}restoreFromBackup(e){try{const t=localStorage.getItem(e);if(!t)throw new Error("Backup not found");const n=JSON.parse(t);if(b.importAllData(n))return console.log("\u2705 Data restored from backup:",e),!0;throw new Error("Import failed")}catch(t){return console.error("\u274c Failed to restore from backup:",t),!1}}getAvailableBackups(){try{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(n&&n.startsWith("quibish_backup_")){const t=parseInt(n.split("_")[2]);e.push({key:n,timestamp:t,date:new Date(t).toLocaleString()})}}return e.sort((e,t)=>t.timestamp-e.timestamp)}catch(e){return console.error("\u274c Failed to get backups:",e),[]}}async initializePersistence(){try{console.log("\ud83d\ude80 Initializing data persistence..."),this.createBackup(),this.needsMigration()&&await this.performMigration();const e=b.healthCheck();return e.healthy||console.warn("\u26a0\ufe0f Storage health check failed:",e),console.log("\u2705 Data persistence initialized successfully"),!0}catch(e){return console.error("\u274c Failed to initialize persistence:",e),!1}}},He=()=>{const{isAuthenticated:t,user:n,loading:a,logout:s}=k(),[r,i]=(0,e.useState)("login"),[o,l]=(0,e.useState)(()=>!sessionStorage.getItem("quibish-splash-seen")),[c,d]=(0,e.useState)(()=>{const e=localStorage.getItem("quibish-dark-mode");return!!e&&JSON.parse(e)}),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(null),[f]=(0,e.useState)([{id:1,name:"Sarah Johnson",avatar:"https://ui-avatars.com/api/?name=Sarah+Johnson&background=8b5cf6&color=fff&size=40",lastMessage:"Hey! Are we still on for lunch today?",lastMessageTime:"2m",unreadCount:2,isOnline:!0,isPinned:!0,isMuted:!1,messageStatus:"delivered",timestamp:new Date(Date.now()-12e4)},{id:2,name:"Team Alpha",avatar:"https://ui-avatars.com/api/?name=Team+Alpha&background=10b981&color=fff&size=40",lastMessage:"Mike: The deployment went smoothly \ud83d\ude80",lastMessageTime:"15m",unreadCount:5,isOnline:!1,isPinned:!1,isMuted:!1,messageStatus:"read",timestamp:new Date(Date.now()-9e5)},{id:3,name:"Alex Chen",avatar:"https://ui-avatars.com/api/?name=Alex+Chen&background=f59e0b&color=fff&size=40",lastMessage:"Thanks for the code review!",lastMessageTime:"1h",unreadCount:0,isOnline:!0,isPinned:!1,isMuted:!0,messageStatus:"sent",timestamp:new Date(Date.now()-36e5)},{id:4,name:"Design Team",avatar:"https://ui-avatars.com/api/?name=Design+Team&background=ef4444&color=fff&size=40",lastMessage:"Lisa: New mockups are ready for review",lastMessageTime:"3h",unreadCount:1,isOnline:!1,isPinned:!0,isMuted:!1,messageStatus:"delivered",timestamp:new Date(Date.now()-108e5)},{id:5,name:"Mom",avatar:"https://ui-avatars.com/api/?name=Mom&background=ec4899&color=fff&size=40",lastMessage:"Don't forget to call grandma today! \u2764\ufe0f",lastMessageTime:"5h",unreadCount:0,isOnline:!1,isPinned:!1,isMuted:!1,messageStatus:"read",timestamp:new Date(Date.now()-18e6)}]),[g]=(0,e.useState)(f[0]);(0,e.useEffect)(()=>{t&&n&&!a?(console.log("App - User authenticated, setting view to home"),i("home")):t||a||(console.log("App - User not authenticated, ensuring login view"),"home"===r&&i("login"))},[t,n,a,r]),(0,e.useEffect)(()=>{if(n&&n.theme){const e="dark"===n.theme;d(e),localStorage.setItem("quibish-dark-mode",JSON.stringify(e))}},[n]),(0,e.useEffect)(()=>((async()=>{try{console.log("\ud83d\ude80 Starting Quibish App...");await Be.initializePersistence()||console.warn("\u26a0\ufe0f Data persistence initialization failed, continuing with limited functionality");const e=b.healthCheck();console.log("\ud83d\udcbe Storage health:",e),console.log("\u2705 App initialization completed"),h(!0),console.log("\u2705 App initialized successfully")}catch(e){console.error("\u274c App initialization failed:",e),p(e.message),h(!0)}})(),()=>{console.log("\ud83e\uddf9 App unmounting - ensuring data persistence...");try{Be.createBackup(),console.log("\ud83d\udcbe Final backup created before unmount")}catch(e){console.warn("\u26a0\ufe0f Could not create final backup:",e)}}),[]),(0,e.useEffect)(()=>{if(window.addEventListener("pwa-new-chat",e=>{console.log("\ud83d\udcf1 PWA: New chat shortcut triggered"),t&&i("home")}),window.addEventListener("pwa-voice-call",e=>{console.log("\ud83d\udcf1 PWA: Voice call shortcut triggered",e.detail),t&&(i("home"),Oe.triggerShortcut("voice-call",{initiated:"shortcut"}))}),window.addEventListener("pwa-video-call",e=>{console.log("\ud83d\udcf1 PWA: Video call shortcut triggered",e.detail),t&&(i("home"),Oe.triggerShortcut("video-call",{initiated:"shortcut"}))}),window.addEventListener("pwa-files-shared",e=>{if(console.log("\ud83d\udcc1 PWA: Files shared",e.detail),t){i("home");const{files:t}=e.detail;console.log("Processing shared files:",t)}}),window.addEventListener("pwa-share-received",e=>{if(console.log("\ud83d\udce4 PWA: Content shared",e.detail),t){i("home");const{title:t,text:n,url:a}=e.detail;console.log("Processing shared content:",{title:t,text:n,url:a})}}),window.addEventListener("pwa-installed",e=>{console.log("\ud83d\udcf1 PWA: App installed",e.detail)}),t&&f.length>0){const e=f.filter(e=>e.lastMessageTime).sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)).slice(0,4).map(e=>({id:e.id,name:e.name,avatar:e.avatar}));Ue.updateShortcuts(e)}},[t,f]),(0,e.useEffect)(()=>{localStorage.setItem("quibish-dark-mode",JSON.stringify(c)),document.documentElement.setAttribute("data-theme",c?"dark":"light"),c?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme")},[c]);const v=()=>{l(!1),sessionStorage.setItem("quibish-splash-seen","true")};return a?(0,x.jsx)(Ae,{size:"large",message:"Loading..."}):u?o?(0,x.jsx)(Ie,{isVisible:!0,darkMode:c,appVersion:"1.0.0",onComplete:v}):(0,x.jsxs)(De,{children:[(0,x.jsx)("div",{className:"app smartphone-optimized ".concat(c?"dark-mode":""),children:(0,x.jsx)("div",{className:"app-content",children:t&&n&&!a?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Le,{compact:!0}),(0,x.jsx)(be,{user:n,conversations:f,currentConversation:g,onLogout:()=>{s(),i("login")},darkMode:c,onToggleDarkMode:()=>d(e=>!e)})]}):a?(0,x.jsx)(Ae,{size:"large",message:"Signing you in..."}):(0,x.jsxs)("div",{className:"auth-container",children:["login"===r&&(0,x.jsx)(Ce,{onLogin:()=>{console.log("App - handleLogin called, waiting for auth state update")},switchToRegister:()=>{console.log("App - switchToRegister called"),i("register")}}),"register"===r&&(0,x.jsx)(Te,{onRegisterSuccess:()=>{console.log("App - handleRegister called, redirecting to login"),i("login")},switchToLogin:()=>i("login")})]})})}),(0,x.jsx)(Pe,{}),(0,x.jsx)(_e,{}),(0,x.jsx)(Fe,{})]}):(0,x.jsx)(Ae,{size:"large",message:m?"Initialization failed: ".concat(m):"Initializing application..."})};console.log("\ud83d\udd0d Voice Recorder Diagnostic Test Starting..."),window.runVoiceRecorderDiagnostics=async function(){console.log("\ud83d\ude80 Starting Voice Recorder Diagnostics...");const e={browserSupport:!1,mimeTypeSupport:!1,permissions:"unknown",getUserMedia:!1,mediaRecorder:!1};try{e.browserSupport=function(){console.log("\n=== Test 1: Browser Support ===");const e={mediaRecorder:!!window.MediaRecorder,getUserMedia:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),audioContext:!(!window.AudioContext&&!window.webkitAudioContext),permissions:!!navigator.permissions};return console.log("Browser Support:",e),e.mediaRecorder?e.getUserMedia?(console.log("\u2705 Basic browser support available"),!0):(console.error("\u274c getUserMedia not supported"),!1):(console.error("\u274c MediaRecorder not supported"),!1)}(),e.browserSupport&&(e.mimeTypeSupport=function(){console.log("\n=== Test 2: MIME Type Support ===");const e=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg","audio/wav","audio/mp4","audio/aac"],t=e.filter(e=>{const t=MediaRecorder.isTypeSupported(e);return console.log("".concat(t?"\u2705":"\u274c"," ").concat(e,": ").concat(t)),t});return console.log("\nSupported MIME types: ".concat(t.length,"/").concat(e.length)),t.length>0}(),e.permissions=await async function(){console.log("\n=== Test 3: Permission Status ===");try{if(navigator.permissions){const e=await navigator.permissions.query({name:"microphone"});return console.log("\ud83c\udfa4 Microphone permission: ".concat(e.state)),e.addEventListener("change",()=>{console.log("\ud83d\udd04 Permission changed to: ".concat(e.state))}),e.state}return console.log("\u26a0\ufe0f Permissions API not supported"),"unknown"}catch(e){return console.error("\u274c Permission check failed:",e),"error"}}(),e.getUserMedia=await async function(){console.log("\n=== Test 4: getUserMedia Test ===");try{console.log("\ud83c\udfa4 Requesting microphone access...");const e=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:44100,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});console.log("\u2705 Microphone access granted"),console.log("\ud83d\udcca Stream info:",{id:e.id,active:e.active,tracks:e.getAudioTracks().length});const t=e.getAudioTracks()[0];return t&&(console.log("\ud83c\udfb5 Audio track settings:",t.getSettings()),console.log("\ud83c\udfb5 Audio track capabilities:",t.getCapabilities())),e.getTracks().forEach(e=>e.stop()),console.log("\ud83e\uddf9 Stream stopped"),!0}catch(e){switch(console.error("\u274c getUserMedia failed:",e),console.error("\u274c Error name:",e.name),console.error("\u274c Error message:",e.message),e.name){case"NotAllowedError":console.log("\ud83d\udca1 User denied microphone permission or feature policy blocks it");break;case"NotFoundError":console.log("\ud83d\udca1 No microphone device found");break;case"NotSupportedError":console.log("\ud83d\udca1 Audio constraints not supported");break;case"AbortError":console.log("\ud83d\udca1 Request was aborted");break;default:console.log("\ud83d\udca1 Unknown error occurred")}return!1}}(),e.getUserMedia&&(e.mediaRecorder=await async function(){console.log("\n=== Test 5: MediaRecorder Test ===");try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("\u2705 Got media stream for MediaRecorder test");const t="audio/webm;codecs=opus",n=new MediaRecorder(e,{mimeType:MediaRecorder.isTypeSupported(t)?t:void 0});return console.log("\u2705 MediaRecorder created successfully"),console.log("\ud83d\udcca MediaRecorder info:",{mimeType:n.mimeType,state:n.state,stream:n.stream.id}),n.onstart=()=>console.log("\ud83c\udfa4 MediaRecorder started"),n.onstop=()=>console.log("\ud83d\uded1 MediaRecorder stopped"),n.ondataavailable=e=>{console.log("\ud83d\udce6 Data available: ".concat(e.data.size," bytes"))},n.onerror=e=>{console.error("\u274c MediaRecorder error:",e.error)},console.log("\ud83c\udfa4 Starting 2-second test recording..."),n.start(100),setTimeout(()=>{n.stop(),e.getTracks().forEach(e=>e.stop()),console.log("\u2705 Test recording completed")},2e3),!0}catch(e){return console.error("\u274c MediaRecorder test failed:",e),!1}}())),console.log("\n=== Final Results ==="),console.log("\ud83d\udcca Diagnostic Results:",e);e.browserSupport&&e.mimeTypeSupport&&e.getUserMedia&&e.mediaRecorder?console.log("\ud83c\udf89 Voice recording should work perfectly!"):(console.log("\u26a0\ufe0f Voice recording may have issues:"),e.browserSupport||console.log("  - Browser support missing"),e.mimeTypeSupport||console.log("  - No supported MIME types"),e.getUserMedia||console.log("  - Cannot access microphone"),e.mediaRecorder||console.log("  - MediaRecorder issues"),"denied"===e.permissions&&console.log("  - Microphone permission denied"))}catch(t){console.error("\u274c Diagnostic test failed:",t)}},window.addEventListener("error",e=>{if(e.filename&&(e.filename.includes("contentScript.js")||e.filename.includes("chrome-extension://")||e.filename.includes("moz-extension://")))return console.warn("\ud83d\udd0c Browser extension error (ignored):",e.message),e.preventDefault(),!0});t.createRoot(document.getElementById("root")).render((0,x.jsx)(e.StrictMode,{children:(0,x.jsx)(S,{children:(0,x.jsx)(He,{})})}))})()})();